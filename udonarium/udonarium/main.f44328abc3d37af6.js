(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8792],{8848:(je,Y,V)=>{"use strict";V.d(Y,{U:()=>E});class E{}},8518:(je,Y,V)=>{"use strict";V.d(Y,{y:()=>j});var E=V(7385),Z=V.n(E),R=V(1782),P=V(4232),k=V(6609);const I=Z()("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),S=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class j{get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}constructor(U){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:k.s.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(U)}parse(U){try{this.peerId=U;let ne=S.exec(U);if(null!=ne)return this.digestUserId=ne[1],this.roomId=ne[2],this.roomName=R.decompress(ne[3]),void(this.digestPassword=ne[4])}catch(ne){console.warn(ne)}this.digestUserId=U}verifyPassword(U){return T(this.digestUserId,this.roomId,this.roomName,U)===this.digestPassword&&this.verifyRoomId(U)}verifyRoomId(U){return F(this.roomId,this.roomName,U)===this.roomId}verifyPeer(U){let ne=j.parse(U);return this.roomId==ne.roomId&&this.roomName==ne.roomName&&this.hasPassword==ne.hasPassword&&(!this.hasPassword||(this.password.length<1?(console.error("do not know password."),!1):ne.verifyPassword(this.password)))}static parse(U){return new j(U)}static create(...U){return U.length<=1?j._create.apply(this,U):j._createRoom.apply(this,U)}static _create(U=""){let ne=function A(W){return null==W?"":q(W)}(U),me=new j(ne);return me.userId=U,me}static _createRoom(U="",ne="",me="",Ve=""){let K=q(U,6),de=F(ne,me,Ve),fe=T(K,de,me,Ve),Le=`${K}${de}${R.compress(me)}-${fe}`,qe=new j(Le);return qe.userId=U,qe.password=Ve,qe}static generateId(U="********"){let me=U;return me=U.replace(/\*/g,Ve=>"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())]),me}}function T(W,U,ne,me){return null==U||null==me?"":0<me.length?q(W+U+ne+me,7):""}function F(W,U,ne){if(ne.length<1)return W;let me=W.slice(0,2);return me+q(me+U+ne,1)}function q(W,U=-1){if(null==W)return"";let ne=P.M.sha256(W),me=I.encode(ne);return U<0&&(U=me.length),me.length<U&&(U=me.length),me=me.slice(0,U),me}},6609:(je,Y,V)=>{"use strict";V.d(Y,{s:()=>E});var E=function(Z){return Z[Z.UNSPECIFIED=0]="UNSPECIFIED",Z[Z.LOW=1]="LOW",Z[Z.MIDDLE=2]="MIDDLE",Z[Z.HIGH=3]="HIGH",Z}(E||{})},4232:(je,Y,V)=>{"use strict";V.d(Y,{M:()=>k});var k,E=V(8823),Z=V.n(E),R=V(5168),P=V.n(R);!function(I){function T(F){let q=new Uint8Array(F.words.length<<2),W=0;for(let U of F.words)q[W++]=(4278190080&U)>>>24,q[W++]=(16711680&U)>>>16,q[W++]=(65280&U)>>>8,q[W++]=255&U;return q}I.sha256=function S(F){let q;if(F instanceof ArrayBuffer){let W=Z().create(F);q=P()(W)}else q=P()(F);return T(q)},I.sha256Hex=function j(F){if(F instanceof ArrayBuffer){let q=Z().create(F);return P()(q).toString()}return P()(F).toString()},I.sha256Base64Url=function A(F){if(null==F)return"";let W=T(P()(F));return btoa(String.fromCharCode(...W)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/g,"")}}(k||(k={}))},8161:(je,Y,V)=>{"use strict";V.d(Y,{$:()=>Z});var Z,R,E=V(4999);(R=Z||(Z={})).encode=function P(I){try{return E.encode(I)}catch(S){console.error(S,I)}return null},R.decode=function k(I){try{return E.decode(I)}catch(S){console.error(S,I)}return null}},9757:(je,Y,V)=>{"use strict";V.d(Y,{b:()=>E});class E{get isActive(){return null!=this.timeoutTimer}constructor(R,P,k=!0){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=R,this.timerMilliSecond=P,k&&this.reset()}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...R){1===R.length?this.timerMilliSecond=R[0]:1<R.length&&(this.callback=R[0],this.timerMilliSecond=R[1]),this.isStopped=!1;let P=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&P<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}},1185:(je,Y,V)=>{"use strict";var E;V.d(Y,{k:()=>E}),function(Z){let R=[];for(let k=0;k<256;k++)R[k]=(k<16?"0":"")+k.toString(16);Z.generateUuid=function P(){const k=new Uint32Array(4);window.crypto.getRandomValues(k);const I=k[0],S=k[1],j=k[2],A=k[3];return R[255&I]+R[I>>8&255]+R[I>>16&255]+R[I>>24&255]+"-"+R[255&S]+R[S>>8&255]+"-"+R[S>>16&15|64]+R[S>>24&255]+"-"+R[63&j|128]+R[j>>8&255]+"-"+R[j>>16&255]+R[j>>24&255]+R[255&A]+R[A>>8&255]+R[A>>16&255]+R[A>>24&255]}}(E||(E={}))},2306:(je,Y,V)=>{"use strict";V.d(Y,{W:()=>P,v:()=>k});let E=0;const Z=new Map,R=new MessageChannel;function P(I){if(4294967296===E&&(E=0),++E in Z)throw new Error("setZeroTimeout queue overflow.");return Z.set(E,I),R.port2.postMessage(E),E}function k(I){Z.delete(I)}R.port1.onmessage=function(I){const S=Z.get(I.data);Z.delete(I.data),S&&S()},R.port1.start(),R.port2.start()},3695:(je,Y,V)=>{"use strict";var E=V(467);let R=null,k=1;const I=Symbol("SIGNAL");function S(t){const n=R;return R=t,n}function U(t){if((!it(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==k)){if(!t.producerMustRecompute(t)&&!fe(t))return t.dirty=!1,void(t.lastCleanEpoch=k);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=k}}function fe(t){Ft(t);for(let n=0;n<t.producerNode.length;n++){const e=t.producerNode[n],i=t.producerLastReadVersion[n];if(i!==e.version||(U(e),i!==e.version))return!0}return!1}function ie(t,n){if(function He(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),Ft(t),1===t.liveConsumerNode.length)for(let i=0;i<t.producerNode.length;i++)ie(t.producerNode[i],t.producerIndexOfThis[i]);const e=t.liveConsumerNode.length-1;if(t.liveConsumerNode[n]=t.liveConsumerNode[e],t.liveConsumerIndexOfThis[n]=t.liveConsumerIndexOfThis[e],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,n<t.liveConsumerNode.length){const i=t.liveConsumerIndexOfThis[n],r=t.liveConsumerNode[n];Ft(r),r.producerIndexOfThis[i]=n}}function it(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Ft(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let ct=null;function Qe(t){return"function"==typeof t}function ft(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const _t=ft(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function St(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class qt{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(Qe(i))try{i()}catch(o){n=o instanceof _t?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{Gi(o)}catch(s){n=n??[],s instanceof _t?n=[...n,...s.errors]:n.push(s)}}if(n)throw new _t(n)}}add(n){var e;if(n&&n!==this)if(this.closed)Gi(n);else{if(n instanceof qt){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&St(e,n)}remove(n){const{_finalizers:e}=this;e&&St(e,n),n instanceof qt&&n._removeParent(this)}}qt.EMPTY=(()=>{const t=new qt;return t.closed=!0,t})();const Yn=qt.EMPTY;function mi(t){return t instanceof qt||t&&"closed"in t&&Qe(t.remove)&&Qe(t.add)&&Qe(t.unsubscribe)}function Gi(t){Qe(t)?t():t.unsubscribe()}const vo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},yo={setTimeout(t,n,...e){const{delegate:i}=yo;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=yo;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Cr(t){yo.setTimeout(()=>{const{onUnhandledError:n}=vo;if(!n)throw t;n(t)})}function Qh(){}const Lg=Lu("C",void 0,void 0);function Lu(t,n,e){return{kind:t,value:n,error:e}}let os=null;function il(t){if(vo.useDeprecatedSynchronousErrorHandling){const n=!os;if(n&&(os={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=os;if(os=null,e)throw i}}else t()}class tc extends qt{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,mi(n)&&n.add(this)):this.destination=rc}static create(n,e,i){return new Bu(n,e,i)}next(n){this.isStopped?ju(function jg(t){return Lu("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?ju(function Bg(t){return Lu("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?ju(Lg,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const nc=Function.prototype.bind;function rl(t,n){return nc.call(t,n)}class Ug{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){ic(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){ic(i)}else ic(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){ic(e)}}}class Bu extends tc{constructor(n,e,i){let r;if(super(),Qe(n)||!n)r={next:n??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&vo.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&rl(n.next,o),error:n.error&&rl(n.error,o),complete:n.complete&&rl(n.complete,o)}):r=n}this.destination=new Ug(r)}}function ic(t){vo.useDeprecatedSynchronousErrorHandling?function Jh(t){vo.useDeprecatedSynchronousErrorHandling&&os&&(os.errorThrown=!0,os.error=t)}(t):Cr(t)}function ju(t,n){const{onStoppedNotification:e}=vo;e&&yo.setTimeout(()=>e(t,n))}const rc={closed:!0,next:Qh,error:function Vg(t){throw t},complete:Qh},Uu="function"==typeof Symbol&&Symbol.observable||"@@observable";function Hg(t){return t}let ir=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function $g(t){return t&&t instanceof tc||function Gg(t){return t&&Qe(t.next)&&Qe(t.error)&&Qe(t.complete)}(t)&&mi(t)}(e)?e:new Bu(e,i,r);return il(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=ef(i))((r,o)=>{const s=new Bu({next:a=>{try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[Uu](){return this}pipe(...e){return function Vu(t){return 0===t.length?Hg:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}(e)(this)}toPromise(e){return new(e=ef(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return t.create=n=>new t(n),t})();function ef(t){var n;return null!==(n=t??vo.Promise)&&void 0!==n?n:Promise}const tf=ft(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ol=(()=>{class t extends ir{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new nf(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new tf}next(e){il(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){il(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){il(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?Yn:(this.currentObservers=null,o.push(e),new qt(()=>{this.currentObservers=null,St(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new ir;return e.source=this,e}}return t.create=(n,e)=>new nf(n,e),t})();class nf extends ol{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:Yn}}class Wg extends ol{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Hu(t){return n=>{if(function oc(t){return Qe(t?.lift)}(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function zu(t,n,e,i,r){return new rf(t,n,e,i,r)}class rf extends tc{constructor(n,e,i,r,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(l){n.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function sl(t,n){return Hu((e,i)=>{let r=0;e.subscribe(zu(i,o=>{i.next(t.call(n,o,r++))}))})}const Gu="https://g.co/ng/security#xss";class le extends Error{constructor(n,e){super(function Zs(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}(n,e)),this.code=n}}function wr(t){return{toString:t}.toString()}const Ro="__parameters__";function Lo(t,n,e){return wr(()=>{const i=function Wu(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(l,c,u){const d=l.hasOwnProperty(Ro)?l[Ro]:Object.defineProperty(l,Ro,{value:[]})[Ro];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(s),l}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}const Zt=globalThis;function en(t){for(let n in t)if(t[n]===en)return n;throw Error("Could not find renamed property on target object.")}function Co(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Cn(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Cn).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function sc(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const ac=en({__forward_ref__:en});function Ht(t){return t.__forward_ref__=Ht,t.toString=function(){return Cn(this())},t}function ut(t){return Ea(t)?t():t}function Ea(t){return"function"==typeof t&&t.hasOwnProperty(ac)&&t.__forward_ref__===Ht}function We(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Xs(t){return{providers:t.providers||[],imports:t.imports||[]}}function cf(t){return XC(t,df)||XC(t,KC)}function XC(t,n){return t.hasOwnProperty(n)?t[n]:null}function uf(t){return t&&(t.hasOwnProperty(Qg)||t.hasOwnProperty(lN))?t[Qg]:null}const df=en({\u0275prov:en}),Qg=en({\u0275inj:en}),KC=en({ngInjectableDef:en}),lN=en({ngInjectorDef:en});class dt{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=We({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function r0(t){return t&&!!t.\u0275providers}const Yu=en({\u0275cmp:en}),o0=en({\u0275dir:en}),s0=en({\u0275pipe:en}),JC=en({\u0275mod:en}),Ks=en({\u0275fac:en}),Xu=en({__NG_ELEMENT_ID__:en}),ew=en({__NG_ENV_ID__:en});function Mt(t){return"string"==typeof t?t:null==t?"":String(t)}function a0(t,n){throw new le(-201,!1)}var tn=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(tn||{});let l0;function tw(){return l0}function Br(t){const n=l0;return l0=t,n}function nw(t,n,e){const i=cf(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&tn.Optional?null:void 0!==n?n:void a0()}const Ku={},c0="__NG_DI_FLAG__",hf="ngTempTokenPath",pN=/\n/gm,iw="__source";let lc;function xa(t){const n=lc;return lc=t,n}function _N(t,n=tn.Default){if(void 0===lc)throw new le(-203,!1);return null===lc?nw(t,void 0,n):lc.get(t,n&tn.Optional?null:void 0,n)}function Ot(t,n=tn.Default){return(tw()||_N)(ut(t),n)}function It(t,n=tn.Default){return Ot(t,ff(n))}function ff(t){return typeof t>"u"||"number"==typeof t?t:(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function u0(t){const n=[];for(let e=0;e<t.length;e++){const i=ut(t[e]);if(Array.isArray(i)){if(0===i.length)throw new le(900,!1);let r,o=tn.Default;for(let s=0;s<i.length;s++){const a=i[s],l=vN(a);"number"==typeof l?-1===l?r=a.token:o|=l:r=a}n.push(Ot(r,o))}else n.push(Ot(i))}return n}function Qu(t,n){return t[c0]=n,t.prototype[c0]=n,t}function vN(t){return t[c0]}const d0=Qu(Lo("Optional"),8),h0=Qu(Lo("SkipSelf"),4);function ll(t,n){return t.hasOwnProperty(Ks)?t[Ks]:null}function cc(t,n){t.forEach(e=>Array.isArray(e)?cc(e,n):n(e))}function ow(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function pf(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function no(t,n,e){let i=uc(t,n);return i>=0?t[1|i]=e:(i=~i,function sw(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function p0(t,n){const e=uc(t,n);if(e>=0)return t[1|e]}function uc(t,n){return function aw(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=t[o<<e];if(n===s)return o<<e;s>n?r=o:i=o+1}return~(r<<e)}(t,n,1)}const cs={},an=[],dc=new dt(""),lw=new dt("",-1),m0=new dt("");class gf{get(n,e=Ku){if(e===Ku){const i=new Error(`NullInjectorError: No provider for ${Cn(n)}!`);throw i.name="NullInjectorError",i}return e}}var _f=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(_f||{}),jo=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(jo||{}),Rt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Rt||{});function TN(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=n.length;if(r+o===i||t.charCodeAt(r+o)<=32)return r}e=r+1}}function g0(t,n,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const o=e[i++],s=e[i++],a=e[i++];t.setAttribute(n,s,a,o)}else{const o=r,s=e[++i];uw(o)?t.setProperty(n,o,s):t.setAttribute(n,o,s),i++}}return i}function cw(t){return 3===t||4===t||6===t}function uw(t){return 64===t.charCodeAt(0)}function Ju(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||dw(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function dw(t,n,e,i,r){let o=0,s=t.length;if(-1===n)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===n){s=-1;break}if(a>n){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,n),o=s+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}const hw="ng-template";function DN(t,n,e,i){let r=0;if(i){for(;r<n.length&&"string"==typeof n[r];r+=2)if("class"===n[r]&&-1!==TN(n[r+1].toLowerCase(),e,0))return!0}else if(_0(t))return!1;if(r=n.indexOf(1,r),r>-1){let o;for(;++r<n.length&&"string"==typeof(o=n[r]);)if(o.toLowerCase()===e)return!0}return!1}function _0(t){return 4===t.type&&t.value!==hw}function SN(t,n,e){return n===(4!==t.type||e?t.value:hw)}function MN(t,n,e){let i=4;const r=t.attrs,o=null!==r?function kN(t){for(let n=0;n<t.length;n++)if(cw(t[n]))return n;return t.length}(r):0;let s=!1;for(let a=0;a<n.length;a++){const l=n[a];if("number"!=typeof l){if(!s)if(4&i){if(i=2|1&i,""!==l&&!SN(t,l,e)||""===l&&1===n.length){if(Uo(i))return!1;s=!0}}else if(8&i){if(null===r||!DN(t,r,l,e)){if(Uo(i))return!1;s=!0}}else{const c=n[++a],u=IN(l,r,_0(t),e);if(-1===u){if(Uo(i))return!1;s=!0;continue}if(""!==c){let d;if(d=u>o?"":r[u+1].toLowerCase(),2&i&&c!==d){if(Uo(i))return!1;s=!0}}}}else{if(!s&&!Uo(i)&&!Uo(l))return!1;if(s&&Uo(l))continue;s=!1,i=l|1&i}}return Uo(i)||s}function Uo(t){return!(1&t)}function IN(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let o=!1;for(;r<n.length;){const s=n[r];if(s===t)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function ON(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function fw(t,n,e=!1){for(let i=0;i<n.length;i++)if(MN(t,n[i],e))return!0;return!1}function PN(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function pw(t,n){return t?":not("+n.trim()+")":n}function NN(t){let n=t[0],e=1,i=2,r="",o=!1;for(;e<t.length;){let s=t[e];if("string"==typeof s)if(2&i){const a=t[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!Uo(s)&&(n+=pw(o,r),r=""),i=s,o=o||!Uo(i);e++}return""!==r&&(n+=pw(o,r)),n}function Kt(t){return wr(()=>{const n=gw(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===_f.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||jo.Emulated,styles:t.styles||an,_:null,schemas:t.schemas||null,tView:null,id:""};_w(e);const i=t.dependencies;return e.directiveDefs=vf(i,!1),e.pipeDefs=vf(i,!0),e.id=function UN(t){let n=0;const e=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const r of e)n=Math.imul(31,n)+r.charCodeAt(0)|0;return n+=2147483648,"c"+n}(e),e})}function LN(t){return Vt(t)||Si(t)}function BN(t){return null!==t}function Ta(t){return wr(()=>({type:t.type,bootstrap:t.bootstrap||an,declarations:t.declarations||an,imports:t.imports||an,exports:t.exports||an,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function mw(t,n){if(null==t)return cs;const e={};for(const i in t)if(t.hasOwnProperty(i)){const r=t[i];let o,s,a=Rt.None;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o):(o=r,s=r),n?(e[o]=a!==Rt.None?[i,a]:i,n[o]=s):e[o]=i}return e}function vt(t){return wr(()=>{const n=gw(t);return _w(n),n})}function Er(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Vt(t){return t[Yu]||null}function Si(t){return t[o0]||null}function Wi(t){return t[s0]||null}function gw(t){const n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:t.inputs||cs,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||an,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:mw(t.inputs,n),outputs:mw(t.outputs),debugInfo:null}}function _w(t){t.features?.forEach(n=>n(t))}function vf(t,n){if(!t)return null;const e=n?Wi:LN;return()=>("function"==typeof t?t():t).map(i=>e(i)).filter(BN)}function VN(...t){return{\u0275providers:v0(0,t),\u0275fromNgModule:!0}}function v0(t,...n){const e=[],i=new Set;let r;const o=s=>{e.push(s)};return cc(n,s=>{const a=s;bf(a,o,[],i)&&(r||=[],r.push(a))}),void 0!==r&&vw(r,o),e}function vw(t,n){for(let e=0;e<t.length;e++){const{ngModule:i,providers:r}=t[e];y0(r,o=>{n(o,i)})}}function bf(t,n,e,i){if(!(t=ut(t)))return!1;let r=null,o=uf(t);const s=!o&&Vt(t);if(o||s){if(s&&!s.standalone)return!1;r=t}else{const l=t.ngModule;if(o=uf(l),!o)return!1;r=l}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const l="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const c of l)bf(c,n,e,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let c;i.add(r);try{cc(o.imports,u=>{bf(u,n,e,i)&&(c||=[],c.push(u))})}finally{}void 0!==c&&vw(c,n)}if(!a){const c=ll(r)||(()=>new r);n({provide:r,useFactory:c,deps:an},r),n({provide:m0,useValue:r,multi:!0},r),n({provide:dc,useValue:()=>Ot(r),multi:!0},r)}const l=o.providers;if(null!=l&&!a){const c=t;y0(l,u=>{n(u,c)})}}}return r!==t&&void 0!==t.providers}function y0(t,n){for(let e of t)r0(e)&&(e=e.\u0275providers),Array.isArray(e)?y0(e,n):n(e)}const HN=en({provide:String,useValue:en});function b0(t){return null!==t&&"object"==typeof t&&HN in t}function ul(t){return"function"==typeof t}const C0=new dt(""),Cf={},GN={};let w0;function wf(){return void 0===w0&&(w0=new gf),w0}class us{}class hc extends us{get destroyed(){return this._destroyed}constructor(n,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,x0(n,s=>this.processProvider(s)),this.records.set(lw,fc(void 0,this)),r.has("environment")&&this.records.set(us,fc(void 0,this));const o=this.records.get(C0);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(m0,an,tn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const n=S(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of e)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),S(n)}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const e=xa(this),i=Br(void 0);try{return n()}finally{xa(e),Br(i)}}get(n,e=Ku,i=tn.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(ew))return n[ew](this);i=ff(i);const o=xa(this),s=Br(void 0);try{if(!(i&tn.SkipSelf)){let l=this.records.get(n);if(void 0===l){const c=function YN(t){return"function"==typeof t||"object"==typeof t&&t instanceof dt}(n)&&cf(n);l=c&&this.injectableDefInScope(c)?fc(E0(n),Cf):null,this.records.set(n,l)}if(null!=l)return this.hydrate(n,l)}return(i&tn.Self?wf():this.parent).get(n,e=i&tn.Optional&&e===Ku?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[hf]=a[hf]||[]).unshift(Cn(n)),o)throw a;return function yN(t,n,e,i){const r=t[hf];throw n[iw]&&r.unshift(n[iw]),t.message=function bN(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let r=Cn(n);if(Array.isArray(n))r=n.map(Cn).join(" -> ");else if("object"==typeof n){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):Cn(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(pN,"\n  ")}`}("\n"+t.message,r,e,i),t.ngTokenPath=r,t[hf]=null,t}(a,n,"R3InjectorError",this.source)}throw a}finally{Br(s),xa(o)}}resolveInjectorInitializers(){const n=S(null),e=xa(this),i=Br(void 0);try{const o=this.get(dc,an,tn.Self);for(const s of o)s()}finally{xa(e),Br(i),S(n)}}toString(){const n=[],e=this.records;for(const i of e.keys())n.push(Cn(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new le(205,!1)}processProvider(n){let e=ul(n=ut(n))?n:ut(n&&n.provide);const i=function WN(t){return b0(t)?fc(void 0,t.useValue):fc(Cw(t),Cf)}(n);if(!ul(n)&&!0===n.multi){let r=this.records.get(e);r||(r=fc(void 0,Cf,!0),r.factory=()=>u0(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,i)}hydrate(n,e){const i=S(null);try{return e.value===Cf&&(e.value=GN,e.value=e.factory()),"object"==typeof e.value&&e.value&&function ZN(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{S(i)}}injectableDefInScope(n){if(!n.providedIn)return!1;const e=ut(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(n){const e=this._onDestroyHooks.indexOf(n);-1!==e&&this._onDestroyHooks.splice(e,1)}}function E0(t){const n=cf(t),e=null!==n?n.factory:ll(t);if(null!==e)return e;if(t instanceof dt)throw new le(204,!1);if(t instanceof Function)return function $N(t){if(t.length>0)throw new le(204,!1);const e=function aN(t){return t&&(t[df]||t[KC])||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new le(204,!1)}function Cw(t,n,e){let i;if(ul(t)){const r=ut(t);return ll(r)||E0(r)}if(b0(t))i=()=>ut(t.useValue);else if(function bw(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...u0(t.deps||[]));else if(function yw(t){return!(!t||!t.useExisting)}(t))i=()=>Ot(ut(t.useExisting));else{const r=ut(t&&(t.useClass||t.provide));if(!function qN(t){return!!t.deps}(t))return ll(r)||E0(r);i=()=>new r(...u0(t.deps))}return i}function fc(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function x0(t,n){for(const e of t)Array.isArray(e)?x0(e,n):e&&r0(e)?x0(e.\u0275providers,n):n(e)}const $n=0,Se=1,rt=2,si=3,Vo=4,sr=5,io=6,mc=7,An=8,gi=9,Ho=10,Ct=11,td=12,Tw=13,gc=14,Xn=15,nd=16,_c=17,Qs=18,id=19,Dw=20,Da=21,Tf=22,dl=23,At=25,D0=1,ds=7,vc=9,ai=10;var S0=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(S0||{});function ar(t){return Array.isArray(t)&&"object"==typeof t[D0]}function lr(t){return Array.isArray(t)&&!0===t[D0]}function M0(t){return!!(4&t.flags)}function hl(t){return t.componentOffset>-1}function Sf(t){return!(1&~t.flags)}function zo(t){return!!t.template}function I0(t){return!!(512&t[rt])}class lF{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Aw(t,n,e,i){null!==n?n.applyValueToInputSignal(n,i):t[e]=i}function Kn(){return kw}function kw(t){return t.type.prototype.ngOnChanges&&(t.setInput=uF),cF}function cF(){const t=Pw(this),n=t?.current;if(n){const e=t.previous;if(e===cs)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function uF(t,n,e,i,r){const o=this.declaredInputs[i],s=Pw(t)||function dF(t,n){return t[Ow]=n}(t,{previous:cs,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new lF(c&&c.currentValue,e,l===cs),Aw(t,n,r,e)}Kn.ngInherit=!0;const Ow="__ngSimpleChanges__";function Pw(t){return t[Ow]||null}const hs=function(t,n,e){};let Rw=!1;function Dn(t){for(;Array.isArray(t);)t=t[$n];return t}function od(t,n){return Dn(n[t])}function xr(t,n){return Dn(n[t.index])}function sd(t,n){return t.data[n]}function yc(t,n){return t[n]}function ro(t,n){const e=n[t];return ar(e)?e:e[$n]}function N0(t){return!(128&~t[rt])}function fs(t,n){return null==n?null:t[n]}function Lw(t){t[_c]=0}function _F(t){1024&t[rt]||(t[rt]|=1024,N0(t)&&ad(t))}function F0(t){return!!(9216&t[rt]||t[dl]?.dirty)}function R0(t){t[Ho].changeDetectionScheduler?.notify(1),F0(t)?ad(t):64&t[rt]&&(function fF(){return Rw}()?(t[rt]|=1024,ad(t)):t[Ho].changeDetectionScheduler?.notify())}function ad(t){t[Ho].changeDetectionScheduler?.notify();let n=fl(t);for(;null!==n&&!(8192&n[rt])&&(n[rt]|=8192,N0(n));)n=fl(n)}function Mf(t,n){if(!(256&~t[rt]))throw new le(911,!1);null===t[Da]&&(t[Da]=[]),t[Da].push(n)}function fl(t){const n=t[si];return lr(n)?n[si]:n}const wt={lFrame:qw(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Uw(){return wt.bindingsEnabled}function bc(){return null!==wt.skipHydrationRootTNode}function ce(){return wt.lFrame.lView}function Yt(){return wt.lFrame.tView}function re(t){return wt.lFrame.contextLView=t,t[An]}function oe(t){return wt.lFrame.contextLView=null,t}function wn(){let t=Vw();for(;null!==t&&64===t.type;)t=t.parent;return t}function Vw(){return wt.lFrame.currentTNode}function ps(t,n){const e=wt.lFrame;e.currentTNode=t,e.isParent=n}function B0(){return wt.lFrame.isParent}function j0(){wt.lFrame.isParent=!1}function Tr(){const t=wt.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Js(){return wt.lFrame.bindingIndex}function Go(){return wt.lFrame.bindingIndex++}function ea(t){const n=wt.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function MF(t,n){const e=wt.lFrame;e.bindingIndex=e.bindingRootIndex=t,U0(n)}function U0(t){wt.lFrame.currentDirectiveIndex=t}function H0(){return wt.lFrame.currentQueryIndex}function If(t){wt.lFrame.currentQueryIndex=t}function AF(t){const n=t[Se];return 2===n.type?n.declTNode:1===n.type?t[sr]:null}function $w(t,n,e){if(e&tn.SkipSelf){let r=n,o=t;for(;!(r=r.parent,null!==r||e&tn.Host||(r=AF(o),null===r||(o=o[gc],10&r.type))););if(null===r)return!1;n=r,t=o}const i=wt.lFrame=Ww();return i.currentTNode=n,i.lView=t,!0}function z0(t){const n=Ww(),e=t[Se];wt.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function Ww(){const t=wt.lFrame,n=null===t?null:t.child;return null===n?qw(t):n}function qw(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function Zw(){const t=wt.lFrame;return wt.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Yw=Zw;function G0(){const t=Zw();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function cr(){return wt.lFrame.selectedIndex}function pl(t){wt.lFrame.selectedIndex=t}function kn(){const t=wt.lFrame;return sd(t.tView,t.selectedIndex)}let Qw=!0;function cd(){return Qw}function ms(t){Qw=t}function Af(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=o;s&&(t.contentHooks??=[]).push(-e,s),a&&((t.contentHooks??=[]).push(e,a),(t.contentCheckHooks??=[]).push(e,a)),l&&(t.viewHooks??=[]).push(-e,l),c&&((t.viewHooks??=[]).push(e,c),(t.viewCheckHooks??=[]).push(e,c)),null!=u&&(t.destroyHooks??=[]).push(e,u)}}function kf(t,n,e){Jw(t,n,3,e)}function Of(t,n,e,i){(3&t[rt])===e&&Jw(t,n,e,i)}function $0(t,n){let e=t[rt];(3&e)===n&&(e&=16383,e+=1,t[rt]=e)}function Jw(t,n,e,i){const o=i??-1,s=n.length-1;let a=0;for(let l=void 0!==i?65535&t[_c]:0;l<s;l++)if("number"==typeof n[l+1]){if(a=n[l],null!=i&&a>=i)break}else n[l]<0&&(t[_c]+=65536),(a<o||-1==o)&&(RF(t,e,n,l),t[_c]=(4294901760&t[_c])+l+2),l++}function eE(t,n){hs(4,t,n);const e=S(null);try{n.call(t)}finally{S(e),hs(5,t,n)}}function RF(t,n,e,i){const r=e[i]<0,o=e[i+1],a=t[r?-e[i]:e[i]];r?t[rt]>>14<t[_c]>>16&&(3&t[rt])===n&&(t[rt]+=16384,eE(a,o)):eE(a,o)}const Cc=-1;class ud{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function q0(t){return t!==Cc}function dd(t){return 32767&t}function hd(t,n){let e=function VF(t){return t>>16}(t),i=n;for(;e>0;)i=i[gc],e--;return i}let Z0=!0;function Pf(t){const n=Z0;return Z0=t,n}const tE=255,nE=5;let HF=0;const gs={};function Nf(t,n){const e=iE(t,n);if(-1!==e)return e;const i=n[Se];i.firstCreatePass&&(t.injectorIndex=n.length,Y0(i.data,t),Y0(n,null),Y0(i.blueprint,null));const r=Ff(t,n),o=t.injectorIndex;if(q0(r)){const s=dd(r),a=hd(r,n),l=a[Se].data;for(let c=0;c<8;c++)n[o+c]=a[s+c]|l[s+c]}return n[o+8]=r,o}function Y0(t,n){t.push(0,0,0,0,0,0,0,0,n)}function iE(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function Ff(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){if(i=uE(r),null===i)return Cc;if(e++,r=r[gc],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return Cc}function X0(t,n,e){!function zF(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Xu)&&(i=e[Xu]),null==i&&(i=e[Xu]=HF++);const r=i&tE;n.data[t+(r>>nE)]|=1<<r}(t,n,e)}function rE(t,n,e){if(e&tn.Optional||void 0!==t)return t;a0()}function oE(t,n,e,i){if(e&tn.Optional&&void 0===i&&(i=null),!(e&(tn.Self|tn.Host))){const r=t[gi],o=Br(void 0);try{return r?r.get(n,i,e&tn.Optional):nw(n,i,e&tn.Optional)}finally{Br(o)}}return rE(i,0,e)}function sE(t,n,e,i=tn.Default,r){if(null!==t){if(2048&n[rt]&&!(i&tn.Self)){const s=function ZF(t,n,e,i,r){let o=t,s=n;for(;null!==o&&null!==s&&2048&s[rt]&&!(512&s[rt]);){const a=aE(o,s,e,i|tn.Self,gs);if(a!==gs)return a;let l=o.parent;if(!l){const c=s[Dw];if(c){const u=c.get(e,gs,i);if(u!==gs)return u}l=uE(s),s=s[gc]}o=l}return r}(t,n,e,i,gs);if(s!==gs)return s}const o=aE(t,n,e,i,gs);if(o!==gs)return o}return oE(n,e,i,r)}function aE(t,n,e,i,r){const o=function WF(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Xu)?t[Xu]:void 0;return"number"==typeof n?n>=0?n&tE:qF:n}(e);if("function"==typeof o){if(!$w(n,t,i))return i&tn.Host?rE(r,0,i):oE(n,e,i,r);try{let s;if(s=o(i),null!=s||i&tn.Optional)return s;a0()}finally{Yw()}}else if("number"==typeof o){let s=null,a=iE(t,n),l=Cc,c=i&tn.Host?n[Xn][sr]:null;for((-1===a||i&tn.SkipSelf)&&(l=-1===a?Ff(t,n):n[a+8],l!==Cc&&cE(i,!1)?(s=n[Se],a=dd(l),n=hd(l,n)):a=-1);-1!==a;){const u=n[Se];if(lE(o,a,u.data)){const d=$F(a,n,e,s,i,c);if(d!==gs)return d}l=n[a+8],l!==Cc&&cE(i,n[Se].data[a+8]===c)&&lE(o,a,n)?(s=u,a=dd(l),n=hd(l,n)):a=-1}}return r}function $F(t,n,e,i,r,o){const s=n[Se],a=s.data[t+8],u=Rf(a,s,e,null==i?hl(a)&&Z0:i!=s&&!!(3&a.type),r&tn.Host&&o===a);return null!==u?ml(n,s,u,a):gs}function Rf(t,n,e,i,r){const o=t.providerIndexes,s=n.data,a=1048575&o,l=t.directiveStart,u=o>>20,h=r?a+u:t.directiveEnd;for(let f=i?a:a+u;f<h;f++){const m=s[f];if(f<l&&e===m||f>=l&&m.type===e)return f}if(r){const f=s[l];if(f&&zo(f)&&f.type===e)return l}return null}function ml(t,n,e,i){let r=t[e];const o=n.data;if(function LF(t){return t instanceof ud}(r)){const s=r;s.resolving&&function dN(t,n){throw n&&n.join(" > "),new le(-200,t)}(function dn(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Mt(t)}(o[e]));const a=Pf(s.canSeeViewProviders);s.resolving=!0;const c=s.injectImpl?Br(s.injectImpl):null;$w(t,i,tn.Default);try{r=t[e]=s.factory(void 0,o,t,i),n.firstCreatePass&&e>=i.directiveStart&&function FF(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=n.type.prototype;if(i){const s=kw(n);(e.preOrderHooks??=[]).push(t,s),(e.preOrderCheckHooks??=[]).push(t,s)}r&&(e.preOrderHooks??=[]).push(0-t,r),o&&((e.preOrderHooks??=[]).push(t,o),(e.preOrderCheckHooks??=[]).push(t,o))}(e,o[e],n)}finally{null!==c&&Br(c),Pf(a),s.resolving=!1,Yw()}}return r}function lE(t,n,e){return!!(e[n+(t>>nE)]&1<<t)}function cE(t,n){return!(t&tn.Self||t&tn.Host&&n)}class Ii{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return sE(this._tNode,this._lView,n,ff(i),e)}}function qF(){return new Ii(wn(),ce())}function ur(t){return wr(()=>{const n=t.prototype.constructor,e=n[Ks]||K0(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const o=r[Ks]||K0(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function K0(t){return Ea(t)?()=>{const n=K0(ut(t));return n&&n()}:ll(t)}function uE(t){const n=t[Se],e=n.type;return 2===e?n.declTNode:1===e?t[sr]:null}function mE(t,n=null,e=null,i){const r=gE(t,n,e,i);return r.resolveInjectorInitializers(),r}function gE(t,n=null,e=null,i,r=new Set){const o=[e||an,VN(t)];return i=i||("object"==typeof t?void 0:Cn(t)),new hc(o,n||wf(),i||null,r)}let Ur=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=Ku;static#t=this.NULL=new gf;static create(e,i){if(Array.isArray(e))return mE({name:""},i,e,"");{const r=e.name??"";return mE({name:r},e.parent,e.providers,r)}}static#n=this.\u0275prov=We({token:t,providedIn:"any",factory:()=>Ot(lw)});static#i=this.__NG_ELEMENT_ID__=-1}return t})();function J0(t){return t.ngOriginalError}class _s{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&J0(n);for(;e&&J0(e);)e=J0(e);return e||null}}const vE=new dt("",{providedIn:"root",factory:()=>It(_s).handleError.bind(void 0)});let xc=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=iR;static#t=this.__NG_ENV_ID__=e=>e}return t})();class nR extends xc{constructor(n){super(),this._lView=n}onDestroy(n){return Mf(this._lView,n),()=>function L0(t,n){if(null===t[Da])return;const e=t[Da].indexOf(n);-1!==e&&t[Da].splice(e,1)}(this._lView,n)}}function iR(){return new nR(ce())}function rR(){return Tc(wn(),ce())}function Tc(t,n){return new ti(xr(t,n))}let ti=(()=>{class t{constructor(e){this.nativeElement=e}static#e=this.__NG_ELEMENT_ID__=rR}return t})();function bE(t){return t instanceof ti?t.nativeElement:t}function e_(t){return n=>{setTimeout(t,void 0,n)}}const Gt=class oR extends ol{constructor(n=!1){super(),this.destroyRef=void 0,this.__isAsync=n,function Ew(){return void 0!==tw()||null!=function gN(){return lc}()}()&&(this.destroyRef=It(xc,{optional:!0})??void 0)}emit(n){const e=S(null);try{super.next(n)}finally{S(e)}}subscribe(n,e,i){let r=n,o=e||(()=>null),s=i;if(n&&"object"==typeof n){const l=n;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=e_(o),r&&(r=e_(r)),s&&(s=e_(s)));const a=super.subscribe({next:r,error:o,complete:s});return n instanceof qt&&n.add(a),a}};function sR(){return this._results[Symbol.iterator]()}class t_{static#e=Symbol.iterator;get changes(){return this._changes??=new Gt}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const e=t_.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=sR)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){this.dirty=!1;const i=function jr(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function xN(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],o=n[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(this._results,i,e))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function jf(t){return!(128&~t.flags)}const n_=new Map;let lR=0;const r_="__ngContext__";function dr(t,n){ar(n)?(t[r_]=n[id],function uR(t){n_.set(t[id],t)}(n)):t[r_]=n}function AE(t){return OE(t[td])}function kE(t){return OE(t[Vo])}function OE(t){for(;null!==t&&!lr(t);)t=t[Vo];return t}let o_;const Hf=new dt("",{providedIn:"root",factory:()=>MR}),MR="ng",UE=new dt(""),Dc=new dt("",{providedIn:"platform",factory:()=>"unknown"}),VE=new dt(""),HE=new dt("",{providedIn:"root",factory:()=>function Sa(){if(void 0!==o_)return o_;if(typeof document<"u")return document;throw new le(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let zE=()=>null;function f_(t,n,e=!1){return zE(t,n,e)}const ZE=new dt("",{providedIn:"root",factory:()=>!1});let Yf;function Ic(t){return function __(){if(void 0===Yf&&(Yf=null,Zt.trustedTypes))try{Yf=Zt.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Yf}()?.createHTML(t)||t}class gl{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Gu})`}}class HR extends gl{getTypeName(){return"HTML"}}class zR extends gl{getTypeName(){return"Style"}}class GR extends gl{getTypeName(){return"Script"}}class $R extends gl{getTypeName(){return"URL"}}class WR extends gl{getTypeName(){return"ResourceURL"}}function oo(t){return t instanceof gl?t.changingThisBreaksApplicationSecurity:t}function vs(t,n){const e=function qR(t){return t instanceof gl&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${Gu})`)}return e===n}class JR{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(Ic(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class e8{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=Ic(n),e}}const n8=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Kf(t){return(t=String(t)).match(n8)?t:"unsafe:"+t}function ta(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function yd(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const ex=ta("area,br,col,hr,img,wbr"),tx=ta("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),nx=ta("rp,rt"),y_=yd(ex,yd(tx,ta("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),yd(nx,ta("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),yd(nx,tx)),b_=ta("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ix=yd(b_,ta("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ta("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),i8=ta("script,style,template");class r8{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0,r=[];for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)r.push(e),e=a8(e);else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let o=s8(e);if(o){e=o;break}e=r.pop()}return this.buf.join("")}startElement(n){const e=rx(n).toLowerCase();if(!y_.hasOwnProperty(e))return this.sanitizedSomething=!0,!i8.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!ix.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=o.value;b_[a]&&(l=Kf(l)),this.buf.push(" ",s,'="',sx(l),'"')}return this.buf.push(">"),!0}endElement(n){const e=rx(n).toLowerCase();y_.hasOwnProperty(e)&&!ex.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(sx(n))}}function s8(t){const n=t.nextSibling;if(n&&t!==n.previousSibling)throw ox(n);return n}function a8(t){const n=t.firstChild;if(n&&function o8(t,n){return(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(t,n))throw ox(n);return n}function rx(t){const n=t.nodeName;return"string"==typeof n?n:"FORM"}function ox(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}const l8=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,c8=/([^\#-~ |!])/g;function sx(t){return t.replace(/&/g,"&amp;").replace(l8,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(c8,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Qf;function ax(t,n){let e=null;try{Qf=Qf||function JE(t){const n=new e8(t);return function t8(){try{return!!(new window.DOMParser).parseFromString(Ic(""),"text/html")}catch{return!1}}()?new JR(n):n}(t);let i=n?String(n):"";e=Qf.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=Qf.getInertBodyElement(i)}while(i!==o);return Ic((new r8).sanitizeChildren(C_(e)||e))}finally{if(e){const i=C_(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function C_(t){return"content"in t&&function u8(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var wo=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(wo||{});function _i(t){const n=function bd(){const t=ce();return t&&t[Ho].sanitizer}();return n?n.sanitize(wo.URL,t)||"":vs(t,"URL")?oo(t):Kf(Mt(t))}const v8=/^>|^->|<!--|-->|--!>|<!-$/g,y8=/(<|>)/g,b8="\u200b$1\u200b";function Cd(t){return t.ownerDocument}var Ma=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Ma||{});let T_;function D_(t,n){return T_(t,n)}function kc(t,n,e,i,r){if(null!=i){let o,s=!1;lr(i)?o=i:ar(i)&&(s=!0,i=i[$n]);const a=Dn(i);0===t&&null!==e?null==r?bx(n,e,a):_l(n,e,a,r||null,!0):1===t&&null!==e?_l(n,e,a,r||null,!0):2===t?function xd(t,n,e){const i=ip(t,n);i&&function B8(t,n,e,i){t.removeChild(n,e,i)}(t,i,n,e)}(n,a,s):3===t&&n.destroyNode(a),null!=o&&function V8(t,n,e,i,r){const o=e[ds];o!==Dn(e)&&kc(n,t,i,o,r);for(let a=ai;a<e.length;a++){const l=e[a];op(l[Se],l,t,n,i,o)}}(n,t,o,e,r)}}function M_(t,n){return t.createComment(function cx(t){return t.replace(v8,n=>n.replace(y8,b8))}(n))}function tp(t,n,e){return t.createElement(n,e)}function _x(t,n){n[Ho].changeDetectionScheduler?.notify(1),op(t,n,n[Ct],2,null,null)}function vx(t,n){const e=t[vc],i=e.indexOf(n);e.splice(i,1)}function wd(t,n){if(t.length<=ai)return;const e=ai+n,i=t[e];if(i){const r=i[nd];null!==r&&r!==t&&vx(r,i),n>0&&(t[e-1][Vo]=i[Vo]);const o=pf(t,ai+n);!function k8(t,n){_x(t,n),n[$n]=null,n[sr]=null}(i[Se],i);const s=o[Qs];null!==s&&s.detachView(o[Se]),i[si]=null,i[Vo]=null,i[rt]&=-129}return i}function np(t,n){if(!(256&n[rt])){const e=n[Ct];e.destroyNode&&op(t,n,e,3,null,null),function P8(t){let n=t[td];if(!n)return I_(t[Se],t);for(;n;){let e=null;if(ar(n))e=n[td];else{const i=n[ai];i&&(e=i)}if(!e){for(;n&&!n[Vo]&&n!==t;)ar(n)&&I_(n[Se],n),n=n[si];null===n&&(n=t),ar(n)&&I_(n[Se],n),e=n&&n[Vo]}n=e}}(n)}}function I_(t,n){if(256&n[rt])return;const e=S(null);try{n[rt]&=-129,n[rt]|=256,n[dl]&&function Le(t){if(Ft(t),it(t))for(let n=0;n<t.producerNode.length;n++)ie(t.producerNode[n],t.producerIndexOfThis[n]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}(n[dl]),function L8(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof ud)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],l=o[s+1];hs(4,a,l);try{l.call(a)}finally{hs(5,a,l)}}else{hs(4,r,o);try{o.call(r)}finally{hs(5,r,o)}}}}}(t,n),function R8(t,n){const e=t.cleanup,i=n[mc];if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+3];s>=0?i[s]():i[-s].unsubscribe(),o+=2}else e[o].call(i[e[o+1]]);null!==i&&(n[mc]=null);const r=n[Da];if(null!==r){n[Da]=null;for(let o=0;o<r.length;o++)(0,r[o])()}}(t,n),1===n[Se].type&&n[Ct].destroy();const i=n[nd];if(null!==i&&lr(n[si])){i!==n[si]&&vx(i,n);const r=n[Qs];null!==r&&r.detachView(t)}!function dR(t){n_.delete(t[id])}(n)}finally{S(e)}}function A_(t,n,e){return function yx(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[$n];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=t.data[i.directiveStart+r];if(o===jo.None||o===jo.Emulated)return null}return xr(i,e)}}(t,n.parent,e)}function _l(t,n,e,i,r){t.insertBefore(n,e,i,r)}function bx(t,n,e){t.appendChild(n,e)}function Cx(t,n,e,i,r){null!==i?_l(t,n,e,i,r):bx(t,n,e)}function ip(t,n){return t.parentNode(n)}function wx(t,n,e){return xx(t,n,e)}let k_,xx=function Ex(t,n,e){return 40&t.type?xr(t,e):null};function rp(t,n,e,i){const r=A_(t,i,n),o=n[Ct],a=wx(i.parent||n[sr],i,n);if(null!=r)if(Array.isArray(e))for(let l=0;l<e.length;l++)Cx(o,r,e[l],a,!1);else Cx(o,r,e,a,!1);void 0!==k_&&k_(o,i,n,e,r)}function Ed(t,n){if(null!==n){const e=n.type;if(3&e)return xr(n,t);if(4&e)return O_(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return Ed(t,i);{const r=t[n.index];return lr(r)?O_(-1,r):Dn(r)}}if(32&e)return D_(n,t)()||Dn(t[n.index]);{const i=Dx(t,n);return null!==i?Array.isArray(i)?i[0]:Ed(fl(t[Xn]),i):Ed(t,n.next)}}return null}function Dx(t,n){return null!==n?t[Xn][sr].projection[n.projection]:null}function O_(t,n){const e=ai+t+1;if(e<n.length){const i=n[e],r=i[Se].firstChild;if(null!==r)return Ed(i,r)}return n[ds]}function P_(t,n,e,i,r,o,s){for(;null!=e;){const a=i[e.index],l=e.type;if(s&&0===n&&(a&&dr(Dn(a),i),e.flags|=2),32&~e.flags)if(8&l)P_(t,n,e.child,i,r,o,!1),kc(n,t,r,a,o);else if(32&l){const c=D_(e,i);let u;for(;u=c();)kc(n,t,r,u,o);kc(n,t,r,a,o)}else 16&l?Mx(t,n,i,e,r,o):kc(n,t,r,a,o);e=s?e.projectionNext:e.next}}function op(t,n,e,i,r,o){P_(e,i,t.firstChild,n,r,o,!1)}function Mx(t,n,e,i,r,o){const s=e[Xn],l=s[sr].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)kc(n,t,r,l[c],o);else{let c=l;const u=s[si];jf(i)&&(c.flags|=128),P_(t,n,c,u,r,o,!0)}}function Ix(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Ax(t,n,e){const{mergedAttrs:i,classes:r,styles:o}=e;null!==i&&g0(t,n,i),null!==r&&Ix(t,n,r),null!==o&&function z8(t,n,e){t.setAttribute(n,"style",e)}(t,n,o)}const Pt={};function v(t=1){kx(Yt(),ce(),cr()+t,!1)}function kx(t,n,e,i){if(!i)if(3&~n[rt]){const o=t.preOrderHooks;null!==o&&Of(n,o,0,e)}else{const o=t.preOrderCheckHooks;null!==o&&kf(n,o,e)}pl(e)}function L(t,n=tn.Default){const e=ce();return null===e?Ot(t,n):sE(wn(),e,ut(t),n)}function Ox(t,n,e,i,r,o){const s=S(null);try{let a=null;r&Rt.SignalBased&&(a=n[i][I]),null!==a&&void 0!==a.transformFn&&(o=a.transformFn(o)),r&Rt.HasDecoratorInputTransform&&(o=t.inputTransforms[i].call(n,o)),null!==t.setInput?t.setInput(n,a,o,e,i):Aw(n,a,i,o)}finally{S(s)}}function sp(t,n,e,i,r,o,s,a,l,c,u){const d=n.blueprint.slice();return d[$n]=r,d[rt]=204|i,(null!==c||t&&2048&t[rt])&&(d[rt]|=2048),Lw(d),d[si]=d[gc]=t,d[An]=e,d[Ho]=s||t&&t[Ho],d[Ct]=a||t&&t[Ct],d[gi]=l||t&&t[gi]||null,d[sr]=o,d[id]=function cR(){return lR++}(),d[io]=u,d[Dw]=c,d[Xn]=2==n.type?t[Xn]:d,d}function Oc(t,n,e,i,r){let o=t.data[n];if(null===o)o=function N_(t,n,e,i,r){const o=Vw(),s=B0(),l=t.data[n]=function Q8(t,n,e,i,r,o){let s=n?n.injectorIndex:-1,a=0;return bc()&&(a|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=l),null!==o&&(s?null==o.child&&null!==l.parent&&(o.child=l):null===o.next&&(o.next=l,l.prev=o)),l}(t,n,e,i,r),function SF(){return wt.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function ld(){const t=wt.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return ps(o,!0),o}function Td(t,n,e,i){if(0===e)return-1;const r=n.length;for(let o=0;o<e;o++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function Px(t,n,e,i,r){const o=cr(),s=2&i;try{pl(-1),s&&n.length>At&&kx(t,n,At,!1),hs(s?2:0,r),e(i,r)}finally{pl(o),hs(s?3:1,r)}}function F_(t,n,e){if(M0(n)){const i=S(null);try{const o=n.directiveEnd;for(let s=n.directiveStart;s<o;s++){const a=t.data[s];a.contentQueries&&a.contentQueries(1,e[s],s)}}finally{S(i)}}}function R_(t,n,e){Uw()&&(function o4(t,n,e,i){const r=e.directiveStart,o=e.directiveEnd;hl(e)&&function h4(t,n,e){const i=xr(n,t),r=Nx(e);let s=16;e.signals?s=4096:e.onPush&&(s=64);const a=ap(t,sp(t,r,null,s,i,n,null,t[Ho].rendererFactory.createRenderer(i,e),null,null,null));t[n.index]=a}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||Nf(e,n),dr(i,n);const s=e.initialInputs;for(let a=r;a<o;a++){const l=t.data[a],c=ml(n,t,a,e);dr(c,n),null!==s&&f4(0,a-r,c,l,0,s),zo(l)&&(ro(e.index,n)[An]=ml(n,t,a,e))}}(t,n,e,xr(e,n)),!(64&~e.flags)&&jx(t,n,e))}function L_(t,n,e=xr){const i=n.localNames;if(null!==i){let r=n.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(n,t):t[s];t[r++]=a}}}function Nx(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=B_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}function B_(t,n,e,i,r,o,s,a,l,c,u){const d=At+i,h=d+r,f=function W8(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:Pt);return e}(d,h),m="function"==typeof c?c():c;return f[Se]={type:t,blueprint:f,template:e,queries:null,viewQuery:a,declTNode:n,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:m,incompleteFirstPass:!1,ssrId:u}}let Fx=()=>null;function Rx(t,n,e,i,r){for(let o in n){if(!n.hasOwnProperty(o))continue;const s=n[o];if(void 0===s)continue;i??={};let a,l=Rt.None;Array.isArray(s)?(a=s[0],l=s[1]):a=s;let c=o;if(null!==r){if(!r.hasOwnProperty(o))continue;c=r[o]}0===t?Lx(i,e,c,a,l):Lx(i,e,c,a)}return i}function Lx(t,n,e,i,r){let o;t.hasOwnProperty(e)?(o=t[e]).push(n,i):o=t[e]=[n,i],void 0!==r&&o.push(r)}function Hr(t,n,e,i,r,o,s,a){const l=xr(n,e);let u,c=n.inputs;!a&&null!=c&&(u=c[i])?(z_(t,e,u,i,r),hl(n)&&function t4(t,n){const e=ro(n,t);16&e[rt]||(e[rt]|=64)}(e,n.index)):3&n.type&&(i=function e4(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=s?s(r,n.value||"",i):r,o.setProperty(l,i,r))}function j_(t,n,e,i){if(Uw()){const r=null===i?null:{"":-1},o=function a4(t,n){const e=t.directiveRegistry;let i=null,r=null;if(e)for(let o=0;o<e.length;o++){const s=e[o];if(fw(n,s.selectors,!1))if(i||(i=[]),zo(s))if(null!==s.findHostDirectiveDefs){const a=[];r=r||new Map,s.findHostDirectiveDefs(s,a,r),i.unshift(...a,s),U_(t,n,a.length)}else i.unshift(s),U_(t,n,0);else r=r||new Map,s.findHostDirectiveDefs?.(s,i,r),i.push(s)}return null===i?null:[i,r]}(t,e);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&Bx(t,n,e,s,r,a),r&&function l4(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const o=e[n[r+1]];if(null==o)throw new le(-301,!1);i.push(n[r],o)}}}(e,i,r)}e.mergedAttrs=Ju(e.mergedAttrs,e.attrs)}function Bx(t,n,e,i,r,o){for(let c=0;c<i.length;c++)X0(Nf(e,n),t,i[c].type);!function u4(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,l=Td(t,n,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];e.mergedAttrs=Ju(e.mergedAttrs,u.hostAttrs),d4(t,e,n,l,u),c4(l,u,r),null!==u.contentQueries&&(e.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(e.flags|=64);const d=u.type.prototype;!s&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),s=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),a=!0),l++}!function J8(t,n,e){const r=n.directiveEnd,o=t.data,s=n.attrs,a=[];let l=null,c=null;for(let u=n.directiveStart;u<r;u++){const d=o[u],h=e?e.get(d):null,m=h?h.outputs:null;l=Rx(0,d.inputs,u,l,h?h.inputs:null),c=Rx(1,d.outputs,u,c,m);const p=null===l||null===s||_0(n)?null:p4(l,u,s);a.push(p)}null!==l&&(l.hasOwnProperty("class")&&(n.flags|=8),l.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=l,n.outputs=c}(t,e,o)}function jx(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,s=function IF(){return wt.lFrame.currentDirectiveIndex}();try{pl(o);for(let a=i;a<r;a++){const l=t.data[a],c=n[a];U0(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&s4(l,c)}}finally{pl(-1),U0(s)}}function s4(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function U_(t,n,e){n.componentOffset=e,(t.components??=[]).push(n.index)}function c4(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;zo(n)&&(e[""]=t)}}function d4(t,n,e,i,r){t.data[i]=r;const o=r.factory||(r.factory=ll(r.type)),s=new ud(o,zo(r),L);t.blueprint[i]=s,e[i]=s,function i4(t,n,e,i,r){const o=r.hostBindings;if(o){let s=t.hostBindingOpCodes;null===s&&(s=t.hostBindingOpCodes=[]);const a=~n.index;(function r4(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(s)!=a&&s.push(a),s.push(e,i,o)}}(t,n,i,Td(t,e,r.hostVars,Pt),r)}function ys(t,n,e,i,r,o){const s=xr(t,n);!function V_(t,n,e,i,r,o,s){if(null==o)t.removeAttribute(n,r,e);else{const a=null==s?Mt(o):s(o,i||"",r);t.setAttribute(n,r,a,e)}}(n[Ct],s,o,t.value,e,i,r)}function f4(t,n,e,i,r,o){const s=o[n];if(null!==s)for(let a=0;a<s.length;)Ox(i,e,s[a++],s[a++],s[a++],s[a++])}function p4(t,n,e){let i=null,r=0;for(;r<e.length;){const o=e[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(t.hasOwnProperty(o)){null===i&&(i=[]);const s=t[o];for(let a=0;a<s.length;a+=3)if(s[a]===n){i.push(o,s[a+1],s[a+2],e[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function Ux(t,n,e,i){return[t,!0,0,n,null,i,null,e,null,null]}function Vx(t,n){const e=t.contentQueries;if(null!==e){const i=S(null);try{for(let r=0;r<e.length;r+=2){const s=e[r+1];if(-1!==s){const a=t.data[s];If(e[r]),a.contentQueries(2,n[s],s)}}}finally{S(i)}}}function ap(t,n){return t[td]?t[Tw][Vo]=n:t[td]=n,t[Tw]=n,n}function H_(t,n,e){If(0);const i=S(null);try{n(t,e)}finally{S(i)}}function Hx(t){return t[mc]||(t[mc]=[])}function zx(t){return t.cleanup||(t.cleanup=[])}function lp(t,n){const e=t[gi],i=e?e.get(_s,null):null;i&&i.handleError(n)}function z_(t,n,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],l=e[o++];Ox(t.data[s],n[s],i,a,l,r)}}function na(t,n,e){const i=od(n,t);!function gx(t,n,e){t.setValue(n,e)}(t[Ct],i,e)}function m4(t,n){const e=ro(n,t),i=e[Se];!function g4(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])}(i,e);const r=e[$n];null!==r&&null===e[io]&&(e[io]=f_(r,e[gi])),G_(i,e,e[An])}function G_(t,n,e){z0(n);try{const i=t.viewQuery;null!==i&&H_(1,i,e);const r=t.template;null!==r&&Px(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),n[Qs]?.finishViewCreation(t),t.staticContentQueries&&Vx(t,n),t.staticViewQueries&&H_(2,t.viewQuery,e);const o=t.components;null!==o&&function _4(t,n){for(let e=0;e<n.length;e++)m4(t,n[e])}(n,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[rt]&=-5,G0()}}function Pc(t,n){return!n||null===n.firstChild||jf(t)}function Sd(t,n,e,i=!0){const r=n[Se];if(function N8(t,n,e,i){const r=ai+i,o=e.length;i>0&&(e[r-1][Vo]=n),i<o-ai?(n[Vo]=e[r],ow(e,ai+i,n)):(e.push(n),n[Vo]=null),n[si]=e;const s=n[nd];null!==s&&e!==s&&function F8(t,n){const e=t[vc];n[Xn]!==n[si][si][Xn]&&(t[rt]|=S0.HasTransplantedViews),null===e?t[vc]=[n]:e.push(n)}(s,n);const a=n[Qs];null!==a&&a.insertView(t),R0(n),n[rt]|=128}(r,n,t,e),i){const s=O_(e,t),a=n[Ct],l=ip(a,t[ds]);null!==l&&function O8(t,n,e,i,r,o){i[$n]=r,i[sr]=n,op(t,i,e,1,r,o)}(r,t[sr],a,n,l,s)}const o=n[io];null!==o&&null!==o.firstChild&&(o.firstChild=null)}function Md(t,n,e,i,r=!1){for(;null!==e;){const o=n[e.index];null!==o&&i.push(Dn(o)),lr(o)&&Wx(o,i);const s=e.type;if(8&s)Md(t,n,e.child,i);else if(32&s){const a=D_(e,n);let l;for(;l=a();)i.push(l)}else if(16&s){const a=Dx(n,e);if(Array.isArray(a))i.push(...a);else{const l=fl(n[Xn]);Md(l[Se],l,a,i,!0)}}e=r?e.projectionNext:e.next}return i}function Wx(t,n){for(let e=ai;e<t.length;e++){const i=t[e],r=i[Se].firstChild;null!==r&&Md(i[Se],i,r,n)}t[ds]!==t[$n]&&n.push(t[ds])}let qx=[];const C4={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{ad(t.lView)},consumerOnSignalRead(){this.lView[dl]=this}},Zx=100;function cp(t,n=!0,e=0){const i=t[Ho],r=i.rendererFactory;r.begin?.();try{!function w4(t,n){W_(t,n);let e=0;for(;F0(t);){if(e===Zx)throw new le(103,!1);e++,W_(t,1)}}(t,e)}catch(s){throw n&&lp(t,s),s}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function E4(t,n,e,i){const r=n[rt];if(!(256&~r))return;n[Ho].inlineEffectRunner?.flush(),z0(n);let s=null,a=null;(function x4(t){return 2!==t.type})(t)&&(a=function v4(t){return t[dl]??function y4(t){const n=qx.pop()??Object.create(C4);return n.lView=t,n}(t)}(n),s=function K(t){return t&&(t.nextProducerIndex=0),S(t)}(a));try{Lw(n),function zw(t){return wt.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Px(t,n,e,2,i);const l=!(3&~r);if(l){const d=t.preOrderCheckHooks;null!==d&&kf(n,d,null)}else{const d=t.preOrderHooks;null!==d&&Of(n,d,0,null),$0(n,0)}if(function T4(t){for(let n=AE(t);null!==n;n=kE(n)){if(!(n[rt]&S0.HasTransplantedViews))continue;const e=n[vc];for(let i=0;i<e.length;i++){_F(e[i])}}}(n),Yx(n,0),null!==t.contentQueries&&Vx(t,n),l){const d=t.contentCheckHooks;null!==d&&kf(n,d)}else{const d=t.contentHooks;null!==d&&Of(n,d,1),$0(n,1)}!function $8(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)pl(~r);else{const o=r,s=e[++i],a=e[++i];MF(s,o),a(2,n[o])}}}finally{pl(-1)}}(t,n);const c=t.components;null!==c&&Kx(n,c,0);const u=t.viewQuery;if(null!==u&&H_(2,u,i),l){const d=t.viewCheckHooks;null!==d&&kf(n,d)}else{const d=t.viewHooks;null!==d&&Of(n,d,2),$0(n,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[Tf]){for(const d of n[Tf])d();n[Tf]=null}n[rt]&=-73}catch(l){throw ad(n),l}finally{null!==a&&(function de(t,n){if(S(n),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(it(t))for(let e=t.nextProducerIndex;e<t.producerNode.length;e++)ie(t.producerNode[e],t.producerIndexOfThis[e]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}(a,s),function b4(t){t.lView[dl]!==t&&(t.lView=null,qx.push(t))}(a)),G0()}}function Yx(t,n){for(let e=AE(t);null!==e;e=kE(e))for(let i=ai;i<e.length;i++)Xx(e[i],n)}function D4(t,n,e){Xx(ro(n,t),e)}function Xx(t,n){N0(t)&&W_(t,n)}function W_(t,n){const i=t[Se],r=t[rt],o=t[dl];let s=!!(0===n&&16&r);if(s||=!!(64&r&&0===n),s||=!!(1024&r),s||=!(!o?.dirty||!fe(o)),o&&(o.dirty=!1),t[rt]&=-9217,s)E4(i,t,i.template,t[An]);else if(8192&r){Yx(t,1);const a=i.components;null!==a&&Kx(t,a,1)}}function Kx(t,n,e){for(let i=0;i<n.length;i++)D4(t,n[i],e)}function Id(t){for(t[Ho].changeDetectionScheduler?.notify();t;){t[rt]|=64;const n=fl(t);if(I0(t)&&!n)return t;t=n}return null}class Ad{get rootNodes(){const n=this._lView,e=n[Se];return Md(e,n,e.firstChild,[])}constructor(n,e,i=!0){this._lView=n,this._cdRefInjectingView=e,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[An]}set context(n){this._lView[An]=n}get destroyed(){return!(256&~this._lView[rt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[si];if(lr(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(wd(n,i),pf(e,i))}this._attachedToViewContainer=!1}np(this._lView[Se],this._lView)}onDestroy(n){Mf(this._lView,n)}markForCheck(){Id(this._cdRefInjectingView||this._lView)}detach(){this._lView[rt]&=-129}reattach(){R0(this._lView),this._lView[rt]|=128}detectChanges(){this._lView[rt]|=1024,cp(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new le(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,_x(this._lView[Se],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new le(902,!1);this._appRef=n,R0(this._lView)}}let ia=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=I4}return t})();const S4=ia,M4=class extends S4{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,e){return this.createEmbeddedViewImpl(n,e)}createEmbeddedViewImpl(n,e,i){const r=function Dd(t,n,e,i){const r=S(null);try{const o=n.tView,l=sp(t,o,e,4096&t[rt]?4096:16,null,n,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);l[nd]=t[n.index];const u=t[Qs];return null!==u&&(l[Qs]=u.createEmbeddedView(o)),G_(o,l,e),l}finally{S(r)}}(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:e,dehydratedView:i});return new Ad(r)}};function I4(){return up(wn(),ce())}function up(t,n){return 4&t.type?new M4(n,t,Tc(t,n)):null}class mp{}class J4{}class rT{}class t5{resolveComponentFactory(n){throw function e5(t){const n=Error(`No component factory found for ${Cn(t)}.`);return n.ngComponent=t,n}(n)}}let gp=(()=>{class t{static#e=this.NULL=new t5}return t})();class Q_{}let vl=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function n5(){const t=ce(),e=ro(wn().index,t);return(ar(e)?e:t)[Ct]}()}return t})(),i5=(()=>{class t{static#e=this.\u0275prov=We({token:t,providedIn:"root",factory:()=>null})}return t})();const J_={};function aT(...t){}class kt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Gt(!1),this.onMicrotaskEmpty=new Gt(!1),this.onStable=new Gt(!1),this.onError=new Gt(!1),typeof Zone>"u")throw new le(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function r5(){const t="function"==typeof Zt.requestAnimationFrame;let n=Zt[t?"requestAnimationFrame":"setTimeout"],e=Zt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&e){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function a5(t){const n=()=>{!function s5(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Zt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,tv(t),t.isCheckStableRunning=!0,ev(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),tv(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{if(function l5(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(a))return e.invokeTask(r,o,s,a);try{return lT(t),e.invokeTask(r,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),cT(t)}},onInvoke:(e,i,r,o,s,a,l)=>{try{return lT(t),e.invoke(r,o,s,a,l)}finally{t.shouldCoalesceRunChangeDetection&&n(),cT(t)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,tv(t),ev(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!kt.isInAngularZone())throw new le(909,!1)}static assertNotInAngularZone(){if(kt.isInAngularZone())throw new le(909,!1)}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,n,o5,aT,aT);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const o5={};function ev(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function tv(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function lT(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function cT(t){t._nesting--,ev(t)}class uT{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Gt,this.onMicrotaskEmpty=new Gt,this.onStable=new Gt,this.onError=new Gt}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}let Fd=(()=>{class t{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const e=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of e)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=We({token:t,providedIn:"root",factory:()=>new t})}return t})();function vp(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:1==o?r=sc(r,a):2==o&&(i=sc(i,a+": "+n[++s]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}class gT extends gp{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=Vt(n);return new Bd(e,this.ngModule)}}function _T(t){const n=[];for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];void 0!==i&&n.push({propName:Array.isArray(i)?i[0]:i,templateName:e})}return n}class yp{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,i){i=ff(i);const r=this.injector.get(n,J_,i);return r!==J_||e===J_?r:this.parentInjector.get(n,e,i)}}class Bd extends rT{get inputs(){const n=this.componentDef,e=n.inputTransforms,i=_T(n.inputs);if(null!==e)for(const r of i)e.hasOwnProperty(r.propName)&&(r.transform=e[r.propName]);return i}get outputs(){return _T(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function FN(t){return t.map(NN).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,i,r){const o=S(null);try{let s=(r=r||this.ngModule)instanceof us?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const a=s?new yp(n,s):n,l=a.get(Q_,null);if(null===l)throw new le(407,!1);const c=a.get(i5,null),h={rendererFactory:l,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:a.get(Fd,null),changeDetectionScheduler:a.get(mp,null)},f=l.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",p=i?function q8(t,n,e,i){const o=i.get(ZE,!1)||e===jo.ShadowDom,s=t.selectRootElement(n,o);return function Z8(t){Fx(t)}(s),s}(f,i,this.componentDef.encapsulation,a):tp(f,m,function p5(t){const n=t.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(m));let g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let y=null;null!==p&&(y=f_(p,a,!0));const C=B_(0,null,null,1,0,null,null,null,null,null,null),N=sp(null,C,null,g,null,null,h,f,a,null,y);let $,H;z0(N);try{const z=this.componentDef;let X,ee=null;z.findHostDirectiveDefs?(X=[],ee=new Map,z.findHostDirectiveDefs(z,X,ee),X.push(z)):X=[z];const he=function g5(t,n){const e=t[Se],i=At;return t[i]=n,Oc(e,i,2,"#host",null)}(N,p),ae=function _5(t,n,e,i,r,o,s){const a=r[Se];!function v5(t,n,e,i){for(const r of t)n.mergedAttrs=Ju(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(vp(n,n.mergedAttrs,!0),null!==e&&Ax(i,e,n))}(i,t,n,s);let l=null;null!==n&&(l=f_(n,r[gi]));const c=o.rendererFactory.createRenderer(n,e);let u=16;e.signals?u=4096:e.onPush&&(u=64);const d=sp(r,Nx(e),null,u,r[t.index],t,o,c,null,null,l);return a.firstCreatePass&&U_(a,t,i.length-1),ap(r,d),r[t.index]=d}(he,p,z,X,N,h,f);H=sd(C,At),p&&function b5(t,n,e,i){if(i)g0(t,e,["ng-version","17.3.12"]);else{const{attrs:r,classes:o}=function RN(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&n.push(o,t[++i]):8===r&&e.push(o);else{if(!Uo(r))break;r=o}i++}return{attrs:n,classes:e}}(n.selectors[0]);r&&g0(t,e,r),o&&o.length>0&&Ix(t,e,o.join(" "))}}(f,z,p,i),void 0!==e&&function C5(t,n,e){const i=t.projection=[];for(let r=0;r<n.length;r++){const o=e[r];i.push(null!=o?Array.from(o):null)}}(H,this.ngContentSelectors,e),$=function y5(t,n,e,i,r,o){const s=wn(),a=r[Se],l=xr(s,r);Bx(a,r,s,e,null,i);for(let u=0;u<e.length;u++)dr(ml(r,a,s.directiveStart+u,s),r);jx(a,r,s),l&&dr(l,r);const c=ml(r,a,s.directiveStart+s.componentOffset,s);if(t[An]=r[An]=c,null!==o)for(const u of o)u(c,n);return F_(a,s,r),c}(ae,z,X,ee,N,[w5]),G_(C,N,null)}finally{G0()}return new m5(this.componentType,$,Tc(H,N),N,H)}finally{S(o)}}}class m5 extends J4{constructor(n,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new Ad(r,void 0,!1),this.componentType=n}setInput(n,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),e))return;const o=this._rootLView;z_(o[Se],o,r,n,e),this.previousInputValues.set(n,e),Id(ro(this._tNode.index,o))}}get injector(){return new Ii(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function w5(){const t=wn();Af(ce()[Se],t)}let zr=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=E5}return t})();function E5(){return bT(wn(),ce())}const x5=zr,vT=class extends x5{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return Tc(this._hostTNode,this._hostLView)}get injector(){return new Ii(this._hostTNode,this._hostLView)}get parentInjector(){const n=Ff(this._hostTNode,this._hostLView);if(q0(n)){const e=hd(n,this._hostLView),i=dd(n);return new Ii(e[Se].data[i+8],e)}return new Ii(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=yT(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-ai}createEmbeddedView(n,e,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const a=n.createEmbeddedViewImpl(e||{},o,null);return this.insertImpl(a,r,Pc(this._hostTNode,null)),a}createComponent(n,e,i,r,o){const s=n&&!function ed(t){return"function"==typeof t}(n);let a;if(s)a=e;else{const m=e||{};a=m.index,i=m.injector,r=m.projectableNodes,o=m.environmentInjector||m.ngModuleRef}const l=s?n:new Bd(Vt(n)),c=i||this.parentInjector;if(!o&&null==l.ngModule){const p=(s?c:this.parentInjector).get(us,null);p&&(o=p)}Vt(l.componentType??{});const f=l.create(c,r,null,o);return this.insertImpl(f.hostView,a,Pc(this._hostTNode,null)),f}insert(n,e){return this.insertImpl(n,e,!0)}insertImpl(n,e,i){const r=n._lView;if(function gF(t){return lr(t[si])}(r)){const a=this.indexOf(n);if(-1!==a)this.detach(a);else{const l=r[si],c=new vT(l,l[sr],l[si]);c.detach(c.indexOf(n))}}const o=this._adjustIndex(e),s=this._lContainer;return Sd(s,r,o,i),n.attachToViewContainerRef(),ow(ov(s),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=yT(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=wd(this._lContainer,e);i&&(pf(ov(this._lContainer),e),np(i[Se],i))}detach(n){const e=this._adjustIndex(n,-1),i=wd(this._lContainer,e);return i&&null!=pf(ov(this._lContainer),e)?new Ad(i):null}_adjustIndex(n,e=0){return n??this.length+e}};function yT(t){return t[8]}function ov(t){return t[8]||(t[8]=[])}function bT(t,n){let e;const i=n[t.index];return lr(i)?e=i:(e=Ux(i,n,null,t),n[t.index]=e,ap(n,e)),CT(e,n,t,i),new vT(e,t,n)}let CT=function ET(t,n,e,i){if(t[ds])return;let r;r=8&e.type?Dn(i):function T5(t,n){const e=t[Ct],i=e.createComment(""),r=xr(n,t);return _l(e,ip(e,r),i,function j8(t,n){return t.nextSibling(n)}(e,r),!1),i}(n,e),t[ds]=r},sv=()=>!1;class av{constructor(n){this.queryList=n,this.matches=null}clone(){return new av(this.queryList)}setDirty(){this.queryList.setDirty()}}class lv{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new lv(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==fv(n,e).matches&&this.queries[e].setDirty()}}class xT{constructor(n,e,i=null){this.flags=e,this.read=i,this.predicate="string"==typeof n?function P5(t){return t.split(",").map(n=>n.trim())}(n):n}}class cv{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(n,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new cv(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class uv{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new uv(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1&~this.metadata.flags){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(n,e,I5(e,o)),this.matchTNodeWithReadOption(n,e,Rf(e,n,o,!1,!1))}else i===ia?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,Rf(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===ti||r===zr||r===ia&&4&e.type)this.addMatch(e.index,-2);else{const o=Rf(e,n,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function I5(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function k5(t,n,e,i){return-1===e?function A5(t,n){return 11&t.type?Tc(t,n):4&t.type?up(t,n):null}(n,t):-2===e?function O5(t,n,e){return e===ti?Tc(n,t):e===ia?up(n,t):e===zr?bT(n,t):void 0}(t,n,i):ml(t,t[Se],e,n)}function TT(t,n,e,i){const r=n[Qs].queries[i];if(null===r.matches){const o=t.data,s=e.matches,a=[];for(let l=0;null!==s&&l<s.length;l+=2){const c=s[l];a.push(c<0?null:k5(n,o[c],s[l+1],e.metadata.read))}r.matches=a}return r.matches}function dv(t,n,e,i){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const s=TT(t,n,r,e);for(let a=0;a<o.length;a+=2){const l=o[a];if(l>0)i.push(s[a/2]);else{const c=o[a+1],u=n[-l];for(let d=ai;d<u.length;d++){const h=u[d];h[nd]===h[si]&&dv(h[Se],h,c,i)}if(null!==u[vc]){const d=u[vc];for(let h=0;h<d.length;h++){const f=d[h];dv(f[Se],f,c,i)}}}}}return i}function ST(t,n,e){const i=Yt();return i.firstCreatePass&&(function IT(t,n,e){null===t.queries&&(t.queries=new cv),t.queries.track(new uv(n,e))}(i,new xT(t,n,e),-1),!(2&~n)&&(i.staticViewQueries=!0)),function DT(t,n,e){const i=new t_(!(4&~e));return function K8(t,n,e,i){const r=Hx(n);r.push(e),t.firstCreatePass&&zx(t).push(i,r.length-1)}(t,n,i,i.destroy),(n[Qs]??=new lv).queries.push(new av(i))-1}(i,ce(),n)}function fv(t,n){return t.queries.getByIndex(n)}function AT(t,n){const e=t[Se],i=fv(e,n);return i.crossesNgTemplate?dv(e,t,n,[]):TT(e,t,i,n)}function PT(t){return function kT(t){return"function"==typeof t&&void 0!==t[I]}(t)&&"function"==typeof t.set}function En(t){let n=function GT(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(zo(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new le(903,!1);r=n.\u0275dir}if(r){if(e){i.push(r);const s=t;s.inputs=Cp(t.inputs),s.inputTransforms=Cp(t.inputTransforms),s.declaredInputs=Cp(t.declaredInputs),s.outputs=Cp(t.outputs);const a=r.hostBindings;a&&Y5(t,a);const l=r.viewQuery,c=r.contentQueries;if(l&&q5(t,l),c&&Z5(t,c),$5(t,r),Co(t.outputs,r.outputs),zo(r)&&r.data.animation){const u=t.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===En&&(e=!1)}}n=Object.getPrototypeOf(n)}!function W5(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=Ju(r.hostAttrs,e=Ju(e,r.hostAttrs))}}(i)}function $5(t,n){for(const e in n.inputs){if(!n.inputs.hasOwnProperty(e)||t.inputs.hasOwnProperty(e))continue;const i=n.inputs[e];if(void 0!==i&&(t.inputs[e]=i,t.declaredInputs[e]=n.declaredInputs[e],null!==n.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!n.inputTransforms.hasOwnProperty(r))continue;t.inputTransforms??={},t.inputTransforms[r]=n.inputTransforms[r]}}}function Cp(t){return t===cs?{}:t===an?[]:t}function q5(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function Z5(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,o)=>{n(i,r,o),e(i,r,o)}:n}function Y5(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}class Cl{}class nL{}class mv extends Cl{constructor(n,e,i){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new gT(this);const r=function or(t,n){const e=t[JC]||null;if(!e&&!0===n)throw new Error(`Type ${Cn(t)} does not have '\u0275mod' property.`);return e}(n);this._bootstrapComponents=function so(t){return t instanceof Function?t():t}(r.bootstrap),this._r3Injector=gE(n,e,[{provide:Cl,useValue:this},{provide:gp,useValue:this.componentFactoryResolver},...i],Cn(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class gv extends nL{constructor(n){super(),this.moduleType=n}create(n){return new mv(this.moduleType,n,[])}}let Ud=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Wg(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ep(t){return!!_v(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function _v(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Cs(t,n,e){return t[n]=e}function li(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function wl(t,n,e,i){const r=li(t,n,e);return li(t,n+1,i)||r}function J(t,n,e,i,r,o,s,a){const l=ce(),c=Yt(),u=t+At,d=c.firstCreatePass?function uL(t,n,e,i,r,o,s,a,l){const c=n.consts,u=Oc(n,t,4,s||null,fs(c,a));j_(n,e,u,fs(c,l)),Af(n,u);const d=u.tView=B_(2,u,i,r,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,c,null);return null!==n.queries&&(n.queries.template(n,u),d.queries=n.queries.embeddedTView(u)),u}(u,c,l,n,e,i,r,o,s):c.data[u];ps(d,!1);const h=XT(c,l,d,t);cd()&&rp(c,l,h,d),dr(h,l);const f=Ux(h,l,h,d);return l[u]=f,ap(l,f),function wT(t,n,e){return sv(t,n,e)}(f,d,l),Sf(d)&&R_(c,l,d),null!=s&&L_(l,d,a),J}let XT=function KT(t,n,e,i){return ms(!0),n[Ct].createComment("")};function xo(t,n,e,i){const r=ce();return li(r,Go(),n)&&(Yt(),ys(kn(),r,t,n,e,i)),xo}function zc(t,n,e,i){return li(t,Go(),e)?n+Mt(e)+i:Pt}function qc(t,n,e,i,r,o,s,a,l,c,u,d){const h=Js();let f=function Eo(t,n,e,i,r,o){const s=wl(t,n,e,i);return wl(t,n+2,r,o)||s}(t,h,e,r,s,l);return f=li(t,h+4,u)||f,ea(5),f?n+Mt(e)+i+Mt(r)+o+Mt(s)+a+Mt(l)+c+Mt(u)+d:Pt}function Ap(t,n){return t<<17|n<<2}function ka(t){return t>>17&32767}function Sv(t){return 2|t}function xl(t){return(131068&t)>>2}function Mv(t,n){return-131069&t|n<<2}function Iv(t){return 1|t}function MD(t,n,e,i){const r=t[e+1],o=null===n;let s=i?ka(r):xl(r),a=!1;for(;0!==s&&(!1===a||o);){const c=t[s+1];XL(t[s],n)&&(a=!0,t[s+1]=i?Iv(c):Sv(c)),s=i?ka(c):xl(c)}a&&(t[e+1]=i?Sv(r):Iv(r))}function XL(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&uc(t,n)>=0}const Ai={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ID(t){return t.substring(Ai.key,Ai.keyEnd)}function KL(t){return t.substring(Ai.value,Ai.valueEnd)}function kD(t,n){const e=Ai.textEnd;let i=Ai.key=Kc(t,n,e);return e===i?-1:(i=Ai.keyEnd=function t6(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=PD(t,i,e),i=Ai.value=Kc(t,i,e),i=Ai.valueEnd=function n6(t,n,e){let i=-1,r=-1,o=-1,s=n,a=s;for(;s<e;){const l=t.charCodeAt(s++);if(59===l)return a;34===l||39===l?a=s=ND(t,l,s,e):n===s-4&&85===o&&82===r&&76===i&&40===l?a=s=ND(t,41,s,e):l>32&&(a=s),o=r,r=i,i=-33&l}return a}(t,i,e),PD(t,i,e))}function Kc(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function PD(t,n,e,i){return(n=Kc(t,n,e))<e&&n++,n}function ND(t,n,e,i){let r=-1,o=e;for(;o<i;){const s=t.charCodeAt(o++);if(s==n&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function b(t,n,e){const i=ce();return li(i,Go(),n)&&Hr(Yt(),kn(),i,t,n,i[Ct],e,!1),b}function Av(t,n,e,i,r){const s=r?"class":"style";z_(t,e,n.inputs[s],s,i)}function vn(t,n,e){return Wo(t,n,e,!1),vn}function kp(t,n){return Wo(t,n,null,!0),kp}function lo(t){!function qo(t,n,e,i){const r=Yt(),o=ea(2);r.firstUpdatePass&&RD(r,null,o,i);const s=ce();if(e!==Pt&&li(s,o,e)){const a=r.data[cr()];if(UD(a,i)&&!FD(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(e=sc(l,e||"")),Av(r,a,s,e,i)}else!function d6(t,n,e,i,r,o,s,a){r===Pt&&(r=an);let l=0,c=0,u=0<r.length?r[0]:null,d=0<o.length?o[0]:null;for(;null!==u||null!==d;){const h=l<r.length?r[l+1]:void 0,f=c<o.length?o[c+1]:void 0;let p,m=null;u===d?(l+=2,c+=2,h!==f&&(m=d,p=f)):null===d||null!==u&&u<d?(l+=2,m=u):(c+=2,m=d,p=f),null!==m&&BD(t,n,e,i,m,p,s,a),u=l<r.length?r[l]:null,d=c<o.length?o[c]:null}}(r,a,s,s[Ct],s[o+1],s[o+1]=function c6(t,n,e){if(null==e||""===e)return an;const i=[],r=oo(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,o)}}(LD,i6,t,!1)}function i6(t,n){for(let e=function JL(t){return function OD(t){Ai.key=0,Ai.keyEnd=0,Ai.value=0,Ai.valueEnd=0,Ai.textEnd=t.length}(t),kD(t,Kc(t,0,Ai.textEnd))}(n);e>=0;e=kD(n,e))LD(t,ID(n),KL(n))}function Wo(t,n,e,i){const r=ce(),o=Yt(),s=ea(2);o.firstUpdatePass&&RD(o,t,s,i),n!==Pt&&li(r,s,n)&&BD(o,o.data[cr()],r,r[Ct],t,r[s+1]=function h6(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Cn(oo(t)))),t}(n,e),i,s)}function FD(t,n){return n>=t.expandoStartIndex}function RD(t,n,e,i){const r=t.data;if(null===r[e+1]){const o=r[cr()],s=FD(t,e);UD(o,i)&&null===n&&!s&&(n=!1),n=function o6(t,n,e,i){const r=function V0(t){const n=wt.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=Wd(e=kv(null,t,n,e,i),n.attrs,i),o=null);else{const s=n.directiveStylingLast;if(-1===s||t[s]!==r)if(e=kv(r,t,n,e,i),null===o){let l=function s6(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==xl(i))return t[ka(i)]}(t,n,i);void 0!==l&&Array.isArray(l)&&(l=kv(null,t,n,l[1],i),l=Wd(l,n.attrs,i),function a6(t,n,e,i){t[ka(e?n.classBindings:n.styleBindings)]=i}(t,n,i,l))}else o=function l6(t,n,e){let i;const r=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<r;o++)i=Wd(i,t[o].hostAttrs,e);return Wd(i,n.attrs,e)}(t,n,i)}return void 0!==o&&(i?n.residualClasses=o:n.residualStyles=o),e}(r,o,n,i),function ZL(t,n,e,i,r,o){let s=o?n.classBindings:n.styleBindings,a=ka(s),l=xl(s);t[i]=e;let u,c=!1;if(Array.isArray(e)?(u=e[1],(null===u||uc(e,u)>0)&&(c=!0)):u=e,r)if(0!==l){const h=ka(t[a+1]);t[i+1]=Ap(h,a),0!==h&&(t[h+1]=Mv(t[h+1],i)),t[a+1]=function WL(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=Ap(a,0),0!==a&&(t[a+1]=Mv(t[a+1],i)),a=i;else t[i+1]=Ap(l,0),0===a?a=i:t[l+1]=Mv(t[l+1],i),l=i;c&&(t[i+1]=Sv(t[i+1])),MD(t,u,i,!0),MD(t,u,i,!1),function YL(t,n,e,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&uc(o,n)>=0&&(e[i+1]=Iv(e[i+1]))}(n,u,t,i,o),s=Ap(a,l),o?n.classBindings=s:n.styleBindings=s}(r,o,n,e,s,i)}}function kv(t,n,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=n[a],i=Wd(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function Wd(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let o=0;o<n.length;o++){const s=n[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),no(t,s,!!e||n[++o]))}return void 0===t?null:t}function LD(t,n,e){no(t,n,oo(e))}function BD(t,n,e,i,r,o,s,a){if(!(3&n.type))return;const l=t.data,c=l[a+1],u=function qL(t){return!(1&~t)}(c)?jD(l,n,e,r,xl(c),s):void 0;Op(u)||(Op(o)||function $L(t){return!(2&~t)}(c)&&(o=jD(l,null,e,r,a,s)),function H8(t,n,e,i,r){if(n)r?t.addClass(e,i):t.removeClass(e,i);else{let o=-1===i.indexOf("-")?void 0:Ma.DashCase;null==r?t.removeStyle(e,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Ma.Important),t.setStyle(e,i,r,o))}}(i,s,od(cr(),e),r,o))}function jD(t,n,e,i,r,o){const s=null===n;let a;for(;r>0;){const l=t[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=e[r+1];h===Pt&&(h=d?an:void 0);let f=d?p0(h,i):u===i?h:void 0;if(c&&!Op(f)&&(f=p0(l,i)),Op(f)&&(a=f,s))return a;const m=t[r+1];r=s?ka(m):xl(m)}if(null!==n){let l=o?n.residualClasses:n.residualStyles;null!=l&&(a=p0(l,i))}return a}function Op(t){return void 0!==t}function UD(t,n){return!!(t.flags&(n?8:16))}function _(t,n,e,i){const r=ce(),o=Yt(),s=At+t,a=r[Ct],l=o.firstCreatePass?function F6(t,n,e,i,r,o){const s=n.consts,l=Oc(n,t,2,i,fs(s,r));return j_(n,e,l,fs(s,o)),null!==l.attrs&&vp(l,l.attrs,!1),null!==l.mergedAttrs&&vp(l,l.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,l),l}(s,o,r,n,e,i):o.data[s],c=GD(o,r,l,a,n,t);r[s]=c;const u=Sf(l);return ps(l,!0),Ax(a,c,l),!function Hd(t){return!(32&~t.flags)}(l)&&cd()&&rp(o,r,c,l),0===function vF(){return wt.lFrame.elementDepthCount}()&&dr(c,r),function yF(){wt.lFrame.elementDepthCount++}(),u&&(R_(o,r,l),F_(o,l,r)),null!==i&&L_(r,l),_}function w(){let t=wn();B0()?j0():(t=t.parent,ps(t,!1));const n=t;(function CF(t){return wt.skipHydrationRootTNode===t})(n)&&function TF(){wt.skipHydrationRootTNode=null}(),function bF(){wt.lFrame.elementDepthCount--}();const e=Yt();return e.firstCreatePass&&(Af(e,t),M0(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function jF(t){return!!(8&t.flags)}(n)&&Av(e,n,ce(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function UF(t){return!!(16&t.flags)}(n)&&Av(e,n,ce(),n.stylesWithoutHost,!1),w}function Ee(t,n,e,i){return _(t,n,e,i),w(),Ee}let GD=(t,n,e,i,r,o)=>(ms(!0),tp(i,r,function Kw(){return wt.lFrame.currentNamespace}()));function Ae(t,n,e){const i=ce(),r=Yt(),o=t+At,s=r.firstCreatePass?function B6(t,n,e,i,r){const o=n.consts,s=fs(o,i),a=Oc(n,t,8,"ng-container",s);return null!==s&&vp(a,s,!0),j_(n,e,a,fs(o,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(o,r,i,n,e):r.data[o];ps(s,!0);const a=$D(r,i,s,t);return i[o]=a,cd()&&rp(r,i,a,s),dr(a,i),Sf(s)&&(R_(r,i,s),F_(r,s,i)),null!=e&&L_(i,s),Ae}function ke(){let t=wn();const n=Yt();return B0()?j0():(t=t.parent,ps(t,!1)),n.firstCreatePass&&(Af(n,t),M0(t)&&n.queries.elementEnd(t)),ke}function Bn(t,n,e){return Ae(t,n,e),ke(),Bn}let $D=(t,n,e,i)=>(ms(!0),M_(n[Ct],""));function Ue(){return ce()}const Tl=void 0;var H6=["en",[["a","p"],["AM","PM"],Tl],[["AM","PM"],Tl,Tl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Tl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Tl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Tl,"{1} 'at' {0}",Tl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function V6(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Qc={};function Dr(t){const n=function z6(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=YD(n);if(e)return e;const i=n.split("-")[0];if(e=YD(i),e)return e;if("en"===i)return H6;throw new le(701,!1)}function YD(t){return t in Qc||(Qc[t]=Zt.ng&&Zt.ng.common&&Zt.ng.common.locales&&Zt.ng.common.locales[t]),Qc[t]}var On=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(On||{});const Jc="en-US";let XD=Jc;function ue(t,n,e,i){const r=ce(),o=Yt(),s=wn();return Bv(o,r,r[Ct],s,t,n,i),ue}function Bv(t,n,e,i,r,o,s){const a=Sf(i),c=t.firstCreatePass&&zx(t),u=n[An],d=Hx(n);let h=!0;if(3&i.type||s){const p=xr(i,n),g=s?s(p):p,y=d.length,C=s?$=>s(Dn($[i.index])):i.index;let N=null;if(!s&&a&&(N=function jB(t,n,e,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=n[mc],l=r[o+2];return a.length>l?a[l]:null}"string"==typeof s&&(o+=2)}return null}(t,n,r,i.index)),null!==N)(N.__ngLastListenerFn__||N).__ngNextListenerFn__=o,N.__ngLastListenerFn__=o,h=!1;else{o=xS(i,n,u,o,!1);const $=e.listen(g,r,o);d.push(o,$),c&&c.push(r,C,y,y+1)}}else o=xS(i,n,u,o,!1);const f=i.outputs;let m;if(h&&null!==f&&(m=f[r])){const p=m.length;if(p)for(let g=0;g<p;g+=2){const H=n[m[g]][m[g+1]].subscribe(o),z=d.length;d.push(o,H),c&&c.push(r,i.index,z,-(z+1))}}}function ES(t,n,e,i){const r=S(null);try{return hs(6,n,e),!1!==e(i)}catch(o){return lp(t,o),!1}finally{hs(7,n,e),S(r)}}function xS(t,n,e,i,r){return function o(s){if(s===Function)return i;Id(t.componentOffset>-1?ro(t.index,n):n);let l=ES(n,e,i,s),c=o.__ngNextListenerFn__;for(;c;)l=ES(n,e,c,s)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&s.preventDefault(),l}}function M(t=1){return function kF(t){return(wt.lFrame.contextLView=function Bw(t,n){for(;t>0;)n=n[gc],t--;return n}(t,wt.lFrame.contextLView))[An]}(t)}function UB(t,n){let e=null;const i=function AN(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const o=n[r];if("*"!==o){if(null===i?fw(t,o,!0):PN(i,o))return r}else e=r}return e}function jv(t){const n=ce()[Xn][sr];if(!n.projection){const i=n.projection=function mf(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}(t?t.length:1,null),r=i.slice();let o=n.child;for(;null!==o;){const s=t?UB(o,t):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function Uv(t,n=0,e){const i=ce(),r=Yt(),o=Oc(r,At+t,16,null,e||null);null===o.projection&&(o.projection=n),j0(),(!i[io]||bc())&&32&~o.flags&&function U8(t,n,e){Mx(n[Ct],0,n,e,A_(t,e,n),wx(e.parent||n[sr],e,n))}(r,i,o)}function Pn(t,n,e){return Vv(t,"",n,"",e),Pn}function Vv(t,n,e,i,r){const o=ce(),s=zc(o,n,e,i);return s!==Pt&&Hr(Yt(),kn(),o,t,s,o[Ct],r,!1),Vv}function Qn(t,n,e){ST(t,n,e)}function Jn(t){const n=ce(),e=Yt(),i=H0();If(i+1);const r=fv(e,i);if(t.dirty&&function mF(t){return!(4&~t[rt])}(n)===!(2&~r.metadata.flags)){if(null===r.matches)t.reset([]);else{const o=AT(n,i);t.reset(o,bE),t.notifyOnChanges()}return!0}return!1}function ei(){return function hv(t,n){return t[Qs].queries[n].queryList}(ce(),H0())}function Lt(t){return yc(function DF(){return wt.lFrame.contextLView}(),At+t)}function O(t,n=""){const e=ce(),i=Yt(),r=t+At,o=i.firstCreatePass?Oc(i,r,1,n,null):i.data[r],s=HS(i,e,o,n,t);e[r]=s,cd()&&rp(i,e,s,o),ps(o,!1)}let HS=(t,n,e,i,r)=>(ms(!0),function S_(t,n){return t.createText(n)}(n[Ct],i));function ht(t){return ki("",t,""),ht}function ki(t,n,e){const i=ce(),r=zc(i,t,n,e);return r!==Pt&&na(i,cr(),r),ki}function eu(t,n,e,i,r){const o=ce(),s=function Gc(t,n,e,i,r,o){const a=wl(t,Js(),e,r);return ea(2),a?n+Mt(e)+i+Mt(r)+o:Pt}(o,t,n,e,i,r);return s!==Pt&&na(o,cr(),s),eu}function Hv(t,n,e,i,r,o,s,a,l,c,u){const d=ce(),h=qc(d,t,n,e,i,r,o,s,a,l,c,u);return h!==Pt&&na(d,cr(),h),Hv}function yt(t,n,e){PT(n)&&(n=n());const i=ce();return li(i,Go(),n)&&Hr(Yt(),kn(),i,t,n,i[Ct],e,!1),yt}function pt(t,n){const e=PT(t);return e&&t.set(n),e}function bt(t,n){const e=ce(),i=Yt(),r=wn();return Bv(i,e,e[Ct],r,t,n),bt}function zv(t,n,e,i,r){if(t=ut(t),Array.isArray(t))for(let o=0;o<t.length;o++)zv(t[o],n,e,i,r);else{const o=Yt(),s=ce(),a=wn();let l=ul(t)?t:ut(t.provide);const c=Cw(t),u=1048575&a.providerIndexes,d=a.directiveStart,h=a.providerIndexes>>20;if(ul(t)||!t.multi){const f=new ud(c,r,L),m=$v(l,n,r?u:u+h,d);-1===m?(X0(Nf(a,s),o,l),Gv(o,t,n.length),n.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(f),s.push(f)):(e[m]=f,s[m]=f)}else{const f=$v(l,n,u+h,d),m=$v(l,n,u,u+h),g=m>=0&&e[m];if(r&&!g||!r&&!(f>=0&&e[f])){X0(Nf(a,s),o,l);const y=function s9(t,n,e,i,r){const o=new ud(t,e,L);return o.multi=[],o.index=n,o.componentProviders=0,YS(o,r,i&&!e),o}(r?o9:r9,e.length,r,i,c);!r&&g&&(e[m].providerFactory=y),Gv(o,t,n.length,0),n.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(y),s.push(y)}else Gv(o,t,f>-1?f:m,YS(e[r?m:f],c,!r&&i));!r&&i&&g&&e[m].componentProviders++}}}function Gv(t,n,e,i){const r=ul(n),o=function zN(t){return!!t.useClass}(n);if(r||o){const l=(o?ut(n.useClass):n).prototype.ngOnDestroy;if(l){const c=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const u=c.indexOf(e);-1===u?c.push(e,[i,l]):c[u+1].push(i,l)}else c.push(e,l)}}}function YS(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function $v(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function r9(t,n,e,i){return Wv(this.multi,[])}function o9(t,n,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=ml(e,e[Se],this.providerFactory.index,i);o=a.slice(0,s),Wv(r,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],Wv(r,o);return o}function Wv(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function jn(t,n=[]){return e=>{e.providersResolver=(i,r)=>function i9(t,n,e){const i=Yt();if(i.firstCreatePass){const r=zo(t);zv(e,i.data,i.blueprint,r,!0),zv(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}function Dl(t,n,e){const i=Tr()+t,r=ce();return r[i]===Pt?Cs(r,i,e?n.call(e):n()):function Vd(t,n){return t[n]}(r,i)}function lt(t,n,e,i){return function KS(t,n,e,i,r,o){const s=n+e;return li(t,s,r)?Cs(t,s+1,o?i.call(o,r):i(r)):Jd(t,s+1)}(ce(),Tr(),t,n,e,i)}function qi(t,n,e,i,r){return QS(ce(),Tr(),t,n,e,i,r)}function Bp(t,n,e,i,r,o){return function JS(t,n,e,i,r,o,s,a){const l=n+e;return function xp(t,n,e,i,r){const o=wl(t,n,e,i);return li(t,n+2,r)||o}(t,l,r,o,s)?Cs(t,l+3,a?i.call(a,r,o,s):i(r,o,s)):Jd(t,l+3)}(ce(),Tr(),t,n,e,i,r,o)}function Jd(t,n){const e=t[n];return e===Pt?void 0:e}function QS(t,n,e,i,r,o,s){const a=n+e;return wl(t,a,r,o)?Cs(t,a+2,s?i.call(s,r,o):i(r,o)):Jd(t,a+2)}function Qt(t,n){const e=Yt();let i;const r=t+At;e.firstCreatePass?(i=function _9(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??=[]).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=ll(i.type)),a=Br(L);try{const l=Pf(!1),c=o();return Pf(l),function $B(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,ce(),r,c),c}finally{Br(a)}}function Jt(t,n,e,i){const r=t+At,o=ce(),s=yc(o,r);return function eh(t,n){return t[Se].data[n].pure}(o,r)?QS(o,Tr(),n,s.transform,e,i,s):s.transform(e,i)}function ni(t,n){return up(t,n)}const CM=new dt(""),Hp=new dt("");let ey,Qv=(()=>{class t{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,ey||(function mj(t){ey=t}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{kt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e()},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(kt),Ot(Jv),Ot(Hp))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})(),Jv=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return ey?.findTestabilityInTree(this,e,i)??null}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function zp(t){return!!t&&"function"==typeof t.then}function wM(t){return!!t&&"function"==typeof t.subscribe}const gj=new dt("");let ty=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i}),this.appInits=It(gj,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const r of this.appInits){const o=r();if(zp(o))e.push(o);else if(wM(o)){const s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});e.push(s)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const EM=new dt("");function DM(t,n){return Array.isArray(n)?n.reduce(DM,t):{...t,...n}}let Sl=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=It(vE),this.afterRenderEffectManager=It(Fd),this.externalTestViews=new Set,this.beforeRender=new ol,this.afterTick=new ol,this.componentTypes=[],this.components=[],this.isStable=It(Ud).hasPendingTasks.pipe(sl(e=>!e)),this._injector=It(us)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof rT;if(!this._injector.get(ty).done)throw!r&&function cl(t){const n=Vt(t)||Si(t)||Wi(t);return null!==n&&n.standalone}(e),new le(405,!1);let s;s=r?e:this._injector.get(gp).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function _j(t){return t.isBoundToModule}(s)?void 0:this._injector.get(Cl),c=s.create(Ur.NULL,[],i||s.selector,a),u=c.location.nativeElement,d=c.injector.get(CM,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),Gp(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){this._tick(!0)}_tick(e){if(this._runningTick)throw new le(101,!1);const i=S(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(e)}catch(r){this.internalErrorHandler(r)}finally{this.afterTick.next(),this._runningTick=!1,S(i)}}detectChangesInAttachedViews(e){let i=0;const r=this.afterRenderEffectManager;for(;;){if(i===Zx)throw new le(103,!1);if(e){const o=0===i;this.beforeRender.next(o);for(let{_lView:s,notifyErrorHandler:a}of this._views)yj(s,o,a)}if(i++,r.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>ny(o))&&(r.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>ny(o))))break}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;Gp(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(EM,[]);[...this._bootstrapListeners,...i].forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>Gp(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new le(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Gp(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function yj(t,n,e){!n&&!ny(t)||function bj(t,n,e){let i;e?(i=0,t[rt]|=1024):i=64&t[rt]?0:1,cp(t,n,i)}(t,e,n)}function ny(t){return F0(t)}let xj=(()=>{class t{constructor(){this.zone=It(kt),this.applicationRef=It(Sl)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Tj(){const t=It(kt),n=It(_s);return e=>t.runOutsideAngular(()=>n.handleError(e))}let Sj=(()=>{class t{constructor(){this.subscription=new qt,this.initialized=!1,this.zone=It(kt),this.pendingTasks=It(Ud)}initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{kt.assertNotInAngularZone(),queueMicrotask(()=>{null!==e&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{kt.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const ra=new dt("",{providedIn:"root",factory:()=>It(ra,tn.Optional|tn.SkipSelf)||function Mj(){return typeof $localize<"u"&&$localize.locale||Jc}()}),iy=new dt("");let AM=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function c5(t="zone.js",n){return"noop"===t?new uT:"zone.js"===t?new kt(n):t}(i?.ngZone,function IM(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const o=function rL(t,n,e){return new mv(t,n,e)}(e.moduleType,this.injector,function MM(t){return[{provide:kt,useFactory:t},{provide:dc,multi:!0,useFactory:()=>{const n=It(xj,{optional:!0});return()=>n.initialize()}},{provide:dc,multi:!0,useFactory:()=>{const n=It(Sj);return()=>{n.initialize()}}},{provide:vE,useFactory:Tj}]}(()=>r)),s=o.injector.get(_s,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{s.handleError(l)}});o.onDestroy(()=>{Gp(this._modules,o),a.unsubscribe()})}),function TM(t,n,e){try{const i=e();return zp(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(s,r,()=>{const a=o.injector.get(ty);return a.runInitializers(),a.donePromise.then(()=>(function KD(t){"string"==typeof t&&(XD=t.toLowerCase().replace(/_/g,"-"))}(o.injector.get(ra,Jc)||Jc),this._moduleDoBootstrap(o),o))})})}bootstrapModule(e,i=[]){const r=DM({},i);return function Ej(t,n,e){const i=new gv(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(Sl);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new le(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new le(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(iy,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(Ur))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),Oa=null;const kM=new dt("");function OM(t,n,e=[]){const i=`Platform: ${n}`,r=new dt(i);return(o=[])=>{let s=ry();if(!s||s.injector.get(kM,!1)){const a=[...e,...o,{provide:r,useValue:!0}];t?t(a):function kj(t){if(Oa&&!Oa.get(kM,!1))throw new le(400,!1);(function xM(){!function nr(t){ct=t}(()=>{throw new le(600,!1)})})(),Oa=t;const n=t.get(AM);(function NM(t){t.get(UE,null)?.forEach(e=>e())})(t)}(function PM(t=[],n){return Ur.create({name:n,providers:[{provide:C0,useValue:"platform"},{provide:iy,useValue:new Set([()=>Oa=null])},...t]})}(a,i))}return function Oj(t){const n=ry();if(!n)throw new le(401,!1);return n}()}}function ry(){return Oa?.get(AM)??null}let Zi=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=Nj}return t})();function Nj(t){return function Fj(t,n,e){if(hl(t)&&!e){const i=ro(t.index,n);return new Ad(i,i)}return 47&t.type?new Ad(n[Xn],n):null}(wn(),ce(),!(16&~t))}class jM{constructor(){}supports(n){return Ep(n)}create(n){return new Uj(n)}}const jj=(t,n)=>n;class Uj{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||jj}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<VM(i,r,o)?e:i,a=VM(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<o.length?o[h]:o[h]=0,m=f+h;u<=m&&m<c&&(o[h]=f+1)}o[s.previousIndex]=u-c}}a!==l&&n(s,a,l)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!Ep(n))throw new le(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function lL(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,r)):n=this._addAfter(new Vj(e,i),o,r),n}_verifyReinsertion(n,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?n=this._reinsertAfter(o,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,o=n._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new UM),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new UM),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class Vj{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Hj{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class UM{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new Hj,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function VM(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class HM{constructor(){}supports(n){return n instanceof Map||_v(n)}create(){return new zj}}class zj{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||_v(n)))throw new le(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new Gj(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class Gj{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function zM(){return new cy([new jM])}let cy=(()=>{class t{static#e=this.\u0275prov=We({token:t,providedIn:"root",factory:zM});constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||zM()),deps:[[t,new h0,new d0]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new le(901,!1)}}return t})();function GM(){return new Zp([new HM])}let Zp=(()=>{class t{static#e=this.\u0275prov=We({token:t,providedIn:"root",factory:GM});constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||GM()),deps:[[t,new h0,new d0]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new le(901,!1)}}return t})();const qj=OM(null,"core",[]);let Zj=(()=>{class t{constructor(e){}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(Sl))};static#t=this.\u0275mod=Ta({type:t});static#n=this.\u0275inj=Xs({})}return t})();function hy(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let f2=null;function oh(){return f2}class AU{}const oa=new dt("");var Mr=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(Mr||{}),Mn=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(Mn||{}),co=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(co||{});const vi={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function tm(t,n){return Do(Dr(t)[On.DateFormat],n)}function nm(t,n){return Do(Dr(t)[On.TimeFormat],n)}function im(t,n){return Do(Dr(t)[On.DateTimeFormat],n)}function To(t,n){const e=Dr(t),i=e[On.NumberSymbols][n];if(typeof i>"u"){if(n===vi.CurrencyDecimal)return e[On.NumberSymbols][vi.Decimal];if(n===vi.CurrencyGroup)return e[On.NumberSymbols][vi.Group]}return i}function m2(t){if(!t[On.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[On.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Do(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function py(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const WU=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,rm={},qU=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var sa=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}(sa||{}),hn=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}(hn||{}),fn=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}(fn||{});function ZU(t,n,e,i){let r=function iV(t){if(v2(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,s=1]=t.split("-").map(a=>+a);return om(r,o-1,s)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(WU))return function rV(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const s=Number(t[4]||0)-e,a=Number(t[5]||0)-i,l=Number(t[6]||0),c=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,s,a,l,c),n}(i)}const n=new Date(t);if(!v2(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=aa(e,n)||n;let a,s=[];for(;n;){if(a=qU.exec(n),!a){s.push(n);break}{s=s.concat(a.slice(1));const u=s.pop();if(!u)break;n=u}}let l=r.getTimezoneOffset();i&&(l=_2(i,l),r=function nV(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function tV(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(_2(n,r)-r))}(r,i,!0));let c="";return s.forEach(u=>{const d=function eV(t){if(gy[t])return gy[t];let n;switch(t){case"G":case"GG":case"GGG":n=Nn(fn.Eras,Mn.Abbreviated);break;case"GGGG":n=Nn(fn.Eras,Mn.Wide);break;case"GGGGG":n=Nn(fn.Eras,Mn.Narrow);break;case"y":n=yi(hn.FullYear,1,0,!1,!0);break;case"yy":n=yi(hn.FullYear,2,0,!0,!0);break;case"yyy":n=yi(hn.FullYear,3,0,!1,!0);break;case"yyyy":n=yi(hn.FullYear,4,0,!1,!0);break;case"Y":n=cm(1);break;case"YY":n=cm(2,!0);break;case"YYY":n=cm(3);break;case"YYYY":n=cm(4);break;case"M":case"L":n=yi(hn.Month,1,1);break;case"MM":case"LL":n=yi(hn.Month,2,1);break;case"MMM":n=Nn(fn.Months,Mn.Abbreviated);break;case"MMMM":n=Nn(fn.Months,Mn.Wide);break;case"MMMMM":n=Nn(fn.Months,Mn.Narrow);break;case"LLL":n=Nn(fn.Months,Mn.Abbreviated,Mr.Standalone);break;case"LLLL":n=Nn(fn.Months,Mn.Wide,Mr.Standalone);break;case"LLLLL":n=Nn(fn.Months,Mn.Narrow,Mr.Standalone);break;case"w":n=my(1);break;case"ww":n=my(2);break;case"W":n=my(1,!0);break;case"d":n=yi(hn.Date,1);break;case"dd":n=yi(hn.Date,2);break;case"c":case"cc":n=yi(hn.Day,1);break;case"ccc":n=Nn(fn.Days,Mn.Abbreviated,Mr.Standalone);break;case"cccc":n=Nn(fn.Days,Mn.Wide,Mr.Standalone);break;case"ccccc":n=Nn(fn.Days,Mn.Narrow,Mr.Standalone);break;case"cccccc":n=Nn(fn.Days,Mn.Short,Mr.Standalone);break;case"E":case"EE":case"EEE":n=Nn(fn.Days,Mn.Abbreviated);break;case"EEEE":n=Nn(fn.Days,Mn.Wide);break;case"EEEEE":n=Nn(fn.Days,Mn.Narrow);break;case"EEEEEE":n=Nn(fn.Days,Mn.Short);break;case"a":case"aa":case"aaa":n=Nn(fn.DayPeriods,Mn.Abbreviated);break;case"aaaa":n=Nn(fn.DayPeriods,Mn.Wide);break;case"aaaaa":n=Nn(fn.DayPeriods,Mn.Narrow);break;case"b":case"bb":case"bbb":n=Nn(fn.DayPeriods,Mn.Abbreviated,Mr.Standalone,!0);break;case"bbbb":n=Nn(fn.DayPeriods,Mn.Wide,Mr.Standalone,!0);break;case"bbbbb":n=Nn(fn.DayPeriods,Mn.Narrow,Mr.Standalone,!0);break;case"B":case"BB":case"BBB":n=Nn(fn.DayPeriods,Mn.Abbreviated,Mr.Format,!0);break;case"BBBB":n=Nn(fn.DayPeriods,Mn.Wide,Mr.Format,!0);break;case"BBBBB":n=Nn(fn.DayPeriods,Mn.Narrow,Mr.Format,!0);break;case"h":n=yi(hn.Hours,1,-12);break;case"hh":n=yi(hn.Hours,2,-12);break;case"H":n=yi(hn.Hours,1);break;case"HH":n=yi(hn.Hours,2);break;case"m":n=yi(hn.Minutes,1);break;case"mm":n=yi(hn.Minutes,2);break;case"s":n=yi(hn.Seconds,1);break;case"ss":n=yi(hn.Seconds,2);break;case"S":n=yi(hn.FractionalSeconds,1);break;case"SS":n=yi(hn.FractionalSeconds,2);break;case"SSS":n=yi(hn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=am(sa.Short);break;case"ZZZZZ":n=am(sa.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=am(sa.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=am(sa.Long);break;default:return null}return gy[t]=n,n}(u);c+=d?d(r,e,l):"''"===u?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function om(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function aa(t,n){const e=function NU(t){return Dr(t)[On.LocaleId]}(t);if(rm[e]??={},rm[e][n])return rm[e][n];let i="";switch(n){case"shortDate":i=tm(t,co.Short);break;case"mediumDate":i=tm(t,co.Medium);break;case"longDate":i=tm(t,co.Long);break;case"fullDate":i=tm(t,co.Full);break;case"shortTime":i=nm(t,co.Short);break;case"mediumTime":i=nm(t,co.Medium);break;case"longTime":i=nm(t,co.Long);break;case"fullTime":i=nm(t,co.Full);break;case"short":const r=aa(t,"shortTime"),o=aa(t,"shortDate");i=sm(im(t,co.Short),[r,o]);break;case"medium":const s=aa(t,"mediumTime"),a=aa(t,"mediumDate");i=sm(im(t,co.Medium),[s,a]);break;case"long":const l=aa(t,"longTime"),c=aa(t,"longDate");i=sm(im(t,co.Long),[l,c]);break;case"full":const u=aa(t,"fullTime"),d=aa(t,"fullDate");i=sm(im(t,co.Full),[u,d])}return i&&(rm[e][n]=i),i}function sm(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function Zo(t,n,e="-",i,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let s=String(t);for(;s.length<n;)s="0"+s;return i&&(s=s.slice(s.length-n)),o+s}function yi(t,n,e=0,i=!1,r=!1){return function(o,s){let a=function XU(t,n){switch(t){case hn.FullYear:return n.getFullYear();case hn.Month:return n.getMonth();case hn.Date:return n.getDate();case hn.Hours:return n.getHours();case hn.Minutes:return n.getMinutes();case hn.Seconds:return n.getSeconds();case hn.FractionalSeconds:return n.getMilliseconds();case hn.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||a>-e)&&(a+=e),t===hn.Hours)0===a&&-12===e&&(a=12);else if(t===hn.FractionalSeconds)return function YU(t,n){return Zo(t,3).substring(0,n)}(a,n);const l=To(s,vi.MinusSign);return Zo(a,n,l,i,r)}}function Nn(t,n,e=Mr.Format,i=!1){return function(r,o){return function KU(t,n,e,i,r,o){switch(e){case fn.Months:return function LU(t,n,e){const i=Dr(t),o=Do([i[On.MonthsFormat],i[On.MonthsStandalone]],n);return Do(o,e)}(n,r,i)[t.getMonth()];case fn.Days:return function RU(t,n,e){const i=Dr(t),o=Do([i[On.DaysFormat],i[On.DaysStandalone]],n);return Do(o,e)}(n,r,i)[t.getDay()];case fn.DayPeriods:const s=t.getHours(),a=t.getMinutes();if(o){const c=function VU(t){const n=Dr(t);return m2(n),(n[On.ExtraData][2]||[]).map(i=>"string"==typeof i?py(i):[py(i[0]),py(i[1])])}(n),u=function HU(t,n,e){const i=Dr(t);m2(i);const o=Do([i[On.ExtraData][0],i[On.ExtraData][1]],n)||[];return Do(o,e)||[]}(n,r,i),d=c.findIndex(h=>{if(Array.isArray(h)){const[f,m]=h,p=s>=f.hours&&a>=f.minutes,g=s<m.hours||s===m.hours&&a<m.minutes;if(f.hours<m.hours){if(p&&g)return!0}else if(p||g)return!0}else if(h.hours===s&&h.minutes===a)return!0;return!1});if(-1!==d)return u[d]}return function FU(t,n,e){const i=Dr(t),o=Do([i[On.DayPeriodsFormat],i[On.DayPeriodsStandalone]],n);return Do(o,e)}(n,r,i)[s<12?0:1];case fn.Eras:return function BU(t,n){return Do(Dr(t)[On.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,n,e,i)}}function am(t){return function(n,e,i){const r=-1*i,o=To(e,vi.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case sa.Short:return(r>=0?"+":"")+Zo(s,2,o)+Zo(Math.abs(r%60),2,o);case sa.ShortGMT:return"GMT"+(r>=0?"+":"")+Zo(s,1,o);case sa.Long:return"GMT"+(r>=0?"+":"")+Zo(s,2,o)+":"+Zo(Math.abs(r%60),2,o);case sa.Extended:return 0===i?"Z":(r>=0?"+":"")+Zo(s,2,o)+":"+Zo(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}const QU=0,lm=4;function g2(t){const n=t.getDay(),e=0===n?-3:lm-n;return om(t.getFullYear(),t.getMonth(),t.getDate()+e)}function my(t,n=!1){return function(e,i){let r;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=g2(e),s=function JU(t){const n=om(t,QU,1).getDay();return om(t,0,1+(n<=lm?lm:lm+7)-n)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Zo(r,t,To(i,vi.MinusSign))}}function cm(t,n=!1){return function(e,i){return Zo(g2(e).getFullYear(),t,To(i,vi.MinusSign),n)}}const gy={};function _2(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function v2(t){return t instanceof Date&&!isNaN(t.valueOf())}const wy=/\s+/,w2=[];let Pi=(()=>{class t{constructor(e,i){this._ngEl=e,this._renderer=i,this.initialClasses=w2,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(wy):w2}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(wy):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,!!e[i]);this._applyStateDiff()}_updateState(e,i){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(wy).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||t)(L(ti),L(vl))};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngClass",""]],inputs:{klass:[Rt.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}return t})();class vV{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ii=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new vV(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),x2(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{x2(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(L(zr),L(ia),L(cy))};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return t})();function x2(t,n){t.context.$implicit=n.item}let xn=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new yV,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){T2("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){T2("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(L(zr),L(ia))};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class yV{constructor(){this.$implicit=null,this.ngIf=null}}function T2(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Cn(n)}'.`)}class Ey{constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Il=(()=>{class t{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const i=e===this._ngSwitch;return this._lastCasesMatched||=i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const i of this._defaultViews)i.enforceState(e)}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return t})(),ah=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new Ey(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#e=this.\u0275fac=function(i){return new(i||t)(L(zr),L(ia),L(Il,9))};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return t})(),lh=(()=>{class t{constructor(e,i,r){r._addDefault(new Ey(e,i))}static#e=this.\u0275fac=function(i){return new(i||t)(L(zr),L(ia),L(Il,9))};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngSwitchDefault",""]],standalone:!0})}return t})(),Al=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split("."),s=-1===r.indexOf("-")?void 0:Ma.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||t)(L(ti),L(Zp),L(vl))};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return t})(),ch=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(this._shouldRecreateView(e)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(e){return!!e.ngTemplateOutlet||!!e.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(e,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(e,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static#e=this.\u0275fac=function(i){return new(i||t)(L(zr))};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Kn]})}return t})();const OV=new dt(""),PV=new dt("");let S2=(()=>{class t{constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,o){if(null==e||""===e||e!=e)return null;try{return ZU(e,i??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(s){throw function Yo(t,n){return new le(2100,!1)}()}}static#e=this.\u0275fac=function(i){return new(i||t)(L(ra,16),L(OV,24),L(PV,24))};static#t=this.\u0275pipe=Er({name:"date",type:t,pure:!0,standalone:!0})}return t})(),I2=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ta({type:t});static#n=this.\u0275inj=Xs({})}return t})();function k2(t){return"server"===t}class C7 extends AU{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Sy extends C7{static makeCurrent(){!function IU(t){f2??=t}(new Sy)}onAndCancel(n,e,i){return n.addEventListener(e,i),()=>{n.removeEventListener(e,i)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function w7(){return hh=hh||document.querySelector("base"),hh?hh.getAttribute("href"):null}();return null==e?null:function E7(t){return new URL(t,document.baseURI).pathname}(e)}resetBaseElement(){hh=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function gV(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(o)}return null}(document.cookie,n)}}let hh=null,T7=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();const My=new dt("");let U2=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(o=>o.supports(e)),!i)throw new le(5101,!1);return this._eventNameToPlugin.set(e,i),i}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(My),Ot(kt))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();class V2{constructor(n){this._doc=n}}const Iy="ng-app-id";let H2=(()=>{class t{constructor(e,i,r,o={}){this.doc=e,this.appId=i,this.nonce=r,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=k2(o),this.resetHostNodes()}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(i=>i.remove()),e.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.elements?.forEach(r=>r.remove()),i.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${Iy}="${this.appId}"]`);if(e?.length){const i=new Map;return e.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(e,i){const r=this.styleRef;if(r.has(e)){const o=r.get(e);return o.usage+=i,o.usage}return r.set(e,{usage:i,elements:[]}),i}getStyleElement(e,i){const r=this.styleNodesInDOM,o=r?.get(i);if(o?.parentNode===e)return r.delete(i),o.removeAttribute(Iy),o;{const s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=i,this.platformIsServer&&s.setAttribute(Iy,this.appId),e.appendChild(s),s}}addStyleToHost(e,i){const r=this.getStyleElement(e,i),o=this.styleRef,s=o.get(i)?.elements;s?s.push(r):o.set(i,{elements:[r],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(oa),Ot(Hf),Ot(HE,8),Ot(Dc))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();const Ay={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ky=/%COMP%/g,I7=new dt("",{providedIn:"root",factory:()=>!0});function G2(t,n){return n.map(e=>e.replace(ky,t))}let Oy=(()=>{class t{constructor(e,i,r,o,s,a,l,c=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=k2(a),this.defaultRenderer=new Py(e,s,l,this.platformIsServer)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===jo.ShadowDom&&(i={...i,encapsulation:jo.Emulated});const r=this.getOrCreateRenderer(e,i);return r instanceof W2?r.applyToHost(e):r instanceof Ny&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case jo.Emulated:o=new W2(l,c,i,this.appId,u,s,a,d);break;case jo.ShadowDom:return new P7(l,c,e,i,s,a,this.nonce,d);default:o=new Ny(l,c,i,u,s,a,d)}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(U2),Ot(H2),Ot(Hf),Ot(I7),Ot(oa),Ot(Dc),Ot(kt),Ot(HE))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();class Py{constructor(n,e,i,r){this.eventManager=n,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(n,e){return e?this.doc.createElementNS(Ay[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){($2(n)?n.content:n).appendChild(e)}insertBefore(n,e,i){n&&($2(n)?n.content:n).insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new le(-5104,!1);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const o=Ay[r];o?n.setAttributeNS(o,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=Ay[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(Ma.DashCase|Ma.Important)?n.style.setProperty(e,i,r&Ma.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&Ma.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){null!=n&&(n[e]=i)}setValue(n,e){n.nodeValue=e}listen(n,e,i){if("string"==typeof n&&!(n=oh().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${e}`);return this.eventManager.addEventListener(n,e,this.decoratePreventDefault(i))}decoratePreventDefault(n){return e=>{if("__ngUnwrap__"===e)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(e)):n(e))&&e.preventDefault()}}}function $2(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class P7 extends Py{constructor(n,e,i,r,o,s,a,l){super(n,o,s,l),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=G2(r.id,r.styles);for(const u of c){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Ny extends Py{constructor(n,e,i,r,o,s,a,l){super(n,o,s,a),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r,this.styles=l?G2(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class W2 extends Ny{constructor(n,e,i,r,o,s,a,l){const c=r+"-"+i.id;super(n,e,i,o,s,a,l,c),this.contentAttr=function A7(t){return"_ngcontent-%COMP%".replace(ky,t)}(c),this.hostAttr=function k7(t){return"_nghost-%COMP%".replace(ky,t)}(c)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}let N7=(()=>{class t extends V2{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(oa))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();const q2=["alt","control","meta","shift"],F7={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},R7={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let L7=(()=>{class t extends V2{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const o=t.parseEventName(i),s=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>oh().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),q2.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),s+=c+".")}),s+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(e,i){let r=F7[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),q2.forEach(s=>{s!==r&&(0,R7[s])(e)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{t.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(oa))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();const Y2=[{provide:Dc,useValue:"browser"},{provide:UE,useValue:function B7(){Sy.makeCurrent()},multi:!0},{provide:oa,useFactory:function U7(){return function SR(t){o_=t}(document),document},deps:[]}],V7=OM(qj,"browser",Y2),H7=new dt(""),X2=[{provide:Hp,useClass:class x7{addToWindow(n){Zt.getAngularTestability=(i,r=!0)=>{const o=n.findTestabilityInTree(i,r);if(null==o)throw new le(5103,!1);return o},Zt.getAllAngularTestabilities=()=>n.getAllTestabilities(),Zt.getAllAngularRootElements=()=>n.getAllRootElements(),Zt.frameworkStabilizers||(Zt.frameworkStabilizers=[]),Zt.frameworkStabilizers.push(i=>{const r=Zt.getAllAngularTestabilities();let o=r.length;const s=function(){o--,0==o&&i()};r.forEach(a=>{a.whenStable(s)})})}findTestabilityInTree(n,e,i){return null==e?null:n.getTestability(e)??(i?oh().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:CM,useClass:Qv,deps:[kt,Jv,Hp]},{provide:Qv,useClass:Qv,deps:[kt,Jv,Hp]}],K2=[{provide:C0,useValue:"root"},{provide:_s,useFactory:function j7(){return new _s},deps:[]},{provide:My,useClass:N7,multi:!0,deps:[oa,kt,Dc]},{provide:My,useClass:L7,multi:!0,deps:[oa]},Oy,H2,U2,{provide:Q_,useExisting:Oy},{provide:class qV{},useClass:T7,deps:[]},[]];let Q2=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:Hf,useValue:e.appId}]}}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(H7,12))};static#t=this.\u0275mod=Ta({type:t});static#n=this.\u0275inj=Xs({providers:[...K2,...X2],imports:[I2,Zj]})}return t})(),tI=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:function(i){let r=null;return r=i?new(i||t):Ot(W7),r},providedIn:"root"})}return t})(),W7=(()=>{class t extends tI{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case wo.NONE:return i;case wo.HTML:return vs(i,"HTML")?oo(i):ax(this._doc,String(i)).toString();case wo.STYLE:return vs(i,"Style")?oo(i):i;case wo.SCRIPT:if(vs(i,"Script"))return oo(i);throw new le(5200,!1);case wo.URL:return vs(i,"URL")?oo(i):Kf(String(i));case wo.RESOURCE_URL:if(vs(i,"ResourceURL"))return oo(i);throw new le(5201,!1);default:throw new le(5202,!1)}}bypassSecurityTrustHtml(e){return function ZR(t){return new HR(t)}(e)}bypassSecurityTrustStyle(e){return function YR(t){return new zR(t)}(e)}bypassSecurityTrustScript(e){return function XR(t){return new GR(t)}(e)}bypassSecurityTrustUrl(e){return function KR(t){return new $R(t)}(e)}bypassSecurityTrustResourceUrl(e){return function QR(t){return new WR(t)}(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(oa))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ne(t,n,e,i){var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o}function Pa(t){return this instanceof Pa?(this.v=t,this):new Pa(t)}function sI(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function By(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=t[o]&&function(s){return new Promise(function(a,l){!function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}(a,l,(s=t[o](s)).done,s.value)})}}}V(4511),"function"==typeof SuppressedError&&SuppressedError;const aI=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function lI(t){return Qe(t?.then)}function cI(t){return Qe(t[Uu])}function uI(t){return Symbol.asyncIterator&&Qe(t?.[Symbol.asyncIterator])}function dI(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const hI=function fH(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function fI(t){return Qe(t?.[hI])}function pI(t){return function oI(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function s(f){return function(m){return Promise.resolve(m).then(f,d)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(f,m){i[f]&&(r[f]=function(p){return new Promise(function(g,y){o.push([f,p,g,y])>1||l(f,p)})},m&&(r[f]=m(r[f])))}function l(f,m){try{!function c(f){f.value instanceof Pa?Promise.resolve(f.value.v).then(u,d):h(o[0][2],f)}(i[f](m))}catch(p){h(o[0][3],p)}}function u(f){l("next",f)}function d(f){l("throw",f)}function h(f,m){f(m),o.shift(),o.length&&l(o[0][0],o[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield Pa(e.read());if(r)return yield Pa(void 0);yield yield Pa(i)}}finally{e.releaseLock()}})}function mI(t){return Qe(t?.getReader)}function pm(t){if(t instanceof ir)return t;if(null!=t){if(cI(t))return function pH(t){return new ir(n=>{const e=t[Uu]();if(Qe(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(aI(t))return function mH(t){return new ir(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(lI(t))return function gH(t){return new ir(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Cr)})}(t);if(uI(t))return gI(t);if(fI(t))return function _H(t){return new ir(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(mI(t))return function vH(t){return gI(pI(t))}(t)}throw dI(t)}function gI(t){return new ir(n=>{(function yH(t,n){var e,i,r,o;return function iI(t,n,e,i){return new(e||(e=Promise))(function(o,s){function a(u){try{c(i.next(u))}catch(d){s(d)}}function l(u){try{c(i.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(u.value).then(a,l)}c((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=sI(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function kl(t,n,e,i=0,r=!1){const o=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!r)return o}function _I(t,n=0){return Hu((e,i)=>{e.subscribe(zu(i,r=>kl(i,t,()=>i.next(r),n),()=>kl(i,t,()=>i.complete(),n),r=>kl(i,t,()=>i.error(r),n)))})}function vI(t,n=0){return Hu((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function yI(t,n){if(!t)throw new Error("Iterable cannot be null");return new ir(e=>{kl(e,n,()=>{const i=t[Symbol.asyncIterator]();kl(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}const{isArray:SH}=Array,{getPrototypeOf:MH,prototype:IH,keys:AH}=Object;const{isArray:NH}=Array;function LH(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}function BH(...t){const n=function PH(t){return Qe(function jy(t){return t[t.length-1]}(t))?t.pop():void 0}(t),{args:e,keys:i}=function kH(t){if(1===t.length){const n=t[0];if(SH(n))return{args:n,keys:null};if(function OH(t){return t&&"object"==typeof t&&MH(t)===IH}(n)){const e=AH(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}(t),r=new ir(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let l=s,c=s;for(let u=0;u<s;u++){let d=!1;pm(e[u]).subscribe(zu(o,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||o.next(i?LH(i,a):a),o.complete())}))}});return n?r.pipe(function RH(t){return sl(n=>function FH(t,n){return NH(n)?t(...n):t(n)}(t,n))}(n)):r}let bI=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static#e=this.\u0275fac=function(i){return new(i||t)(L(vl),L(ti))};static#t=this.\u0275dir=vt({type:t})}return t})(),Ol=(()=>{class t extends bI{static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,features:[En]})}return t})();const Es=new dt(""),jH={provide:Es,useExisting:Ht(()=>Uy),multi:!0};let Uy=(()=>{class t extends Ol{writeValue(e){this.setProperty("checked",e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){1&i&&ue("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},features:[jn([jH]),En]})}return t})();const UH={provide:Es,useExisting:Ht(()=>hr),multi:!0},HH=new dt("");let hr=(()=>{class t extends bI{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function VH(){const t=oh()?oh().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static#e=this.\u0275fac=function(i){return new(i||t)(L(vl),L(ti),L(HH,8))};static#t=this.\u0275dir=vt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&ue("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[jn([UH]),En]})}return t})();function Na(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function CI(t){return null!=t&&"number"==typeof t.length}const fr=new dt(""),Fa=new dt("");function xI(t){return Na(t.value)?{required:!0}:null}function mm(t){return null}function AI(t){return null!=t}function kI(t){return zp(t)?function DH(t,n){return n?function TH(t,n){if(null!=t){if(cI(t))return function bH(t,n){return pm(t).pipe(vI(n),_I(n))}(t,n);if(aI(t))return function wH(t,n){return new ir(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(lI(t))return function CH(t,n){return pm(t).pipe(vI(n),_I(n))}(t,n);if(uI(t))return yI(t,n);if(fI(t))return function EH(t,n){return new ir(e=>{let i;return kl(e,n,()=>{i=t[hI](),kl(e,n,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>Qe(i?.return)&&i.return()})}(t,n);if(mI(t))return function xH(t,n){return yI(pI(t),n)}(t,n)}throw dI(t)}(t,n):pm(t)}(t):t}function OI(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function PI(t,n){return n.map(e=>e(t))}function NI(t){return t.map(n=>function GH(t){return!t.validate}(n)?n:e=>n.validate(e))}function Vy(t){return null!=t?function FI(t){if(!t)return null;const n=t.filter(AI);return 0==n.length?null:function(e){return OI(PI(e,n))}}(NI(t)):null}function Hy(t){return null!=t?function RI(t){if(!t)return null;const n=t.filter(AI);return 0==n.length?null:function(e){return BH(PI(e,n).map(kI)).pipe(sl(OI))}}(NI(t)):null}function LI(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function zy(t){return t?Array.isArray(t)?t:[t]:[]}function gm(t,n){return Array.isArray(t)?t.includes(n):t===n}function UI(t,n){const e=zy(n);return zy(t).forEach(r=>{gm(e,r)||e.push(r)}),e}function VI(t,n){return zy(n).filter(e=>!gm(t,e))}class HI{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=Vy(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=Hy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Ir extends HI{get formDirective(){return null}get path(){return null}}class Ra extends HI{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class zI{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Ar=(()=>{class t extends zI{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||t)(L(Ra,2))};static#t=this.\u0275dir=vt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&kp("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[En]})}return t})(),ou=(()=>{class t extends zI{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||t)(L(Ir,10))};static#t=this.\u0275dir=vt({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&kp("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[En]})}return t})();const ph="VALID",vm="INVALID",su="PENDING",mh="DISABLED";function Wy(t){return(ym(t)?t.validators:t)||null}function qy(t,n){return(ym(n)?n.asyncValidators:t)||null}function ym(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Zy{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===ph}get invalid(){return this.status===vm}get pending(){return this.status==su}get disabled(){return this.status===mh}get enabled(){return this.status!==mh}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(UI(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(UI(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(VI(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(VI(n,this._rawAsyncValidators))}hasValidator(n){return gm(this._rawValidators,n)}hasAsyncValidator(n){return gm(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=su,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=mh,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=ph,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ph||this.status===su)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?mh:ph}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=su,this._hasOwnPendingAsyncValidator=!0;const e=kI(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Gt,this.statusChanges=new Gt}_calculateStatus(){return this._allControlsDisabled()?mh:this.errors?vm:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(su)?su:this._anyControlsHaveStatus(vm)?vm:ph}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){ym(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function ZH(t){return Array.isArray(t)?Vy(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function YH(t){return Array.isArray(t)?Hy(t):t||null}(this._rawAsyncValidators)}}class Yy extends Zy{constructor(n,e,i){super(Wy(e),qy(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){(function WI(t,n,e){t._forEachChild((i,r)=>{if(void 0===e[r])throw new le(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function $I(t,n,e){const i=t.controls;if(!(n?Object.keys(i):i).length)throw new le(1e3,"");if(!i[e])throw new le(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n?n[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const au=new dt("CallSetDisabledState",{providedIn:"root",factory:()=>bm}),bm="always";function gh(t,n,e=bm){Xy(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function QH(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&qI(t,n)})}(t,n),function ez(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function JH(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&qI(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function KH(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function Em(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function Xy(t,n){const e=function BI(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(LI(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function jI(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(LI(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();Em(n._rawValidators,r),Em(n._rawAsyncValidators,r)}function qI(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}const oz={provide:Ir,useExisting:Ht(()=>La)},_h=Promise.resolve();let La=(()=>{class t extends Ir{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Gt,this.form=new Yy({},Vy(e),Hy(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){_h.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),gh(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){_h.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){_h.then(()=>{const i=this._findContainer(e.path),r=new Yy({});(function ZI(t,n){Xy(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){_h.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){_h.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function YI(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static#e=this.\u0275fac=function(i){return new(i||t)(L(fr,10),L(Fa,10),L(au,8))};static#t=this.\u0275dir=vt({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){1&i&&ue("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[Rt.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[jn([oz]),En]})}return t})();function XI(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function KI(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const QI=class extends Zy{constructor(n=null,e,i){super(Wy(e),qy(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ym(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=KI(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){XI(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){XI(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){KI(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},lz={provide:Ra,useExisting:Ht(()=>pr)},tA=Promise.resolve();let pr=(()=>{class t extends Ra{constructor(e,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new QI,this._registered=!1,this.name="",this.update=new Gt,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function Jy(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(o=>{o.constructor===hr?e=o:function iz(t){return Object.getPrototypeOf(t.constructor)===Ol}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function Qy(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){gh(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){tA.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&hy(i);tA.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function Cm(t,n){return[...n.path,t]}(e,this._parent):[e]}static#e=this.\u0275fac=function(i){return new(i||t)(L(Ir,9),L(fr,10),L(Fa,10),L(Es,10),L(Zi,8),L(au,8))};static#t=this.\u0275dir=vt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Rt.None,"disabled","isDisabled"],model:[Rt.None,"ngModel","model"],options:[Rt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[jn([lz]),En,Kn]})}return t})(),lu=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=vt({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return t})();const cz={provide:Es,useExisting:Ht(()=>cu),multi:!0};let cu=(()=>{class t extends Ol{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){1&i&&ue("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[jn([cz]),En]})}return t})();const uz={provide:Es,useExisting:Ht(()=>vh),multi:!0};let dz=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),vh=(()=>{class t extends Ol{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=It(au,{optional:!0})??bm}ngOnInit(){this._control=this._injector.get(Ra),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}setDisabledState(e){(this.setDisabledStateFired||e||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",e),this.setDisabledStateFired=!0}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}static#e=this.\u0275fac=function(i){return new(i||t)(L(vl),L(ti),L(dz),L(Ur))};static#t=this.\u0275dir=vt({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(i,r){1&i&&ue("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[jn([uz]),En]})}return t})();const hz={provide:Es,useExisting:Ht(()=>Pl),multi:!0};let Pl=(()=>{class t extends Ol{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(i,r){1&i&&ue("change",function(s){return r.onChange(s.target.value)})("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[jn([hz]),En]})}return t})();const vz={provide:Es,useExisting:Ht(()=>la),multi:!0};function sA(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let la=(()=>{class t extends Ol{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=sA(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function yz(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&ue("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[jn([vz]),En]})}return t})(),Ba=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(sA(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||t)(L(ti),L(vl),L(la,9))};static#t=this.\u0275dir=vt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return t})();const bz={provide:Es,useExisting:Ht(()=>ib),multi:!0};function aA(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let ib=(()=>{class t extends Ol{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const c=this._getOptionValue(s[a].value);r.push(c)}}else{const s=i.options;for(let a=0;a<s.length;a++){const l=s[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function Cz(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&ue("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[jn([bz]),En]})}return t})(),ja=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(aA(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(aA(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||t)(L(ti),L(vl),L(ib,9))};static#t=this.\u0275dir=vt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return t})();function lA(t){return"number"==typeof t?t:parseInt(t,10)}function cA(t){return"number"==typeof t?t:parseFloat(t)}let Nl=(()=>{class t{constructor(){this._validator=mm}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):mm,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=vt({type:t,features:[Kn]})}return t})();const wz={provide:fr,useExisting:Ht(()=>rb),multi:!0};let rb=(()=>{class t extends Nl{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>cA(e),this.createValidator=e=>function EI(t){return n=>{if(Na(n.value)||Na(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&xo("max",r._enabled?r.max:null)},inputs:{max:"max"},features:[jn([wz]),En]})}return t})();const Ez={provide:fr,useExisting:Ht(()=>ob),multi:!0};let ob=(()=>{class t extends Nl{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>cA(e),this.createValidator=e=>function wI(t){return n=>{if(Na(n.value)||Na(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&xo("min",r._enabled?r.min:null)},inputs:{min:"min"},features:[jn([Ez]),En]})}return t})();const xz={provide:fr,useExisting:Ht(()=>Tm),multi:!0};let Tm=(()=>{class t extends Nl{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=hy,this.createValidator=e=>xI}enabled(e){return e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){2&i&&xo("required",r._enabled?"":null)},inputs:{required:"required"},features:[jn([xz]),En]})}return t})();const Sz={provide:fr,useExisting:Ht(()=>sb),multi:!0};let sb=(()=>{class t extends Nl{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>lA(e),this.createValidator=e=>function SI(t){return n=>Na(n.value)||!CI(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&xo("minlength",r._enabled?r.minlength:null)},inputs:{minlength:"minlength"},features:[jn([Sz]),En]})}return t})();const Mz={provide:fr,useExisting:Ht(()=>ab),multi:!0};let ab=(()=>{class t extends Nl{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>lA(e),this.createValidator=e=>function MI(t){return n=>CI(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=ur(t)))(r||t)}})();static#t=this.\u0275dir=vt({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&xo("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[jn([Mz]),En]})}return t})(),Az=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ta({type:t});static#n=this.\u0275inj=Xs({})}return t})(),Oz=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:au,useValue:e.callSetDisabledState??bm}]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ta({type:t});static#n=this.\u0275inj=Xs({imports:[Az]})}return t})();var Et=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(Et||{});const ca="*";function xs(t,n){return{type:Et.Trigger,name:t,definitions:n,options:{}}}function Yi(t,n=null){return{type:Et.Animate,styles:n,timings:t}}function Tt(t){return{type:Et.Style,styles:t,offset:null}}function fA(t,n,e){return{type:Et.State,name:t,styles:n,options:e}}function Xo(t){return{type:Et.Keyframes,steps:t}}function Xi(t,n,e=null){return{type:Et.Transition,expr:t,animation:n,options:e}}class yh{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class pA{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function mA(t){return new le(3e3,!1)}function Ua(t){switch(t.length){case 0:return new yh;case 1:return t[0];default:return new pA(t)}}function gA(t,n,e=new Map,i=new Map){const r=[],o=[];let s=-1,a=null;if(n.forEach(l=>{const c=l.get("offset"),u=c==s,d=u&&a||new Map;l.forEach((h,f)=>{let m=f,p=h;if("offset"!==f)switch(m=t.normalizePropertyName(m,r),p){case"!":p=e.get(f);break;case ca:p=i.get(f);break;default:p=t.normalizeStyleValue(f,m,p,r)}d.set(m,p)}),u||o.push(d),a=d,s=c}),r.length)throw function sG(t){return new le(3502,!1)}();return o}function cb(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&ub(e,"start",t)));break;case"done":t.onDone(()=>i(e&&ub(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&ub(e,"destroy",t)))}}function ub(t,n,e){const o=db(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),s=t._data;return null!=s&&(o._data=s),o}function db(t,n,e,i,r="",o=0,s){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function uo(t,n,e){let i=t.get(n);return i||t.set(n,i=e),i}function _A(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}const vG=typeof document>"u"?null:document.documentElement;function hb(t){const n=t.parentNode||t.host||null;return n===vG?null:n}let Fl=null,vA=!1;function yA(t,n){for(;n;){if(n===t)return!0;n=hb(n)}return!1}function bA(t,n,e){if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]}let fb=(()=>{class t{validateStyleProperty(e){return function bG(t){Fl||(Fl=function CG(){return typeof document<"u"?document.body:null}()||{},vA=!!Fl.style&&"WebkitAppearance"in Fl.style);let n=!0;return Fl.style&&!function yG(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in Fl.style,!n&&vA&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in Fl.style)),n}(e)}matchesElement(e,i){return!1}containsElement(e,i){return yA(e,i)}getParentElement(e){return hb(e)}query(e,i,r){return bA(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],l){return new yh(r,o)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();class pb{static#e=this.NOOP=new fb}class mb{}const EG=1e3,gb="ng-enter",Dm="ng-leave",Sm="ng-trigger",Mm=".ng-trigger",wA="ng-animating",_b=".ng-animating";function ua(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:vb(parseFloat(n[1]),n[2])}function vb(t,n){return"s"===n?t*EG:t}function Im(t,n,e){return t.hasOwnProperty("duration")?t:function TG(t,n,e){let r,o=0,s="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(mA()),{duration:0,delay:0,easing:""};r=vb(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(o=vb(parseFloat(l),a[4]));const c=a[5];c&&(s=c)}else r=t;if(!e){let a=!1,l=n.length;r<0&&(n.push(function Bz(){return new le(3100,!1)}()),a=!0),o<0&&(n.push(function jz(){return new le(3101,!1)}()),a=!0),a&&n.splice(l,0,mA())}return{duration:r,delay:o,easing:s}}(t,n,e)}function Ts(t,n,e){n.forEach((i,r)=>{const o=bb(r);e&&!e.has(r)&&e.set(r,t.style[o]),t.style[o]=i})}function Rl(t,n){n.forEach((e,i)=>{const r=bb(i);t.style[r]=""})}function bh(t){return Array.isArray(t)?1==t.length?t[0]:function Pz(t,n=null){return{type:Et.Sequence,steps:t,options:n}}(t):t}const yb=new RegExp("{{\\s*(.+?)\\s*}}","g");function xA(t){let n=[];if("string"==typeof t){let e;for(;e=yb.exec(t);)n.push(e[1]);yb.lastIndex=0}return n}function Ch(t,n,e){const i=`${t}`,r=i.replace(yb,(o,s)=>{let a=n[s];return null==a&&(e.push(function Vz(t){return new le(3003,!1)}()),a=""),a.toString()});return r==i?t:r}const MG=/-+([a-z0-9])/g;function bb(t){return t.replace(MG,(...n)=>n[1].toUpperCase())}function ho(t,n,e){switch(n.type){case Et.Trigger:return t.visitTrigger(n,e);case Et.State:return t.visitState(n,e);case Et.Transition:return t.visitTransition(n,e);case Et.Sequence:return t.visitSequence(n,e);case Et.Group:return t.visitGroup(n,e);case Et.Animate:return t.visitAnimate(n,e);case Et.Keyframes:return t.visitKeyframes(n,e);case Et.Style:return t.visitStyle(n,e);case Et.Reference:return t.visitReference(n,e);case Et.AnimateChild:return t.visitAnimateChild(n,e);case Et.AnimateRef:return t.visitAnimateRef(n,e);case Et.Query:return t.visitQuery(n,e);case Et.Stagger:return t.visitStagger(n,e);default:throw function Hz(t){return new le(3004,!1)}()}}function Cb(t,n){return window.getComputedStyle(t)[n]}const kG=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class TA extends mb{normalizePropertyName(n,e){return bb(n)}normalizeStyleValue(n,e,i,r){let o="";const s=i.toString().trim();if(kG.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function zz(t,n){return new le(3005,!1)}())}return s+o}}const Am="*";const km=new Set(["true","1"]),Om=new Set(["false","0"]);function DA(t,n){const e=km.has(t)||Om.has(t),i=km.has(n)||Om.has(n);return(r,o)=>{let s=t==Am||t==r,a=n==Am||n==o;return!s&&e&&"boolean"==typeof r&&(s=r?km.has(t):Om.has(t)),!a&&i&&"boolean"==typeof o&&(a=o?km.has(n):Om.has(n)),s&&a}}const FG=new RegExp("s*:selfs*,?","g");function wb(t,n,e,i){return new RG(t).build(n,e,i)}class RG{constructor(n){this._driver=n}build(n,e,i){const r=new jG(e);return this._resetContextStyleTimingState(r),ho(this,bh(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==n.name.charAt(0)&&e.errors.push(function Gz(){return new le(3006,!1)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),a.type==Et.State){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,o.push(this.visitState(l,e))}),l.name=c}else if(a.type==Et.Transition){const l=this.visitTransition(a,e);i+=l.queryCount,r+=l.depCount,s.push(l)}else e.errors.push(function $z(){return new le(3007,!1)}())}),{type:Et.Trigger,name:n.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{xA(l).forEach(c=>{s.hasOwnProperty(c)||o.add(c)})})}),o.size&&e.errors.push(function Wz(t,n){return new le(3008,!1)}(0,o.values()))}return{type:Et.State,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=ho(this,bh(n.animation),e),r=function OG(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function PG(t,n,e){if(":"==t[0]){const l=function NG(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function nG(t){return new le(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof l)return void n.push(l);t=l}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function tG(t){return new le(3015,!1)}()),n;const r=i[1],o=i[2],s=i[3];n.push(DA(r,s)),"<"==o[0]&&(r!=Am||s!=Am)&&n.push(DA(s,r))}(i,e,n)):e.push(t),e}(n.expr,e.errors);return{type:Et.Transition,matchers:r,animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Ll(n.options)}}visitSequence(n,e){return{type:Et.Sequence,steps:n.steps.map(i=>ho(this,i,e)),options:Ll(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const o=n.steps.map(s=>{e.currentTime=i;const a=ho(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:Et.Group,steps:o,options:Ll(n.options)}}visitAnimate(n,e){const i=function VG(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return Eb(Im(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=Eb(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=Im(e,n);return Eb(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,o=n.styles?n.styles:Tt({});if(o.type==Et.Keyframes)r=this.visitKeyframes(o,e);else{let s=n.styles,a=!1;if(!s){a=!0;const c={};i.easing&&(c.easing=i.easing),s=Tt(c)}e.currentTime+=i.duration+i.delay;const l=this.visitStyle(s,e);l.isEmptyStep=a,r=l}return e.currentAnimateTimings=null,{type:Et.Animate,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of r)"string"==typeof a?a===ca?i.push(a):e.errors.push(new le(3002,!1)):i.push(new Map(Object.entries(a)));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let l of a.values())if(l.toString().indexOf("{{")>=0){o=!0;break}}),{type:Et.Style,styles:i,easing:s,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),n.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,l)=>{const c=e.collectedStyles.get(e.currentQuerySelector),u=c.get(l);let d=!0;u&&(o!=r&&o>=u.startTime&&r<=u.endTime&&(e.errors.push(function Zz(t,n,e,i,r){return new le(3010,!1)}()),d=!1),o=u.startTime),d&&c.set(l,{startTime:o,endTime:r}),e.options&&function SG(t,n,e){const i=n.params||{},r=xA(t);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function Uz(t){return new le(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(n,e){const i={type:Et.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function Yz(){return new le(3011,!1)}()),i;let o=0;const s=[];let a=!1,l=!1,c=0;const u=n.steps.map(y=>{const C=this._makeStyleAst(y,e);let N=null!=C.offset?C.offset:function UG(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(C.styles),$=0;return null!=N&&(o++,$=C.offset=N),l=l||$<0||$>1,a=a||$<c,c=$,s.push($),C});l&&e.errors.push(function Xz(){return new le(3012,!1)}()),a&&e.errors.push(function Kz(){return new le(3200,!1)}());const d=n.steps.length;let h=0;o>0&&o<d?e.errors.push(function Qz(){return new le(3202,!1)}()):0==o&&(h=1/(d-1));const f=d-1,m=e.currentTime,p=e.currentAnimateTimings,g=p.duration;return u.forEach((y,C)=>{const N=h>0?C==f?1:h*C:s[C],$=N*g;e.currentTime=m+p.delay+$,p.duration=$,this._validateStyleAst(y,e),y.offset=N,i.styles.push(y)}),i}visitReference(n,e){return{type:Et.Reference,animation:ho(this,bh(n.animation),e),options:Ll(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:Et.AnimateChild,options:Ll(n.options)}}visitAnimateRef(n,e){return{type:Et.AnimateRef,animation:this.visitReference(n.animation,e),options:Ll(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[o,s]=function LG(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(FG,"")),t=t.replace(/@\*/g,Mm).replace(/@\w+/g,e=>Mm+"-"+e.slice(1)).replace(/:animating/g,_b),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+o:o,uo(e.collectedStyles,e.currentQuerySelector,new Map);const a=ho(this,bh(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:Et.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:n.selector,options:Ll(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function Jz(){return new le(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:Im(n.timings,e.errors,!0);return{type:Et.Stagger,animation:ho(this,bh(n.animation),e),timings:i,options:null}}}class jG{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ll(t){return t?(t={...t}).params&&(t.params=function BG(t){return t?{...t}:null}(t.params)):t={},t}function Eb(t,n,e){return{duration:t,delay:n,easing:e}}function xb(t,n,e,i,r,o,s=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class Pm{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const GG=new RegExp(":enter","g"),WG=new RegExp(":leave","g");function Tb(t,n,e,i,r,o=new Map,s=new Map,a,l,c=[]){return(new qG).buildKeyframes(t,n,e,i,r,o,s,a,l,c)}class qG{buildKeyframes(n,e,i,r,o,s,a,l,c,u=[]){c=c||new Pm;const d=new Db(n,e,c,r,o,u,[]);d.options=l;const h=l.delay?ua(l.delay):0;d.currentTimeline.delayNextStep(h),d.currentTimeline.setStyles([s],null,d.errors,l),ho(this,i,d);const f=d.timelines.filter(m=>m.containsAnimation());if(f.length&&a.size){let m;for(let p=f.length-1;p>=0;p--){const g=f[p];if(g.element===e){m=g;break}}m&&!m.allowOnlyTimelineStyles()&&m.setStyles([a],null,d.errors,l)}return f.length?f.map(m=>m.buildKeyframes()):[xb(e,[],[],[],0,h,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,i),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,i){for(const r of n){const o=r?.delay;if(o){const s="number"==typeof o?o:ua(Ch(o,r?.params??{},e.errors));i.delayNextStep(s)}}}_visitSubInstructions(n,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?ua(i.duration):null,a=null!=i.delay?ua(i.delay):null;return 0!==s&&n.forEach(l=>{const c=e.appendInstructionToTimeline(l,s,a);o=Math.max(o,c.duration+c.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),ho(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const o=n.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){r.previousNode.type==Et.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Nm);const s=ua(o.delay);r.delayNextStep(s)}n.steps.length&&(n.steps.forEach(s=>ho(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?ua(n.options.delay):0;n.steps.forEach(s=>{const a=e.createSubContext(n.options);o&&a.delayNextStep(o),ho(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return Im(e.params?Ch(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=n.style;o.type==Et.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(o):i.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(l=>{a.forwardTime((l.offset||0)*o),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},o=r.delay?ua(r.delay):0;o&&(e.previousNode.type===Et.Style||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Nm);let s=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{e.currentQueryIndex=u;const d=e.createSubContext(n.options,c);o&&d.delayNextStep(o),c===e.element&&(l=d.currentTimeline),ho(this,n.animation,d),d.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,d.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,o=n.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let l=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=e.currentTimeline;l&&u.delayNextStep(l);const d=u.currentTime;ho(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-d+(r.startTime-i.currentTimeline.startTime)}}const Nm={};class Db{constructor(n,e,i,r,o,s,a,l){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Nm,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Fm(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=ua(i.duration)),null!=i.delay&&(r.delay=ua(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=Ch(o[a],s,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,o=new Db(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=Nm,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},o=new ZG(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,o,s){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(GG,"."+this._enterClassName)).replace(WG,"."+this._leaveClassName);let c=this._driver.query(this.element,n,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!o&&0==a.length&&s.push(function eG(t){return new le(3014,!1)}()),a}}class Fm{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new Fm(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||ca),this._currentKeyframe.set(e,ca);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},s=function YG(t,n){const e=new Map;let i;return t.forEach(r=>{if("*"===r){i??=n.keys();for(let o of i)e.set(o,ca)}else for(let[o,s]of r)e.set(o,s)}),e}(n,this._globalTimelineStyles);for(let[a,l]of s){const c=Ch(l,o,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??ca),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=new Map([...this._backFill,...a]);c.forEach((u,d)=>{"!"===u?n.add(d):u===ca&&e.add(d)}),i||c.set("offset",l/this.duration),r.push(c)});const o=[...n.values()],s=[...e.values()];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return xb(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class ZG extends Fm{constructor(n,e,i,r,o,s,a=!1){super(n,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,l=new Map(n[0]);l.set("offset",0),o.push(l);const c=new Map(n[0]);c.set("offset",IA(a)),o.push(c);const u=n.length-1;for(let d=1;d<=u;d++){let h=new Map(n[d]);const f=h.get("offset");h.set("offset",IA((e+f*i)/s)),o.push(h)}i=s,e=0,r="",n=o}return xb(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function IA(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}function AA(t,n,e,i,r,o,s,a,l,c,u,d,h){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:d,errors:h}}const Sb={};class kA{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function XG(t,n,e,i,r){return t.some(o=>o(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,i):new Map}build(n,e,i,r,o,s,a,l,c,u){const d=[],h=this.ast.options&&this.ast.options.params||Sb,m=this.buildStyles(i,a&&a.params||Sb,d),p=l&&l.params||Sb,g=this.buildStyles(r,p,d),y=new Set,C=new Map,N=new Map,$="void"===r,H={params:OA(p,h),delay:this.ast.options?.delay},z=u?[]:Tb(n,e,this.ast.animation,o,s,m,g,H,c,d);let X=0;return z.forEach(ee=>{X=Math.max(ee.duration+ee.delay,X)}),d.length?AA(e,this._triggerName,i,r,$,m,g,[],[],C,N,X,d):(z.forEach(ee=>{const he=ee.element,ae=uo(C,he,new Set);ee.preStyleProps.forEach(we=>ae.add(we));const se=uo(N,he,new Set);ee.postStyleProps.forEach(we=>se.add(we)),he!==e&&y.add(he)}),AA(e,this._triggerName,i,r,$,m,g,z,[...y.values()],C,N,X))}}function OA(t,n){const e={...n};return Object.entries(t).forEach(([i,r])=>{null!=r&&(e[i]=r)}),e}class KG{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i=new Map,r=OA(n,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=Ch(s,r,e));const l=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,l,s,e),i.set(a,s)})}),i}}class JG{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new KG(r.style,r.options&&r.options.params||{},i))}),PA(this.states,"true","1"),PA(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new kA(n,r,this.states))}),this.fallbackTransition=function e$(t,n,e){return new kA(t,{type:Et.Transition,animation:{type:Et.Sequence,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(s=>s.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function PA(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const t$=new Pm;class n${constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const i=[],o=wb(this._driver,e,i,[]);if(i.length)throw function aG(t){return new le(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,i){const r=n.element,o=gA(this._normalizer,n.keyframes,e,i);return this._driver.animate(r,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],o=this._animations.get(n);let s;const a=new Map;if(o?(s=Tb(this._driver,e,o,gb,Dm,new Map,new Map,i,t$,r),s.forEach(u=>{const d=uo(a,u.element,new Map);u.postStyleProps.forEach(h=>d.set(h,null))})):(r.push(function lG(){return new le(3300,!1)}()),s=[]),r.length)throw function cG(t){return new le(3504,!1)}();a.forEach((u,d)=>{u.forEach((h,f)=>{u.set(f,this._driver.computeStyle(d,f,ca))})});const c=Ua(s.map(u=>{const d=a.get(u.element);return this._buildPlayer(u,new Map,d)}));return this._playersById.set(n,c),c.onDestroy(()=>this.destroy(n)),this.players.push(c),c}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function uG(t){return new le(3301,!1)}();return e}listen(n,e,i,r){const o=db(e,"","","");return cb(this._getPlayer(n),i,o,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const o=this._getPlayer(n);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const NA="ng-animate-queued",Mb="ng-animate-disabled",a$=[],FA={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},l$={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ko="__ng_removed";class Ib{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function h$(t){return t??null}(i?n.value:n),i){const{value:o,...s}=n;this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const wh="void",Ab=new Ib(wh);class c${constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,So(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.has(e))throw function dG(t,n){return new le(3302,!1)}();if(null==i||0==i.length)throw function hG(t){return new le(3303,!1)}();if(!function f$(t){return"start"==t||"done"==t}(i))throw function fG(t,n){return new le(3400,!1)}();const o=uo(this._elementListeners,n,[]),s={name:e,phase:i,callback:r};o.push(s);const a=uo(this._engine.statesByElement,n,new Map);return a.has(e)||(So(n,Sm),So(n,Sm+"-"+e),a.set(e,Ab)),()=>{this._engine.afterFlush(()=>{const l=o.indexOf(s);l>=0&&o.splice(l,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function pG(t){return new le(3401,!1)}();return e}trigger(n,e,i,r=!0){const o=this._getTrigger(e),s=new kb(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(So(n,Sm),So(n,Sm+"-"+e),this._engine.statesByElement.set(n,a=new Map));let l=a.get(e);const c=new Ib(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(e,c),l||(l=Ab),c.value!==wh&&l.value===c.value){if(!function g$(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(l.params,c.params)){const p=[],g=o.matchStyles(l.value,l.params,p),y=o.matchStyles(c.value,c.params,p);p.length?this._engine.reportError(p):this._engine.afterFlush(()=>{Rl(n,g),Ts(n,y)})}return}const h=uo(this._engine.playersByElement,n,[]);h.forEach(p=>{p.namespaceId==this.id&&p.triggerName==e&&p.queued&&p.destroy()});let f=o.matchTransition(l.value,c.value,n,c.params),m=!1;if(!f){if(!r)return;f=o.fallbackTransition,m=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:f,fromState:l,toState:c,player:s,isFallbackTransition:m}),m||(So(n,NA),s.onStart(()=>{uu(n,NA)})),s.onDone(()=>{let p=this.players.indexOf(s);p>=0&&this.players.splice(p,1);const g=this._engine.playersByElement.get(n);if(g){let y=g.indexOf(s);y>=0&&g.splice(y,1)}}),this.players.push(s),h.push(s),s}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,Mm,!0);i.forEach(r=>{if(r[Ko])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const o=this._engine.statesByElement.get(n),s=new Map;if(o){const a=[];if(o.forEach((l,c)=>{if(s.set(c,l.value),this._triggers.has(c)){const u=this.trigger(n,c,wh,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,s),i&&Ua(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const l=this._triggers.get(s).fallbackTransition,c=i.get(s)||Ab,u=new Ib(wh),d=new kb(this.id,s,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:s,transition:l,fromState:c,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(n):[];if(o&&o.length)r=!0;else{let s=n;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const o=n[Ko];(!o||o===FA)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){So(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const l=db(o,i.triggerName,i.fromState.value,i.toState.value);l._data=n,cb(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class u${_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,i,r){this.bodyNode=n,this.driver=e,this._normalizer=i,this.scheduler=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,s)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new c$(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,n),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(e),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(n,e,i,r){if(Rm(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!Rm(e))return;const o=e[Ko];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(n){const s=this._fetchNamespace(n);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),So(n,Mb)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),uu(n,Mb))}removeNode(n,e,i){if(Rm(e)){this.scheduler?.notify();const r=n?this._fetchNamespace(n):null;r?r.removeNode(e,i):this.markElementAsRemoved(n,e,!1,i);const o=this.namespacesByHostElement.get(e);o&&o.id!==n&&o.removeNode(e,i)}else this._onRemovalComplete(e,i)}markElementAsRemoved(n,e,i,r,o){this.collectedLeaveElements.push(e),e[Ko]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,i,r,o){return Rm(e)?this._fetchNamespace(n).listen(e,i,r,o):()=>{}}_buildInstruction(n,e,i,r,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,Mm,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,_b,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Ua(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[Ko];if(e&&e.setForRemoval){if(n[Ko]=FA,e.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(Mb)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)So(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Ua(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function mG(t){return new le(3402,!1)}()}_flushAnimations(n,e){const i=new Pm,r=[],o=new Map,s=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(te=>{u.add(te);const _e=this.driver.query(te,".ng-animate-queued",!0);for(let ve=0;ve<_e.length;ve++)u.add(_e[ve])});const d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=BA(h,this.collectedEnterElements),m=new Map;let p=0;f.forEach((te,_e)=>{const ve=gb+p++;m.set(_e,ve),te.forEach(Ye=>So(Ye,ve))});const g=[],y=new Set,C=new Set;for(let te=0;te<this.collectedLeaveElements.length;te++){const _e=this.collectedLeaveElements[te],ve=_e[Ko];ve&&ve.setForRemoval&&(g.push(_e),y.add(_e),ve.hasAnimation?this.driver.query(_e,".ng-star-inserted",!0).forEach(Ye=>y.add(Ye)):C.add(_e))}const N=new Map,$=BA(h,Array.from(y));$.forEach((te,_e)=>{const ve=Dm+p++;N.set(_e,ve),te.forEach(Ye=>So(Ye,ve))}),n.push(()=>{f.forEach((te,_e)=>{const ve=m.get(_e);te.forEach(Ye=>uu(Ye,ve))}),$.forEach((te,_e)=>{const ve=N.get(_e);te.forEach(Ye=>uu(Ye,ve))}),g.forEach(te=>{this.processLeaveNode(te)})});const H=[],z=[];for(let te=this._namespaceList.length-1;te>=0;te--)this._namespaceList[te].drainQueuedTransitions(e).forEach(ve=>{const Ye=ve.player,Oe=ve.element;if(H.push(Ye),this.collectedEnterElements.length){const Sn=Oe[Ko];if(Sn&&Sn.setForMove){if(Sn.previousTriggersValues&&Sn.previousTriggersValues.has(ve.triggerName)){const xi=Sn.previousTriggersValues.get(ve.triggerName),qn=this.statesByElement.get(ve.element);if(qn&&qn.has(ve.triggerName)){const Ti=qn.get(ve.triggerName);Ti.value=xi,qn.set(ve.triggerName,Ti)}}return void Ye.destroy()}}const jt=!d||!this.driver.containsElement(d,Oe),Ge=N.get(Oe),mt=m.get(Oe),$t=this._buildInstruction(ve,i,mt,Ge,jt);if($t.errors&&$t.errors.length)return void z.push($t);if(jt)return Ye.onStart(()=>Rl(Oe,$t.fromStyles)),Ye.onDestroy(()=>Ts(Oe,$t.toStyles)),void r.push(Ye);if(ve.isFallbackTransition)return Ye.onStart(()=>Rl(Oe,$t.fromStyles)),Ye.onDestroy(()=>Ts(Oe,$t.toStyles)),void r.push(Ye);const Gn=[];$t.timelines.forEach(Sn=>{Sn.stretchStartingKeyframe=!0,this.disabledNodes.has(Sn.element)||Gn.push(Sn)}),$t.timelines=Gn,i.append(Oe,$t.timelines),s.push({instruction:$t,player:Ye,element:Oe}),$t.queriedElements.forEach(Sn=>uo(a,Sn,[]).push(Ye)),$t.preStyleProps.forEach((Sn,xi)=>{if(Sn.size){let qn=l.get(xi);qn||l.set(xi,qn=new Set),Sn.forEach((Ti,Fr)=>qn.add(Fr))}}),$t.postStyleProps.forEach((Sn,xi)=>{let qn=c.get(xi);qn||c.set(xi,qn=new Set),Sn.forEach((Ti,Fr)=>qn.add(Fr))})});if(z.length){const te=[];z.forEach(_e=>{te.push(function gG(t,n){return new le(3505,!1)}())}),H.forEach(_e=>_e.destroy()),this.reportError(te)}const X=new Map,ee=new Map;s.forEach(te=>{const _e=te.element;i.has(_e)&&(ee.set(_e,_e),this._beforeAnimationBuild(te.player.namespaceId,te.instruction,X))}),r.forEach(te=>{const _e=te.element;this._getPreviousPlayers(_e,!1,te.namespaceId,te.triggerName,null).forEach(Ye=>{uo(X,_e,[]).push(Ye),Ye.destroy()})});const he=g.filter(te=>UA(te,l,c)),ae=new Map;LA(ae,this.driver,C,c,ca).forEach(te=>{UA(te,l,c)&&he.push(te)});const we=new Map;f.forEach((te,_e)=>{LA(we,this.driver,new Set(te),l,"!")}),he.forEach(te=>{const _e=ae.get(te),ve=we.get(te);ae.set(te,new Map([..._e?.entries()??[],...ve?.entries()??[]]))});const Ce=[],Ie=[],Re={};s.forEach(te=>{const{element:_e,player:ve,instruction:Ye}=te;if(i.has(_e)){if(u.has(_e))return ve.onDestroy(()=>Ts(_e,Ye.toStyles)),ve.disabled=!0,ve.overrideTotalTime(Ye.totalTime),void r.push(ve);let Oe=Re;if(ee.size>1){let Ge=_e;const mt=[];for(;Ge=Ge.parentNode;){const $t=ee.get(Ge);if($t){Oe=$t;break}mt.push(Ge)}mt.forEach($t=>ee.set($t,Oe))}const jt=this._buildAnimation(ve.namespaceId,Ye,X,o,we,ae);if(ve.setRealPlayer(jt),Oe===Re)Ce.push(ve);else{const Ge=this.playersByElement.get(Oe);Ge&&Ge.length&&(ve.parentPlayer=Ua(Ge)),r.push(ve)}}else Rl(_e,Ye.fromStyles),ve.onDestroy(()=>Ts(_e,Ye.toStyles)),Ie.push(ve),u.has(_e)&&r.push(ve)}),Ie.forEach(te=>{const _e=o.get(te.element);if(_e&&_e.length){const ve=Ua(_e);te.setRealPlayer(ve)}}),r.forEach(te=>{te.parentPlayer?te.syncPlayerEvents(te.parentPlayer):te.destroy()});for(let te=0;te<g.length;te++){const _e=g[te],ve=_e[Ko];if(uu(_e,Dm),ve&&ve.hasAnimation)continue;let Ye=[];if(a.size){let jt=a.get(_e);jt&&jt.length&&Ye.push(...jt);let Ge=this.driver.query(_e,_b,!0);for(let mt=0;mt<Ge.length;mt++){let $t=a.get(Ge[mt]);$t&&$t.length&&Ye.push(...$t)}}const Oe=Ye.filter(jt=>!jt.destroyed);Oe.length?p$(this,_e,Oe):this.processLeaveNode(_e)}return g.length=0,Ce.forEach(te=>{this.players.push(te),te.onDone(()=>{te.destroy();const _e=this.players.indexOf(te);this.players.splice(_e,1)}),te.play()}),Ce}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(s=a)}else{const a=this.playersByElement.get(n);if(a){const l=!o||o==wh;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||s.push(c)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(n,e,i){const o=e.element,s=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const l of e.timelines){const c=l.element,u=c!==o,d=uo(i,c,[]);this._getPreviousPlayers(c,u,s,a,e.toState).forEach(f=>{const m=f.getRealPlayer();m.beforeDestroy&&m.beforeDestroy(),f.destroy(),d.push(f)})}Rl(o,e.fromStyles)}_buildAnimation(n,e,i,r,o,s){const a=e.triggerName,l=e.element,c=[],u=new Set,d=new Set,h=e.timelines.map(m=>{const p=m.element;u.add(p);const g=p[Ko];if(g&&g.removedBeforeQueried)return new yh(m.duration,m.delay);const y=p!==l,C=function m$(t){const n=[];return jA(t,n),n}((i.get(p)||a$).map(X=>X.getRealPlayer())).filter(X=>!!X.element&&X.element===p),N=o.get(p),$=s.get(p),H=gA(this._normalizer,m.keyframes,N,$),z=this._buildPlayer(m,H,C);if(m.subTimeline&&r&&d.add(p),y){const X=new kb(n,a,p);X.setRealPlayer(z),c.push(X)}return z});c.forEach(m=>{uo(this.playersByQueriedElement,m.element,[]).push(m),m.onDone(()=>function d$(t,n,e){let i=t.get(n);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}return i}(this.playersByQueriedElement,m.element,m))}),u.forEach(m=>So(m,wA));const f=Ua(h);return f.onDestroy(()=>{u.forEach(m=>uu(m,wA)),Ts(l,e.toStyles)}),d.forEach(m=>{uo(r,m,[]).push(f)}),f}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new yh(n.duration,n.delay)}}class kb{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new yh,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>cb(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){uo(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function Rm(t){return t&&1===t.nodeType}function RA(t,n){const e=t.style.display;return t.style.display=n??"none",e}function LA(t,n,e,i,r){const o=[];e.forEach(l=>o.push(RA(l)));const s=[];i.forEach((l,c)=>{const u=new Map;l.forEach(d=>{const h=n.computeStyle(c,d,r);u.set(d,h),(!h||0==h.length)&&(c[Ko]=l$,s.push(c))}),t.set(c,u)});let a=0;return e.forEach(l=>RA(l,o[a++])),s}function BA(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const r=new Set(n),o=new Map;function s(a){if(!a)return 1;let l=o.get(a);if(l)return l;const c=a.parentNode;return l=e.has(c)?c:r.has(c)?1:s(c),o.set(a,l),l}return n.forEach(a=>{const l=s(a);1!==l&&e.get(l).push(a)}),e}function So(t,n){t.classList?.add(n)}function uu(t,n){t.classList?.remove(n)}function p$(t,n,e){Ua(e).onDone(()=>t.processLeaveNode(n))}function jA(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof pA?jA(i.players,n):n.push(i)}}function UA(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(o=>r.add(o)):n.set(t,i),e.delete(t),!0}class Eh{constructor(n,e,i,r){this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(o,s)=>{},this._transitionEngine=new u$(n.body,e,i,r),this._timelineEngine=new n$(n.body,e,i),this._transitionEngine.onRemovalComplete=(o,s)=>this.onRemovalComplete(o,s)}registerTrigger(n,e,i,r,o){const s=n+"-"+r;let a=this._triggerCache[s];if(!a){const l=[],u=wb(this._driver,o,l,[]);if(l.length)throw function oG(t,n){return new le(3404,!1)}();a=function QG(t,n,e){return new JG(t,n,e)}(r,u,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i){this._transitionEngine.removeNode(n,e,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[o,s]=_A(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=_A(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(n,e,i,r,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}class xh{static#e=this.initialStylesByElement=new WeakMap;constructor(n,e,i){this._element=n,this._startStyles=e,this._endStyles=i,this._state=0;let r=xh.initialStylesByElement.get(n);r||xh.initialStylesByElement.set(n,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&Ts(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ts(this._element,this._initialStyles),this._endStyles&&(Ts(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(xh.initialStylesByElement.delete(this._element),this._startStyles&&(Rl(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Rl(this._element,this._endStyles),this._endStyles=null),Ts(this._element,this._initialStyles),this._state=3)}}function Ob(t){let n=null;return t.forEach((e,i)=>{(function v$(t){return"display"===t||"position"===t})(i)&&(n=n||new Map,n.set(i,e))}),n}class VA{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(n,e,i){return n.animate(this._convertKeyframesToObject(e),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:Cb(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class HA{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return yA(n,e)}getParentElement(n){return hb(n)}query(n,e,i){return bA(n,e,i)}computeStyle(n,e,i){return Cb(n,e)}animate(n,e,i,r,o,s=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(l.easing=o);const c=new Map,u=s.filter(f=>f instanceof VA);(function IG(t,n){return 0===t||0===n})(i,r)&&u.forEach(f=>{f.currentSnapshot.forEach((m,p)=>c.set(p,m))});let d=function DG(t){return t.length?t[0]instanceof Map?t:t.map(n=>new Map(Object.entries(n))):[]}(e).map(f=>new Map(f));d=function AG(t,n,e){if(e.size&&n.length){let i=n[0],r=[];if(e.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<n.length;o++){let s=n[o];r.forEach(a=>s.set(a,Cb(t,a)))}}return n}(n,d,c);const h=function _$(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=Ob(n[0]),n.length>1&&(i=Ob(n[n.length-1]))):n instanceof Map&&(e=Ob(n)),e||i?new xh(t,e,i):null}(n,d);return new VA(n,d,l,h)}}const zA="@.disabled";class GA{constructor(n,e,i,r){this.namespaceId=n,this.delegate=e,this.engine=i,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==zA?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class y$ extends GA{constructor(n,e,i,r,o){super(e,i,r,o),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==zA?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.slice(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function b$(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function C$(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}class w${constructor(n,e,i){this.delegate=n,this.engine=e,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(r,o)=>{const s=o?.parentNode(r);s&&o.removeChild(s,r)}}createRenderer(n,e){const r=this.delegate.createRenderer(n,e);if(!n||!e?.data?.animation){const c=this._rendererCache;let u=c.get(r);return u||(u=new GA("",r,this.engine,()=>c.delete(r)),c.set(r,u)),u}const o=e.id,s=e.id+"-"+this._currentId;this._currentId++,this.engine.register(s,n);const a=c=>{Array.isArray(c)?c.forEach(a):this.engine.registerTrigger(o,s,n,c.name,c)};return e.data.animation.forEach(a),new y$(this,s,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,e,i){if(n>=0&&n<this._microtaskId)return void this._zone.run(()=>e(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),r.push([e,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let E$=(()=>{class t extends Eh{constructor(e,i,r){super(e,i,r,It(mp,{optional:!0}))}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(oa),Ot(pb),Ot(mb))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();const $A=[{provide:mb,useFactory:function x$(){return new TA}},{provide:Eh,useClass:E$},{provide:Q_,useFactory:function T$(t,n,e){return new w$(t,n,e)},deps:[Oy,Eh,kt]}],Pb=[{provide:pb,useFactory:()=>new HA},{provide:VE,useValue:"BrowserAnimations"},...$A],WA=[{provide:pb,useClass:fb},{provide:VE,useValue:"NoopAnimations"},...$A];let D$=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?WA:Pb}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ta({type:t});static#n=this.\u0275inj=Xs({providers:Pb,imports:[Q2]})}return t})();var Mo=V(2306),S$=V(8848),du=V(8518);const qA=du.y.parse("???");class Ds{static get instance(){return Ds._instance||(Ds._instance=new Ds),Ds._instance}get isOpen(){return!!this.connection&&this.connection.peer.isOpen}get peerId(){return this.connection?this.connection.peerId:qA.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peer(){return this.connection?this.connection.peer:qA}get peers(){return this.connection?this.connection.peers.concat():[]}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}constructor(){this.callback=new S$.U,this.config={},this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}configure(n){this.config=n}open(...n){this.connectionClassPromise&&(console.warn("It is already opened."),this.close()),this.openAsync.apply(this,n)}openAsync(...n){var e=this;return(0,E.A)(function*(){let i=e.dynamicImport(e.config?.backend?.mode);e.connectionClassPromise=i,e.connectionClass=yield i,e.connectionClassPromise==i&&(console.log("Network open...",n),e.connection=e.initializeConnection(),e.connection.open.apply(e.connection,n),window.addEventListener("unload",e.callbackUnload,!1))})()}close(){this.connection&&this.connection.close(),this.connection=null,this.connectionClassPromise=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){this.connection&&this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n.peerId),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=(0,Mo.W)(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?n.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){n.length&&this.connection.send(n);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peer,i)),this.sendInterval=0<this.queue.size?(0,Mo.W)(this.sendCallback):null}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}listAllRooms(){return this.connection?this.connection.listAllRooms():Promise.resolve([])}initializeConnection(){let n=new this.connectionClass;return n.configure(this.config),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=(0,Mo.W)(this.sendCallback)),n}dynamicImport(n=""){return(0,E.A)(function*(){return"skyway2023"===n?(yield Promise.all([V.e(918),V.e(7299)]).then(V.bind(V,1652))).SkyWayConnection:(yield Promise.all([V.e(918),V.e(1528)]).then(V.bind(V,844))).SkyWayConnection})()}}class hu{constructor(n,e,i=Ds.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===Ds.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class Nb{get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new Nb(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class Bl{static get instance(){return Bl._instance||(Bl._instance=new Bl,Bl._instance.initializeNetworkEvent()),Bl._instance}constructor(){this.listenerMap=new Map,this.keyMap=new Map,console.log("EventSystem ready...")}register(n){return new Nb(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=[];if(null!=n)r=this.getListenersByKey(n);else if(null!=e)r=this.getListenersByEventName(e);else{let o=this.listenerMap.values();for(let s of o)r=r.concat(s)}for(let o of r.concat())o.isEqual(n,e,i)&&o.unregister()}registerListener(n){let e=this.getListenersByEventName(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),e=this.getListenersByKey(n.key),e.push(n),this.keyMap.set(n.key,e),n}unregisterListener(n){let e=this.getListenersByEventName(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),e.length<1&&this.listenerMap.delete(n.eventName),e=this.getListenersByKey(n.key),i=e.indexOf(n),0<=i&&e.splice(i,1),e.length<1&&this.keyMap.delete(n.key),n.unregister(),n)}call(...n){"string"==typeof n[0]?this._call(new hu(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();Ds.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof hu?n[0]:new hu(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new hu(n[0],n[1]))}_trigger(n){let e=this.getListenersByEventName(n.eventName).concat(this.getListenersByEventName("*"));for(let i of e)i.trigger(n);return n}getListenersByEventName(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}getListenersByKey(n){return this.keyMap.has(n)?this.keyMap.get(n):[]}initializeNetworkEvent(){let n=Ds.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e.peerId})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e.peerId})},n.onConnect=e=>{this.sendSystemMessage("<"+e.userId+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e.peerId})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e.userId+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e.peerId})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e.userId+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e.peerId,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(n){console.log(n)}}const Q=Bl.instance,Be=Ds.instance;function ZA(t){return typeof t>"u"||null===t}var Ni={isNothing:ZA,isObject:function M$(t){return"object"==typeof t&&null!==t},toArray:function I$(t){return Array.isArray(t)?t:ZA(t)?[]:[t]},repeat:function k$(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},isNegativeZero:function O$(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t},extend:function A$(t,n){var e,i,r,o;if(n)for(e=0,i=(o=Object.keys(n)).length;e<i;e+=1)t[r=o[e]]=n[r];return t}};function YA(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function Th(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=YA(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(Th.prototype=Object.create(Error.prototype)).constructor=Th,Th.prototype.toString=function(n){return this.name+": "+YA(this,n)};var kr=Th;function Fb(t,n,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+t.slice(n,e).replace(/\t/g,"\u2192")+s,pos:i-n+o.length}}function Rb(t,n){return Ni.repeat(" ",n-t.length)+t}var U$=function j$(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(t.buffer);)r.push(o.index),i.push(o.index+o[0].length),t.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var l,c,a="",u=Math.min(t.line+n.linesAfter,r.length).toString().length,d=n.maxLength-(n.indent+u+3);for(l=1;l<=n.linesBefore&&!(s-l<0);l++)c=Fb(t.buffer,i[s-l],r[s-l],t.position-(i[s]-i[s-l]),d),a=Ni.repeat(" ",n.indent)+Rb((t.line-l+1).toString(),u)+" | "+c.str+"\n"+a;for(c=Fb(t.buffer,i[s],r[s],t.position,d),a+=Ni.repeat(" ",n.indent)+Rb((t.line+1).toString(),u)+" | "+c.str+"\n",a+=Ni.repeat("-",n.indent+u+3+c.pos)+"^\n",l=1;l<=n.linesAfter&&!(s+l>=r.length);l++)c=Fb(t.buffer,i[s+l],r[s+l],t.position-(i[s]-i[s+l]),d),a+=Ni.repeat(" ",n.indent)+Rb((t.line+l+1).toString(),u)+" | "+c.str+"\n";return a.replace(/\n$/,"")},V$=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],H$=["scalar","sequence","mapping"],Ki=function G$(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===V$.indexOf(e))throw new kr('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function z$(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===H$.indexOf(this.kind))throw new kr('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function XA(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function Lb(t){return this.extend(t)}Lb.prototype.extend=function(n){var e=[],i=[];if(n instanceof Ki)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new kr("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(o){if(!(o instanceof Ki))throw new kr("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new kr("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new kr("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof Ki))throw new kr("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(Lb.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=XA(r,"implicit"),r.compiledExplicit=XA(r,"explicit"),r.compiledTypeMap=function $$(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var KA=Lb,QA=new Ki("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),JA=new Ki("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),ek=new Ki("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),tk=new KA({explicit:[QA,JA,ek]}),nk=new Ki("tag:yaml.org,2002:null",{kind:"scalar",resolve:function W$(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function q$(){return null},predicate:function Z$(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),ik=new Ki("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function Y$(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function X$(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function K$(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function Q$(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function J$(t){return 48<=t&&t<=55}function eW(t){return 48<=t&&t<=57}var rk=new Ki("tag:yaml.org,2002:int",{kind:"scalar",resolve:function tW(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!Q$(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!J$(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!eW(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function nW(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function iW(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!Ni.isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),rW=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),aW=/^[-+]?[0-9]+e/,ok=new Ki("tag:yaml.org,2002:float",{kind:"scalar",resolve:function oW(t){return!(null===t||!rW.test(t)||"_"===t[t.length-1])},construct:function sW(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function cW(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||Ni.isNegativeZero(t))},represent:function lW(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Ni.isNegativeZero(t))return"-0.0";return e=t.toString(10),aW.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),sk=tk.extend({implicit:[nk,ik,rk,ok]}),ak=sk,lk=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),ck=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),uk=new Ki("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function uW(t){return null!==t&&(null!==lk.exec(t)||null!==ck.exec(t))},construct:function dW(t){var n,e,i,r,o,s,a,h,l=0,c=null;if(null===(n=lk.exec(t))&&(n=ck.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(o=+n[4],s=+n[5],a=+n[6],n[7]){for(l=n[7].slice(0,3);l.length<3;)l+="0";l=+l}return n[9]&&(c=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(c=-c)),h=new Date(Date.UTC(e,i,r,o,s,a,l)),c&&h.setTime(h.getTime()-c),h},instanceOf:Date,represent:function hW(t){return t.toISOString()}}),dk=new Ki("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function fW(t){return"<<"===t||null===t}}),Bb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",hk=new Ki("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function pW(t){if(null===t)return!1;var n,e,i=0,r=t.length,o=Bb;for(e=0;e<r;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function mW(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,o=Bb,s=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function _W(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function gW(t){var i,r,n="",e=0,o=t.length,s=Bb;for(i=0;i<o;i++)i%3==0&&i&&(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]),e=(e<<8)+t[i];return 0==(r=o%3)?(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]):2===r?(n+=s[e>>10&63],n+=s[e>>4&63],n+=s[e<<2&63],n+=s[64]):1===r&&(n+=s[e>>2&63],n+=s[e<<4&63],n+=s[64],n+=s[64]),n}}),vW=Object.prototype.hasOwnProperty,yW=Object.prototype.toString,fk=new Ki("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function bW(t){if(null===t)return!0;var e,i,r,o,s,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==yW.call(r=a[e]))return!1;for(o in r)if(vW.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==n.indexOf(o))return!1;n.push(o)}return!0},construct:function CW(t){return null!==t?t:[]}}),wW=Object.prototype.toString,pk=new Ki("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function EW(t){if(null===t)return!0;var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1){if("[object Object]"!==wW.call(i=s[n])||1!==(r=Object.keys(i)).length)return!1;o[n]=[r[0],i[r[0]]]}return!0},construct:function xW(t){if(null===t)return[];var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1)i=s[n],r=Object.keys(i),o[n]=[r[0],i[r[0]]];return o}}),TW=Object.prototype.hasOwnProperty,mk=new Ki("tag:yaml.org,2002:set",{kind:"mapping",resolve:function DW(t){if(null===t)return!0;var n,e=t;for(n in e)if(TW.call(e,n)&&null!==e[n])return!1;return!0},construct:function SW(t){return null!==t?t:{}}}),jb=ak.extend({implicit:[uk,dk],explicit:[hk,fk,pk,mk]}),Va=Object.prototype.hasOwnProperty,Bm=1,gk=2,_k=3,jm=4,Ub=1,MW=2,vk=3,IW=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,AW=/[\x85\u2028\u2029]/,kW=/[,\[\]\{\}]/,yk=/^(?:!|!!|![a-z\-]+!)$/i,bk=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Ck(t){return Object.prototype.toString.call(t)}function Ss(t){return 10===t||13===t}function jl(t){return 9===t||32===t}function $r(t){return 9===t||32===t||10===t||13===t}function fu(t){return 44===t||91===t||93===t||123===t||125===t}function OW(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function PW(t){return 120===t?2:117===t?4:85===t?8:0}function NW(t){return 48<=t&&t<=57?t-48:-1}function wk(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function FW(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var Ek=new Array(256),xk=new Array(256),pu=0;pu<256;pu++)Ek[pu]=wk(pu)?1:0,xk[pu]=wk(pu);function RW(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||jb,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Tk(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=U$(e),new kr(n,e)}function ot(t,n){throw Tk(t,n)}function Um(t,n){t.onWarning&&t.onWarning.call(null,Tk(t,n))}var Dk={YAML:function(n,e,i){var r,o,s;null!==n.version&&ot(n,"duplication of %YAML directive"),1!==i.length&&ot(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&ot(n,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&ot(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=s<2,1!==s&&2!==s&&Um(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,o;2!==i.length&&ot(n,"TAG directive accepts exactly two arguments"),o=i[1],yk.test(r=i[0])||ot(n,"ill-formed tag handle (first argument) of the TAG directive"),Va.call(n.tagMap,r)&&ot(n,'there is a previously declared suffix for "'+r+'" tag handle'),bk.test(o)||ot(n,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{ot(n,"tag prefix is malformed: "+o)}n.tagMap[r]=o}};function Ha(t,n,e,i){var r,o,s,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||ot(t,"expected valid JSON character");else IW.test(a)&&ot(t,"the stream contains non-printable characters");t.result+=a}}function Sk(t,n,e,i){var r,o,s,a;for(Ni.isObject(e)||ot(t,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)Va.call(n,o=r[s])||(n[o]=e[o],i[o]=!0)}function mu(t,n,e,i,r,o,s,a,l){var c,u;if(Array.isArray(r))for(c=0,u=(r=Array.prototype.slice.call(r)).length;c<u;c+=1)Array.isArray(r[c])&&ot(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===Ck(r[c])&&(r[c]="[object Object]");if("object"==typeof r&&"[object Object]"===Ck(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)Sk(t,n,o[c],e);else Sk(t,n,o,e);else!t.json&&!Va.call(e,r)&&Va.call(n,r)&&(t.line=s||t.line,t.lineStart=a||t.lineStart,t.position=l||t.position,ot(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):n[r]=o,delete e[r];return n}function Vb(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):ot(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function bi(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;jl(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!Ss(r))break;for(Vb(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&Um(t,"deficient indentation"),i}function Vm(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!$r(e)))}function Hb(t,n){1===n?t.result+=" ":n>1&&(t.result+=Ni.repeat("\n",n-1))}function Mk(t,n){var e,l,i=t.tag,r=t.anchor,o=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=o),l=t.input.charCodeAt(t.position);0!==l&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,ot(t,"tab characters must not be used in indentation")),45===l&&$r(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,bi(t,!0,-1)&&t.lineIndent<=n)o.push(null),l=t.input.charCodeAt(t.position);else if(e=t.line,gu(t,n,_k,!1,!0),o.push(t.result),bi(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==l)ot(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=o,!0)}function zW(t){var n,r,o,s,e=!1,i=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&ot(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(e=!0,s=t.input.charCodeAt(++t.position)):33===s?(i=!0,r="!!",s=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(o=t.input.slice(n,t.position),s=t.input.charCodeAt(++t.position)):ot(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!$r(s);)33===s&&(i?ot(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),yk.test(r)||ot(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),s=t.input.charCodeAt(++t.position);o=t.input.slice(n,t.position),kW.test(o)&&ot(t,"tag suffix cannot contain flow indicator characters")}o&&!bk.test(o)&&ot(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{ot(t,"tag name is malformed: "+o)}return e?t.tag=o:Va.call(t.tagMap,r)?t.tag=t.tagMap[r]+o:"!"===r?t.tag="!"+o:"!!"===r?t.tag="tag:yaml.org,2002:"+o:ot(t,'undeclared tag handle "'+r+'"'),!0}function GW(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&ot(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!$r(e)&&!fu(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&ot(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function gu(t,n,e,i,r){var o,s,a,d,h,f,m,p,g,l=1,c=!1,u=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=s=a=jm===e||_k===e,i&&bi(t,!0,-1)&&(c=!0,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)),1===l)for(;zW(t)||GW(t);)bi(t,!0,-1)?(c=!0,a=o,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)):a=!1;if(a&&(a=c||r),(1===l||jm===e)&&(p=Bm===e||gk===e?n:n+1,g=t.position-t.lineStart,1===l?a&&(Mk(t,g)||function HW(t,n,e){var i,r,o,s,a,l,C,c=t.tag,u=t.anchor,d={},h=Object.create(null),f=null,m=null,p=null,g=!1,y=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=d),C=t.input.charCodeAt(t.position);0!==C;){if(!g&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,ot(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),o=t.line,63!==C&&58!==C||!$r(i)){if(s=t.line,a=t.lineStart,l=t.position,!gu(t,e,gk,!1,!0))break;if(t.line===o){for(C=t.input.charCodeAt(t.position);jl(C);)C=t.input.charCodeAt(++t.position);if(58===C)$r(C=t.input.charCodeAt(++t.position))||ot(t,"a whitespace character is expected after the key-value separator within a block mapping"),g&&(mu(t,d,h,f,m,null,s,a,l),f=m=p=null),y=!0,g=!1,r=!1,f=t.tag,m=t.result;else{if(!y)return t.tag=c,t.anchor=u,!0;ot(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return t.tag=c,t.anchor=u,!0;ot(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===C?(g&&(mu(t,d,h,f,m,null,s,a,l),f=m=p=null),y=!0,g=!0,r=!0):g?(g=!1,r=!0):ot(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,C=i;if((t.line===o||t.lineIndent>n)&&(g&&(s=t.line,a=t.lineStart,l=t.position),gu(t,n,jm,!0,r)&&(g?m=t.result:p=t.result),g||(mu(t,d,h,f,m,p,s,a,l),f=m=p=null),bi(t,!0,-1),C=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>n)&&0!==C)ot(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return g&&mu(t,d,h,f,m,null,s,a,l),y&&(t.tag=c,t.anchor=u,t.kind="mapping",t.result=d),y}(t,g,p))||function UW(t,n){var i,r,o,a,u,d,h,f,p,g,y,C,e=!0,s=t.tag,l=t.anchor,m=Object.create(null);if(91===(C=t.input.charCodeAt(t.position)))u=93,f=!1,a=[];else{if(123!==C)return!1;u=125,f=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),C=t.input.charCodeAt(++t.position);0!==C;){if(bi(t,!0,n),(C=t.input.charCodeAt(t.position))===u)return t.position++,t.tag=s,t.anchor=l,t.kind=f?"mapping":"sequence",t.result=a,!0;e?44===C&&ot(t,"expected the node content, but found ','"):ot(t,"missed comma between flow collection entries"),y=null,d=h=!1,63===C&&$r(t.input.charCodeAt(t.position+1))&&(d=h=!0,t.position++,bi(t,!0,n)),i=t.line,r=t.lineStart,o=t.position,gu(t,n,Bm,!1,!0),g=t.tag,p=t.result,bi(t,!0,n),C=t.input.charCodeAt(t.position),(h||t.line===i)&&58===C&&(d=!0,C=t.input.charCodeAt(++t.position),bi(t,!0,n),gu(t,n,Bm,!1,!0),y=t.result),f?mu(t,a,m,g,p,y,i,r,o):a.push(d?mu(t,null,m,g,p,y,i,r,o):p),bi(t,!0,n),44===(C=t.input.charCodeAt(t.position))?(e=!0,C=t.input.charCodeAt(++t.position)):e=!1}ot(t,"unexpected end of the stream within a flow collection")}(t,p)?u=!0:(s&&function VW(t,n){var e,i,u,d,r=Ub,o=!1,s=!1,a=n,l=0,c=!1;if(124===(d=t.input.charCodeAt(t.position)))i=!1;else{if(62!==d)return!1;i=!0}for(t.kind="scalar",t.result="";0!==d;)if(43===(d=t.input.charCodeAt(++t.position))||45===d)Ub===r?r=43===d?vk:MW:ot(t,"repeat of a chomping mode identifier");else{if(!((u=NW(d))>=0))break;0===u?ot(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?ot(t,"repeat of an indentation width identifier"):(a=n+u-1,s=!0)}if(jl(d)){do{d=t.input.charCodeAt(++t.position)}while(jl(d));if(35===d)do{d=t.input.charCodeAt(++t.position)}while(!Ss(d)&&0!==d)}for(;0!==d;){for(Vb(t),t.lineIndent=0,d=t.input.charCodeAt(t.position);(!s||t.lineIndent<a)&&32===d;)t.lineIndent++,d=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>a&&(a=t.lineIndent),Ss(d))l++;else{if(t.lineIndent<a){r===vk?t.result+=Ni.repeat("\n",o?1+l:l):r===Ub&&o&&(t.result+="\n");break}for(i?jl(d)?(c=!0,t.result+=Ni.repeat("\n",o?1+l:l)):c?(c=!1,t.result+=Ni.repeat("\n",l+1)):0===l?o&&(t.result+=" "):t.result+=Ni.repeat("\n",l):t.result+=Ni.repeat("\n",o?1+l:l),o=!0,s=!0,l=0,e=t.position;!Ss(d)&&0!==d;)d=t.input.charCodeAt(++t.position);Ha(t,e,t.position,!1)}}return!0}(t,p)||function BW(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(Ha(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else Ss(e)?(Ha(t,i,r,!0),Hb(t,bi(t,!1,n)),i=r=t.position):t.position===t.lineStart&&Vm(t)?ot(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);ot(t,"unexpected end of the stream within a single quoted scalar")}(t,p)||function jW(t,n){var e,i,r,o,s,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return Ha(t,e,t.position,!0),t.position++,!0;if(92===a){if(Ha(t,e,t.position,!0),Ss(a=t.input.charCodeAt(++t.position)))bi(t,!1,n);else if(a<256&&Ek[a])t.result+=xk[a],t.position++;else if((s=PW(a))>0){for(r=s,o=0;r>0;r--)(s=OW(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+s:ot(t,"expected hexadecimal character");t.result+=FW(o),t.position++}else ot(t,"unknown escape sequence");e=i=t.position}else Ss(a)?(Ha(t,e,i,!0),Hb(t,bi(t,!1,n)),e=i=t.position):t.position===t.lineStart&&Vm(t)?ot(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}ot(t,"unexpected end of the stream within a double quoted scalar")}(t,p)?u=!0:function $W(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!$r(i)&&!fu(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&ot(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),Va.call(t.anchorMap,e)||ot(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],bi(t,!0,-1),!0}(t)?(u=!0,(null!==t.tag||null!==t.anchor)&&ot(t,"alias node should not have any properties")):function LW(t,n,e){var r,o,s,a,l,c,u,f,d=t.kind,h=t.result;if($r(f=t.input.charCodeAt(t.position))||fu(f)||35===f||38===f||42===f||33===f||124===f||62===f||39===f||34===f||37===f||64===f||96===f||(63===f||45===f)&&($r(r=t.input.charCodeAt(t.position+1))||e&&fu(r)))return!1;for(t.kind="scalar",t.result="",o=s=t.position,a=!1;0!==f;){if(58===f){if($r(r=t.input.charCodeAt(t.position+1))||e&&fu(r))break}else if(35===f){if($r(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&Vm(t)||e&&fu(f))break;if(Ss(f)){if(l=t.line,c=t.lineStart,u=t.lineIndent,bi(t,!1,-1),t.lineIndent>=n){a=!0,f=t.input.charCodeAt(t.position);continue}t.position=s,t.line=l,t.lineStart=c,t.lineIndent=u;break}}a&&(Ha(t,o,s,!1),Hb(t,t.line-l),o=s=t.position,a=!1),jl(f)||(s=t.position+1),f=t.input.charCodeAt(++t.position)}return Ha(t,o,s,!1),!!t.result||(t.kind=d,t.result=h,!1)}(t,p,Bm===e)&&(u=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===l&&(u=a&&Mk(t,g))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&ot(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),d=0,h=t.implicitTypes.length;d<h;d+=1)if((m=t.implicitTypes[d]).resolve(t.result)){t.result=m.construct(t.result),t.tag=m.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(Va.call(t.typeMap[t.kind||"fallback"],t.tag))m=t.typeMap[t.kind||"fallback"][t.tag];else for(m=null,d=0,h=(f=t.typeMap.multi[t.kind||"fallback"]).length;d<h;d+=1)if(t.tag.slice(0,f[d].tag.length)===f[d].tag){m=f[d];break}m||ot(t,"unknown tag !<"+t.tag+">"),null!==t.result&&m.kind!==t.kind&&ot(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+m.kind+'", not "'+t.kind+'"'),m.resolve(t.result,t.tag)?(t.result=m.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):ot(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||u}function WW(t){var e,i,r,s,n=t.position,o=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(s=t.input.charCodeAt(t.position))&&(bi(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(o=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!$r(s);)s=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&ot(t,"directive name must not be less than one character in length");0!==s;){for(;jl(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!Ss(s));break}if(Ss(s))break;for(e=t.position;0!==s&&!$r(s);)s=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==s&&Vb(t),Va.call(Dk,i)?Dk[i](t,i,r):Um(t,'unknown document directive "'+i+'"')}bi(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,bi(t,!0,-1)):o&&ot(t,"directives end mark is expected"),gu(t,t.lineIndent-1,jm,!1,!0),bi(t,!0,-1),t.checkLineBreaks&&AW.test(t.input.slice(n,t.position))&&Um(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Vm(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,bi(t,!0,-1)):t.position<t.length-1&&ot(t,"end of the stream or a document separator is expected")}function Ik(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new RW(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,ot(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)WW(e);return e.documents}var Ak={loadAll:function qW(t,n,e){null!==n&&"object"==typeof n&&typeof e>"u"&&(e=n,n=null);var i=Ik(t,e);if("function"!=typeof n)return i;for(var r=0,o=i.length;r<o;r+=1)n(i[r])},load:function ZW(t,n){var e=Ik(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new kr("expected a single document in the stream, but found more")}}},kk=Object.prototype.toString,Ok=Object.prototype.hasOwnProperty,zb=65279,KW=9,Dh=10,QW=13,JW=32,eq=33,tq=34,Gb=35,nq=37,iq=38,rq=39,oq=42,Pk=44,sq=45,Hm=58,aq=61,lq=62,cq=63,uq=64,Nk=91,Fk=93,dq=96,Rk=123,hq=124,Lk=125,mr={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},fq=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],pq=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function gq(t){var n,e,i;if(n=t.toString(16).toUpperCase(),t<=255)e="x",i=2;else if(t<=65535)e="u",i=4;else{if(!(t<=4294967295))throw new kr("code point within a string may not be greater than 0xFFFFFFFF");e="U",i=8}return"\\"+e+Ni.repeat("0",i-n.length)+n}var Sh=2;function vq(t){this.schema=t.schema||jb,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=Ni.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=function mq(t,n){var e,i,r,o,s,a,l;if(null===n)return{};for(e={},r=0,o=(i=Object.keys(n)).length;r<o;r+=1)s=i[r],a=String(n[s]),"!!"===s.slice(0,2)&&(s="tag:yaml.org,2002:"+s.slice(2)),(l=t.compiledTypeMap.fallback[s])&&Ok.call(l.styleAliases,a)&&(a=l.styleAliases[a]),e[s]=a;return e}(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType='"'===t.quotingType?Sh:1,this.forceQuotes=t.forceQuotes||!1,this.replacer="function"==typeof t.replacer?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Bk(t,n){for(var s,e=Ni.repeat(" ",n),i=0,r=-1,o="",a=t.length;i<a;)-1===(r=t.indexOf("\n",i))?(s=t.slice(i),i=a):(s=t.slice(i,r+1),i=r+1),s.length&&"\n"!==s&&(o+=e),o+=s;return o}function $b(t,n){return"\n"+Ni.repeat(" ",t.indent*n)}function zm(t){return t===JW||t===KW}function Mh(t){return 32<=t&&t<=126||161<=t&&t<=55295&&8232!==t&&8233!==t||57344<=t&&t<=65533&&t!==zb||65536<=t&&t<=1114111}function jk(t){return Mh(t)&&t!==zb&&t!==QW&&t!==Dh}function Uk(t,n,e){var i=jk(t),r=i&&!zm(t);return(e?i:i&&t!==Pk&&t!==Nk&&t!==Fk&&t!==Rk&&t!==Lk)&&t!==Gb&&!(n===Hm&&!r)||jk(n)&&!zm(n)&&t===Gb||n===Hm&&r}function Ih(t,n){var i,e=t.charCodeAt(n);return e>=55296&&e<=56319&&n+1<t.length&&(i=t.charCodeAt(n+1))>=56320&&i<=57343?1024*(e-55296)+i-56320+65536:e}function Vk(t){return/^\n* /.test(t)}var Hk=1,Wb=2,zk=3,Gk=4,_u=5;function Eq(t,n,e,i,r){t.dump=function(){if(0===n.length)return t.quotingType===Sh?'""':"''";if(!t.noCompatMode&&(-1!==fq.indexOf(n)||pq.test(n)))return t.quotingType===Sh?'"'+n+'"':"'"+n+"'";var o=t.indent*Math.max(1,e),s=-1===t.lineWidth?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-o);switch(function wq(t,n,e,i,r,o,s,a){var l,c=0,u=null,d=!1,h=!1,f=-1!==i,m=-1,p=function bq(t){return Mh(t)&&t!==zb&&!zm(t)&&t!==sq&&t!==cq&&t!==Hm&&t!==Pk&&t!==Nk&&t!==Fk&&t!==Rk&&t!==Lk&&t!==Gb&&t!==iq&&t!==oq&&t!==eq&&t!==hq&&t!==aq&&t!==lq&&t!==rq&&t!==tq&&t!==nq&&t!==uq&&t!==dq}(Ih(t,0))&&function Cq(t){return!zm(t)&&t!==Hm}(Ih(t,t.length-1));if(n||s)for(l=0;l<t.length;c>=65536?l+=2:l++){if(!Mh(c=Ih(t,l)))return _u;p=p&&Uk(c,u,a),u=c}else{for(l=0;l<t.length;c>=65536?l+=2:l++){if((c=Ih(t,l))===Dh)d=!0,f&&(h=h||l-m-1>i&&" "!==t[m+1],m=l);else if(!Mh(c))return _u;p=p&&Uk(c,u,a),u=c}h=h||f&&l-m-1>i&&" "!==t[m+1]}return d||h?e>9&&Vk(t)?_u:s?o===Sh?_u:Wb:h?Gk:zk:!p||s||r(t)?o===Sh?_u:Wb:Hk}(n,i||t.flowLevel>-1&&e>=t.flowLevel,t.indent,s,function l(c){return function yq(t,n){var e,i;for(e=0,i=t.implicitTypes.length;e<i;e+=1)if(t.implicitTypes[e].resolve(n))return!0;return!1}(t,c)},t.quotingType,t.forceQuotes&&!i,r)){case Hk:return n;case Wb:return"'"+n.replace(/'/g,"''")+"'";case zk:return"|"+$k(n,t.indent)+Wk(Bk(n,o));case Gk:return">"+$k(n,t.indent)+Wk(Bk(function xq(t,n){for(var o,s,e=/(\n+)([^\n]*)/g,i=(c=void 0,c=t.indexOf("\n"),e.lastIndex=c=-1!==c?c:t.length,qk(t.slice(0,c),n)),r="\n"===t[0]||" "===t[0];s=e.exec(t);){var l=s[2];o=" "===l[0],i+=s[1]+(r||o||""===l?"":"\n")+qk(l,n),r=o}var c;return i}(n,s),o));case _u:return'"'+function Tq(t){for(var i,n="",e=0,r=0;r<t.length;e>=65536?r+=2:r++)e=Ih(t,r),!(i=mr[e])&&Mh(e)?(n+=t[r],e>=65536&&(n+=t[r+1])):n+=i||gq(e);return n}(n)+'"';default:throw new kr("impossible error: invalid scalar style")}}()}function $k(t,n){var e=Vk(t)?String(n):"",i="\n"===t[t.length-1];return e+(!i||"\n"!==t[t.length-2]&&"\n"!==t?i?"":"-":"+")+"\n"}function Wk(t){return"\n"===t[t.length-1]?t.slice(0,-1):t}function qk(t,n){if(""===t||" "===t[0])return t;for(var i,o,e=/ [^ ]/g,r=0,s=0,a=0,l="";i=e.exec(t);)(a=i.index)-r>n&&(l+="\n"+t.slice(r,o=s>r?s:a),r=o+1),s=a;return l+="\n",(l+=t.length-r>n&&s>r?t.slice(r,s)+"\n"+t.slice(s+1):t.slice(r)).slice(1)}function Yk(t,n,e){var i,r,o,s,a,l;for(o=0,s=(r=e?t.explicitTypes:t.implicitTypes).length;o<s;o+=1)if(((a=r[o]).instanceOf||a.predicate)&&(!a.instanceOf||"object"==typeof n&&n instanceof a.instanceOf)&&(!a.predicate||a.predicate(n))){if(t.tag=e?a.multi&&a.representName?a.representName(n):a.tag:"?",a.represent){if(l=t.styleMap[a.tag]||a.defaultStyle,"[object Function]"===kk.call(a.represent))i=a.represent(n,l);else{if(!Ok.call(a.represent,l))throw new kr("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');i=a.represent[l](n,l)}t.dump=i}return!0}return!1}function da(t,n,e,i,r,o,s){t.tag=null,t.dump=e,Yk(t,e,!1)||Yk(t,e,!0);var c,a=kk.call(t.dump),l=i;i&&(i=t.flowLevel<0||t.flowLevel>n);var d,h,u="[object Object]"===a||"[object Array]"===a;if(u&&(h=-1!==(d=t.duplicates.indexOf(e))),(null!==t.tag&&"?"!==t.tag||h||2!==t.indent&&n>0)&&(r=!1),h&&t.usedDuplicates[d])t.dump="*ref_"+d;else{if(u&&h&&!t.usedDuplicates[d]&&(t.usedDuplicates[d]=!0),"[object Object]"===a)i&&0!==Object.keys(t.dump).length?(function Mq(t,n,e,i){var a,l,c,u,d,h,r="",o=t.tag,s=Object.keys(e);if(!0===t.sortKeys)s.sort();else if("function"==typeof t.sortKeys)s.sort(t.sortKeys);else if(t.sortKeys)throw new kr("sortKeys must be a boolean or a function");for(a=0,l=s.length;a<l;a+=1)h="",(!i||""!==r)&&(h+=$b(t,n)),u=e[c=s[a]],t.replacer&&(u=t.replacer.call(e,c,u)),da(t,n+1,c,!0,!0,!0)&&((d=null!==t.tag&&"?"!==t.tag||t.dump&&t.dump.length>1024)&&(t.dump&&Dh===t.dump.charCodeAt(0)?h+="?":h+="? "),h+=t.dump,d&&(h+=$b(t,n)),da(t,n+1,u,!0,d)&&(t.dump&&Dh===t.dump.charCodeAt(0)?h+=":":h+=": ",r+=h+=t.dump));t.tag=o,t.dump=r||"{}"}(t,n,t.dump,r),h&&(t.dump="&ref_"+d+t.dump)):(function Sq(t,n,e){var s,a,l,c,u,i="",r=t.tag,o=Object.keys(e);for(s=0,a=o.length;s<a;s+=1)u="",""!==i&&(u+=", "),t.condenseFlow&&(u+='"'),c=e[l=o[s]],t.replacer&&(c=t.replacer.call(e,l,c)),da(t,n,l,!1,!1)&&(t.dump.length>1024&&(u+="? "),u+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),da(t,n,c,!1,!1)&&(i+=u+=t.dump));t.tag=r,t.dump="{"+i+"}"}(t,n,t.dump),h&&(t.dump="&ref_"+d+" "+t.dump));else if("[object Array]"===a)i&&0!==t.dump.length?(function Zk(t,n,e,i){var s,a,l,r="",o=t.tag;for(s=0,a=e.length;s<a;s+=1)l=e[s],t.replacer&&(l=t.replacer.call(e,String(s),l)),(da(t,n+1,l,!0,!0,!1,!0)||typeof l>"u"&&da(t,n+1,null,!0,!0,!1,!0))&&((!i||""!==r)&&(r+=$b(t,n)),t.dump&&Dh===t.dump.charCodeAt(0)?r+="-":r+="- ",r+=t.dump);t.tag=o,t.dump=r||"[]"}(t,t.noArrayIndent&&!s&&n>0?n-1:n,t.dump,r),h&&(t.dump="&ref_"+d+t.dump)):(function Dq(t,n,e){var o,s,a,i="",r=t.tag;for(o=0,s=e.length;o<s;o+=1)a=e[o],t.replacer&&(a=t.replacer.call(e,String(o),a)),(da(t,n,a,!1,!1)||typeof a>"u"&&da(t,n,null,!1,!1))&&(""!==i&&(i+=","+(t.condenseFlow?"":" ")),i+=t.dump);t.tag=r,t.dump="["+i+"]"}(t,n,t.dump),h&&(t.dump="&ref_"+d+" "+t.dump));else{if("[object String]"!==a){if("[object Undefined]"===a)return!1;if(t.skipInvalid)return!1;throw new kr("unacceptable kind of an object to dump "+a)}"?"!==t.tag&&Eq(t,t.dump,n,o,l)}null!==t.tag&&"?"!==t.tag&&(c=encodeURI("!"===t.tag[0]?t.tag.slice(1):t.tag).replace(/!/g,"%21"),c="!"===t.tag[0]?"!"+c:"tag:yaml.org,2002:"===c.slice(0,18)?"!!"+c.slice(18):"!<"+c+">",t.dump=c+" "+t.dump)}return!0}function Iq(t,n){var r,o,e=[],i=[];for(qb(t,e,i),r=0,o=i.length;r<o;r+=1)n.duplicates.push(e[i[r]]);n.usedDuplicates=new Array(o)}function qb(t,n,e){var i,r,o;if(null!==t&&"object"==typeof t)if(-1!==(r=n.indexOf(t)))-1===e.indexOf(r)&&e.push(r);else if(n.push(t),Array.isArray(t))for(r=0,o=t.length;r<o;r+=1)qb(t[r],n,e);else for(r=0,o=(i=Object.keys(t)).length;r<o;r+=1)qb(t[i[r]],n,e)}function Zb(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}const Zq={Type:Ki,Schema:KA,FAILSAFE_SCHEMA:tk,JSON_SCHEMA:sk,CORE_SCHEMA:ak,DEFAULT_SCHEMA:jb,load:Ak.load,loadAll:Ak.loadAll,dump:function Aq(t,n){var e=new vq(n=n||{});e.noRefs||Iq(t,e);var i=t;return e.replacer&&(i=e.replacer.call({"":i},"",i)),da(e,0,i,!0,!0)?e.dump+"\n":""},YAMLException:kr,types:{binary:hk,float:ok,map:ek,null:nk,pairs:pk,set:mk,timestamp:uk,bool:ik,int:rk,merge:dk,omap:fk,seq:JA,str:QA},safeLoad:Zb("safeLoad","load"),safeLoadAll:Zb("safeLoadAll","loadAll"),safeDump:Zb("safeDump","dump")},Xk=Object.getOwnPropertyNames(Object.prototype),Yq=Object.getOwnPropertyNames(Array.prototype);let Gm=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}static#e=this.appConfig={backend:{mode:"",ur:""},webrtc:{key:""},app:{title:""}};initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,E.A)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=Zq.load(i);t.applyConfig(r)}catch(i){console.warn(i)}Q.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,E.A)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?Xk.concat(Yq):Xk).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),t.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();var Yb,ha=V(9757);(Yb||(Yb={})).resize=function n(e,i,r,o){let s=e.width,a=e.height,l=s/(i=Math.round(i)),c=a/(r=Math.round(r)),u=Math.ceil(l/2),d=Math.ceil(c/2),h=e.getContext("2d"),f=h.getImageData(0,0,s,a),m=h.createImageData(i,r),p=f.data,g=m.data;for(let y=0;y<r;y++)for(let C=0;C<i;C++){let N=4*(C+y*i),$=0,H=0,z=0,X=0,ee=0,he=0,ae=0,se=(y+.5)*c,we=Math.floor(y*c),Ce=Math.ceil((y+1)*c);for(let Ie=we;Ie<Ce;Ie++){let Re=Math.abs(se-(Ie+.5))/d,te=(C+.5)*l,_e=Re*Re,ve=Math.floor(C*l),Ye=Math.ceil((C+1)*l);for(let Oe=ve;Oe<Ye;Oe++){let jt=Math.abs(te-(Oe+.5))/u,Ge=Math.sqrt(_e+jt*jt);if(Ge>=1)continue;$=2*Ge*Ge*Ge-3*Ge*Ge+1;let mt=4*(Oe+Ie*s);ae+=$*p[mt+3],z+=$,p[mt+3]<255&&($=$*p[mt+3]/250),X+=$*p[mt],ee+=$*p[mt+1],he+=$*p[mt+2],H+=$}}g[N]=X/H,g[N+1]=ee/H,g[N+2]=he/H,g[N+3]=ae/z}!0===o?(e.width=i,e.height=r):h.clearRect(0,0,s,a),h.putImageData(m,0,0)};var Qo,Kk=V(4232);!function(t){function r(){return(r=(0,E.A)(function*(o){return o instanceof Blob?Kk.M.sha256Hex(yield t.readAsArrayBufferAsync(o)):Kk.M.sha256Hex(o)})).apply(this,arguments)}t.readAsArrayBufferAsync=function n(o){return new Promise((s,a)=>{let l=new FileReader;l.onload=c=>{s(l.result)},l.onabort=l.onerror=c=>{a(c)},l.readAsArrayBuffer(o)})},t.readAsTextAsync=function e(o){return new Promise((s,a)=>{let l=new FileReader;l.onload=c=>{s(l.result)},l.onabort=l.onerror=c=>{a(c)},l.readAsText(o)})},t.calcSHA256Async=function i(o){return r.apply(this,arguments)}}(Qo||(Qo={}));var Or=function(t){return t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL",t}(Or||{});class pn{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Or.URL:this.blob===this.thumbnail.blob?Or.THUMBNAIL:Or.COMPLETE:Or.NULL}get isEmpty(){return this.state<=Or.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}static createEmpty(n){let e=new pn;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new pn;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new pn;return e.apply(n),e}}static createAsync(n){return(0,E.A)(function*(){return n instanceof File?yield pn._createAsync(n,n.name):n instanceof Blob?yield pn._createAsync(n):void 0})()}static _createAsync(n,e){return(0,E.A)(function*(){let i=yield Qo.readAsArrayBufferAsync(n),r=new pn;r.context.identifier=yield Qo.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield pn.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Or.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Or.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,l=r.height*s,c=document.createElement("canvas"),u=c.getContext("2d");c.width=r.width,c.height=r.height,u.drawImage(r,0,0),Yb.resize(c,a,l,!0),c.toBlob(d=>{let h={type:d.type,blob:d,url:window.URL.createObjectURL(d)};e(h)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}static#e=this.Empty=pn.createEmpty("null")}class Dt{static get instance(){return Dt._instance||(Dt._instance=new Dt),Dt._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}constructor(){this.imageHash={},console.log("ImageStorage ready...")}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,E.A)(function*(){let i=yield pn.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=pn.create(n);else if(n instanceof pn)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=pn.create(n)}return this._add(e)}_add(n){return Or.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof pn?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),Q.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new ha.b(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)Or.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}class Ms{static get instance(){return Ms._instance||(Ms._instance=new Ms),Ms._instance}constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}register(n,e){e||(e=n.name??n.toString().match(/function\s*([^(]*)\(/)?.[1]??""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306e\uff27ameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){return this.aliasMap.get(n)??""}}const Qk=Symbol("synchronize-variables"),Jk=Symbol("synchronize-attributes");function eO(t){return n=>{const e=class extends n{constructor(...r){super(...r),this.constructor===e&&function Kq(t){nO(t,Qk,n=>function(){return this.context.syncData[n]},n=>function(i){this.context.syncData[n]=i,this.update()}),nO(t,Jk,n=>function(){return this.context.syncData.attributes[n]},n=>function(i){this.context.syncData.attributes[n]=i,this.update()})}(this)}};return Ms.instance.register(e,t),e}}function vu(){return(t,n)=>{tO(t,Qk,n)}}function tO(t,n,e){t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!1,configurable:!0,writable:!0,value:new Set}),t[n].add(e)}function nO(t,n,e,i){const r=new Set;let o=t;for(;o;){const s=o[n];if(null!=s&&o.hasOwnProperty(n))for(const a of s){if(r.has(a))continue;r.add(a);const l=t[a];Object.defineProperty(t,a,{get:e(a),set:i(a),enumerable:!0,configurable:!0}),void 0!==l&&(t[a]=l)}o=Object.getPrototypeOf(o)}}var fa;!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function u(h){return e[h]}function d(h){return r[h]}t.xml2element=function s(h){let f=new DOMParser,m=null;try{h=function c(h){return h.replace(o,"").trim()}(h),m=f.parseFromString(h,"application/xml"),m.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",m.documentElement),m=null)}catch(p){console.error(p)}return m?m.documentElement:null},t.encodeEntityReference=function a(h){return h.replace(n,u)},t.decodeEntityReference=function l(h){return h.replace(i,d)}}(fa||(fa={}));var iO=V(1185);const Qq=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class Un{static get instance(){return Un._instance||(Un._instance=new Un),Un._instance}constructor(){console.log("ObjectSerializer ready...")}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():Un.toAttributes(n.toContext().syncData),r=n.aliasName,o="";for(let s in i)void 0!==i[s]&&(o+=" "+s+'="'+fa.encodeEntityReference(i[s]+"")+'"');return e+=`<${r+o}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let s=Un.make2Attributes(n[i],i);for(let a in s)void 0!==s[a]&&(e[a]=s[a])}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=Un.array2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else if("object"==typeof n){let r=Un.object2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else void 0!==n&&(i[e]=n);return i}static object2attributes(n,e){let i={};for(let r in n){let a=Un.make2Attributes(n[r],e+"."+r);for(let l in a)void 0!==a[l]&&(i[l]=a[l])}return i}static array2attributes(n,e){let i={},r=n.length;for(let o=0;o<r;o++){let l=Un.make2Attributes(n[o],e+"."+o);for(let c in l)void 0!==l[c]&&(i[c]=l[c])}return i}parseXml(n){let e=null;if(e="string"==typeof n?fa.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=Ms.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();Un.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=fa.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],l=n,c=s.find(d=>Qq.includes(d));null==c?1<s.length&&(({obj:l,key:a}=Un.attributes2object(s,l,a)),null==a)||("string"!=typeof l[a]&&null!=l[a]&&(o=JSON.parse(o)),l[a]=o):console.log(`skip invalid key (${c})`)}return n}static attributes2object(n,e,i){let r=null,o=n.length;for(let s=0;s<o;s++){let a=parseInt(n[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class De{static get instance(){return De._instance||(De._instance=new De),De._instance}constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&Q.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}Q.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=(0,Mo.W)(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;o.value[1]+n<e||this.garbageMap.delete(o.value[0])}}}class za{static get aliasName(){return Ms.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}constructor(n=iO.k.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}initialize(){De.instance.add(this)}destroy(){De.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),De.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){let n=this.toXml();return Un.instance.parseXml(n)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:rO(this.context.syncData)}}toXml(){return Un.instance.toXml(this)}}function rO(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=rO(t[i]):"function"!==r&&(n[i]=t[i])}return n}const Xb=new Map,$m=new Set;let Kb=!1;function oO(t,n=Be.peerId){Xb.set(t.identifier,{object:t,originFrom:n}),t instanceof Qi&&Qb(t.parent),sO()}function Qb(t){let n=t;for(;n&&!$m.has(n.identifier);)$m.add(n.identifier),n=n.parent;sO()}function sO(){Kb||(queueMicrotask(Jq),Kb=!0)}const Jq=()=>{Kb=!1;let t=Array.from(Xb.values()),n=Array.from($m.values());Xb.clear(),$m.clear();for(let e of t){let i={aliasName:e.object.aliasName,identifier:e.object.identifier};Q.trigger(new hu(`UPDATE_GAME_OBJECT/aliasName/${i.aliasName}`,i,e.originFrom)),Q.trigger(new hu(`UPDATE_GAME_OBJECT/identifier/${i.identifier}`,i,e.originFrom))}for(let e of n)Q.trigger(`UPDATE_OBJECT_CHILDREN/identifier/${e}`,{identifier:e})};var Jb;const Ul={};let Qi=Jb=class extends za{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!1}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return De.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==De.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&De.instance.isDeleted(this.parentIdentifier)}get children(){return this.sortChildren().concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){Qb(this);let e=new Set,i=this;for(;i&&!e.has(i.identifier);)e.add(i.identifier),i.onChildAdded(n),i=i.parent}_onChildRemoved(n){Qb(this);let e=new Set,i=this;for(;i&&!e.has(i.identifier);)e.add(i.identifier),i.onChildRemoved(n),i=i.parent}initializeChildren(){if(null==Ul[this.identifier])return;let n=Ul[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);Ul[this.identifier]&&delete Ul[this.identifier]}sortChildren(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parentIdentifier===this.identifier;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.sortChildren();for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;let e=n.parentIdentifier!==this.identifier;n.parent&&e&&n.parent.removeChild(n);let i=this.sortChildren(),r=0<i.length?i[i.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=r,n.minorIndex=Math.random(),e&&(i.push(n),this._onChildAdded(n)),n}prependChild(n){return this._children.length<1?this.appendChild(n):this.insertBefore(n,this.sortChildren()[0])}insertBefore(n,e){if(n.contains(this))return null;let i=n.parentIdentifier!==this.identifier;if(n===e&&!i)return n;n.parent&&i&&n.parent.removeChild(n);let r=this.sortChildren(),o=r.indexOf(e);if(o<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let s=0<o?r[o-1].index:0,a=e.index-s,l=s+a*(.45+.1*Math.random());return n.majorIndex=0|l,n.minorIndex=l-n.majorIndex,i?(r.splice(o,0,n),this._onChildAdded(n)):this.needsSort=!0,a<1e-7&&this.updateIndexs(),n}removeChild(n){let e=this._children.indexOf(n);return e<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this._children.splice(e,1),this._onChildRemoved(n),n)}contains(n){let e=new Set,i=n.parent;for(;i;){if(e.has(i.identifier))return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(i===this)return!0;e.add(i.identifier),i=i.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return null==this.attributes[n]?"":this.attributes[n]}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return Un.toAttributes(this.attributes)}parseAttributes(n){Un.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=fa.encodeEntityReference(this.value+"");for(let e of this.children)n+=Un.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=Un.instance.parseXml(e[r]);o instanceof Jb&&this.appendChild(o)}else this.value=fa.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in Ul||(Ul[this.parentIdentifier]=[]),Ul[this.parentIdentifier].push(this))}};function di(t){return n=>eO(t)(n)}function st(){return(t,n)=>{t instanceof Qi?function Xq(){return(t,n)=>{tO(t,Jk,n)}}()(t,n):vu()(t,n)}}Ne([vu()],Qi.prototype,"value",void 0),Ne([vu()],Qi.prototype,"attributes",void 0),Ne([vu()],Qi.prototype,"parentIdentifier",void 0),Ne([vu()],Qi.prototype,"majorIndex",void 0),Ne([vu()],Qi.prototype,"minorIndex",void 0),Qi=Jb=Ne([eO("node")],Qi);let Wr=class extends Qi{constructor(){super(...arguments),this._sendTo=[],this._tags=[]}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return Dt.instance.get(this.imageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length}get isSendFromSelf(){return this.from===Be.peer.userId||this.originFrom===Be.peer.userId}get isRelatedToMe(){return!!(-1<this.sendTo.indexOf(Be.peer.userId)||this.isSendFromSelf)}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return!(!this.isSystem||"System-BCDice"!==this.from)}get isSecret(){return-1<this.tags.indexOf("secret")}};Ne([st()],Wr.prototype,"originFrom",void 0),Ne([st()],Wr.prototype,"from",void 0),Ne([st()],Wr.prototype,"to",void 0),Ne([st()],Wr.prototype,"name",void 0),Ne([st()],Wr.prototype,"tag",void 0),Ne([st()],Wr.prototype,"dicebot",void 0),Ne([st()],Wr.prototype,"imageIdentifier",void 0),Wr=Ne([di("chat")],Wr);let yu=class extends Qi{constructor(){super(...arguments),this.name="\u30bf\u30d6",this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof Wr&&n.isDisplayable&&(this._unreadLength++,Q.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new Wr;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),Q.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof Wr&&!e.isDisplayable||(n+=Un.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}};var Io;Ne([st()],yu.prototype,"name",void 0),yu=Ne([di("chat-tab")],yu);let Is=class extends Qi{static#e=Io=this;static get instance(){return Io._instance||(Io._instance=new Io("ChatTabList"),Io._instance.initialize()),Io._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof yu)e=n[0];else{let i=n[0];e=new yu(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Io.instance.children)i.destroy();let e=Io.instance.toContext();e.syncData=this.toContext().syncData,Io.instance.apply(e),Io.instance.update(),super.parseInnerXml.apply(Io.instance,[n]),this.destroy()}};Is=Io=Ne([di("chat-tab-list")],Is);var ma,pa=function(t){return t[t.None=0]="None",t[t.IgnoreCase=1]="IgnoreCase",t[t.IgnoreWidth=2]="IgnoreWidth",t}(pa||{});!function(t){function n(r){return r.replace(/[\uff01-\uff5e]/g,o=>String.fromCharCode(o.charCodeAt(0)-65248))}function i(r,o){if(o===pa.None)return r;let s=r;return o&pa.IgnoreCase&&(s=s.toLocaleLowerCase()),o&pa.IgnoreWidth&&(s=n(s)),s}t.toHalfWidth=n,t.equals=function e(r,o,s=pa.None){return r.length===o.length&&(r===o||i(r,s)===i(o,s))},t.normalize=i}(ma||(ma={}));let Ah=class extends Qi{constructor(){super(...arguments),this.dicebot="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e){let i="";i="string"==typeof n?n:n.palette,console.log(i);let o=0,s=!0;for(;s;)o++,s=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(a,l)=>{l=ma.toHalfWidth(l),console.log(l),s=!0;for(let c of this.paletteVariables)if(c.name==l)return c.value;if(e){let c=e.getFirstElementByName(l,pa.IgnoreWidth);if(c)return c.isNumberResource?c.currentValue+"":c.value+""}return""}),128<o&&(s=!1);return i}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(n);return e?{name:ma.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var Vl;Ne([st()],Ah.prototype,"dicebot",void 0),Ah=Ne([di("chat-palette")],Ah);let tt=Vl=class extends Qi{get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isNote(){return null!=this.type&&"note"===this.type}static create(n,e="",i={},r=""){let o;return o=r&&0<r.length?new Vl(r):new Vl,o.attributes=i,o.name=n,o.value=e,o.initialize(),o}getElementsByName(n,e=pa.None){let i=[];for(let r of this.children)r instanceof Vl&&(ma.equals(r.getAttribute("name"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByName(n,e)));return i}getElementsByType(n,e=pa.None){let i=[];for(let r of this.children)r instanceof Vl&&(ma.equals(r.getAttribute("type"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByType(n,e)));return i}getFirstElementByName(n,e=pa.None){for(let i of this.children)if(i instanceof Vl){if(ma.equals(i.getAttribute("name"),n,e))return i;let r=i.getFirstElementByName(n,e);if(r)return r}return null}};var mn,t;Ne([st()],tt.prototype,"name",void 0),Ne([st()],tt.prototype,"type",void 0),Ne([st()],tt.prototype,"currentValue",void 0),tt=Vl=Ne([di("data")],tt),(t=mn||(mn={})).sqrMagnitude=function n(s,a={x:0,y:0,z:0}){return(s.x-a.x)**2+(s.y-a.y)**2+((s.z??0)-(a.z??0))**2},t.clampMin=function e(s,a=0){return s<a?a:s},t.clampMax=function i(s,a=100){return s<a?s:a},t.radians=function r(s){return s*Math.PI/180},t.degrees=function o(s){return 180*s/Math.PI};let qr=class extends Qi{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=pn.Empty,this._dataElements={}}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageDataElement.getFirstElementByName("imageIdentifier");if(n&&this._imageFile.identifier!==n.value){let e=Dt.instance.get(n.value);this._imageFile=e||pn.Empty}return this._imageFile}calcSqrDistance(n){return mn.sqrMagnitude({x:this.location.x,y:this.location.y,z:this.posZ},{x:n.location.x,y:n.location.y,z:n.posZ})}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=tt.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(tt.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(tt.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(tt.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(tt.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?De.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);i&&(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?Dt.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;i&&(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};var e1;Ne([st()],qr.prototype,"location",void 0),Ne([st()],qr.prototype,"posZ",void 0),qr=Ne([di("TabletopObject")],qr);let Vn=e1=class extends qr{constructor(){super(...arguments),this.rotate=0,this.roll=0}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",1)}get chatPalette(){for(let n of this.children)if(n instanceof Ah)return n;return null}static create(n,e,i){let r=new e1;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}createTestGameDataElement(n,e,i){this.createDataElements();let r=tt.create("name",n,{},"name_"+this.identifier),o=tt.create("size",e,{},"size_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let s=tt.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),a=tt.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),l=tt.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.detailDataElement.appendChild(s),s.appendChild(a),s.appendChild(l);let c=tt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(c),c.appendChild(tt.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),c.appendChild(tt.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),c=tt.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(tt.create("\u5668\u7528\u5ea6",24,{},"\u5668\u7528\u5ea6"+this.identifier)),c.appendChild(tt.create("\u654f\u6377\u5ea6",24,{},"\u654f\u6377\u5ea6"+this.identifier)),c.appendChild(tt.create("\u7b4b\u529b",24,{},"\u7b4b\u529b"+this.identifier)),c.appendChild(tt.create("\u751f\u547d\u529b",24,{},"\u751f\u547d\u529b"+this.identifier)),c.appendChild(tt.create("\u77e5\u529b",24,{},"\u77e5\u529b"+this.identifier)),c.appendChild(tt.create("\u7cbe\u795e\u529b",24,{},"\u7cbe\u795e\u529b"+this.identifier)),c=tt.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(tt.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),c.appendChild(tt.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),c.appendChild(tt.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),c.appendChild(tt.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),c.appendChild(tt.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),c.appendChild(tt.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let h=new Ah("ChatPalette_"+this.identifier);h.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),h.initialize(),this.appendChild(h)}};var ri;Ne([st()],Vn.prototype,"rotate",void 0),Ne([st()],Vn.prototype,"roll",void 0),Vn=e1=Ne([di("character")],Vn);let Bt=class extends za{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier=""}static#e=ri=this;static#t=this.myCursor=null;static#n=this.userIdMap=new Map;static#i=this.peerIdMap=new Map;get isMine(){return ri.myCursor&&ri.myCursor===this}get image(){return Dt.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||Q.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{Be.peerIds.includes(this.peerId)||(ri.userIdMap.delete(this.userId),ri.peerIdMap.delete(this.peerId),De.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),Q.unregister(this),ri.userIdMap.delete(this.userId),ri.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(ri.userIdMap,n,!0)}static findByPeerId(n){return this.find(ri.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&De.instance.get(r))return De.instance.get(r);let o=De.instance.getObjects(ri);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return n.set(a,s.identifier),s}return null}static createMyCursor(){return ri.myCursor?(console.warn("It is already created."),ri.myCursor):(ri.myCursor=new ri,ri.myCursor.peerId=Be.peerId,ri.myCursor.initialize(),ri.myCursor)}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(ri.userIdMap.set(e,this.identifier),ri.userIdMap.delete(this.userId)),i!==this.peerId&&(ri.peerIdMap.set(i,this.identifier),ri.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};Ne([st()],Bt.prototype,"userId",void 0),Ne([st()],Bt.prototype,"peerId",void 0),Ne([st()],Bt.prototype,"name",void 0),Ne([st()],Bt.prototype,"imageIdentifier",void 0),Bt=ri=Ne([di("PeerCursor")],Bt);let Hl=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return Is.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,c=new Date(o.utc_datetime).getTime();this.timeOffset=c+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+c),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,o,s){let a={from:Be.peer.userId,to:this.findId(s),name:this.makeMessageName(o,s),imageIdentifier:this.findImageIdentifier(o),timestamp:this.calcTimeStamp(e),tag:r,text:i};return e.addMessage(a)}findId(e){let i=De.instance.get(e);return i instanceof Vn?i.identifier:i instanceof Bt?i.userId:null}findObjectName(e){let i=De.instance.get(e);return i instanceof Vn||i instanceof Bt?i.name:e}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" > "+this.findObjectName(i)}findImageIdentifier(e){let i=De.instance.get(e);return i instanceof Vn?i.imageFile?i.imageFile.identifier:"":i instanceof Bt?i.imageIdentifier:e}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();var aO=function(t){return t.ACTION="action",t.SEPARATOR="separator",t}(aO||{});const gn={name:"",enabled:!0,type:aO.SEPARATOR};let Zr=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0}}static#e=this.ContextMenuComponentClass=null;get isShow(){return!!this.panelComponentRef}open(e,i,r,o){this.close(),o||(o=t.defaultParentViewContainerRef);let a=o.createComponent(t.ContextMenuComponentClass,{index:o.length,injector:o.injector});const l=a.injector.get(t);l.panelComponentRef=a,i&&(l.actions=i),e&&(l.position.x=e.x,l.position.y=e.y),l.title=r??"",a.onDestroy(()=>{l.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();var As,t1=function(t){return t.ASC="ASC",t.DESC="DESC",t}(t1||{});let ks=class extends za{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=t1.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static#e=As=this;static get instance(){return As._instance||(As._instance=new As("DataSummarySetting"),As._instance.initialize()),As._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=As.instance.toContext();e.syncData=this.toContext().syncData,As.instance.apply(e),As.instance.update(),this.destroy()}};Ne([st()],ks.prototype,"sortTag",void 0),Ne([st()],ks.prototype,"sortOrder",void 0),Ne([st()],ks.prototype,"dataTag",void 0),ks=As=Ne([di("summary-setting")],ks);class ga{get summarySetting(){return ks.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}static#e=this._newLineDataElement=function tZ(t){let e=new tt("newLineString_DataElement");return e.name=t,e}("/");get newLineDataElement(){return ga._newLineDataElement}constructor(){this.tableInventory=new Wm(n=>"table"===n.location.name),this.commonInventory=new Wm(n=>!this.isAnyLocation(n.location.name)),this.privateInventory=new Wm(n=>n.location.name===Be.peerId),this.graveyardInventory=new Wm(n=>"graveyard"===n.location.name),this.locationMap=new Map,this.tagNameMap=new Map,this.initialize()}initialize(){Q.register(this).on("OPEN_NETWORK",n=>{this.refresh()}).on("CONNECT_PEER",n=>{this.refresh()}).on("DISCONNECT_PEER",n=>{this.refresh()}).on("UPDATE_GAME_OBJECT",n=>{let e=De.instance.get(n.data.identifier);if(e)if(e instanceof Vn){let i=this.locationMap.get(e.identifier);e.location.name!==i&&(this.locationMap.set(e.identifier,e.location.name),this.refresh())}else if(e instanceof tt){if(!this.containsInGameCharacter(e))return;let i=this.tagNameMap.get(e.identifier);(this.dataTags.includes(i)||this.dataTags.includes(e.name))&&e.name!==i&&(this.tagNameMap.set(e.identifier,e.name),this.refreshDataElements()),this.sortTag===e.name&&this.refreshSort(),0<e.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else e instanceof ks&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",n=>{this.locationMap.delete(n.data.identifier),this.tagNameMap.delete(n.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",n=>{n.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(n){let e=n.parent,i=Vn.aliasName;for(;e;){if(e.aliasName===i)return!0;e=e.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort()}callInventoryUpdate(){Q.trigger("UPDATE_INVENTORY",null)}isAnyLocation(n){if("table"===n||n===Be.peerId||"graveyard"===n)return!0;for(let e of Be.peers)if(e.isOpen&&n===e.peerId)return!0;return!1}static#t=this.\u0275fac=function(e){return new(e||ga)};static#n=this.\u0275prov=We({token:ga,factory:ga.\u0275fac,providedIn:"root"})}class Wm{get summarySetting(){return ks.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.rootDataElement)continue;let i=this.dataTags.map(r=>r===this.newLineString?this.newLineDataElement:e.rootDataElement.getFirstElementByName(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}constructor(n){this.classifier=n,this.newLineString="/",this.newLineDataElement=ga._newLineDataElement,this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=De.instance.getObjects(Vn),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,o)=>{let s=r.rootDataElement?.getFirstElementByName(e),a=o.rootDataElement?.getFirstElementByName(e);if(!s&&!a)return 0;if(!a)return-1;if(!s)return 1;let l=this.convertToSortableValue(s),c=this.convertToSortableValue(a);return l<c?i:l>c?-1*i:0}),n}convertToSortableValue(n){let i=ma.toHalfWidth(((n.isNumberResource?n.currentValue:n.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}class nZ{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let gr=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}static#e=this.ModalComponentClass=null;get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){return r||(r=t.defaultParentViewContainerRef),new Promise((o,s)=>{const c=new t;c.modalContext=new nZ(g=>{h&&(h.destroy(),o(g),this.count--)},g=>{h&&(h.destroy(),s(g),this.count--)},i);const d=Ur.create({providers:[{provide:t,useValue:c}],parent:r.injector});let h=r.createComponent(t.ModalComponentClass,{index:r.length,injector:d}),f=h.instance.content.createComponent(e);h.onDestroy(()=>{h=null,this.count--}),f.onDestroy(()=>{f=null,this.count--}),this.count++;let m=h.instance,p=f.instance;(null!=m?.ngOnChanges||null!=p?.ngOnChanges)&&queueMicrotask(()=>{f&&p?.ngOnChanges({}),h&&m?.ngOnChanges({})})})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})(),yn=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.scrollablePanel=null}static#e=this.UIPanelComponentClass=null;get isShow(){return!!this.panelComponentRef}open(e,i,r){r||(r=t.defaultParentViewContainerRef);let s=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector}),a=s.instance.content.createComponent(e);const l=s.injector.get(t);l.panelComponentRef=s,i&&(i.title&&(l.title=i.title),i.top&&(l.top=i.top),i.left&&(l.left=i.left),i.width&&(l.width=i.width),i.height&&(l.height=i.height)),s.onDestroy(()=>{l.panelComponentRef=null,s=null}),a.onDestroy(()=>{a=null});let c=s.instance,u=a.instance;return(null!=c?.ngOnChanges||null!=u?.ngOnChanges)&&queueMicrotask(()=>{a&&null!=u?.ngOnChanges&&u?.ngOnChanges({}),s&&null!=c?.ngOnChanges&&c?.ngOnChanges({})}),a.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})(),Ci=(()=>{class t{get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>{this._isDragging=e,document.body.dispatchEvent(new CustomEvent("draggingstate",{detail:e,bubbles:!0}))})}constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1,this.isTablePickGesture=!1}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i,3),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s,12),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<mn.sqrMagnitude(e,this.startPostion)&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&mn.sqrMagnitude(e,r)<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(kt))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function n1(t,n=[]){let e=cO(t.aliasName,n),i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function lO(t,n=[]){let e=cO(t.aliasName,n),i=Number.MAX_SAFE_INTEGER,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:e[o].zindex<i&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i-1,!(0<=t.zindex))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function cO(t,n){let e=De.instance.getObjects(t);return n.forEach(i=>e=e.concat(De.instance.getObjects(i))),e=e.filter(i=>i.isVisibleOnTable),e}var qm,zl=function(t){return t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK",t}(zl||{});let Yr=qm=class extends qr{constructor(){super(...arguments),this.state=zl.FRONT,this.rotate=0,this.owner="",this.zindex=0}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get ownerName(){let n=Bt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isHand||Be.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isHand(){return Be.peer.userId===this.owner}get isFront(){return this.state===zl.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=zl.FRONT,this.owner=""}faceDown(){this.state=zl.BACK,this.owner=""}toTopmost(){n1(this,["card-stack"])}toBackmost(){lO(this,["card-stack"])}static create(n,e,i,r=2,o){let s=null;return s=o?new qm(o):new qm,s.createDataElements(),s.commonDataElement.appendChild(tt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(tt.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(tt.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(tt.create("back",i,{type:"image"},"back_"+s.identifier)),s.initialize(),s}};var Zm;Ne([st()],Yr.prototype,"state",void 0),Ne([st()],Yr.prototype,"rotate",void 0),Ne([st()],Yr.prototype,"owner",void 0),Ne([st()],Yr.prototype,"zindex",void 0),Yr=qm=Ne([di("card")],Yr);let ji=Zm=class extends qr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0}get name(){return this.getCommonValue("name","")}get ownerName(){let n=Bt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.prependChild(n)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){n1(this,["card"])}toBackmost(){lO(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new Zm(e):new Zm,i.createDataElements(),i.commonDataElement.appendChild(tt.create("name",n,{},"name_"+i.identifier));let r=new Qi("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};Ne([st()],ji.prototype,"rotate",void 0),Ne([st()],ji.prototype,"zindex",void 0),Ne([st()],ji.prototype,"owner",void 0),Ne([st()],ji.prototype,"isShowTotal",void 0),ji=Zm=Ne([di("card-stack")],ji);var Ym,_r=function(t){return t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20",t}(_r||{});let Os=Ym=class extends qr{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement?.children.map(n=>n.name)??[]}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get ownerName(){let n=Bt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isMine||Be.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isMine(){return Be.peer.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],o=s=>s+1+"";switch(n){case _r.D2:i=2;break;case _r.D4:i=4;break;case _r.D6:i=6;break;case _r.D8:i=8;break;case _r.D10_10TIMES:o=s=>s+1+"0";case _r.D10:i=10;break;case _r.D12:i=12;break;case _r.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(tt.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=r[0].name,r}static create(n,e,i,r){let o=r?new Ym(r):new Ym;return o.createDataElements(),o.commonDataElement.appendChild(tt.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(tt.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};var Xm;Ne([st()],Os.prototype,"face",void 0),Ne([st()],Os.prototype,"owner",void 0),Ne([st()],Os.prototype,"rotate",void 0),Os=Ym=Ne([di("dice-symbol")],Os);let Ps=Xm=class extends qr{constructor(){super(...arguments),this.isLock=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}static create(n,e,i,r,o){let s=null;return s=o?new Xm(o):new Xm,s.createDataElements(),s.commonDataElement.appendChild(tt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(tt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(tt.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(tt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.initialize(),s}};Ne([st()],Ps.prototype,"isLock",void 0),Ps=Xm=Ne([di("table-mask")],Ps);var Km,bu=function(t){return t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL",t}(bu||{});let Ao=Km=class extends qr{constructor(){super(...arguments),this.isLocked=!1,this.mode=bu.ALL,this.rotate=0}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&bu.WALL)}get hasFloor(){return!!(this.mode&bu.FLOOR)}static create(n,e,i,r,o,s,a){let l=null;return l=a?new Km(a):new Km,l.createDataElements(),l.commonDataElement.appendChild(tt.create("name",n,{},"name_"+l.identifier)),l.commonDataElement.appendChild(tt.create("width",e,{},"width_"+l.identifier)),l.commonDataElement.appendChild(tt.create("height",r,{},"height_"+l.identifier)),l.commonDataElement.appendChild(tt.create("depth",i,{},"depth_"+l.identifier)),l.imageDataElement.appendChild(tt.create("wall",o,{type:"image"},"wall_"+l.identifier)),l.imageDataElement.appendChild(tt.create("floor",s,{type:"image"},"floor_"+l.identifier)),l.initialize(),l}};Ne([st()],Ao.prototype,"isLocked",void 0),Ne([st()],Ao.prototype,"mode",void 0),Ne([st()],Ao.prototype,"rotate",void 0),Ao=Km=Ne([di("terrain")],Ao);var Gl=function(t){return t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL",t}(Gl||{}),uO=function(t){return t.NONE="",t.WHITE="white",t.BLACK="black",t}(uO||{});let Fi=class extends Qi{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=uO.NONE,this.selected=!1,this.gridType=Gl.SQUARE,this.gridColor="#000000e6"}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof Ao&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof Ps&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&Q.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};Ne([st()],Fi.prototype,"name",void 0),Ne([st()],Fi.prototype,"width",void 0),Ne([st()],Fi.prototype,"height",void 0),Ne([st()],Fi.prototype,"gridSize",void 0),Ne([st()],Fi.prototype,"imageIdentifier",void 0),Ne([st()],Fi.prototype,"backgroundImageIdentifier",void 0),Ne([st()],Fi.prototype,"backgroundFilterType",void 0),Ne([st()],Fi.prototype,"selected",void 0),Ne([st()],Fi.prototype,"gridType",void 0),Ne([st()],Fi.prototype,"gridColor",void 0),Fi=Ne([di("game-table")],Fi);var Xr=function(t){return t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL",t}(Xr||{});class fo{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return Xr.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?Xr.URL:Xr.COMPLETE:Xr.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}static createEmpty(n){let e=new fo;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new fo;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new fo;return e.apply(n),e}}static createAsync(n){return(0,E.A)(function*(){return n instanceof File?yield fo._createAsync(n,n.name):n instanceof Blob?yield fo._createAsync(n):void 0})()}static _createAsync(n,e){return(0,E.A)(function*(){let i=yield Qo.readAsArrayBufferAsync(n),r=new fo;return r.context.identifier=yield Qo.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),this.createURLs()}createURLs(){this.state!==Xr.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==Xr.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var $l,Qm=function(t){return t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION",t}(Qm||{});class nt{static get audioContext(){return nt._audioContext||(nt._audioContext=new(window.AudioContext||window.webkitAudioContext)),nt._audioContext}static#e=this._volume=.5;static get volume(){return nt._volume}static set volume(n){nt._volume=n,nt.masterGainNode.gain.setTargetAtTime(nt._volume,nt.audioContext.currentTime,.01)}static#t=this._auditionVolume=.5;static get auditionVolume(){return nt._auditionVolume}static set auditionVolume(n){nt._auditionVolume=n,nt.auditionGainNode.gain.setTargetAtTime(nt._auditionVolume,nt.audioContext.currentTime,.01)}static get masterGainNode(){if(!nt._masterGainNode){let n=nt.audioContext.createGain();n.gain.setValueAtTime(nt._volume,nt.audioContext.currentTime),n.connect(nt.audioContext.destination),nt._masterGainNode=n}return nt._masterGainNode}static get auditionGainNode(){if(!nt._auditionGainNode){let n=nt.audioContext.createGain();n.gain.setValueAtTime(nt._auditionVolume,nt.audioContext.currentTime),n.connect(nt.audioContext.destination),nt._auditionGainNode=n}return nt._auditionGainNode}static get rootNode(){return nt.masterGainNode}static get auditionNode(){return nt.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=nt.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}static#n=this.cacheMap=new Map;constructor(n){this.volumeType=Qm.MASTER,this.audio=n}static play(n,e=1){this.playBufferAsync(n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===Xr.URL&&(nt.cacheMap.has(n.identifier)?e=nt.cacheMap.get(n.identifier).url:nt.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){this.audioElm&&(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===Qm.AUDITION?nt.auditionNode:nt.rootNode}static playBufferAsync(n,e=1){return(0,E.A)(function*(){let i=yield nt.createBufferSourceAsync(n);if(!i)return;let r=nt.audioContext.createGain();r.gain.setValueAtTime(e,nt.audioContext.currentTime),r.connect(nt.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(n){var e=this;return(0,E.A)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===Xr.URL)if(nt.cacheMap.has(n.identifier))i=nt.cacheMap.get(n.identifier).blob;else{let s=yield nt.createCacheAsync(n);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=nt.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,E.A)(function*(i,r){nt.audioContext.decodeAudioData(yield Qo.readAsArrayBufferAsync(n),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,E.A)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,E.A)(function*(){let e={url:n.url,blob:null};try{e.blob=yield nt.getBlobAsync(n)}catch(i){return console.error(i),e}return nt.cacheMap.has(n.identifier)?nt.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),nt.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){nt.audioContext.resume();let n=()=>{nt.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}class at{static get instance(){return at._instance||(at._instance=new at),at._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}constructor(){this.hash={},console.log("AudioStorage ready...")}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,E.A)(function*(){let i=yield fo.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=fo.create(n);else if(n instanceof fo)e=n;else{if(this.update(n))return this.hash[n.identifier];e=fo.create(n)}return this._add(e)}_add(n){return Xr.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof fo?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),Q.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new ha.b(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of at.instance.audios)Xr.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}let pe=(()=>{class t{static#e=this.dicePick="";static#t=this.dicePut="";static#n=this.diceRoll1="";static#i=this.diceRoll2="";static#r=this.cardDraw="";static#o=this.cardPick="";static#s=this.cardPut="";static#a=this.cardShuffle="";static#l=this.piecePick="";static#c=this.piecePut="";static#u=this.blockPick="";static#d=this.blockPut="";static#h=this.lock="";static#f=this.unlock="";static#p=this.sweep="";static#m=this.selectionStart=""}return t})(),xe=$l=class extends za{onStoreAdded(){super.onStoreAdded(),Q.register(this).on("SOUND_EFFECT",n=>{nt.play(at.instance.get(n.data),.5)}).on("SEND_MESSAGE",n=>{let e=De.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||!e.isDicebot||(Math.random()<.5?$l.play(pe.diceRoll1):$l.play(pe.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),Q.unregister(this)}play(n){$l.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,$l._play(e)}static _play(n){Q.call("SOUND_EFFECT",n)}static playLocal(n){let e="";e="string"==typeof n?n:n.identifier,$l._playLocal(e)}static _playLocal(n){Q.trigger("SOUND_EFFECT",n)}};var Wl;xe=$l=Ne([di("sound-effect")],xe);let _a=class extends za{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static#e=Wl=this;static get instance(){return Wl._instance||(Wl._instance=new Wl("TableSelecter"),Wl._instance.initialize()),Wl._instance}onStoreAdded(){super.onStoreAdded(),Q.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),Q.unregister(this)}get viewTable(){let n=De.instance.get(this.viewTableIdentifier);return n||(n=De.instance.getObjects(Fi)[0],n&&(this.viewTableIdentifier.length<1||De.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,Q.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};var Jm;Ne([st()],_a.prototype,"viewTableIdentifier",void 0),_a=Wl=Ne([di("TableSelecter")],_a);let Ns=Jm=class extends qr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password=""}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}toTopmost(){n1(this)}static create(n,e,i=16,r=1,o=1,s){let a=s?new Jm(s):new Jm;return a.createDataElements(),a.commonDataElement.appendChild(tt.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(tt.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(tt.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(tt.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(tt.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.initialize(),a}};var hi;Ne([st()],Ns.prototype,"rotate",void 0),Ne([st()],Ns.prototype,"zindex",void 0),Ne([st()],Ns.prototype,"password",void 0),Ns=Jm=Ne([di("text-note")],Ns),function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},t.parse=e}(hi||(hi={}));class Ui{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new Ui){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,o=n.x*this.m13+n.y*this.m23+this.m43,s=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,l=r+this.m32,c=o+this.m33,u=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==u&&(u=1e-4),a/=u,l/=u,c/=u;let d=c-o;if(0==d)return e.x=i,e.y=r,e.z=o,e.w=o,e;let h=-o/d;return i+=h*(a-i),r+=h*(l-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,o=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,s=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(n){return Ui.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new Ui){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(Ui.makePosition(e,Ui.MATRIX3D))}static makePerspective(n,e=new Ui){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(Ui.makePerspective(n,Ui.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,l=this.m22,c=this.m23,u=this.m24,d=this.m31,h=this.m32,f=this.m33,m=this.m34,p=this.m41,g=this.m42,y=this.m43,C=this.m44;e[0]=c*m*g-u*f*g+u*h*y-l*m*y-c*h*C+l*f*C,e[1]=s*f*g-o*m*g-s*h*y+r*m*y+o*h*C-r*f*C,e[2]=o*u*g-s*c*g+s*l*y-r*u*y-o*l*C+r*c*C,e[3]=s*c*h-o*u*h-s*l*f+r*u*f+o*l*m-r*c*m;let N=i*e[0]+a*e[1]+d*e[2]+p*e[3];return 0==N?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=u*f*p-c*m*p-u*d*y+a*m*y+c*d*C-a*f*C,e[5]=o*m*p-s*f*p+s*d*y-i*m*y-o*d*C+i*f*C,e[6]=s*c*p-o*u*p-s*a*y+i*u*y+o*a*C-i*c*C,e[7]=o*u*d-s*c*d+s*a*f-i*u*f-o*a*m+i*c*m,e[8]=l*m*p-u*h*p+u*d*g-a*m*g-l*d*C+a*h*C,e[9]=s*h*p-r*m*p-s*d*g+i*m*g+r*d*C-i*h*C,e[10]=r*u*p-s*l*p+s*a*g-i*u*g-r*a*C+i*l*C,e[11]=s*l*d-r*u*d-s*a*h+i*u*h+r*a*m-i*l*m,e[12]=c*h*p-l*f*p-c*d*g+a*f*g+l*d*y-a*h*y,e[13]=r*f*p-o*h*p+o*d*g-i*f*g-r*d*y+i*h*y,e[14]=o*l*p-r*c*p-o*a*g+i*c*g+r*a*y-i*l*y,e[15]=r*c*d-o*l*d+o*a*h-i*c*h-r*a*f+i*l*f,n.setData(e),n.scalar(1/N),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=hi.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(Ui.MATRIX3D.setCSS(n).flatten()):this.append(Ui.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new Ui){let o=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,s=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,l=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,c=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,u=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,d=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,h=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,f=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,m=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,p=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,g=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,y=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,C=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,N=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=l,i.m22=c,i.m23=u,i.m24=d,i.m31=h,i.m32=f,i.m33=m,i.m34=p,i.m41=g,i.m42=y,i.m43=C,i.m44=N,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}static#e=this.MATRIX3D=new Ui}class kh{constructor(n){this.matrix=new Ui,this.sceneTransform=new Ui,this.inverseSceneTransform=new Ui,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=hi.relation(e.paddingTop,i),this.paddingTop=hi.relation(e.paddingTop,r),this.marginLeft=hi.relation(e.marginLeft,i),this.marginTop=hi.relation(e.marginTop,r),this.borderLeft=hi.relation(e.borderLeft,i),this.borderTop=hi.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let o_x=n,o_y=e,o_z=i,s=new kh(r),a=Ui.multiply(this.sceneTransform,s.inverseSceneTransform),l={x:0,y:0,z:0,w:1};return l.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,l.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,l.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,l.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(l),l}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new Ui),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],l=hi.relation(a[0],i.offsetWidth,.5*i.offsetWidth),c=hi.relation(a[1],i.offsetHeight,.5*i.offsetHeight),u=hi.relation(a[2],0,0);e.appendPosition(-l,-c,-u),e.appendCSS(r.transform),e.appendPosition(l,c,u)}let o=this.getPosition(n);e.appendPosition(o.x,o.y,0);let s=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);s=hi.parse(a.perspective)}if(n.parentElement&&s){let l=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),c=hi.relation(l[0],i.parentElement.offsetWidth),u=hi.relation(l[1],i.parentElement.offsetHeight);e.appendPosition(-c,-u,0),e.appendPerspective(s),e.appendPosition(c,u,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let ql=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new kh(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new kh(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new kh(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(Ci))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),i1=(()=>{class t{get tableSelecter(){return _a.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return De.instance.getObjects(Bt)}constructor(e){this.coordinateService=e,this._emptyTable=new Fi(""),this.locationMap=new Map,this.parentMap=new Map,this.indexMap=new Map,this.characterCache=new Zl(()=>De.instance.getObjects(Vn).filter(i=>i.isVisibleOnTable)),this.cardCache=new Zl(()=>De.instance.getObjects(Yr).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Zl(()=>De.instance.getObjects(ji).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Zl(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.terrainCache=new Zl(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Zl(()=>De.instance.getObjects(Ns)),this.diceSymbolCache=new Zl(()=>De.instance.getObjects(Os)),this.initialize()}initialize(){this.refreshCacheAll(),Q.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(Ps.aliasName),void this.refreshCache(Ao.aliasName);let i=De.instance.get(e.data.identifier);i&&i instanceof qr?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=Un.instance.parseXml(e.data.xmlElement);if(r instanceof qr){let o=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=o.x-25,r.location.y=o.y-25,r.posZ=o.z,this.placeToTabletop(r),xe.play(pe.piecePut)}else r instanceof yu&&Is.instance.addChatTab(r)})}findCache(e){switch(e){case Vn.aliasName:return this.characterCache;case Yr.aliasName:return this.cardCache;case ji.aliasName:return this.cardStackCache;case Ps.aliasName:return this.tableMaskCache;case Ao.aliasName:return this.terrainCache;case Ns.aliasName:return this.textNoteCache;case Os.aliasName:return this.diceSymbolCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId||e.isVisibleOnTable&&this.indexMap.get(e.identifier)!==e.index}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId),this.indexMap.set(e.identifier,e.index)}clearMap(){this.locationMap.clear(),this.parentMap.clear(),this.indexMap.clear()}placeToTabletop(e){switch(e.aliasName){case Ps.aliasName:e instanceof Ps&&(e.isLock=!1);case Ao.aliasName:if(e instanceof Ao&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(ql))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac})}return t})();class Zl{get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}refresh(){this.needsRefresh=!0}}var dO=V(8161);class Yl{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new Yl(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new Yl(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&Q.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){Q.unregister(this),this.sendChankTimer&&(0,Mo.v)(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=dO.$.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Q.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),(0,Mo.W)(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);Q.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),(0,Mo.W)(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=(0,Mo.W)(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Q.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),Q.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=dO.$.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new ha.b(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class Cu{static get instance(){return Cu._instance||(Cu._instance=new Cu),Cu._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),Q.register(this).on("CONNECT_PEER",-1,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),at.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=at.instance.get(o.identifier);null===s&&(s=fo.createEmpty(o.identifier),at.instance.add(s)),s.state<Xr.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<at.instance.getCatalog().length&&at.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let o=at.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=at.instance.get(i[r].identifier);this.startSendTask(s,n.data.receiver)}else{let r=n.data.candidatePeers,o=r.indexOf(Be.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+n.data.identifiers),void Q.call(n,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),at.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=at.instance.get(e);this.receiveTaskMap.has(e)||i&&Xr.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),Q.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){Q.unregister(this)}startSendTask(n,e){var i=this;return(0,E.A)(function*(){let r=Yl.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),Q.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let o={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===Xr.URL?o.url=n.url:(o.blob=yield Qo.readAsArrayBufferAsync(n.blob),o.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),at.instance.synchronize()},r.start(o)})()}startReceiveTask(n){let e=at.instance.get(n),i=Yl.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&Q.trigger("UPDATE_AUDIO_RESOURE",[o]),at.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),Q.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:Be.peerId,candidatePeers:Be.peerIds},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}const Oh=15,hO=573;function rg(t){return og(t.map(([n,e])=>new Array(n).fill(e,0,n)))}function og(t){return t.reduce((n,e)=>n.concat(Array.isArray(e)?og(e):e),[])}const vO=[0,1,2,3].concat(...rg([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function Hn(){const t=this;function e(r,o){let s=0;do{s|=1&r,r>>>=1,s<<=1}while(--o>0);return s>>>1}t.build_tree=function(r){const o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.elems;let l,c,d,u=-1;for(r.heap_len=0,r.heap_max=hO,l=0;l<a;l++)0!==o[2*l]?(r.heap[++r.heap_len]=u=l,r.depth[l]=0):o[2*l+1]=0;for(;r.heap_len<2;)d=r.heap[++r.heap_len]=u<2?++u:0,o[2*d]=1,r.depth[d]=0,r.opt_len--,s&&(r.static_len-=s[2*d+1]);for(t.max_code=u,l=Math.floor(r.heap_len/2);l>=1;l--)r.pqdownheap(o,l);d=a;do{l=r.heap[1],r.heap[1]=r.heap[r.heap_len--],r.pqdownheap(o,1),c=r.heap[1],r.heap[--r.heap_max]=l,r.heap[--r.heap_max]=c,o[2*d]=o[2*l]+o[2*c],r.depth[d]=Math.max(r.depth[l],r.depth[c])+1,o[2*l+1]=o[2*c+1]=d,r.heap[1]=d++,r.pqdownheap(o,1)}while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],function n(r){const o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,d,h,f,m,p,g=0;for(f=0;f<=Oh;f++)r.bl_count[f]=0;for(o[2*r.heap[r.heap_max]+1]=0,u=r.heap_max+1;u<hO;u++)d=r.heap[u],f=o[2*o[2*d+1]+1]+1,f>c&&(f=c,g++),o[2*d+1]=f,!(d>t.max_code)&&(r.bl_count[f]++,m=0,d>=l&&(m=a[d-l]),p=o[2*d],r.opt_len+=p*(f+m),s&&(r.static_len+=p*(s[2*d+1]+m)));if(0!==g){do{for(f=c-1;0===r.bl_count[f];)f--;r.bl_count[f]--,r.bl_count[f+1]+=2,r.bl_count[c]--,g-=2}while(g>0);for(f=c;0!==f;f--)for(d=r.bl_count[f];0!==d;)h=r.heap[--u],!(h>t.max_code)&&(o[2*h+1]!=f&&(r.opt_len+=(f-o[2*h+1])*o[2*h],o[2*h+1]=f),d--)}}(r),function i(r,o,s){const a=[];let c,u,d,l=0;for(c=1;c<=Oh;c++)a[c]=l=l+s[c-1]<<1;for(u=0;u<=o;u++)d=r[2*u+1],0!==d&&(r[2*u]=e(a[d]++,d))}(o,t.max_code,r.bl_count)}}function Ji(t,n,e,i,r){const o=this;o.static_tree=t,o.extra_bits=n,o.extra_base=e,o.elems=i,o.max_length=r}Hn._length_code=[0,1,2,3,4,5,6,7].concat(...rg([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),Hn.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],Hn.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],Hn.d_code=function(t){return t<256?vO[t]:vO[256+(t>>>7)]},Hn.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Hn.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Hn.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Hn.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];const dZ=rg([[144,8],[112,9],[24,7],[8,8]]);Ji.static_ltree=og([12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227].map((t,n)=>[t,dZ[n]]));const fZ=rg([[30,5]]);function Fs(t,n,e,i,r){const o=this;o.good_length=t,o.max_lazy=n,o.nice_length=e,o.max_chain=i,o.func=r}Ji.static_dtree=og([0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23].map((t,n)=>[t,fZ[n]])),Ji.static_l_desc=new Ji(Ji.static_ltree,Hn.extra_lbits,257,286,Oh),Ji.static_d_desc=new Ji(Ji.static_dtree,Hn.extra_dbits,0,30,Oh),Ji.static_bl_desc=new Ji(null,Hn.extra_blbits,0,19,7);const ts=[new Fs(0,0,0,0,0),new Fs(4,4,8,4,1),new Fs(4,5,16,8,1),new Fs(4,6,32,32,1),new Fs(4,4,16,16,2),new Fs(8,16,32,32,2),new Fs(8,16,128,128,2),new Fs(8,32,128,256,2),new Fs(32,128,258,1024,2),new Fs(32,258,258,4096,2)],ag=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],po=262;function bO(t,n,e,i){const r=t[2*n],o=t[2*e];return r<o||r==o&&i[n]<=i[e]}function yZ(){const t=this;let n,e,i,r,o,s,a,l,c,u,d,h,f,m,p,g,y,C,N,$,H,z,X,ee,he,ae,se,we,Ce,Ie,Re,te,_e;const ve=new Hn,Ye=new Hn,Oe=new Hn;let jt,Ge,mt,$t,Gn,In;function xi(){let ge;for(ge=0;ge<286;ge++)Re[2*ge]=0;for(ge=0;ge<30;ge++)te[2*ge]=0;for(ge=0;ge<19;ge++)_e[2*ge]=0;Re[512]=1,t.opt_len=t.static_len=0,Ge=mt=0}function Ti(ge,Te){let Me,ye=-1,Ze=ge[1],xt=0,on=7,Lr=4;0===Ze&&(on=138,Lr=3),ge[2*(Te+1)+1]=65535;for(let rs=0;rs<=Te;rs++)Me=Ze,Ze=ge[2*(rs+1)+1],!(++xt<on&&Me==Ze)&&(xt<Lr?_e[2*Me]+=xt:0!==Me?(Me!=ye&&_e[2*Me]++,_e[32]++):xt<=10?_e[34]++:_e[36]++,xt=0,ye=Me,0===Ze?(on=138,Lr=3):Me==Ze?(on=6,Lr=3):(on=7,Lr=4))}function Rr(ge){t.pending_buf[t.pending++]=ge}function _o(ge){Rr(255&ge),Rr(ge>>>8&255)}function Rn(ge,Te){let ye;const Me=Te;In>16-Me?(ye=ge,Gn|=ye<<In&65535,_o(Gn),Gn=ye>>>16-In,In+=Me-16):(Gn|=ge<<In&65535,In+=Me)}function zi(ge,Te){const ye=2*ge;Rn(65535&Te[ye],65535&Te[ye+1])}function wa(ge,Te){let ye,Ze,Me=-1,xt=ge[1],on=0,Lr=7,rs=4;for(0===xt&&(Lr=138,rs=3),ye=0;ye<=Te;ye++)if(Ze=xt,xt=ge[2*(ye+1)+1],!(++on<Lr&&Ze==xt)){if(on<rs)do{zi(Ze,_e)}while(0!=--on);else 0!==Ze?(Ze!=Me&&(zi(Ze,_e),on--),zi(16,_e),Rn(on-3,2)):on<=10?(zi(17,_e),Rn(on-3,3)):(zi(18,_e),Rn(on-11,7));on=0,Me=Ze,0===xt?(Lr=138,rs=3):Ze==xt?(Lr=6,rs=3):(Lr=7,rs=4)}}function eo(){16==In?(_o(Gn),Gn=0,In=0):In>=8&&(Rr(255&Gn),Gn>>>=8,In-=8)}function qs(ge,Te){let ye,Me,Ze;if(t.dist_buf[Ge]=ge,t.lc_buf[Ge]=255&Te,Ge++,0===ge?Re[2*Te]++:(mt++,ge--,Re[2*(Hn._length_code[Te]+256+1)]++,te[2*Hn.d_code(ge)]++),!(8191&Ge)&&se>2){for(ye=8*Ge,Me=H-y,Ze=0;Ze<30;Ze++)ye+=te[2*Ze]*(5+Hn.extra_dbits[Ze]);if(ye>>>=3,mt<Math.floor(Ge/2)&&ye<Math.floor(Me/2))return!0}return Ge==jt-1}function is(ge,Te){let ye,Me,xt,on,Ze=0;if(0!==Ge)do{ye=t.dist_buf[Ze],Me=t.lc_buf[Ze],Ze++,0===ye?zi(Me,ge):(xt=Hn._length_code[Me],zi(xt+256+1,ge),on=Hn.extra_lbits[xt],0!==on&&(Me-=Hn.base_length[xt],Rn(Me,on)),ye--,xt=Hn.d_code(ye),zi(xt,Te),on=Hn.extra_dbits[xt],0!==on&&(ye-=Hn.base_dist[xt],Rn(ye,on)))}while(Ze<Ge);zi(256,ge),$t=ge[513]}function Rg(){In>8?_o(Gn):In>0&&Rr(255&Gn),Gn=0,In=0}function Ru(ge,Te,ye){Rn(0+(ye?1:0),3),function GC(ge,Te,ye){Rg(),$t=8,ye&&(_o(Te),_o(~Te)),t.pending_buf.set(l.subarray(ge,ge+Te),t.pending),t.pending+=Te}(ge,Te,!0)}function tl(ge){(function Die(ge,Te,ye){let Me,Ze,xt=0;se>0?(ve.build_tree(t),Ye.build_tree(t),xt=function Fr(){let ge;for(Ti(Re,ve.max_code),Ti(te,Ye.max_code),Oe.build_tree(t),ge=18;ge>=3&&0===_e[2*Hn.bl_order[ge]+1];ge--);return t.opt_len+=3*(ge+1)+5+5+4,ge}(),Me=t.opt_len+3+7>>>3,Ze=t.static_len+3+7>>>3,Ze<=Me&&(Me=Ze)):Me=Ze=Te+5,Te+4<=Me&&-1!=ge?Ru(ge,Te,ye):Ze==Me?(Rn(2+(ye?1:0),3),is(Ji.static_ltree,Ji.static_dtree)):(Rn(4+(ye?1:0),3),function No(ge,Te,ye){let Me;for(Rn(ge-257,5),Rn(Te-1,5),Rn(ye-4,4),Me=0;Me<ye;Me++)Rn(_e[2*Hn.bl_order[Me]+1],3);wa(Re,ge-1),wa(te,Te-1)}(ve.max_code+1,Ye.max_code+1,xt+1),is(Re,te)),xi(),ye&&Rg()})(y>=0?y:-1,H-y,ge),y=H,n.flush_pending()}function $C(){let ge,Te,ye,Me;do{if(Me=c-X-H,0===Me&&0===H&&0===X)Me=o;else if(-1==Me)Me--;else if(H>=o+o-po){l.set(l.subarray(o,o+o),0),z-=o,H-=o,y-=o,ge=f,ye=ge;do{Te=65535&d[--ye],d[ye]=Te>=o?Te-o:0}while(0!=--ge);ge=o,ye=ge;do{Te=65535&u[--ye],u[ye]=Te>=o?Te-o:0}while(0!=--ge);Me+=o}if(0===n.avail_in)return;ge=n.read_buf(l,H+X,Me),X+=ge,X>=3&&(h=255&l[H],h=(h<<g^255&l[H+1])&p)}while(X<po&&0!==n.avail_in)}function rN(ge){let Me,Ze,Te=he,ye=H,xt=ee;const on=H>o-po?H-(o-po):0;let Lr=Ie;const rs=a,WC=H+258;let oN=l[ye+xt-1],sN=l[ye+xt];ee>=Ce&&(Te>>=2),Lr>X&&(Lr=X);do{if(Me=ge,l[Me+xt]==sN&&l[Me+xt-1]==oN&&l[Me]==l[ye]&&l[++Me]==l[ye+1]){ye+=2,Me++;do{}while(l[++ye]==l[++Me]&&l[++ye]==l[++Me]&&l[++ye]==l[++Me]&&l[++ye]==l[++Me]&&l[++ye]==l[++Me]&&l[++ye]==l[++Me]&&l[++ye]==l[++Me]&&l[++ye]==l[++Me]&&ye<WC);if(Ze=258-(WC-ye),ye=WC-258,Ze>xt){if(z=ge,xt=Ze,Ze>=Lr)break;oN=l[ye+xt-1],sN=l[ye+xt]}}}while((ge=65535&u[ge&rs])>on&&0!=--Te);return xt<=X?xt:X}t.depth=[],t.bl_count=[],t.heap=[],Re=[],te=[],_e=[],t.pqdownheap=function(ge,Te){const ye=t.heap,Me=ye[Te];let Ze=Te<<1;for(;Ze<=t.heap_len&&(Ze<t.heap_len&&bO(ge,ye[Ze+1],ye[Ze],t.depth)&&Ze++,!bO(ge,Me,ye[Ze],t.depth));)ye[Te]=ye[Ze],Te=Ze,Ze<<=1;ye[Te]=Me},t.deflateInit=function(ge,Te,ye,Me,Ze,xt){return Me||(Me=8),Ze||(Ze=8),xt||(xt=0),ge.msg=null,-1==Te&&(Te=6),Ze<1||Ze>9||8!=Me||ye<9||ye>15||Te<0||Te>9||xt<0||xt>2?-2:(ge.dstate=t,s=ye,o=1<<s,a=o-1,m=Ze+7,f=1<<m,p=f-1,g=Math.floor((m+3-1)/3),l=new Uint8Array(2*o),u=[],d=[],jt=1<<Ze+6,t.pending_buf=new Uint8Array(4*jt),i=4*jt,t.dist_buf=new Uint16Array(jt),t.lc_buf=new Uint8Array(jt),se=Te,we=xt,function Aie(ge){return ge.total_in=ge.total_out=0,ge.msg=null,t.pending=0,t.pending_out=0,e=113,r=0,function qn(){ve.dyn_tree=Re,ve.stat_desc=Ji.static_l_desc,Ye.dyn_tree=te,Ye.stat_desc=Ji.static_d_desc,Oe.dyn_tree=_e,Oe.stat_desc=Ji.static_bl_desc,Gn=0,In=0,$t=8,xi()}(),function Sn(){c=2*o,d[f-1]=0;for(let ge=0;ge<f-1;ge++)d[ge]=0;ae=ts[se].max_lazy,Ce=ts[se].good_length,Ie=ts[se].nice_length,he=ts[se].max_chain,H=0,y=0,X=0,C=ee=2,$=0,h=0}(),0}(ge))},t.deflateEnd=function(){return 42!=e&&113!=e&&666!=e?-2:(t.lc_buf=null,t.dist_buf=null,t.pending_buf=null,d=null,u=null,l=null,t.dstate=null,113==e?-3:0)},t.deflateParams=function(ge,Te,ye){let Me=0;return-1==Te&&(Te=6),Te<0||Te>9||ye<0||ye>2?-2:(ts[se].func!=ts[Te].func&&0!==ge.total_in&&(Me=ge.deflate(1)),se!=Te&&(se=Te,ae=ts[se].max_lazy,Ce=ts[se].good_length,Ie=ts[se].nice_length,he=ts[se].max_chain),we=ye,Me)},t.deflateSetDictionary=function(ge,Te,ye){let Ze,Me=ye,xt=0;if(!Te||42!=e)return-2;if(Me<3)return 0;for(Me>o-po&&(Me=o-po,xt=ye-Me),l.set(Te.subarray(xt,xt+Me),0),H=Me,y=Me,h=255&l[0],h=(h<<g^255&l[1])&p,Ze=0;Ze<=Me-3;Ze++)h=(h<<g^255&l[Ze+2])&p,u[Ze&a]=d[h],d[h]=Ze;return 0},t.deflate=function(ge,Te){let ye,Me,Ze,xt,on;if(Te>4||Te<0)return-2;if(!ge.next_out||!ge.next_in&&0!==ge.avail_in||666==e&&4!=Te)return ge.msg=ag[4],-2;if(0===ge.avail_out)return ge.msg=ag[7],-5;if(n=ge,xt=r,r=Te,42==e&&(Me=8+(s-8<<4)<<8,Ze=(se-1&255)>>1,Ze>3&&(Ze=3),Me|=Ze<<6,0!==H&&(Me|=32),Me+=31-Me%31,e=113,function Ca(ge){Rr(ge>>8&255),Rr(255&ge)}(Me)),0!==t.pending){if(n.flush_pending(),0===n.avail_out)return r=-1,0}else if(0===n.avail_in&&Te<=xt&&4!=Te)return n.msg=ag[7],-5;if(666==e&&0!==n.avail_in)return ge.msg=ag[7],-5;if(0!==n.avail_in||0!==X||0!=Te&&666!=e){switch(on=-1,ts[se].func){case 0:on=function Sie(ge){let ye,Te=65535;for(Te>i-5&&(Te=i-5);;){if(X<=1){if($C(),0===X&&0==ge)return 0;if(0===X)break}if(H+=X,X=0,ye=y+Te,(0===H||H>=ye)&&(X=H-ye,H=ye,tl(!1),0===n.avail_out)||H-y>=o-po&&(tl(!1),0===n.avail_out))return 0}return tl(4==ge),0===n.avail_out?4==ge?2:0:4==ge?3:1}(Te);break;case 1:on=function Mie(ge){let ye,Te=0;for(;;){if(X<po){if($C(),X<po&&0==ge)return 0;if(0===X)break}if(X>=3&&(h=(h<<g^255&l[H+2])&p,Te=65535&d[h],u[H&a]=d[h],d[h]=H),0!==Te&&(H-Te&65535)<=o-po&&2!=we&&(C=rN(Te)),C>=3)if(ye=qs(H-z,C-3),X-=C,C<=ae&&X>=3){C--;do{H++,h=(h<<g^255&l[H+2])&p,Te=65535&d[h],u[H&a]=d[h],d[h]=H}while(0!=--C);H++}else H+=C,C=0,h=255&l[H],h=(h<<g^255&l[H+1])&p;else ye=qs(0,255&l[H]),X--,H++;if(ye&&(tl(!1),0===n.avail_out))return 0}return tl(4==ge),0===n.avail_out?4==ge?2:0:4==ge?3:1}(Te);break;case 2:on=function Iie(ge){let ye,Me,Te=0;for(;;){if(X<po){if($C(),X<po&&0==ge)return 0;if(0===X)break}if(X>=3&&(h=(h<<g^255&l[H+2])&p,Te=65535&d[h],u[H&a]=d[h],d[h]=H),ee=C,N=z,C=2,0!==Te&&ee<ae&&(H-Te&65535)<=o-po&&(2!=we&&(C=rN(Te)),C<=5&&(1==we||3==C&&H-z>4096)&&(C=2)),ee>=3&&C<=ee){Me=H+X-3,ye=qs(H-1-N,ee-3),X-=ee-1,ee-=2;do{++H<=Me&&(h=(h<<g^255&l[H+2])&p,Te=65535&d[h],u[H&a]=d[h],d[h]=H)}while(0!=--ee);if($=0,C=2,H++,ye&&(tl(!1),0===n.avail_out))return 0}else if(0!==$){if(ye=qs(0,255&l[H-1]),ye&&tl(!1),H++,X--,0===n.avail_out)return 0}else $=1,H++,X--}return 0!==$&&(ye=qs(0,255&l[H-1]),$=0),tl(4==ge),0===n.avail_out?4==ge?2:0:4==ge?3:1}(Te)}if((2==on||3==on)&&(e=666),0==on||2==on)return 0===n.avail_out&&(r=-1),0;if(1==on){if(1==Te)!function Ws(){Rn(2,3),zi(256,Ji.static_ltree),eo(),1+$t+10-In<9&&(Rn(2,3),zi(256,Ji.static_ltree),eo()),$t=7}();else if(Ru(0,0,!1),3==Te)for(ye=0;ye<f;ye++)d[ye]=0;if(n.flush_pending(),0===n.avail_out)return r=-1,0}}return 4!=Te?0:1}}function CO(){const t=this;t.next_in_index=0,t.next_out_index=0,t.avail_in=0,t.total_in=0,t.avail_out=0,t.total_out=0}CO.prototype={deflateInit(t,n){const e=this;return e.dstate=new yZ,n||(n=Oh),e.dstate.deflateInit(e,t,n)},deflate(t){const n=this;return n.dstate?n.dstate.deflate(n,t):-2},deflateEnd(){const t=this;if(!t.dstate)return-2;const n=t.dstate.deflateEnd();return t.dstate=null,n},deflateParams(t,n){const e=this;return e.dstate?e.dstate.deflateParams(e,t,n):-2},deflateSetDictionary(t,n){const e=this;return e.dstate?e.dstate.deflateSetDictionary(e,t,n):-2},read_buf(t,n,e){const i=this;let r=i.avail_in;return r>e&&(r=e),0===r?0:(i.avail_in-=r,t.set(i.next_in.subarray(i.next_in_index,i.next_in_index+r),n),i.next_in_index+=r,i.total_in+=r,r)},flush_pending(){const t=this;let n=t.dstate.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(t.next_out.set(t.dstate.pending_buf.subarray(t.dstate.pending_out,t.dstate.pending_out+n),t.next_out_index),t.next_out_index+=n,t.dstate.pending_out+=n,t.total_out+=n,t.avail_out-=n,t.dstate.pending-=n,0===t.dstate.pending&&(t.dstate.pending_out=0))}};const ln=0,va=1,Qr=-2,zn=-3,wO=-4,ya=-5,mo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],EO=1440,MZ=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],IZ=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],AZ=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],kZ=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],OZ=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],PZ=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Ga=15;function d1(){let n,e,i,r,o,s;function a(c,u,d,h,f,m,p,g,y,C,N){let $,H,z,X,ee,he,ae,se,we,Ce,Ie,Re,te,_e,ve;Ce=0,ee=d;do{i[c[u+Ce]]++,Ce++,ee--}while(0!==ee);if(i[0]==d)return p[0]=-1,g[0]=0,ln;for(se=g[0],he=1;he<=Ga&&0===i[he];he++);for(ae=he,se<he&&(se=he),ee=Ga;0!==ee&&0===i[ee];ee--);for(z=ee,se>ee&&(se=ee),g[0]=se,_e=1<<he;he<ee;he++,_e<<=1)if((_e-=i[he])<0)return zn;if((_e-=i[ee])<0)return zn;for(i[ee]+=_e,s[1]=he=0,Ce=1,te=2;0!=--ee;)s[te]=he+=i[Ce],te++,Ce++;ee=0,Ce=0;do{0!==(he=c[u+Ce])&&(N[s[he]++]=ee),Ce++}while(++ee<d);for(d=s[z],s[0]=ee=0,Ce=0,X=-1,Re=-se,o[0]=0,Ie=0,ve=0;ae<=z;ae++)for($=i[ae];0!=$--;){for(;ae>Re+se;){if(X++,Re+=se,ve=z-Re,ve=ve>se?se:ve,(H=1<<(he=ae-Re))>$+1&&(H-=$+1,te=ae,he<ve))for(;++he<ve&&!((H<<=1)<=i[++te]);)H-=i[te];if(ve=1<<he,C[0]+ve>EO)return zn;o[X]=Ie=C[0],C[0]+=ve,0!==X?(s[X]=ee,r[0]=he,r[1]=se,he=ee>>>Re-se,r[2]=Ie-o[X-1]-he,y.set(r,3*(o[X-1]+he))):p[0]=Ie}for(r[1]=ae-Re,Ce>=d?r[0]=192:N[Ce]<h?(r[0]=N[Ce]<256?0:96,r[2]=N[Ce++]):(r[0]=m[N[Ce]-h]+16+64,r[2]=f[N[Ce++]-h]),H=1<<ae-Re,he=ee>>>Re;he<ve;he+=H)y.set(r,3*(Ie+he));for(he=1<<ae-1;ee&he;he>>>=1)ee^=he;for(ee^=he,we=(1<<Re)-1;(ee&we)!=s[X];)X--,Re-=se,we=(1<<Re)-1}return 0!==_e&&1!=z?ya:ln}function l(c){let u;for(n||(n=[],e=[],i=new Int32Array(Ga+1),r=[],o=new Int32Array(Ga),s=new Int32Array(Ga+1)),e.length<c&&(e=[]),u=0;u<c;u++)e[u]=0;for(u=0;u<Ga+1;u++)i[u]=0;for(u=0;u<3;u++)r[u]=0;o.set(i.subarray(0,Ga),0),s.set(i.subarray(0,Ga+1),0)}this.inflate_trees_bits=function(c,u,d,h,f){let m;return l(19),n[0]=0,m=a(c,0,19,19,null,null,d,u,h,n,e),m==zn?f.msg="oversubscribed dynamic bit lengths tree":(m==ya||0===u[0])&&(f.msg="incomplete dynamic bit lengths tree",m=zn),m},this.inflate_trees_dynamic=function(c,u,d,h,f,m,p,g,y){let C;return l(288),n[0]=0,C=a(d,0,c,257,AZ,kZ,m,h,g,n,e),C!=ln||0===h[0]?(C==zn?y.msg="oversubscribed literal/length tree":C!=wO&&(y.msg="incomplete literal/length tree",C=zn),C):(l(288),C=a(d,c,u,0,OZ,PZ,p,f,g,n,e),C!=ln||0===f[0]&&c>257?(C==zn?y.msg="oversubscribed distance tree":C==ya?(y.msg="incomplete distance tree",C=zn):C!=wO&&(y.msg="empty distance tree with lengths",C=zn),C):ln)}}d1.inflate_trees_fixed=function(t,n,e,i){return t[0]=9,n[0]=5,e[0]=MZ,i[0]=IZ,ln};const hg=0,xO=1,TO=2,DO=3,SO=4,MO=5,IO=6,h1=7,AO=8,fg=9;function NZ(){const t=this;let n,i,d,f,e=0,r=0,o=0,s=0,a=0,l=0,c=0,u=0,h=0,m=0;function p(g,y,C,N,$,H,z,X){let ee,he,ae,se,we,Ce,Ie,Re,te,_e,ve,Ye,Oe,jt,Ge,mt;Ie=X.next_in_index,Re=X.avail_in,we=z.bitb,Ce=z.bitk,te=z.write,_e=te<z.read?z.read-te-1:z.end-te,ve=mo[g],Ye=mo[y];do{for(;Ce<20;)Re--,we|=(255&X.read_byte(Ie++))<<Ce,Ce+=8;if(ee=we&ve,he=C,ae=N,mt=3*(ae+ee),0!==(se=he[mt]))for(;;){if(we>>=he[mt+1],Ce-=he[mt+1],16&se){for(se&=15,Oe=he[mt+2]+(we&mo[se]),we>>=se,Ce-=se;Ce<15;)Re--,we|=(255&X.read_byte(Ie++))<<Ce,Ce+=8;for(ee=we&Ye,he=$,ae=H,mt=3*(ae+ee),se=he[mt];;){if(we>>=he[mt+1],Ce-=he[mt+1],16&se){for(se&=15;Ce<se;)Re--,we|=(255&X.read_byte(Ie++))<<Ce,Ce+=8;if(jt=he[mt+2]+(we&mo[se]),we>>=se,Ce-=se,_e-=Oe,te>=jt)Ge=te-jt,te-Ge>0&&2>te-Ge?(z.win[te++]=z.win[Ge++],z.win[te++]=z.win[Ge++],Oe-=2):(z.win.set(z.win.subarray(Ge,Ge+2),te),te+=2,Ge+=2,Oe-=2);else{Ge=te-jt;do{Ge+=z.end}while(Ge<0);if(se=z.end-Ge,Oe>se){if(Oe-=se,te-Ge>0&&se>te-Ge)do{z.win[te++]=z.win[Ge++]}while(0!=--se);else z.win.set(z.win.subarray(Ge,Ge+se),te),te+=se,Ge+=se,se=0;Ge=0}}if(te-Ge>0&&Oe>te-Ge)do{z.win[te++]=z.win[Ge++]}while(0!=--Oe);else z.win.set(z.win.subarray(Ge,Ge+Oe),te),te+=Oe,Ge+=Oe,Oe=0;break}if(64&se)return X.msg="invalid distance code",Oe=X.avail_in-Re,Oe=Ce>>3<Oe?Ce>>3:Oe,Re+=Oe,Ie-=Oe,Ce-=Oe<<3,z.bitb=we,z.bitk=Ce,X.avail_in=Re,X.total_in+=Ie-X.next_in_index,X.next_in_index=Ie,z.write=te,zn;ee+=he[mt+2],ee+=we&mo[se],mt=3*(ae+ee),se=he[mt]}break}if(64&se)return 32&se?(Oe=X.avail_in-Re,Oe=Ce>>3<Oe?Ce>>3:Oe,Re+=Oe,Ie-=Oe,Ce-=Oe<<3,z.bitb=we,z.bitk=Ce,X.avail_in=Re,X.total_in+=Ie-X.next_in_index,X.next_in_index=Ie,z.write=te,va):(X.msg="invalid literal/length code",Oe=X.avail_in-Re,Oe=Ce>>3<Oe?Ce>>3:Oe,Re+=Oe,Ie-=Oe,Ce-=Oe<<3,z.bitb=we,z.bitk=Ce,X.avail_in=Re,X.total_in+=Ie-X.next_in_index,X.next_in_index=Ie,z.write=te,zn);if(ee+=he[mt+2],ee+=we&mo[se],mt=3*(ae+ee),0===(se=he[mt])){we>>=he[mt+1],Ce-=he[mt+1],z.win[te++]=he[mt+2],_e--;break}}else we>>=he[mt+1],Ce-=he[mt+1],z.win[te++]=he[mt+2],_e--}while(_e>=258&&Re>=10);return Oe=X.avail_in-Re,Oe=Ce>>3<Oe?Ce>>3:Oe,Re+=Oe,Ie-=Oe,Ce-=Oe<<3,z.bitb=we,z.bitk=Ce,X.avail_in=Re,X.total_in+=Ie-X.next_in_index,X.next_in_index=Ie,z.write=te,ln}t.init=function(g,y,C,N,$,H){n=hg,c=g,u=y,d=C,h=N,f=$,m=H,i=null},t.proc=function(g,y,C){let N,$,H,he,ae,se,we,z=0,X=0,ee=0;for(ee=y.next_in_index,he=y.avail_in,z=g.bitb,X=g.bitk,ae=g.write,se=ae<g.read?g.read-ae-1:g.end-ae;;)switch(n){case hg:if(se>=258&&he>=10&&(g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,C=p(c,u,d,h,f,m,g,y),ee=y.next_in_index,he=y.avail_in,z=g.bitb,X=g.bitk,ae=g.write,se=ae<g.read?g.read-ae-1:g.end-ae,C!=ln)){n=C==va?h1:fg;break}o=c,i=d,r=h,n=xO;case xO:for(N=o;X<N;){if(0===he)return g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);C=ln,he--,z|=(255&y.read_byte(ee++))<<X,X+=8}if($=3*(r+(z&mo[N])),z>>>=i[$+1],X-=i[$+1],H=i[$],0===H){s=i[$+2],n=IO;break}if(16&H){a=15&H,e=i[$+2],n=TO;break}if(!(64&H)){o=H,r=$/3+i[$+2];break}if(32&H){n=h1;break}return n=fg,y.msg="invalid literal/length code",C=zn,g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);case TO:for(N=a;X<N;){if(0===he)return g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);C=ln,he--,z|=(255&y.read_byte(ee++))<<X,X+=8}e+=z&mo[N],z>>=N,X-=N,o=u,i=f,r=m,n=DO;case DO:for(N=o;X<N;){if(0===he)return g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);C=ln,he--,z|=(255&y.read_byte(ee++))<<X,X+=8}if($=3*(r+(z&mo[N])),z>>=i[$+1],X-=i[$+1],H=i[$],16&H){a=15&H,l=i[$+2],n=SO;break}if(!(64&H)){o=H,r=$/3+i[$+2];break}return n=fg,y.msg="invalid distance code",C=zn,g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);case SO:for(N=a;X<N;){if(0===he)return g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);C=ln,he--,z|=(255&y.read_byte(ee++))<<X,X+=8}l+=z&mo[N],z>>=N,X-=N,n=MO;case MO:for(we=ae-l;we<0;)we+=g.end;for(;0!==e;){if(0===se&&(ae==g.end&&0!==g.read&&(ae=0,se=ae<g.read?g.read-ae-1:g.end-ae),0===se&&(g.write=ae,C=g.inflate_flush(y,C),ae=g.write,se=ae<g.read?g.read-ae-1:g.end-ae,ae==g.end&&0!==g.read&&(ae=0,se=ae<g.read?g.read-ae-1:g.end-ae),0===se)))return g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);g.win[ae++]=g.win[we++],se--,we==g.end&&(we=0),e--}n=hg;break;case IO:if(0===se&&(ae==g.end&&0!==g.read&&(ae=0,se=ae<g.read?g.read-ae-1:g.end-ae),0===se&&(g.write=ae,C=g.inflate_flush(y,C),ae=g.write,se=ae<g.read?g.read-ae-1:g.end-ae,ae==g.end&&0!==g.read&&(ae=0,se=ae<g.read?g.read-ae-1:g.end-ae),0===se)))return g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);C=ln,g.win[ae++]=s,se--,n=hg;break;case h1:if(X>7&&(X-=8,he++,ee--),g.write=ae,C=g.inflate_flush(y,C),ae=g.write,se=ae<g.read?g.read-ae-1:g.end-ae,g.read!=g.write)return g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);n=AO;case AO:return C=va,g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);case fg:return C=zn,g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C);default:return C=Qr,g.bitb=z,g.bitk=X,y.avail_in=he,y.total_in+=ee-y.next_in_index,y.next_in_index=ee,g.write=ae,g.inflate_flush(y,C)}},t.free=function(){}}const kO=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xu=0,f1=1,OO=2,PO=3,NO=4,FO=5,pg=6,mg=7,RO=8,Kl=9;function FZ(t,n){const e=this;let a,i=xu,r=0,o=0,s=0;const l=[0],c=[0],u=new NZ;let d=0,h=new Int32Array(3*EO);const m=new d1;e.bitk=0,e.bitb=0,e.win=new Uint8Array(n),e.end=n,e.read=0,e.write=0,e.reset=function(p,g){g&&(g[0]=0),i==pg&&u.free(p),i=xu,e.bitk=0,e.bitb=0,e.read=e.write=0},e.reset(t,null),e.inflate_flush=function(p,g){let y,C,N;return C=p.next_out_index,N=e.read,y=(N<=e.write?e.write:e.end)-N,y>p.avail_out&&(y=p.avail_out),0!==y&&g==ya&&(g=ln),p.avail_out-=y,p.total_out+=y,p.next_out.set(e.win.subarray(N,N+y),C),C+=y,N+=y,N==e.end&&(N=0,e.write==e.end&&(e.write=0),y=e.write-N,y>p.avail_out&&(y=p.avail_out),0!==y&&g==ya&&(g=ln),p.avail_out-=y,p.total_out+=y,p.next_out.set(e.win.subarray(N,N+y),C),C+=y,N+=y),p.next_out_index=C,e.read=N,g},e.proc=function(p,g){let y,C,N,$,H,z,X,ee;for($=p.next_in_index,H=p.avail_in,C=e.bitb,N=e.bitk,z=e.write,X=z<e.read?e.read-z-1:e.end-z;;){let he,ae,se,we,Ce,Ie,Re,te;switch(i){case xu:for(;N<3;){if(0===H)return e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);g=ln,H--,C|=(255&p.read_byte($++))<<N,N+=8}switch(y=7&C,d=1&y,y>>>1){case 0:C>>>=3,N-=3,y=7&N,C>>>=y,N-=y,i=f1;break;case 1:he=[],ae=[],se=[[]],we=[[]],d1.inflate_trees_fixed(he,ae,se,we),u.init(he[0],ae[0],se[0],0,we[0],0),C>>>=3,N-=3,i=pg;break;case 2:C>>>=3,N-=3,i=PO;break;case 3:return C>>>=3,N-=3,i=Kl,p.msg="invalid block type",g=zn,e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g)}break;case f1:for(;N<32;){if(0===H)return e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);g=ln,H--,C|=(255&p.read_byte($++))<<N,N+=8}if((~C>>>16&65535)!=(65535&C))return i=Kl,p.msg="invalid stored block lengths",g=zn,e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);r=65535&C,C=N=0,i=0!==r?OO:0!==d?mg:xu;break;case OO:if(0===H||0===X&&(z==e.end&&0!==e.read&&(z=0,X=z<e.read?e.read-z-1:e.end-z),0===X&&(e.write=z,g=e.inflate_flush(p,g),z=e.write,X=z<e.read?e.read-z-1:e.end-z,z==e.end&&0!==e.read&&(z=0,X=z<e.read?e.read-z-1:e.end-z),0===X)))return e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);if(g=ln,y=r,y>H&&(y=H),y>X&&(y=X),e.win.set(p.read_buf($,y),z),$+=y,H-=y,z+=y,X-=y,0!=(r-=y))break;i=0!==d?mg:xu;break;case PO:for(;N<14;){if(0===H)return e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);g=ln,H--,C|=(255&p.read_byte($++))<<N,N+=8}if(o=y=16383&C,(31&y)>29||(y>>5&31)>29)return i=Kl,p.msg="too many length or distance symbols",g=zn,e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);if(y=258+(31&y)+(y>>5&31),!a||a.length<y)a=[];else for(ee=0;ee<y;ee++)a[ee]=0;C>>>=14,N-=14,s=0,i=NO;case NO:for(;s<4+(o>>>10);){for(;N<3;){if(0===H)return e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);g=ln,H--,C|=(255&p.read_byte($++))<<N,N+=8}a[kO[s++]]=7&C,C>>>=3,N-=3}for(;s<19;)a[kO[s++]]=0;if(l[0]=7,y=m.inflate_trees_bits(a,l,c,h,p),y!=ln)return(g=y)==zn&&(a=null,i=Kl),e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);s=0,i=FO;case FO:for(;y=o,!(s>=258+(31&y)+(y>>5&31));){let _e,ve;for(y=l[0];N<y;){if(0===H)return e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);g=ln,H--,C|=(255&p.read_byte($++))<<N,N+=8}if(y=h[3*(c[0]+(C&mo[y]))+1],ve=h[3*(c[0]+(C&mo[y]))+2],ve<16)C>>>=y,N-=y,a[s++]=ve;else{for(ee=18==ve?7:ve-14,_e=18==ve?11:3;N<y+ee;){if(0===H)return e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);g=ln,H--,C|=(255&p.read_byte($++))<<N,N+=8}if(C>>>=y,N-=y,_e+=C&mo[ee],C>>>=ee,N-=ee,ee=s,y=o,ee+_e>258+(31&y)+(y>>5&31)||16==ve&&ee<1)return a=null,i=Kl,p.msg="invalid bit length repeat",g=zn,e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);ve=16==ve?a[ee-1]:0;do{a[ee++]=ve}while(0!=--_e);s=ee}}if(c[0]=-1,Ce=[],Ie=[],Re=[],te=[],Ce[0]=9,Ie[0]=6,y=o,y=m.inflate_trees_dynamic(257+(31&y),1+(y>>5&31),a,Ce,Ie,Re,te,h,p),y!=ln)return y==zn&&(a=null,i=Kl),g=y,e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);u.init(Ce[0],Ie[0],h,Re[0],h,te[0]),i=pg;case pg:if(e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,(g=u.proc(e,p,g))!=va)return e.inflate_flush(p,g);if(g=ln,u.free(p),$=p.next_in_index,H=p.avail_in,C=e.bitb,N=e.bitk,z=e.write,X=z<e.read?e.read-z-1:e.end-z,0===d){i=xu;break}i=mg;case mg:if(e.write=z,g=e.inflate_flush(p,g),z=e.write,X=z<e.read?e.read-z-1:e.end-z,e.read!=e.write)return e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);i=RO;case RO:return g=va,e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);case Kl:return g=zn,e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g);default:return g=Qr,e.bitb=C,e.bitk=N,p.avail_in=H,p.total_in+=$-p.next_in_index,p.next_in_index=$,e.write=z,e.inflate_flush(p,g)}}},e.free=function(p){e.reset(p,null),e.win=null,h=null},e.set_dictionary=function(p,g,y){e.win.set(p.subarray(g,g+y),0),e.read=e.write=y},e.sync_point=function(){return i==f1?1:0}}const jZ=[0,0,255,255];function UZ(){const t=this;function n(e){return e&&e.istate?(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=7,e.istate.blocks.reset(e,null),ln):Qr}t.mode=0,t.method=0,t.was=[0],t.need=0,t.marker=0,t.wbits=0,t.inflateEnd=function(e){return t.blocks&&t.blocks.free(e),t.blocks=null,ln},t.inflateInit=function(e,i){return e.msg=null,t.blocks=null,i<8||i>15?(t.inflateEnd(e),Qr):(t.wbits=i,e.istate.blocks=new FZ(e,1<<i),n(e),ln)},t.inflate=function(e,i){let r,o;if(!e||!e.istate||!e.next_in)return Qr;const s=e.istate;for(i=4==i?ya:ln,r=ya;;)switch(s.mode){case 0:if(0===e.avail_in)return r;if(r=i,e.avail_in--,e.total_in++,8!=(15&(s.method=e.read_byte(e.next_in_index++)))){s.mode=13,e.msg="unknown compression method",s.marker=5;break}if(8+(s.method>>4)>s.wbits){s.mode=13,e.msg="invalid win size",s.marker=5;break}s.mode=1;case 1:if(0===e.avail_in)return r;if(r=i,e.avail_in--,e.total_in++,o=255&e.read_byte(e.next_in_index++),((s.method<<8)+o)%31!=0){s.mode=13,e.msg="incorrect header check",s.marker=5;break}if(!(32&o)){s.mode=7;break}s.mode=2;case 2:if(0===e.avail_in)return r;r=i,e.avail_in--,e.total_in++,s.need=(255&e.read_byte(e.next_in_index++))<<24&4278190080,s.mode=3;case 3:if(0===e.avail_in)return r;r=i,e.avail_in--,e.total_in++,s.need+=(255&e.read_byte(e.next_in_index++))<<16&16711680,s.mode=4;case 4:if(0===e.avail_in)return r;r=i,e.avail_in--,e.total_in++,s.need+=(255&e.read_byte(e.next_in_index++))<<8&65280,s.mode=5;case 5:return 0===e.avail_in?r:(r=i,e.avail_in--,e.total_in++,s.need+=255&e.read_byte(e.next_in_index++),s.mode=6,2);case 6:return s.mode=13,e.msg="need dictionary",s.marker=0,Qr;case 7:if(r=s.blocks.proc(e,r),r==zn){s.mode=13,s.marker=0;break}if(r==ln&&(r=i),r!=va)return r;r=i,s.blocks.reset(e,s.was),s.mode=12;case 12:return e.avail_in=0,va;case 13:return zn;default:return Qr}},t.inflateSetDictionary=function(e,i,r){let o=0,s=r;if(!e||!e.istate||6!=e.istate.mode)return Qr;const a=e.istate;return s>=1<<a.wbits&&(s=(1<<a.wbits)-1,o=r-s),a.blocks.set_dictionary(i,o,s),a.mode=7,ln},t.inflateSync=function(e){let i,r,o,s,a;if(!e||!e.istate)return Qr;const l=e.istate;if(13!=l.mode&&(l.mode=13,l.marker=0),0===(i=e.avail_in))return ya;for(r=e.next_in_index,o=l.marker;0!==i&&o<4;)e.read_byte(r)==jZ[o]?o++:o=0!==e.read_byte(r)?0:4-o,r++,i--;return e.total_in+=r-e.next_in_index,e.next_in_index=r,e.avail_in=i,l.marker=o,4!=o?zn:(s=e.total_in,a=e.total_out,n(e),e.total_in=s,e.total_out=a,l.mode=7,ln)},t.inflateSyncPoint=function(e){return e&&e.istate&&e.istate.blocks?e.istate.blocks.sync_point():Qr}}function zO(){}zO.prototype={inflateInit(t){const n=this;return n.istate=new UZ,t||(t=15),n.istate.inflateInit(n,t)},inflate(t){const n=this;return n.istate?n.istate.inflate(n,t):Qr},inflateEnd(){const t=this;if(!t.istate)return Qr;const n=t.istate.inflateEnd(t);return t.istate=null,n},inflateSync(){const t=this;return t.istate?t.istate.inflateSync(t):Qr},inflateSetDictionary(t,n){const e=this;return e.istate?e.istate.inflateSetDictionary(e,t,n):Qr},read_byte(t){return this.next_in[t]},read_buf(t,n){return this.next_in.subarray(t,t+n)}};const fi=4294967295,oi=65535,m1=134695760,HZ=m1,g1=33639248,ZO=101010256,_1=101075792,YO=117853008,XO=1,KO=39169,QO=10,JO=1,v1=21589,GZ=28789,$Z=25461,e3=6534,i3=new Date(2107,11,31),r3=new Date(1980,0,1),cn=void 0,Wa="undefined",jh="function";class o3{constructor(n){return class extends TransformStream{constructor(e,i){const r=new n(i);super({transform(o,s){s.enqueue(r.append(o))},flush(o){const s=r.flush();s&&o.enqueue(s)}})}}}}const ZZ=64;let s3=2;try{typeof navigator!=Wa&&navigator.hardwareConcurrency&&(s3=navigator.hardwareConcurrency)}catch{}const YZ={chunkSize:524288,maxWorkers:s3,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,workerScripts:cn,CompressionStreamNative:typeof CompressionStream!=Wa&&CompressionStream,DecompressionStreamNative:typeof DecompressionStream!=Wa&&DecompressionStream},qa=Object.assign({},YZ);function E1(){return qa}function a3(t){return Math.max(t.chunkSize,ZZ)}function x1(t){const{baseURL:n,chunkSize:e,maxWorkers:i,terminateWorkerTimeout:r,useCompressionStream:o,useWebWorkers:s,Deflate:a,Inflate:l,CompressionStream:c,DecompressionStream:u,workerScripts:d}=t;if(Za("baseURL",n),Za("chunkSize",e),Za("maxWorkers",i),Za("terminateWorkerTimeout",r),Za("useCompressionStream",o),Za("useWebWorkers",s),a&&(qa.CompressionStream=new o3(a)),l&&(qa.DecompressionStream=new o3(l)),Za("CompressionStream",c),Za("DecompressionStream",u),d!==cn){const{deflate:h,inflate:f}=d;if((h||f)&&(qa.workerScripts||(qa.workerScripts={})),h){if(!Array.isArray(h))throw new Error("workerScripts.deflate must be an array");qa.workerScripts.deflate=h}if(f){if(!Array.isArray(f))throw new Error("workerScripts.inflate must be an array");qa.workerScripts.inflate=f}}}function Za(t,n){n!==cn&&(qa[t]=n)}const T1={application:{"andrew-inset":"ez",annodex:"anx","atom+xml":"atom","atomcat+xml":"atomcat","atomserv+xml":"atomsrv",bbolin:"lin","cu-seeme":"cu","davmount+xml":"davmount",dsptype:"tsp",ecmascript:["es","ecma"],futuresplash:"spl",hta:"hta","java-archive":"jar","java-serialized-object":"ser","java-vm":"class",m3g:"m3g","mac-binhex40":"hqx",mathematica:["nb","ma","mb"],msaccess:"mdb",msword:["doc","dot","wiz"],mxf:"mxf",oda:"oda",ogg:"ogx",pdf:"pdf","pgp-keys":"key","pgp-signature":["asc","sig"],"pics-rules":"prf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],rar:"rar","rdf+xml":"rdf","rss+xml":"rss",rtf:"rtf","xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","xpdl"],"xspf+xml":"xspf",zip:"zip","vnd.android.package-archive":"apk","vnd.cinderella":"cdy","vnd.google-earth.kml+xml":"kml","vnd.google-earth.kmz":"kmz","vnd.mozilla.xul+xml":"xul","vnd.ms-excel":["xls","xlb","xlt","xlm","xla","xlc","xlw"],"vnd.ms-pki.seccat":"cat","vnd.ms-pki.stl":"stl","vnd.ms-powerpoint":["ppt","pps","pot","ppa","pwz"],"vnd.oasis.opendocument.chart":"odc","vnd.oasis.opendocument.database":"odb","vnd.oasis.opendocument.formula":"odf","vnd.oasis.opendocument.graphics":"odg","vnd.oasis.opendocument.graphics-template":"otg","vnd.oasis.opendocument.image":"odi","vnd.oasis.opendocument.presentation":"odp","vnd.oasis.opendocument.presentation-template":"otp","vnd.oasis.opendocument.spreadsheet":"ods","vnd.oasis.opendocument.spreadsheet-template":"ots","vnd.oasis.opendocument.text":"odt","vnd.oasis.opendocument.text-master":["odm","otm"],"vnd.oasis.opendocument.text-template":"ott","vnd.oasis.opendocument.text-web":"oth","vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","vnd.openxmlformats-officedocument.spreadsheetml.template":"xltx","vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","vnd.openxmlformats-officedocument.presentationml.slideshow":"ppsx","vnd.openxmlformats-officedocument.presentationml.template":"potx","vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","vnd.openxmlformats-officedocument.wordprocessingml.template":"dotx","vnd.smaf":"mmf","vnd.stardivision.calc":"sdc","vnd.stardivision.chart":"sds","vnd.stardivision.draw":"sda","vnd.stardivision.impress":"sdd","vnd.stardivision.math":["sdf","smf"],"vnd.stardivision.writer":["sdw","vor"],"vnd.stardivision.writer-global":"sgl","vnd.sun.xml.calc":"sxc","vnd.sun.xml.calc.template":"stc","vnd.sun.xml.draw":"sxd","vnd.sun.xml.draw.template":"std","vnd.sun.xml.impress":"sxi","vnd.sun.xml.impress.template":"sti","vnd.sun.xml.math":"sxm","vnd.sun.xml.writer":"sxw","vnd.sun.xml.writer.global":"sxg","vnd.sun.xml.writer.template":"stw","vnd.symbian.install":["sis","sisx"],"vnd.visio":["vsd","vst","vss","vsw","vsdx","vssx","vstx","vssm","vstm"],"vnd.wap.wbxml":"wbxml","vnd.wap.wmlc":"wmlc","vnd.wap.wmlscriptc":"wmlsc","vnd.wordperfect":"wpd","vnd.wordperfect5.1":"wp5","x-123":"wk","x-7z-compressed":"7z","x-abiword":"abw","x-apple-diskimage":"dmg","x-bcpio":"bcpio","x-bittorrent":"torrent","x-cbr":["cbr","cba","cbt","cb7"],"x-cbz":"cbz","x-cdf":["cdf","cda"],"x-cdlink":"vcd","x-chess-pgn":"pgn","x-cpio":"cpio","x-csh":"csh","x-director":["dir","dxr","cst","cct","cxt","w3d","fgd","swa"],"x-dms":"dms","x-doom":"wad","x-dvi":"dvi","x-httpd-eruby":"rhtml","x-font":"pcf.Z","x-freemind":"mm","x-gnumeric":"gnumeric","x-go-sgf":"sgf","x-graphing-calculator":"gcf","x-gtar":["gtar","taz"],"x-hdf":"hdf","x-httpd-php":["phtml","pht","php"],"x-httpd-php-source":"phps","x-httpd-php3":"php3","x-httpd-php3-preprocessed":"php3p","x-httpd-php4":"php4","x-httpd-php5":"php5","x-ica":"ica","x-info":"info","x-internet-signup":["ins","isp"],"x-iphone":"iii","x-iso9660-image":"iso","x-java-jnlp-file":"jnlp","x-jmol":"jmz","x-killustrator":"kil","x-latex":"latex","x-lyx":"lyx","x-lzx":"lzx","x-maker":["frm","fb","fbdoc"],"x-ms-wmd":"wmd","x-msdos-program":["com","exe","bat","dll"],"x-netcdf":["nc"],"x-ns-proxy-autoconfig":["pac","dat"],"x-nwc":"nwc","x-object":"o","x-oz-application":"oza","x-pkcs7-certreqresp":"p7r","x-python-code":["pyc","pyo"],"x-qgis":["qgs","shp","shx"],"x-quicktimeplayer":"qtl","x-redhat-package-manager":["rpm","rpa"],"x-ruby":"rb","x-sh":"sh","x-shar":"shar","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","x-stuffit":"sit","x-sv4cpio":"sv4cpio","x-sv4crc":"sv4crc","x-tar":"tar","x-tex-gf":"gf","x-tex-pk":"pk","x-texinfo":["texinfo","texi"],"x-trash":["~","%","bak","old","sik"],"x-ustar":"ustar","x-wais-source":"src","x-wingz":"wz","x-x509-ca-cert":["crt","der","cer"],"x-xcf":"xcf","x-xfig":"fig","x-xpinstall":"xpi",applixware:"aw","atomsvc+xml":"atomsvc","ccxml+xml":"ccxml","cdmi-capability":"cdmia","cdmi-container":"cdmic","cdmi-domain":"cdmid","cdmi-object":"cdmio","cdmi-queue":"cdmiq","docbook+xml":"dbk","dssc+der":"dssc","dssc+xml":"xdssc","emma+xml":"emma","epub+zip":"epub",exi:"exi","font-tdpfr":"pfr","gml+xml":"gml","gpx+xml":"gpx",gxf:"gxf",hyperstudio:"stk","inkml+xml":["ink","inkml"],ipfix:"ipfix","jsonml+json":"jsonml","lost+xml":"lostxml","mads+xml":"mads",marc:"mrc","marcxml+xml":"mrcx","mathml+xml":["mathml","mml"],mbox:"mbox","mediaservercontrol+xml":"mscml","metalink+xml":"metalink","metalink4+xml":"meta4","mets+xml":"mets","mods+xml":"mods",mp21:["m21","mp21"],mp4:"mp4s","oebps-package+xml":"opf","omdoc+xml":"omdoc",onenote:["onetoc","onetoc2","onetmp","onepkg"],oxps:"oxps","patch-ops-error+xml":"xer","pgp-encrypted":"pgp",pkcs10:"p10","pkcs7-mime":["p7m","p7c"],"pkcs7-signature":"p7s",pkcs8:"p8","pkix-attr-cert":"ac","pkix-crl":"crl","pkix-pkipath":"pkipath",pkixcmp:"pki","pls+xml":"pls","prs.cww":"cww","pskc+xml":"pskcxml","reginfo+xml":"rif","relax-ng-compact-syntax":"rnc","resource-lists+xml":"rl","resource-lists-diff+xml":"rld","rls-services+xml":"rs","rpki-ghostbusters":"gbr","rpki-manifest":"mft","rpki-roa":"roa","rsd+xml":"rsd","sbml+xml":"sbml","scvp-cv-request":"scq","scvp-cv-response":"scs","scvp-vp-request":"spq","scvp-vp-response":"spp",sdp:"sdp","set-payment-initiation":"setpay","set-registration-initiation":"setreg","shf+xml":"shf","sparql-query":"rq","sparql-results+xml":"srx",srgs:"gram","srgs+xml":"grxml","sru+xml":"sru","ssdl+xml":"ssdl","ssml+xml":"ssml","tei+xml":["tei","teicorpus"],"thraud+xml":"tfi","timestamped-data":"tsd","vnd.3gpp.pic-bw-large":"plb","vnd.3gpp.pic-bw-small":"psb","vnd.3gpp.pic-bw-var":"pvb","vnd.3gpp2.tcap":"tcap","vnd.3m.post-it-notes":"pwn","vnd.accpac.simply.aso":"aso","vnd.accpac.simply.imp":"imp","vnd.acucobol":"acu","vnd.acucorp":["atc","acutc"],"vnd.adobe.air-application-installer-package+zip":"air","vnd.adobe.formscentral.fcdt":"fcdt","vnd.adobe.fxp":["fxp","fxpl"],"vnd.adobe.xdp+xml":"xdp","vnd.adobe.xfdf":"xfdf","vnd.ahead.space":"ahead","vnd.airzip.filesecure.azf":"azf","vnd.airzip.filesecure.azs":"azs","vnd.amazon.ebook":"azw","vnd.americandynamics.acc":"acc","vnd.amiga.ami":"ami","vnd.anser-web-certificate-issue-initiation":"cii","vnd.anser-web-funds-transfer-initiation":"fti","vnd.antix.game-component":"atx","vnd.apple.installer+xml":"mpkg","vnd.apple.mpegurl":"m3u8","vnd.aristanetworks.swi":"swi","vnd.astraea-software.iota":"iota","vnd.audiograph":"aep","vnd.blueice.multipass":"mpm","vnd.bmi":"bmi","vnd.businessobjects":"rep","vnd.chemdraw+xml":"cdxml","vnd.chipnuts.karaoke-mmd":"mmd","vnd.claymore":"cla","vnd.cloanto.rp9":"rp9","vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"vnd.cluetrust.cartomobile-config":"c11amc","vnd.cluetrust.cartomobile-config-pkg":"c11amz","vnd.commonspace":"csp","vnd.contact.cmsg":"cdbcmsg","vnd.cosmocaller":"cmc","vnd.crick.clicker":"clkx","vnd.crick.clicker.keyboard":"clkk","vnd.crick.clicker.palette":"clkp","vnd.crick.clicker.template":"clkt","vnd.crick.clicker.wordbank":"clkw","vnd.criticaltools.wbs+xml":"wbs","vnd.ctc-posml":"pml","vnd.cups-ppd":"ppd","vnd.curl.car":"car","vnd.curl.pcurl":"pcurl","vnd.dart":"dart","vnd.data-vision.rdz":"rdz","vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"vnd.dece.ttml+xml":["uvt","uvvt"],"vnd.dece.unspecified":["uvx","uvvx"],"vnd.dece.zip":["uvz","uvvz"],"vnd.denovo.fcselayout-link":"fe_launch","vnd.dna":"dna","vnd.dolby.mlp":"mlp","vnd.dpgraph":"dpg","vnd.dreamfactory":"dfac","vnd.ds-keypoint":"kpxx","vnd.dvb.ait":"ait","vnd.dvb.service":"svc","vnd.dynageo":"geo","vnd.ecowin.chart":"mag","vnd.enliven":"nml","vnd.epson.esf":"esf","vnd.epson.msf":"msf","vnd.epson.quickanime":"qam","vnd.epson.salt":"slt","vnd.epson.ssf":"ssf","vnd.eszigno3+xml":["es3","et3"],"vnd.ezpix-album":"ez2","vnd.ezpix-package":"ez3","vnd.fdf":"fdf","vnd.fdsn.mseed":"mseed","vnd.fdsn.seed":["seed","dataless"],"vnd.flographit":"gph","vnd.fluxtime.clip":"ftc","vnd.framemaker":["fm","frame","maker","book"],"vnd.frogans.fnc":"fnc","vnd.frogans.ltf":"ltf","vnd.fsc.weblaunch":"fsc","vnd.fujitsu.oasys":"oas","vnd.fujitsu.oasys2":"oa2","vnd.fujitsu.oasys3":"oa3","vnd.fujitsu.oasysgp":"fg5","vnd.fujitsu.oasysprs":"bh2","vnd.fujixerox.ddd":"ddd","vnd.fujixerox.docuworks":"xdw","vnd.fujixerox.docuworks.binder":"xbd","vnd.fuzzysheet":"fzs","vnd.genomatix.tuxedo":"txd","vnd.geogebra.file":"ggb","vnd.geogebra.tool":"ggt","vnd.geometry-explorer":["gex","gre"],"vnd.geonext":"gxt","vnd.geoplan":"g2w","vnd.geospace":"g3w","vnd.gmx":"gmx","vnd.grafeq":["gqf","gqs"],"vnd.groove-account":"gac","vnd.groove-help":"ghf","vnd.groove-identity-message":"gim","vnd.groove-injector":"grv","vnd.groove-tool-message":"gtm","vnd.groove-tool-template":"tpl","vnd.groove-vcard":"vcg","vnd.hal+xml":"hal","vnd.handheld-entertainment+xml":"zmm","vnd.hbci":"hbci","vnd.hhe.lesson-player":"les","vnd.hp-hpgl":"hpgl","vnd.hp-hpid":"hpid","vnd.hp-hps":"hps","vnd.hp-jlyt":"jlt","vnd.hp-pcl":"pcl","vnd.hp-pclxl":"pclxl","vnd.hydrostatix.sof-data":"sfd-hdstx","vnd.ibm.minipay":"mpy","vnd.ibm.modcap":["afp","listafp","list3820"],"vnd.ibm.rights-management":"irm","vnd.ibm.secure-container":"sc","vnd.iccprofile":["icc","icm"],"vnd.igloader":"igl","vnd.immervision-ivp":"ivp","vnd.immervision-ivu":"ivu","vnd.insors.igm":"igm","vnd.intercon.formnet":["xpw","xpx"],"vnd.intergeo":"i2g","vnd.intu.qbo":"qbo","vnd.intu.qfx":"qfx","vnd.ipunplugged.rcprofile":"rcprofile","vnd.irepository.package+xml":"irp","vnd.is-xpr":"xpr","vnd.isac.fcs":"fcs","vnd.jam":"jam","vnd.jcp.javame.midlet-rms":"rms","vnd.jisp":"jisp","vnd.joost.joda-archive":"joda","vnd.kahootz":["ktz","ktr"],"vnd.kde.karbon":"karbon","vnd.kde.kchart":"chrt","vnd.kde.kformula":"kfo","vnd.kde.kivio":"flw","vnd.kde.kontour":"kon","vnd.kde.kpresenter":["kpr","kpt"],"vnd.kde.kspread":"ksp","vnd.kde.kword":["kwd","kwt"],"vnd.kenameaapp":"htke","vnd.kidspiration":"kia","vnd.kinar":["kne","knp"],"vnd.koan":["skp","skd","skt","skm"],"vnd.kodak-descriptor":"sse","vnd.las.las+xml":"lasxml","vnd.llamagraphics.life-balance.desktop":"lbd","vnd.llamagraphics.life-balance.exchange+xml":"lbe","vnd.lotus-1-2-3":"123","vnd.lotus-approach":"apr","vnd.lotus-freelance":"pre","vnd.lotus-notes":"nsf","vnd.lotus-organizer":"org","vnd.lotus-screencam":"scm","vnd.lotus-wordpro":"lwp","vnd.macports.portpkg":"portpkg","vnd.mcd":"mcd","vnd.medcalcdata":"mc1","vnd.mediastation.cdkey":"cdkey","vnd.mfer":"mwf","vnd.mfmp":"mfm","vnd.micrografx.flo":"flo","vnd.micrografx.igx":"igx","vnd.mif":"mif","vnd.mobius.daf":"daf","vnd.mobius.dis":"dis","vnd.mobius.mbk":"mbk","vnd.mobius.mqy":"mqy","vnd.mobius.msl":"msl","vnd.mobius.plc":"plc","vnd.mobius.txf":"txf","vnd.mophun.application":"mpn","vnd.mophun.certificate":"mpc","vnd.ms-artgalry":"cil","vnd.ms-cab-compressed":"cab","vnd.ms-excel.addin.macroenabled.12":"xlam","vnd.ms-excel.sheet.binary.macroenabled.12":"xlsb","vnd.ms-excel.sheet.macroenabled.12":"xlsm","vnd.ms-excel.template.macroenabled.12":"xltm","vnd.ms-fontobject":"eot","vnd.ms-htmlhelp":"chm","vnd.ms-ims":"ims","vnd.ms-lrm":"lrm","vnd.ms-officetheme":"thmx","vnd.ms-powerpoint.addin.macroenabled.12":"ppam","vnd.ms-powerpoint.presentation.macroenabled.12":"pptm","vnd.ms-powerpoint.slide.macroenabled.12":"sldm","vnd.ms-powerpoint.slideshow.macroenabled.12":"ppsm","vnd.ms-powerpoint.template.macroenabled.12":"potm","vnd.ms-project":["mpp","mpt"],"vnd.ms-word.document.macroenabled.12":"docm","vnd.ms-word.template.macroenabled.12":"dotm","vnd.ms-works":["wps","wks","wcm","wdb"],"vnd.ms-wpl":"wpl","vnd.ms-xpsdocument":"xps","vnd.mseq":"mseq","vnd.musician":"mus","vnd.muvee.style":"msty","vnd.mynfc":"taglet","vnd.neurolanguage.nlu":"nlu","vnd.nitf":["ntf","nitf"],"vnd.noblenet-directory":"nnd","vnd.noblenet-sealer":"nns","vnd.noblenet-web":"nnw","vnd.nokia.n-gage.data":"ngdat","vnd.nokia.n-gage.symbian.install":"n-gage","vnd.nokia.radio-preset":"rpst","vnd.nokia.radio-presets":"rpss","vnd.novadigm.edm":"edm","vnd.novadigm.edx":"edx","vnd.novadigm.ext":"ext","vnd.oasis.opendocument.chart-template":"otc","vnd.oasis.opendocument.formula-template":"odft","vnd.oasis.opendocument.image-template":"oti","vnd.olpc-sugar":"xo","vnd.oma.dd2+xml":"dd2","vnd.openofficeorg.extension":"oxt","vnd.openxmlformats-officedocument.presentationml.slide":"sldx","vnd.osgeo.mapguide.package":"mgp","vnd.osgi.dp":"dp","vnd.osgi.subsystem":"esa","vnd.palm":["pdb","pqa","oprc"],"vnd.pawaafile":"paw","vnd.pg.format":"str","vnd.pg.osasli":"ei6","vnd.picsel":"efif","vnd.pmi.widget":"wg","vnd.pocketlearn":"plf","vnd.powerbuilder6":"pbd","vnd.previewsystems.box":"box","vnd.proteus.magazine":"mgz","vnd.publishare-delta-tree":"qps","vnd.pvi.ptid1":"ptid","vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"vnd.realvnc.bed":"bed","vnd.recordare.musicxml":"mxl","vnd.recordare.musicxml+xml":"musicxml","vnd.rig.cryptonote":"cryptonote","vnd.rn-realmedia":"rm","vnd.rn-realmedia-vbr":"rmvb","vnd.route66.link66+xml":"link66","vnd.sailingtracker.track":"st","vnd.seemail":"see","vnd.sema":"sema","vnd.semd":"semd","vnd.semf":"semf","vnd.shana.informed.formdata":"ifm","vnd.shana.informed.formtemplate":"itp","vnd.shana.informed.interchange":"iif","vnd.shana.informed.package":"ipk","vnd.simtech-mindmapper":["twd","twds"],"vnd.smart.teacher":"teacher","vnd.solent.sdkm+xml":["sdkm","sdkd"],"vnd.spotfire.dxp":"dxp","vnd.spotfire.sfs":"sfs","vnd.stepmania.package":"smzip","vnd.stepmania.stepchart":"sm","vnd.sus-calendar":["sus","susp"],"vnd.svd":"svd","vnd.syncml+xml":"xsm","vnd.syncml.dm+wbxml":"bdm","vnd.syncml.dm+xml":"xdm","vnd.tao.intent-module-archive":"tao","vnd.tcpdump.pcap":["pcap","cap","dmp"],"vnd.tmobile-livetv":"tmo","vnd.trid.tpt":"tpt","vnd.triscape.mxs":"mxs","vnd.trueapp":"tra","vnd.ufdl":["ufd","ufdl"],"vnd.uiq.theme":"utz","vnd.umajin":"umj","vnd.unity":"unityweb","vnd.uoml+xml":"uoml","vnd.vcx":"vcx","vnd.visionary":"vis","vnd.vsf":"vsf","vnd.webturbo":"wtb","vnd.wolfram.player":"nbp","vnd.wqd":"wqd","vnd.wt.stf":"stf","vnd.xara":"xar","vnd.xfdl":"xfdl","vnd.yamaha.hv-dic":"hvd","vnd.yamaha.hv-script":"hvs","vnd.yamaha.hv-voice":"hvp","vnd.yamaha.openscoreformat":"osf","vnd.yamaha.openscoreformat.osfpvg+xml":"osfpvg","vnd.yamaha.smaf-audio":"saf","vnd.yamaha.smaf-phrase":"spf","vnd.yellowriver-custom-menu":"cmp","vnd.zul":["zir","zirz"],"vnd.zzazz.deck+xml":"zaz","voicexml+xml":"vxml",widget:"wgt",winhlp:"hlp","wsdl+xml":"wsdl","wspolicy+xml":"wspolicy","x-ace-compressed":"ace","x-authorware-bin":["aab","x32","u32","vox"],"x-authorware-map":"aam","x-authorware-seg":"aas","x-blorb":["blb","blorb"],"x-bzip":"bz","x-bzip2":["bz2","boz"],"x-cfs-compressed":"cfs","x-chat":"chat","x-conference":"nsc","x-dgc-compressed":"dgc","x-dtbncx+xml":"ncx","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-eva":"eva","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-freearc":"arc","x-gca-compressed":"gca","x-glulx":"ulx","x-gramps-xml":"gramps","x-install-instructions":"install","x-lzh-compressed":["lzh","lha"],"x-mie":"mie","x-mobipocket-ebook":["prc","mobi"],"x-ms-application":"application","x-ms-shortcut":"lnk","x-ms-xbap":"xbap","x-msbinder":"obd","x-mscardfile":"crd","x-msclip":"clp","application/x-ms-installer":"msi","x-msmediaview":["mvb","m13","m14"],"x-msmetafile":["wmf","wmz","emf","emz"],"x-msmoney":"mny","x-mspublisher":"pub","x-msschedule":"scd","x-msterminal":"trm","x-mswrite":"wri","x-nzb":"nzb","x-pkcs12":["p12","pfx"],"x-pkcs7-certificates":["p7b","spc"],"x-research-info-systems":"ris","x-silverlight-app":"xap","x-sql":"sql","x-stuffitx":"sitx","x-subrip":"srt","x-t3vm-image":"t3","x-tex-tfm":"tfm","x-tgif":"obj","x-xliff+xml":"xlf","x-xz":"xz","x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"xaml+xml":"xaml","xcap-diff+xml":"xdf","xenc+xml":"xenc","xml-dtd":"dtd","xop+xml":"xop","xproc+xml":"xpl","xslt+xml":"xslt","xv+xml":["mxml","xhvml","xvml","xvm"],yang:"yang","yin+xml":"yin",envoy:"evy",fractals:"fif","internet-property-stream":"acx",olescript:"axs","vnd.ms-outlook":"msg","vnd.ms-pkicertstore":"sst","x-compress":"z","x-perfmon":["pma","pmc","pmr","pmw"],"ynd.ms-pkipko":"pko",gzip:["gz","tgz"],"smil+xml":["smi","smil"],"vnd.debian.binary-package":["deb","udeb"],"vnd.hzn-3d-crossword":"x3d","vnd.sqlite3":["db","sqlite","sqlite3","db-wal","sqlite-wal","db-shm","sqlite-shm"],"vnd.wap.sic":"sic","vnd.wap.slc":"slc","x-krita":["kra","krz"],"x-perl":["pm","pl"],yaml:["yaml","yml"]},audio:{amr:"amr","amr-wb":"awb",annodex:"axa",basic:["au","snd"],flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"prs.sid":"sid","x-aiff":"aifc","x-gsm":"gsm","x-ms-wma":"wma","x-ms-wax":"wax","x-pn-realaudio":"ram","x-realaudio":"ra","x-sd2":"sd2",adpcm:"adp",mp4:"mp4a",s3m:"s3m",silk:"sil","vnd.dece.audio":["uva","uvva"],"vnd.digital-winds":"eol","vnd.dra":"dra","vnd.dts":"dts","vnd.dts.hd":"dtshd","vnd.lucent.voice":"lvp","vnd.ms-playready.media.pya":"pya","vnd.nuera.ecelp4800":"ecelp4800","vnd.nuera.ecelp7470":"ecelp7470","vnd.nuera.ecelp9600":"ecelp9600","vnd.rip":"rip",webm:"weba","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",aac:"aac",aiff:["aiff","aif","aff"],opus:"opus",wav:"wav"},chemical:{"x-alchemy":"alc","x-cache":["cac","cache"],"x-cache-csf":"csf","x-cactvs-binary":["cbin","cascii","ctab"],"x-cdx":"cdx","x-chem3d":"c3d","x-cif":"cif","x-cmdf":"cmdf","x-cml":"cml","x-compass":"cpa","x-crossfire":"bsd","x-csml":["csml","csm"],"x-ctx":"ctx","x-cxf":["cxf","cef"],"x-embl-dl-nucleotide":["emb","embl"],"x-gamess-input":["inp","gam","gamin"],"x-gaussian-checkpoint":["fch","fchk"],"x-gaussian-cube":"cub","x-gaussian-input":["gau","gjc","gjf"],"x-gaussian-log":"gal","x-gcg8-sequence":"gcg","x-genbank":"gen","x-hin":"hin","x-isostar":["istr","ist"],"x-jcamp-dx":["jdx","dx"],"x-kinemage":"kin","x-macmolecule":"mcm","x-macromodel-input":"mmod","x-mdl-molfile":"mol","x-mdl-rdfile":"rd","x-mdl-rxnfile":"rxn","x-mdl-sdfile":"sd","x-mdl-tgf":"tgf","x-mmcif":"mcif","x-mol2":"mol2","x-molconn-Z":"b","x-mopac-graph":"gpt","x-mopac-input":["mop","mopcrt","zmt"],"x-mopac-out":"moo","x-ncbi-asn1":"asn","x-ncbi-asn1-ascii":["prt","ent"],"x-ncbi-asn1-binary":"val","x-rosdal":"ros","x-swissprot":"sw","x-vamas-iso14976":"vms","x-vmd":"vmd","x-xtel":"xtel","x-xyz":"xyz"},font:{otf:"otf",woff:"woff",woff2:"woff2"},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe","jfif","jfif-tbnl","jif"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"vnd.djvu":["djvu","djv"],"vnd.wap.wbmp":"wbmp","x-canon-cr2":"cr2","x-canon-crw":"crw","x-cmu-raster":"ras","x-coreldraw":"cdr","x-coreldrawpattern":"pat","x-coreldrawtemplate":"cdt","x-corelphotopaint":"cpt","x-epson-erf":"erf","x-icon":"ico","x-jg":"art","x-jng":"jng","x-nikon-nef":"nef","x-olympus-orf":"orf","x-portable-anymap":"pnm","x-portable-bitmap":"pbm","x-portable-graymap":"pgm","x-portable-pixmap":"ppm","x-rgb":"rgb","x-xbitmap":"xbm","x-xpixmap":"xpm","x-xwindowdump":"xwd",bmp:"bmp",cgm:"cgm",g3fax:"g3",ktx:"ktx","prs.btif":"btif",sgi:"sgi","vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"vnd.dwg":"dwg","vnd.dxf":"dxf","vnd.fastbidsheet":"fbs","vnd.fpx":"fpx","vnd.fst":"fst","vnd.fujixerox.edmics-mmr":"mmr","vnd.fujixerox.edmics-rlc":"rlc","vnd.ms-modi":"mdi","vnd.ms-photo":"wdp","vnd.net-fpx":"npx","vnd.xiff":"xif",webp:"webp","x-3ds":"3ds","x-cmx":"cmx","x-freehand":["fh","fhc","fh4","fh5","fh7"],"x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod",avif:"avifs",heic:["heif","heic"],pjpeg:["pjpg"],"vnd.adobe.photoshop":"psd","x-adobe-dng":"dng","x-fuji-raf":"raf","x-icns":"icns","x-kodak-dcr":"dcr","x-kodak-k25":"k25","x-kodak-kdc":"kdc","x-minolta-mrw":"mrw","x-panasonic-raw":["raw","rw2","rwl"],"x-pentax-pef":["pef","ptx"],"x-sigma-x3f":"x3f","x-sony-arw":"arw","x-sony-sr2":"sr2","x-sony-srf":"srf"},message:{rfc822:["eml","mime","mht","mhtml","nws"]},model:{iges:["igs","iges"],mesh:["msh","mesh","silo"],vrml:["wrl","vrml"],"x3d+vrml":["x3dv","x3dvz"],"x3d+xml":"x3dz","x3d+binary":["x3db","x3dbz"],"vnd.collada+xml":"dae","vnd.dwf":"dwf","vnd.gdl":"gdl","vnd.gtw":"gtw","vnd.mts":"mts","vnd.usdz+zip":"usdz","vnd.vtu":"vtu"},text:{"cache-manifest":["manifest","appcache"],calendar:["ics","icz","ifb"],css:"css",csv:"csv",h323:"323",html:["html","htm","shtml","stm"],iuls:"uls",plain:["txt","text","brf","conf","def","list","log","in","bas","diff","ksh"],richtext:"rtx",scriptlet:["sct","wsc"],texmacs:"tm","tab-separated-values":"tsv","vnd.sun.j2me.app-descriptor":"jad","vnd.wap.wml":"wml","vnd.wap.wmlscript":"wmls","x-bibtex":"bib","x-boo":"boo","x-c++hdr":["h++","hpp","hxx","hh"],"x-c++src":["c++","cpp","cxx","cc"],"x-component":"htc","x-dsrc":"d","x-diff":"patch","x-haskell":"hs","x-java":"java","x-literate-haskell":"lhs","x-moc":"moc","x-pascal":["p","pas","pp","inc"],"x-pcs-gcd":"gcd","x-python":"py","x-scala":"scala","x-setext":"etx","x-tcl":["tcl","tk"],"x-tex":["tex","ltx","sty","cls"],"x-vcalendar":"vcs","x-vcard":"vcf",n3:"n3","prs.lines.tag":"dsc",sgml:["sgml","sgm"],troff:["t","tr","roff","man","me","ms"],turtle:"ttl","uri-list":["uri","uris","urls"],vcard:"vcard","vnd.curl":"curl","vnd.curl.dcurl":"dcurl","vnd.curl.scurl":"scurl","vnd.curl.mcurl":"mcurl","vnd.dvb.subtitle":"sub","vnd.fly":"fly","vnd.fmi.flexstor":"flx","vnd.graphviz":"gv","vnd.in3d.3dml":"3dml","vnd.in3d.spot":"spot","x-asm":["s","asm"],"x-c":["c","h","dic"],"x-fortran":["f","for","f77","f90"],"x-opml":"opml","x-nfo":"nfo","x-sfv":"sfv","x-uuencode":"uu",webviewhtml:"htt",javascript:"js",json:"json",markdown:["md","markdown","mdown","markdn"],"vnd.wap.si":"si","vnd.wap.sl":"sl"},video:{avif:"avif","3gpp":"3gp",annodex:"axv",dl:"dl",dv:["dif","dv"],fli:"fli",gl:"gl",mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.dece.hd":["uvh","uvvh"],"vnd.dece.mobile":["uvm","uvvm"],"vnd.dece.pd":["uvp","uvvp"],"vnd.dece.sd":["uvs","uvvs"],"vnd.dece.video":["uvv","uvvv"],"vnd.dvb.file":"dvb","vnd.fvt":"fvt","vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv",mp2t:"ts"},"x-conference":{"x-cooltalk":"ice"},"x-world":{"x-vrml":["vrm","flr","wrz","xaf","xof"]}};(()=>{const t={};for(const n of Object.keys(T1))for(const e of Object.keys(T1[n])){const i=T1[n][e];if("string"==typeof i)t[i]=n+"/"+e;else for(let r=0;r<i.length;r++)t[i[r]]=n+"/"+e}})();const l3=[];for(let t=0;t<256;t++){let n=t;for(let e=0;e<8;e++)1&n?n=n>>>1^3988292384:n>>>=1;l3[t]=n}class _g{constructor(n){this.crc=n||-1}append(n){let e=0|this.crc;for(let i=0,r=0|n.length;i<r;i++)e=e>>>8^l3[255&(e^n[i])];this.crc=e}get(){return~this.crc}}class c3 extends TransformStream{constructor(){let n;const e=new _g;super({transform(i,r){e.append(i),r.enqueue(i)},flush(){const i=new Uint8Array(4);new DataView(i.buffer).setUint32(0,e.get()),n.value=i}}),n=this}}function vg(t){if(typeof TextEncoder==Wa){t=unescape(encodeURIComponent(t));const n=new Uint8Array(t.length);for(let e=0;e<n.length;e++)n[e]=t.charCodeAt(e);return n}return(new TextEncoder).encode(t)}const Pr={concat(t,n){if(0===t.length||0===n.length)return t.concat(n);const e=t[t.length-1],i=Pr.getPartial(e);return 32===i?t.concat(n):Pr._shiftRight(n,i,0|e,t.slice(0,t.length-1))},bitLength(t){const n=t.length;return 0===n?0:32*(n-1)+Pr.getPartial(t[n-1])},clamp(t,n){if(32*t.length<n)return t;const e=(t=t.slice(0,Math.ceil(n/32))).length;return n&=31,e>0&&n&&(t[e-1]=Pr.partial(n,t[e-1]&2147483648>>n-1,1)),t},partial:(t,n,e)=>32===t?n:(e?0|n:n<<32-t)+1099511627776*t,getPartial:t=>Math.round(t/1099511627776)||32,_shiftRight(t,n,e,i){for(void 0===i&&(i=[]);n>=32;n-=32)i.push(e),e=0;if(0===n)return i.concat(t);for(let s=0;s<t.length;s++)i.push(e|t[s]>>>n),e=t[s]<<32-n;const o=Pr.getPartial(t.length?t[t.length-1]:0);return i.push(Pr.partial(n+o&31,n+o>32?e:i.pop(),1)),i}},yg={bytes:{fromBits(t){const e=Pr.bitLength(t)/8,i=new Uint8Array(e);let r;for(let o=0;o<e;o++)3&o||(r=t[o/4]),i[o]=r>>>24,r<<=8;return i},toBits(t){const n=[];let e,i=0;for(e=0;e<t.length;e++)i=i<<8|t[e],!(3&~e)&&(n.push(i),i=0);return 3&e&&n.push(Pr.partial(8*(3&e),i)),n}}},u3_sha1=class{constructor(t){const n=this;n.blockSize=512,n._init=[1732584193,4023233417,2562383102,271733878,3285377520],n._key=[1518500249,1859775393,2400959708,3395469782],t?(n._h=t._h.slice(0),n._buffer=t._buffer.slice(0),n._length=t._length):n.reset()}reset(){const t=this;return t._h=t._init.slice(0),t._buffer=[],t._length=0,t}update(t){const n=this;"string"==typeof t&&(t=yg.utf8String.toBits(t));const e=n._buffer=Pr.concat(n._buffer,t),i=n._length,r=n._length=i+Pr.bitLength(t);if(r>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");const o=new Uint32Array(e);let s=0;for(let a=n.blockSize+i-(n.blockSize+i&n.blockSize-1);a<=r;a+=n.blockSize)n._block(o.subarray(16*s,16*(s+1))),s+=1;return e.splice(0,16*s),n}finalize(){const t=this;let n=t._buffer;const e=t._h;n=Pr.concat(n,[Pr.partial(1,1)]);for(let i=n.length+2;15&i;i++)n.push(0);for(n.push(Math.floor(t._length/4294967296)),n.push(0|t._length);n.length;)t._block(n.splice(0,16));return t.reset(),e}_f(t,n,e,i){return t<=19?n&e|~n&i:t<=39?n^e^i:t<=59?n&e|n&i|e&i:t<=79?n^e^i:void 0}_S(t,n){return n<<t|n>>>32-t}_block(t){const n=this,e=n._h,i=Array(80);for(let c=0;c<16;c++)i[c]=t[c];let r=e[0],o=e[1],s=e[2],a=e[3],l=e[4];for(let c=0;c<=79;c++){c>=16&&(i[c]=n._S(1,i[c-3]^i[c-8]^i[c-14]^i[c-16]));const u=n._S(5,r)+n._f(c,o,s,a)+l+i[c]+n._key[Math.floor(c/20)]|0;l=a,a=s,s=n._S(30,o),o=r,r=u}e[0]=e[0]+r|0,e[1]=e[1]+o|0,e[2]=e[2]+s|0,e[3]=e[3]+a|0,e[4]=e[4]+l|0}},d3_aes=class{constructor(t){const n=this;n._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],n._tables[0][0][0]||n._precompute();const e=n._tables[0][4],i=n._tables[1],r=t.length;let o,s,a,l=1;if(4!==r&&6!==r&&8!==r)throw new Error("invalid aes key size");for(n._key=[s=t.slice(0),a=[]],o=r;o<4*r+28;o++){let c=s[o-1];(o%r==0||8===r&&o%r==4)&&(c=e[c>>>24]<<24^e[c>>16&255]<<16^e[c>>8&255]<<8^e[255&c],o%r==0&&(c=c<<8^c>>>24^l<<24,l=l<<1^283*(l>>7))),s[o]=s[o-r]^c}for(let c=0;o;c++,o--){const u=s[3&c?o:o-4];a[c]=o<=4||c<4?u:i[0][e[u>>>24]]^i[1][e[u>>16&255]]^i[2][e[u>>8&255]]^i[3][e[255&u]]}}encrypt(t){return this._crypt(t,0)}decrypt(t){return this._crypt(t,1)}_precompute(){const t=this._tables[0],n=this._tables[1],e=t[4],i=n[4],r=[],o=[];let s,a,l,c;for(let u=0;u<256;u++)o[(r[u]=u<<1^283*(u>>7))^u]=u;for(let u=s=0;!e[u];u^=a||1,s=o[s]||1){let d=s^s<<1^s<<2^s<<3^s<<4;d=d>>8^255&d^99,e[u]=d,i[d]=u,c=r[l=r[a=r[u]]];let h=16843009*c^65537*l^257*a^16843008*u,f=257*r[d]^16843008*d;for(let m=0;m<4;m++)t[m][u]=f=f<<24^f>>>8,n[m][d]=h=h<<24^h>>>8}for(let u=0;u<5;u++)t[u]=t[u].slice(0),n[u]=n[u].slice(0)}_crypt(t,n){if(4!==t.length)throw new Error("invalid aes block size");const e=this._key[n],i=e.length/4-2,r=[0,0,0,0],o=this._tables[n],s=o[0],a=o[1],l=o[2],c=o[3],u=o[4];let g,y,C,d=t[0]^e[0],h=t[n?3:1]^e[1],f=t[2]^e[2],m=t[n?1:3]^e[3],p=4;for(let N=0;N<i;N++)g=s[d>>>24]^a[h>>16&255]^l[f>>8&255]^c[255&m]^e[p],y=s[h>>>24]^a[f>>16&255]^l[m>>8&255]^c[255&d]^e[p+1],C=s[f>>>24]^a[m>>16&255]^l[d>>8&255]^c[255&h]^e[p+2],m=s[m>>>24]^a[d>>16&255]^l[h>>8&255]^c[255&f]^e[p+3],p+=4,d=g,h=y,f=C;for(let N=0;N<4;N++)r[n?3&-N:N]=u[d>>>24]<<24^u[h>>16&255]<<16^u[f>>8&255]<<8^u[255&m]^e[p++],g=d,d=h,h=f,f=m,m=g;return r}},KZ={getRandomValues(t){const n=new Uint32Array(t.buffer),e=i=>{let r=987654321;const o=4294967295;return function(){return r=36969*(65535&r)+(r>>16)&o,(((r<<16)+(i=18e3*(65535&i)+(i>>16)&o)&o)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let r,i=0;i<t.length;i+=4){const o=e(4294967296*(r||Math.random()));r=987654071*o(),n[i/4]=4294967296*o()|0}return t}},h3_ctrGladman=class{constructor(t,n){this._prf=t,this._initIv=n,this._iv=n}reset(){this._iv=this._initIv}update(t){return this.calculate(this._prf,t,this._iv)}incWord(t){if(255&~(t>>24))t+=1<<24;else{let n=t>>16&255,e=t>>8&255,i=255&t;255===n?(n=0,255===e?(e=0,255===i?i=0:++i):++e):++n,t=0,t+=n<<16,t+=e<<8,t+=i}return t}incCounter(t){0===(t[0]=this.incWord(t[0]))&&(t[1]=this.incWord(t[1]))}calculate(t,n,e){let i;if(!(i=n.length))return[];const r=Pr.bitLength(n);for(let o=0;o<i;o+=4){this.incCounter(e);const s=t.encrypt(e);n[o]^=s[0],n[o+1]^=s[1],n[o+2]^=s[2],n[o+3]^=s[3]}return Pr.clamp(n,r)}},Ql={importKey:t=>new Ql.hmacSha1(yg.bytes.toBits(t)),pbkdf2(t,n,e,i){if(e=e||1e4,i<0||e<0)throw new Error("invalid params to pbkdf2");const r=1+(i>>5)<<2;let o,s,a,l,c;const u=new ArrayBuffer(r),d=new DataView(u);let h=0;const f=Pr;for(n=yg.bytes.toBits(n),c=1;h<(r||1);c++){for(o=s=t.encrypt(f.concat(n,[c])),a=1;a<e;a++)for(s=t.encrypt(s),l=0;l<s.length;l++)o[l]^=s[l];for(a=0;h<(r||1)&&a<o.length;a++)d.setInt32(h,o[a]),h+=4}return u.slice(0,i/8)},hmacSha1:class{constructor(t){const n=this,e=n._hash=u3_sha1,i=[[],[]];n._baseHash=[new e,new e];const r=n._baseHash[0].blockSize/32;t.length>r&&(t=(new e).update(t).finalize());for(let o=0;o<r;o++)i[0][o]=909522486^t[o],i[1][o]=1549556828^t[o];n._baseHash[0].update(i[0]),n._baseHash[1].update(i[1]),n._resultHash=new e(n._baseHash[0])}reset(){const t=this;t._resultHash=new t._hash(t._baseHash[0]),t._updated=!1}update(t){this._updated=!0,this._resultHash.update(t)}digest(){const t=this,n=t._resultHash.finalize(),e=new t._hash(t._baseHash[1]).update(n).finalize();return t.reset(),e}encrypt(t){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(t),this.digest(t)}}},QZ=typeof crypto!=Wa&&typeof crypto.getRandomValues==jh,D1="Invalid password",f3="Invalid signature",S1="zipjs-abort-check-password";function p3(t){return QZ?crypto.getRandomValues(t):KZ.getRandomValues(t)}const JZ="raw",m3={name:"PBKDF2"},nY=Object.assign({hash:{name:"HMAC"}},m3),M1=Object.assign({iterations:1e3,hash:{name:"SHA-1"}},m3),iY=["deriveBits"],Uh=[8,12,16],Vh=[16,24,32],rY=[0,0,0,0],bg=typeof crypto!=Wa,Hh=bg&&crypto.subtle,g3=bg&&typeof Hh!=Wa,Rs=yg.bytes,oY=d3_aes,sY=h3_ctrGladman,aY=Ql.hmacSha1;let _3=bg&&g3&&typeof Hh.importKey==jh,v3=bg&&g3&&typeof Hh.deriveBits==jh;class lY extends TransformStream{constructor({password:n,rawPassword:e,signed:i,encryptionStrength:r,checkPasswordOnly:o}){super({start(){Object.assign(this,{ready:new Promise(s=>this.resolveReady=s),password:C3(n,e),signed:i,strength:r-1,pending:new Uint8Array})},transform(s,a){var l=this;return(0,E.A)(function*(){const c=l,{password:u,strength:d,resolveReady:h,ready:f}=c;u?(yield function uY(t,n,e,i){return I1.apply(this,arguments)}(c,d,u,Po(s,0,Uh[d]+2)),s=Po(s,Uh[d]+2),o?a.error(new Error(S1)):h()):yield f;const m=new Uint8Array(s.length-10-(s.length-10)%16);a.enqueue(y3(c,s,m,0,10,!0))})()},flush(s){var a=this;return(0,E.A)(function*(){const{signed:l,ctr:c,hmac:u,pending:d,ready:h}=a;if(u&&c){yield h;const f=Po(d,0,d.length-10),m=Po(d,d.length-10);let p=new Uint8Array;if(f.length){const g=Gh(Rs,f);u.update(g);const y=c.update(g);p=zh(Rs,y)}if(l){const g=Po(zh(Rs,u.digest()),0,10);for(let y=0;y<10;y++)if(g[y]!=m[y])throw new Error(f3)}s.enqueue(p)}})()}})}}class cY extends TransformStream{constructor({password:n,rawPassword:e,encryptionStrength:i}){let r;super({start(){Object.assign(this,{ready:new Promise(o=>this.resolveReady=o),password:C3(n,e),strength:i-1,pending:new Uint8Array})},transform(o,s){var a=this;return(0,E.A)(function*(){const l=a,{password:c,strength:u,resolveReady:d,ready:h}=l;let f=new Uint8Array;c?(f=yield function dY(t,n,e){return A1.apply(this,arguments)}(l,u,c),d()):yield h;const m=new Uint8Array(f.length+o.length-o.length%16);m.set(f,0),s.enqueue(y3(l,o,m,f.length,0))})()},flush(o){var s=this;return(0,E.A)(function*(){const{ctr:a,hmac:l,pending:c,ready:u}=s;if(l&&a){yield u;let d=new Uint8Array;if(c.length){const h=a.update(Gh(Rs,c));l.update(h),d=zh(Rs,h)}r.signature=zh(Rs,l.digest()).slice(0,10),o.enqueue(N1(d,r.signature))}})()}}),r=this}}function y3(t,n,e,i,r,o){const{ctr:s,hmac:a,pending:l}=t,c=n.length-r;let u;for(l.length&&(n=N1(l,n),e=function pY(t,n){if(n&&n>t.length){const e=t;(t=new Uint8Array(n)).set(e,0)}return t}(e,c-c%16)),u=0;u<=c-16;u+=16){const d=Gh(Rs,Po(n,u,u+16));o&&a.update(d);const h=s.update(d);o||a.update(h),e.set(zh(Rs,h),u+i)}return t.pending=Po(n,u),e}function I1(){return I1=(0,E.A)(function*(t,n,e,i){const r=yield b3(t,n,e,Po(i,0,Uh[n])),o=Po(i,Uh[n]);if(r[0]!=o[0]||r[1]!=o[1])throw new Error(D1)}),I1.apply(this,arguments)}function A1(){return A1=(0,E.A)(function*(t,n,e){const i=p3(new Uint8Array(Uh[n]));return N1(i,yield b3(t,n,e,i))}),A1.apply(this,arguments)}function b3(t,n,e,i){return k1.apply(this,arguments)}function k1(){return k1=(0,E.A)(function*(t,n,e,i){t.password=null;const r=yield function hY(t,n,e,i,r){return O1.apply(this,arguments)}(JZ,e,nY,!1,iY),o=yield function fY(t,n,e){return P1.apply(this,arguments)}(Object.assign({salt:i},M1),r,8*(2*Vh[n]+2)),s=new Uint8Array(o),a=Gh(Rs,Po(s,0,Vh[n])),l=Gh(Rs,Po(s,Vh[n],2*Vh[n])),c=Po(s,2*Vh[n]);return Object.assign(t,{keys:{key:a,authentication:l,passwordVerification:c},ctr:new sY(new oY(a),Array.from(rY)),hmac:new aY(l)}),c}),k1.apply(this,arguments)}function O1(){return O1=(0,E.A)(function*(t,n,e,i,r){if(!_3)return Ql.importKey(n);try{return yield Hh.importKey(t,n,e,i,r)}catch{return _3=!1,Ql.importKey(n)}}),O1.apply(this,arguments)}function P1(){return P1=(0,E.A)(function*(t,n,e){if(!v3)return Ql.pbkdf2(n,t.salt,M1.iterations,e);try{return yield Hh.deriveBits(t,n,e)}catch{return v3=!1,Ql.pbkdf2(n,t.salt,M1.iterations,e)}}),P1.apply(this,arguments)}function C3(t,n){return n===cn?vg(t):n}function N1(t,n){let e=t;return t.length+n.length&&(e=new Uint8Array(t.length+n.length),e.set(t,0),e.set(n,t.length)),e}function Po(t,n,e){return t.subarray(n,e)}function zh(t,n){return t.fromBits(n)}function Gh(t,n){return t.toBits(n)}class mY extends TransformStream{constructor({password:n,passwordVerification:e,checkPasswordOnly:i}){super({start(){Object.assign(this,{password:n,passwordVerification:e}),x3(this,n)},transform(r,o){const s=this;if(s.password){const a=w3(s,r.subarray(0,12));if(s.password=null,a[11]!=s.passwordVerification)throw new Error(D1);r=r.subarray(12)}i?o.error(new Error(S1)):o.enqueue(w3(s,r))}})}}class gY extends TransformStream{constructor({password:n,passwordVerification:e}){super({start(){Object.assign(this,{password:n,passwordVerification:e}),x3(this,n)},transform(i,r){const o=this;let s,a;if(o.password){o.password=null;const l=p3(new Uint8Array(12));l[11]=o.passwordVerification,s=new Uint8Array(i.length+l.length),s.set(E3(o,l),0),a=12}else s=new Uint8Array(i.length),a=0;s.set(E3(o,i),a),r.enqueue(s)}})}}function w3(t,n){const e=new Uint8Array(n.length);for(let i=0;i<n.length;i++)e[i]=T3(t)^n[i],F1(t,e[i]);return e}function E3(t,n){const e=new Uint8Array(n.length);for(let i=0;i<n.length;i++)e[i]=T3(t)^n[i],F1(t,n[i]);return e}function x3(t,n){const e=[305419896,591751049,878082192];Object.assign(t,{keys:e,crcKey0:new _g(e[0]),crcKey2:new _g(e[2])});for(let i=0;i<n.length;i++)F1(t,n.charCodeAt(i))}function F1(t,n){let[e,i,r]=t.keys;t.crcKey0.append([n]),e=~t.crcKey0.get(),i=S3(Math.imul(S3(i+D3(e)),134775813)+1),t.crcKey2.append([i>>>24]),r=~t.crcKey2.get(),t.keys=[e,i,r]}function T3(t){const n=2|t.keys[2];return D3(Math.imul(n,1^n)>>>8)}function D3(t){return 255&t}function S3(t){return 4294967295&t}const M3="deflate-raw";class _Y extends TransformStream{constructor(n,{chunkSize:e,CompressionStream:i,CompressionStreamNative:r}){super({});const{compressed:o,encrypted:s,useCompressionStream:a,zipCrypto:l,signed:c,level:u}=n,d=this;let h,f,m=I3(super.readable);(!s||l)&&c&&(h=new c3,m=Ls(m,h)),o&&(m=k3(m,a,{level:u,chunkSize:e},r,i)),s&&(l?m=Ls(m,new gY(n)):(f=new cY(n),m=Ls(m,f))),A3(d,m,()=>{let p;s&&!l&&(p=f.signature),(!s||l)&&c&&(p=new DataView(h.value.buffer).getUint32(0)),d.signature=p})}}class vY extends TransformStream{constructor(n,{chunkSize:e,DecompressionStream:i,DecompressionStreamNative:r}){super({});const{zipCrypto:o,encrypted:s,signed:a,signature:l,compressed:c,useCompressionStream:u}=n;let d,h,f=I3(super.readable);s&&(o?f=Ls(f,new mY(n)):(h=new lY(n),f=Ls(f,h))),c&&(f=k3(f,u,{chunkSize:e},r,i)),(!s||o)&&a&&(d=new c3,f=Ls(f,d)),A3(this,f,()=>{if((!s||o)&&a){const m=new DataView(d.value.buffer);if(l!=m.getUint32(0,!1))throw new Error(f3)}})}}function I3(t){return Ls(t,new TransformStream({transform(n,e){n&&n.length&&e.enqueue(n)}}))}function A3(t,n,e){n=Ls(n,new TransformStream({flush:e})),Object.defineProperty(t,"readable",{get:()=>n})}function k3(t,n,e,i,r){try{t=Ls(t,new(n&&i?i:r)(M3,e))}catch{if(!n)return t;try{t=Ls(t,new r(M3,e))}catch{return t}}return t}function Ls(t,n){return t.pipeThrough(n)}const bY="start",CY="pull",O3="data",wY="ack",P3="close",N3="deflate",F3="inflate";class EY extends TransformStream{constructor(n,e){super({});const i=this,{codecType:r}=n;let o;r.startsWith(N3)?o=_Y:r.startsWith(F3)&&(o=vY);let s=0,a=0;const l=new o(n,e),c=super.readable,u=new TransformStream({transform(h,f){h&&h.length&&(a+=h.length,f.enqueue(h))},flush(){Object.assign(i,{inputSize:a})}}),d=new TransformStream({transform(h,f){h&&h.length&&(s+=h.length,f.enqueue(h))},flush(){const{signature:h}=l;Object.assign(i,{signature:h,outputSize:s,inputSize:a})}});Object.defineProperty(i,"readable",{get:()=>c.pipeThrough(u).pipeThrough(l).pipeThrough(d)})}}class xY extends TransformStream{constructor(n){let e;super({transform:function i(r,o){if(e){const s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),r=s,e=null}r.length>n?(o.enqueue(r.slice(0,n)),i(r.slice(n),o)):e=r},flush(r){e&&e.length&&r.enqueue(e)}})}}let R3=typeof Worker!=Wa;class R1{constructor(n,{readable:e,writable:i},{options:r,config:o,streamOptions:s,useWebWorkers:a,transferStreams:l,scripts:c},u){const{signal:d}=s;return Object.assign(n,{busy:!0,readable:e.pipeThrough(new xY(o.chunkSize)).pipeThrough(new TY(e,s),{signal:d}),writable:i,options:Object.assign({},r),scripts:c,transferStreams:l,terminate:()=>new Promise(h=>{const{worker:f,busy:m}=n;f?(m?n.resolveTerminated=h:(f.terminate(),h()),n.interface=null):h()}),onTaskFinished(){const{resolveTerminated:h}=n;h&&(n.resolveTerminated=null,n.terminated=!0,n.worker.terminate(),h()),n.busy=!1,u(n)}}),(a&&R3?DY:L3)(n,o)}}class TY extends TransformStream{constructor(n,{onstart:e,onprogress:i,size:r,onend:o}){let s=0;super({start:()=>(0,E.A)(function*(){e&&(yield L1(e,r))})(),transform:(a,l)=>(0,E.A)(function*(){s+=a.length,i&&(yield L1(i,s,r)),l.enqueue(a)})(),flush:()=>(0,E.A)(function*(){n.size=s,o&&(yield L1(o,s))})()})}}function L1(t){return B1.apply(this,arguments)}function B1(){return B1=(0,E.A)(function*(t,...n){try{yield t(...n)}catch{}}),B1.apply(this,arguments)}function L3(t,n){return{run:()=>function SY(t,n){return j1.apply(this,arguments)}(t,n)}}function DY(t,n){const{baseURL:e,chunkSize:i}=n;if(!t.interface){let r;try{r=function AY(t,n,e){const i={type:"module"};let r,o;typeof t==jh&&(t=t());try{r=new URL(t,n)}catch{r=t}if(B3)try{o=new Worker(r)}catch{B3=!1,o=new Worker(r,i)}else o=new Worker(r,i);return o.addEventListener("message",s=>function kY(t,n){return V1.apply(this,arguments)}(s,e)),o}(t.scripts[0],e,t)}catch{return R3=!1,L3(t,n)}Object.assign(t,{worker:r,interface:{run:()=>function MY(t,n){return U1.apply(this,arguments)}(t,{chunkSize:i})}})}return t.interface}function j1(){return j1=(0,E.A)(function*({options:t,readable:n,writable:e,onTaskFinished:i},r){try{const o=new EY(t,r);yield n.pipeThrough(o).pipeTo(e,{preventClose:!0,preventAbort:!0});const{signature:s,inputSize:a,outputSize:l}=o;return{signature:s,inputSize:a,outputSize:l}}finally{i()}}),j1.apply(this,arguments)}function U1(){return U1=(0,E.A)(function*(t,n){let e,i;const r=new Promise((h,f)=>{e=h,i=f});Object.assign(t,{reader:null,writer:null,resolveResult:e,rejectResult:i,result:r});const{readable:o,options:s,scripts:a}=t,{writable:l,closed:c}=function IY(t){let n;const e=new Promise(r=>n=r);return{writable:new WritableStream({write:r=>(0,E.A)(function*(){const o=t.getWriter();yield o.ready,yield o.write(r),o.releaseLock()})(),close(){n()},abort:r=>t.getWriter().abort(r)}),closed:e}}(t.writable),u=Cg({type:bY,scripts:a.slice(1),options:s,config:n,readable:o,writable:l},t);u||Object.assign(t,{reader:o.getReader(),writer:l.getWriter()});const d=yield r;return u||(yield l.getWriter().close()),yield c,d}),U1.apply(this,arguments)}let B3=!0,j3=!0;function Cg(t,{worker:n,writer:e,onTaskFinished:i,transferStreams:r}){try{let{value:o,readable:s,writable:a}=t;const l=[];if(o&&(t.value=o.byteLength<o.buffer.byteLength?o.buffer.slice(0,o.byteLength):o.buffer,l.push(t.value)),r&&j3?(s&&l.push(s),a&&l.push(a)):t.readable=t.writable=null,l.length)try{return n.postMessage(t,l),!0}catch{j3=!1,t.readable=t.writable=null,n.postMessage(t)}else n.postMessage(t)}catch(o){throw e&&e.releaseLock(),i(),o}}function V1(){return V1=(0,E.A)(function*({data:t},n){const{type:e,value:i,messageId:r,result:o,error:s}=t,{reader:a,writer:l,resolveResult:c,rejectResult:u,onTaskFinished:d}=n;try{if(s){const{message:f,stack:m,code:p,name:g}=s,y=new Error(f);Object.assign(y,{stack:m,code:p,name:g}),h(y)}else{if(e==CY){const{value:f,done:m}=yield a.read();Cg({type:O3,value:f,done:m,messageId:r},n)}e==O3&&(yield l.ready,yield l.write(new Uint8Array(i)),Cg({type:wY,messageId:r},n)),e==P3&&h(null,o)}}catch(f){Cg({type:P3,messageId:r},n),h(f)}function h(f,m){f?u(f):c(m),l&&l.releaseLock(),d()}}),V1.apply(this,arguments)}let Xa=[];const H1=[];let U3=0;function V3(t,n){return z1.apply(this,arguments)}function z1(){return z1=(0,E.A)(function*(t,n){const{options:e,config:i}=n,{transferStreams:r,useWebWorkers:o,useCompressionStream:s,codecType:a,compressed:l,signed:c,encrypted:u}=e,{workerScripts:d,maxWorkers:h}=i;return n.transferStreams=r||r===cn,n.useWebWorkers=!!(l||c||u||n.transferStreams)&&(o||o===cn&&i.useWebWorkers),n.scripts=n.useWebWorkers&&d?d[a]:[],e.useCompressionStream=s||s===cn&&i.useCompressionStream,(yield function m(){return p.apply(this,arguments)}()).run();function p(){return(p=(0,E.A)(function*(){const y=Xa.find(C=>!C.busy);if(y)return G1(y),new R1(y,t,n,g);if(Xa.length<h){const C={indexWorker:U3};return U3++,Xa.push(C),new R1(C,t,n,g)}return new Promise(C=>H1.push({resolve:C,stream:t,workerOptions:n}))})).apply(this,arguments)}function g(y){if(H1.length){const[{resolve:C,stream:N,workerOptions:$}]=H1.splice(0,1);C(new R1(y,N,$,g))}else y.worker?(G1(y),function OY(t,n){const{config:e}=n,{terminateWorkerTimeout:i}=e;Number.isFinite(i)&&i>=0&&(t.terminated?t.terminated=!1:t.terminateTimeout=setTimeout((0,E.A)(function*(){Xa=Xa.filter(r=>r!=t);try{yield t.terminate()}catch{}}),i))}(y,n)):Xa=Xa.filter(C=>C!=y)}}),z1.apply(this,arguments)}function G1(t){const{terminateTimeout:n}=t;n&&(clearTimeout(n),t.terminateTimeout=null)}const zY=65536,q1="writable";class Eg{constructor(){this.size=0}init(){this.initialized=!0}}class Ka extends Eg{get readable(){const n=this,{chunkSize:e=zY}=n,i=new ReadableStream({start(){this.chunkOffset=0},pull(r){var o=this;return(0,E.A)(function*(){const{offset:s=0,size:a,diskNumberStart:l}=i,{chunkOffset:c}=o;r.enqueue(yield vr(n,s+c,Math.min(e,a-c),l)),c+e>a?r.close():o.chunkOffset+=e})()}});return i}}class Qa extends Ka{constructor(n){super(),Object.assign(this,{blob:n,size:n.size})}readUint8Array(n,e){var i=this;return(0,E.A)(function*(){const r=i,o=n+e;let a=yield(n||o<r.size?r.blob.slice(n,o):r.blob).arrayBuffer();return a.byteLength>e&&(a=a.slice(n,o)),new Uint8Array(a)})()}}class Ja extends Eg{constructor(n){super();const i=new TransformStream,r=[];n&&r.push(["Content-Type",n]),Object.defineProperty(this,q1,{get:()=>i.writable}),this.blob=new Response(i.readable,{headers:r}).blob()}getData(){return this.blob}}class WY extends Ka{constructor(n){super(),this.readers=n}init(){var n=()=>super.init,e=this;return(0,E.A)(function*(){const i=e,{readers:r}=i;i.lastDiskNumber=0,i.lastDiskOffset=0,yield Promise.all(r.map(function(){var o=(0,E.A)(function*(s,a){yield s.init(),a!=r.length-1&&(i.lastDiskOffset+=s.size),i.size+=s.size});return function(s,a){return o.apply(this,arguments)}}())),n().call(e)})()}readUint8Array(n,e,i=0){var r=this;return(0,E.A)(function*(){const o=r,{readers:s}=r;let a,l=i;-1==l&&(l=s.length-1);let c=n;for(;c>=s[l].size;)c-=s[l].size,l++;const u=s[l],d=u.size;if(c+e<=d)a=yield vr(u,c,e);else{const h=d-c;a=new Uint8Array(e),a.set(yield vr(u,c,h)),a.set(yield o.readUint8Array(n+h,e-h,i),h)}return o.lastDiskNumber=Math.max(l,o.lastDiskNumber),a})()}}class tP extends Eg{constructor(n,e=4294967295){super();const i=this;let r,o,s;Object.assign(i,{diskNumber:0,diskOffset:0,size:0,maxSize:e,availableSize:e});const a=new WritableStream({write(h){var f=this;return(0,E.A)(function*(){const{availableSize:m}=i;if(s)h.length>=m?(yield l(h.slice(0,m)),yield u(),i.diskOffset+=r.size,i.diskNumber++,s=null,yield f.write(h.slice(m))):yield l(h);else{const{value:p,done:g}=yield n.next();if(g&&!p)throw new Error("Writer iterator completed too soon");r=p,r.size=0,r.maxSize&&(i.maxSize=r.maxSize),i.availableSize=i.maxSize,yield go(r),o=p.writable,s=o.getWriter(),yield f.write(h)}})()},close:()=>(0,E.A)(function*(){yield s.ready,yield u()})()});function l(h){return c.apply(this,arguments)}function c(){return(c=(0,E.A)(function*(h){const f=h.length;f&&(yield s.ready,yield s.write(h),r.size+=f,i.size+=f,i.availableSize-=f)})).apply(this,arguments)}function u(){return d.apply(this,arguments)}function d(){return(d=(0,E.A)(function*(){o.size=r.size,yield s.close()})).apply(this,arguments)}Object.defineProperty(i,q1,{get:()=>a})}}function go(t,n){return lC.apply(this,arguments)}function lC(){return lC=(0,E.A)(function*(t,n){if(!t.init||t.initialized)return Promise.resolve();yield t.init(n)}),lC.apply(this,arguments)}function nP(t){return Array.isArray(t)&&(t=new WY(t)),t instanceof ReadableStream&&(t={readable:t}),t}function iP(t){t.writable===cn&&typeof t.next==jh&&(t=new tP(t)),t instanceof WritableStream&&(t={writable:t});const{writable:n}=t;return n.size===cn&&(n.size=0),t instanceof tP||Object.assign(t,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),t}function vr(t,n,e,i){return t.readUint8Array(n,e,i)}function Dg(t){function n(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var i=e.done;return Promise.resolve(e.value).then(function(r){return{value:r,done:i}})}return(Dg=function(i){this.s=i,this.n=i.next}).prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(i){var r=this.s.return;return void 0===r?Promise.resolve({value:i,done:!0}):n(r.apply(this.s,arguments))},throw:function(i){var r=this.s.return;return void 0===r?Promise.reject(i):n(r.apply(this.s,arguments))}},new Dg(t)}function oP(t,n){this.v=t,this.k=n}function yr(t){return new oP(t,0)}function $h(t){var n,e;function i(o,s){try{var a=t[o](s),l=a.value,c=l instanceof oP;Promise.resolve(c?l.v:l).then(function(u){if(c){var d="return"===o?"return":"next";if(!l.k||u.done)return i(d,u);u=t[d](u).value}r(a.done?"return":"normal",u)},function(u){i("throw",u)})}catch(u){r("throw",u)}}function r(o,s){switch(o){case"return":n.resolve({value:s,done:!0});break;case"throw":n.reject(s);break;default:n.resolve({value:s,done:!1})}(n=n.next)?i(n.key,n.arg):e=null}this._invoke=function(o,s){return new Promise(function(a,l){var c={key:o,arg:s,resolve:a,reject:l,next:null};e?e=e.next=c:(n=e=c,i(o,s))})},"function"!=typeof t.return&&(this.return=void 0)}$h.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},$h.prototype.next=function(t){return this._invoke("next",t)},$h.prototype.throw=function(t){return this._invoke("throw",t)},$h.prototype.return=function(t){return this._invoke("return",t)};const sP="\0\u263a\u263b\u2665\u2666\u2663\u2660\u2022\u25d8\u25cb\u25d9\u2642\u2640\u266a\u266b\u263c\u25ba\u25c4\u2195\u203c\xb6\xa7\u25ac\u21a8\u2191\u2193\u2192\u2190\u221f\u2194\u25b2\u25bc !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xc7\xfc\xe9\xe2\xe4\xe0\xe5\xe7\xea\xeb\xe8\xef\xee\xec\xc4\xc5\xc9\xe6\xc6\xf4\xf6\xf2\xfb\xf9\xff\xd6\xdc\xa2\xa3\xa5\u20a7\u0192\xe1\xed\xf3\xfa\xf1\xd1\xaa\xba\xbf\u2310\xac\xbd\xbc\xa1\xab\xbb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\xdf\u0393\u03c0\u03a3\u03c3\xb5\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u03c6\u03b5\u2229\u2261\xb1\u2265\u2264\u2320\u2321\xf7\u2248\xb0\u2219\xb7\u221a\u207f\xb2\u25a0 ".split(""),YY=256==sP.length;function Sg(t,n){return n&&"cp437"==n.trim().toLowerCase()?function XY(t){if(YY){let n="";for(let e=0;e<t.length;e++)n+=sP[t[e]];return n}return(new TextDecoder).decode(t)}(t):new TextDecoder(n).decode(t)}const aP="filename",lP="rawFilename",cP="comment",uP="rawComment",dP="uncompressedSize",hP="compressedSize",cC="diskNumberStart",Mg="lastModDate",uC="rawLastModDate",dC="lastAccessDate",KY="rawLastAccessDate",hC="creationDate",QY="rawCreationDate",pP="internalFileAttribute",mP="externalFileAttribute",gP="msDosCompatible",fC="zip64",_P="encrypted",vP="version",yP="versionMadeBy",bP="zipCrypto",JY=[aP,lP,hP,dP,Mg,uC,cP,uP,dC,hC,"offset",cC,cC,pP,mP,gP,fC,_P,vP,yP,bP,"directory","bitFlag","signature","filenameUTF8","commentUTF8","compressionMethod","extraField","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"];class Wh{constructor(n){JY.forEach(e=>this[e]=n[e])}}const pC="File format is not recognized",rX="Zip64 extra field not found",CP="Compression method not supported",wP="Split zip file",aX=[[dP,fi],[hP,fi],["offset",fi],[cC,oi]],lX={[oi]:{getValue:pi,bytes:4},[fi]:{getValue:Ig,bytes:8}};class mC{constructor(n,e={}){Object.assign(this,{reader:nP(n),options:e,config:E1()})}getEntriesGenerator(n={}){var e=this;return function ZY(t){return function(){return new $h(t.apply(this,arguments))}}(function*(){const i=e;let{reader:r}=i;const{config:o}=i;if(yield yr(go(r)),(r.size===cn||!r.readUint8Array)&&(r=new Qa(yield yr(new Response(r.readable).blob())),yield yr(go(r))),r.size<22)throw new Error(pC);r.chunkSize=a3(o);const s=yield yr(function pX(t,n,e,i,r){return vC.apply(this,arguments)}(r,ZO,r.size,22,16*oi));if(!s)throw pi(Hi(yield yr(vr(r,0,4))))==m1?new Error(wP):new Error("End of central directory not found");const a=Hi(s);let l=pi(a,12),c=pi(a,16);const u=s.offset,d=Vi(a,20),h=u+22+d;let f=Vi(a,4);const m=r.lastDiskNumber||0;let p=Vi(a,6),g=Vi(a,8),y=0,C=0;if(c==fi||l==fi||g==oi||p==oi){const we=Hi(yield yr(vr(r,s.offset-20,20)));if(pi(we,0)==YO){c=Ig(we,8);let Ce=yield yr(vr(r,c,56,-1)),Ie=Hi(Ce);const Re=s.offset-20-56;if(pi(Ie,0)!=_1&&c!=Re){const te=c;c=Re,y=c-te,Ce=yield yr(vr(r,c,56,-1)),Ie=Hi(Ce)}if(pi(Ie,0)!=_1)throw new Error("End of Zip64 central directory locator not found");f==oi&&(f=pi(Ie,16)),p==oi&&(p=pi(Ie,20)),g==oi&&(g=Ig(Ie,32)),l==fi&&(l=Ig(Ie,40)),c-=l}}if(c>=r.size&&(y=r.size-c-l-22,c=r.size-l-22),m!=f)throw new Error(wP);if(c<0)throw new Error(pC);let N=0,$=yield yr(vr(r,c,l,p)),H=Hi($);if(l){const se=s.offset-l;if(pi(H,N)!=g1&&c!=se){const we=c;c=se,y+=c-we,$=yield yr(vr(r,c,l,p)),H=Hi($)}}const z=s.offset-c-(r.lastDiskOffset||0);if(l!=z&&z>=0&&(l=z,$=yield yr(vr(r,c,l,p)),H=Hi($)),c<0||c>=r.size)throw new Error(pC);const X=Nr(i,n,"filenameEncoding"),ee=Nr(i,n,"commentEncoding");for(let se=0;se<g;se++){const we=new cX(r,o,i.options);if(pi(H,N)!=g1)throw new Error("Central directory header not found");TP(we,H,N+6);const Ce=!!we.bitFlag.languageEncodingFlag,Ie=N+46,Re=Ie+we.filenameLength,te=Re+we.extraFieldLength,_e=Vi(H,N+4),ve=!0,Ye=$.subarray(Ie,Re),Oe=Vi(H,N+32),jt=te+Oe,Ge=$.subarray(te,jt),mt=Ce,$t=Ce,Gn=ve&&!(16&~Su(H,N+38)),In=pi(H,N+42)+y;Object.assign(we,{versionMadeBy:_e,msDosCompatible:ve,compressedSize:0,uncompressedSize:0,commentLength:Oe,directory:Gn,offset:In,diskNumberStart:Vi(H,N+34),internalFileAttribute:Vi(H,N+36),externalFileAttribute:pi(H,N+38),rawFilename:Ye,filenameUTF8:mt,commentUTF8:$t,rawExtraField:$.subarray(Re,te)});const Sn=Nr(i,n,"decodeText")||Sg,xi=mt?"utf-8":X||"cp437",qn=$t?"utf-8":ee||"cp437";let Ti=Sn(Ye,xi);Ti===cn&&(Ti=Sg(Ye,xi));let Fr=Sn(Ge,qn);Fr===cn&&(Fr=Sg(Ge,qn)),Object.assign(we,{rawComment:Ge,filename:Ti,comment:Fr,directory:Gn||Ti.endsWith("/")}),C=Math.max(In,C),yield yr(DP(we,we,H,N+6)),we.zipCrypto=we.encrypted&&!we.extraFieldAES;const Rr=new Wh(we);Rr.getData=(Ca,Rn)=>we.getData(Ca,Rr,Rn),N=jt;const{onprogress:_o}=n;if(_o)try{yield yr(_o(se+1,g,new Wh(we)))}catch{}yield Rr}const he=Nr(i,n,"extractPrependedData"),ae=Nr(i,n,"extractAppendedData");return he&&(i.prependedData=C>0?yield yr(vr(r,0,C)):new Uint8Array),i.comment=d?yield yr(vr(r,u+22,d)):new Uint8Array,ae&&(i.appendedData=h<r.size?yield yr(vr(r,h,r.size-h)):new Uint8Array),!0})()}getEntries(n={}){var e=this;return(0,E.A)(function*(){const i=[];var s,r=!1,o=!1;try{for(var l,a=function rP(t){var n,e,i,r=2;for(typeof Symbol<"u"&&(e=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(e&&null!=(n=t[e]))return n.call(t);if(i&&null!=(n=t[i]))return new Dg(n.call(t));e="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(e.getEntriesGenerator(n));r=!(l=yield a.next()).done;r=!1)i.push(l.value)}catch(c){o=!0,s=c}finally{try{r&&null!=a.return&&(yield a.return())}finally{if(o)throw s}}return i})()}close(){return(0,E.A)(function*(){})()}}class cX{constructor(n,e,i){Object.assign(this,{reader:n,config:e,options:i})}getData(n,e,i={}){var r=this;return(0,E.A)(function*(){const o=r,{reader:s,offset:a,diskNumberStart:l,extraFieldAES:c,compressionMethod:u,config:d,bitFlag:h,signature:f,rawLastModDate:m,uncompressedSize:p,compressedSize:g}=o,y=e.localDirectory={},N=Hi(yield vr(s,a,30,l));let $=Nr(o,i,"password"),H=Nr(o,i,"rawPassword");const z=Nr(o,i,"passThrough");if($=$&&$.length&&$,H=H&&H.length&&H,c&&99!=c.originalCompressionMethod)throw new Error(CP);if(0!=u&&8!=u&&!z)throw new Error(CP);if(67324752!=pi(N,0))throw new Error("Local file header not found");TP(y,N,4),y.rawExtraField=y.extraFieldLength?yield vr(s,a+30+y.filenameLength,y.extraFieldLength,l):new Uint8Array,yield DP(o,y,N,4,!0),Object.assign(e,{lastAccessDate:y.lastAccessDate,creationDate:y.creationDate});const X=o.encrypted&&y.encrypted&&!z,ee=X&&!c;if(z||(e.zipCrypto=ee),X){if(!ee&&c.strength===cn)throw new Error("Encryption method not supported");if(!$&&!H)throw new Error("File contains encrypted entry")}const ae=g,se=s.readable;Object.assign(se,{diskNumberStart:l,offset:a+30+y.filenameLength+y.extraFieldLength,size:ae});const we=Nr(o,i,"signal"),Ce=Nr(o,i,"checkPasswordOnly");Ce&&(n=new WritableStream),n=iP(n),yield go(n,z?g:p);const{writable:Ie}=n,{onstart:Re,onprogress:te,onend:_e}=i,ve={options:{codecType:F3,password:$,rawPassword:H,zipCrypto:ee,encryptionStrength:c&&c.strength,signed:Nr(o,i,"checkSignature")&&!z,passwordVerification:ee&&(h.dataDescriptor?m>>>8&255:f>>>24&255),signature:f,compressed:0!=u&&!z,encrypted:o.encrypted&&!z,useWebWorkers:Nr(o,i,"useWebWorkers"),useCompressionStream:Nr(o,i,"useCompressionStream"),transferStreams:Nr(o,i,"transferStreams"),checkPasswordOnly:Ce},config:d,streamOptions:{signal:we,size:ae,onstart:Re,onprogress:te,onend:_e}};let Ye=0;try{({outputSize:Ye}=yield V3({readable:se,writable:Ie},ve))}catch(Oe){if(!Ce||Oe.message!=S1)throw Oe}finally{const Oe=Nr(o,i,"preventClose");Ie.size+=Ye,!Oe&&!Ie.locked&&(yield Ie.getWriter().close())}return Ce?cn:n.getData?n.getData():Ie})()}}function TP(t,n,e){const i=t.rawBitFlag=Vi(n,e+2),r=!(1&~i),o=pi(n,e+6);Object.assign(t,{encrypted:r,version:Vi(n,e),bitFlag:{level:(6&i)>>1,dataDescriptor:!(8&~i),languageEncodingFlag:!(2048&~i)},rawLastModDate:o,lastModDate:mX(o),filenameLength:Vi(n,e+22),extraFieldLength:Vi(n,e+24)})}function DP(t,n,e,i,r){return gC.apply(this,arguments)}function gC(){return gC=(0,E.A)(function*(t,n,e,i,r){const{rawExtraField:o}=n,s=n.extraField=new Map,a=Hi(new Uint8Array(o));let l=0;try{for(;l<o.length;){const y=Vi(a,l),C=Vi(a,l+2);s.set(y,{type:y,data:o.slice(l+4,l+4+C)}),l+=4+C}}catch{}const c=Vi(e,i+4);Object.assign(n,{signature:pi(e,i+10),uncompressedSize:pi(e,i+18),compressedSize:pi(e,i+14)});const u=s.get(XO);u&&(function uX(t,n){n.zip64=!0;const e=Hi(t.data),i=aX.filter(([r,o])=>n[r]==o);for(let r=0,o=0;r<i.length;r++){const[s,a]=i[r];if(n[s]==a){const l=lX[a];n[s]=t[s]=l.getValue(e,o),o+=l.bytes}else if(t[s])throw new Error(rX)}}(u,n),n.extraFieldZip64=u);const d=s.get(GZ);d&&(yield SP(d,aP,lP,n,t),n.extraFieldUnicodePath=d);const h=s.get($Z);h&&(yield SP(h,cP,uP,n,t),n.extraFieldUnicodeComment=h);const f=s.get(KO);f?(function dX(t,n,e){const i=Hi(t.data),r=Su(i,4);Object.assign(t,{vendorVersion:Su(i,0),vendorId:Su(i,2),strength:r,originalCompressionMethod:e,compressionMethod:Vi(i,5)}),n.compressionMethod=t.compressionMethod}(f,n,c),n.extraFieldAES=f):n.compressionMethod=c;const m=s.get(QO);m&&(function hX(t,n){const e=Hi(t.data);let r,i=4;try{for(;i<t.data.length&&!r;){const o=Vi(e,i),s=Vi(e,i+2);o==JO&&(r=t.data.slice(i+4,i+4+s)),i+=4+s}}catch{}try{if(r&&24==r.length){const o=Hi(r),s=o.getBigUint64(0,!0),a=o.getBigUint64(8,!0),l=o.getBigUint64(16,!0);Object.assign(t,{rawLastModDate:s,rawLastAccessDate:a,rawCreationDate:l});const c=yC(s),h={lastModDate:c,lastAccessDate:yC(a),creationDate:yC(l)};Object.assign(t,h),Object.assign(n,h)}}catch{}}(m,n),n.extraFieldNTFS=m);const p=s.get(v1);p&&(function fX(t,n,e){const i=Hi(t.data),r=Su(i,0),o=[],s=[];e?(!(1&~r)&&(o.push(Mg),s.push(uC)),!(2&~r)&&(o.push(dC),s.push(KY)),!(4&~r)&&(o.push(hC),s.push(QY))):t.data.length>=5&&(o.push(Mg),s.push(uC));let a=1;o.forEach((l,c)=>{if(t.data.length>=a+4){const u=pi(i,a);n[l]=t[l]=new Date(1e3*u),t[s[c]]=u}a+=4})}(p,n,r),n.extraFieldExtendedTimestamp=p);const g=s.get(e3);g&&(n.extraFieldUSDZ=g)}),gC.apply(this,arguments)}function SP(t,n,e,i,r){return _C.apply(this,arguments)}function _C(){return _C=(0,E.A)(function*(t,n,e,i,r){const o=Hi(t.data),s=new _g;s.append(r[e]);const a=Hi(new Uint8Array(4));a.setUint32(0,s.get(),!0);const l=pi(o,1);Object.assign(t,{version:Su(o,0),[n]:Sg(t.data.subarray(5)),valid:!r.bitFlag.languageEncodingFlag&&l==pi(a,0)}),t.valid&&(i[n]=t[n],i[n+"UTF8"]=!0)}),_C.apply(this,arguments)}function vC(){return vC=(0,E.A)(function*(t,n,e,i,r){const o=new Uint8Array(4);!function gX(t,n,e){t.setUint32(n,e,!0)}(Hi(o),0,n);const a=i+r;return(yield l(i))||(yield l(Math.min(a,e)));function l(u){return c.apply(this,arguments)}function c(){return(c=(0,E.A)(function*(u){const d=e-u,h=yield vr(t,d,u);for(let f=h.length-i;f>=0;f--)if(h[f]==o[0]&&h[f+1]==o[1]&&h[f+2]==o[2]&&h[f+3]==o[3])return{offset:d+f,buffer:h.slice(f,f+i).buffer}})).apply(this,arguments)}}),vC.apply(this,arguments)}function Nr(t,n,e){return n[e]===cn?t.options[e]:n[e]}function mX(t){const n=(4294901760&t)>>16,e=65535&t;try{return new Date(1980+((65024&n)>>9),((480&n)>>5)-1,31&n,(63488&e)>>11,(2016&e)>>5,2*(31&e),0)}catch{}}function yC(t){return new Date(Number(t/BigInt(1e4)-BigInt(116444736e5)))}function Su(t,n){return t.getUint8(n)}function Vi(t,n){return t.getUint16(n,!0)}function pi(t,n){return t.getUint32(n,!0)}function Ig(t,n){return Number(t.getBigUint64(n,!0))}function Hi(t){return new DataView(t.buffer)}const MP="Version exceeds 65535",bC="Zip64 is not supported (make sure 'keepOrder' is set to 'true')",IP=new Uint8Array([7,0,2,0,65,69,3,0,0]);let CC=0;const AP=[];class wC{constructor(n,e={}){n=iP(n),Object.assign(this,{writer:n,addSplitZipSignature:n.availableSize!==cn&&n.availableSize>0&&n.availableSize!==1/0&&n.maxSize!==cn&&n.maxSize>0&&n.maxSize!==1/0,options:e,config:E1(),files:new Map,filenames:new Set,offset:e.offset===cn?n.writable.size:e.offset,pendingEntriesSize:0,pendingAddFileCalls:new Set,bufferedWrites:0})}add(n="",e,i={}){var r=this;return(0,E.A)(function*(){const o=r,{pendingAddFileCalls:s,config:a}=o;let l;CC<a.maxWorkers?CC++:yield new Promise(c=>AP.push(c));try{if(n=n.trim(),o.filenames.has(n))throw new Error("File already exists");return o.filenames.add(n),l=function TX(t,n,e,i){return EC.apply(this,arguments)}(o,n,e,i),s.add(l),yield l}catch(c){throw o.filenames.delete(n),c}finally{s.delete(l);const c=AP.shift();c?c():CC--}})()}close(n=new Uint8Array,e={}){var i=this;return(0,E.A)(function*(){const r=i,{pendingAddFileCalls:o,writer:s}=i,{writable:a}=s;for(;o.size;)yield Promise.allSettled(Array.from(o));return yield function NX(t,n,e){return SC.apply(this,arguments)}(i,n,e),_n(r,e,"preventClose")||(yield a.getWriter().close()),s.getData?s.getData():a})()}}function EC(){return EC=(0,E.A)(function*(t,n,e,i){n=n.trim(),i.directory&&!n.endsWith("/")?n+="/":i.directory=n.endsWith("/");const r=_n(t,i,"encodeText",vg);let o=r(n);if(o===cn&&(o=vg(n)),rn(o)>oi)throw new Error("File entry name exceeds 64KB");const s=i.comment||"";let a=r(s);if(a===cn&&(a=vg(s)),rn(a)>oi)throw new Error("File entry comment exceeds 64KB");const l=_n(t,i,vP,20);if(l>oi)throw new Error(MP);const c=_n(t,i,yP,20);if(c>oi)throw new Error(MP);const u=_n(t,i,Mg,new Date),d=_n(t,i,dC),h=_n(t,i,hC),f=_n(t,i,gP,!0),m=_n(t,i,pP,0),p=_n(t,i,mP,0),g=_n(t,i,"passThrough");let y,C;g||(y=_n(t,i,"password"),C=_n(t,i,"rawPassword"));const N=_n(t,i,"encryptionStrength",3),$=_n(t,i,bP),H=_n(t,i,"extendedTimestamp",!0),z=_n(t,i,"keepOrder",!0),X=_n(t,i,"level"),ee=_n(t,i,"useWebWorkers"),he=_n(t,i,"bufferedWrite"),ae=_n(t,i,"dataDescriptorSignature",!1),se=_n(t,i,"signal"),we=_n(t,i,"useUnicodeFileNames",!0),Ce=_n(t,i,"useCompressionStream"),Ie=_n(t,i,"compressionMethod");let Re=_n(t,i,"dataDescriptor",!0),te=_n(t,i,fC);if(!($||y===cn&&C===cn||N>=1&&N<=3))throw new Error("The strength must equal 1, 2, or 3");let _e=new Uint8Array;const{extraField:ve}=i;if(ve){let wa=0,No=0;ve.forEach(eo=>wa+=4+rn(eo)),_e=new Uint8Array(wa),ve.forEach((eo,Ws)=>{if(Ws>oi)throw new Error("Extra field type exceeds 65535");if(rn(eo)>oi)throw new Error("Extra field data exceeds 64KB");wi(_e,new Uint16Array([Ws]),No),wi(_e,new Uint16Array([rn(eo)]),No+2),wi(_e,eo,No+4),No+=4+rn(eo)})}let Ye=0,Oe=0,jt=0;if(g&&(({uncompressedSize:jt}=i),jt===cn))throw new Error("Undefined uncompressed size");const Ge=!0===te;e&&(e=nP(e),yield go(e),g?Ye=kP(jt):e.size===cn?(Re=!0,(te||te===cn)&&(te=!0,jt=Ye=fi+1)):(jt=e.size,Ye=kP(jt)));const{diskOffset:mt,diskNumber:$t,maxSize:Gn}=t.writer,In=Ge||jt>fi,Sn=Ge||Ye>fi,xi=Ge||t.offset+t.pendingEntriesSize-mt>fi,Ti=_n(t,i,"supportZip64SplitFile",!0)&&Ge||$t+Math.ceil(t.pendingEntriesSize/Gn)>oi;if(xi||In||Sn||Ti){if(!1===te||!z)throw new Error(bC);te=!0}te=te||!1;const Fr=_n(t,i,_P),{signature:Rr}=i,_o=function MX(t){const{rawFilename:n,lastModDate:e,lastAccessDate:i,creationDate:r,level:o,zip64:s,zipCrypto:a,useUnicodeFileNames:l,dataDescriptor:c,directory:u,rawExtraField:d,encryptionStrength:h,extendedTimestamp:f,encrypted:m}=t,p=0!==o&&!u;let C,N,$,H,{version:g,compressionMethod:y}=t;if(m&&!a){C=new Uint8Array(rn(IP)+2);const te=er(C);un(te,0,KO),wi(C,IP,2),Ag(te,8,h)}else C=new Uint8Array;if(f){$=new Uint8Array(9+(i?4:0)+(r?4:0));const te=er($);un(te,0,v1),un(te,2,rn($)-4),H=1+(i?2:0)+(r?4:0),Ag(te,4,H);let _e=5;nn(te,_e,Math.floor(e.getTime()/1e3)),_e+=4,i&&(nn(te,_e,Math.floor(i.getTime()/1e3)),_e+=4),r&&nn(te,_e,Math.floor(r.getTime()/1e3));try{N=new Uint8Array(36);const ve=er(N),Ye=IC(e);un(ve,0,QO),un(ve,2,32),un(ve,8,JO),un(ve,10,24),Jr(ve,12,Ye),Jr(ve,20,IC(i)||Ye),Jr(ve,28,IC(r)||Ye)}catch{N=new Uint8Array}}else N=$=new Uint8Array;let z=0;l&&(z|=2048),c&&(z|=8),y===cn&&(y=p?8:0),p&&(o>=1&&o<3&&(z|=6),o>=3&&o<5&&(z|=1),9===o&&(z|=2)),s&&(g=g>45?g:45),m&&(z|=1,a||(g=g>51?g:51,C[9]=y,y=99));const X=new Uint8Array(26),ee=er(X);un(ee,0,g),un(ee,2,z),un(ee,4,y);const he=new Uint32Array(1),ae=er(he);let se;se=e<r3?r3:e>i3?i3:e,un(ae,0,(se.getHours()<<6|se.getMinutes())<<5|se.getSeconds()/2),un(ae,2,(se.getFullYear()-1980<<4|se.getMonth()+1)<<5|se.getDate());const we=he[0];nn(ee,6,we),un(ee,22,rn(n));const Ce=rn(C,$,N,d);un(ee,24,Ce);const Ie=new Uint8Array(30+rn(n)+Ce);return nn(er(Ie),0,67324752),wi(Ie,X,4),wi(Ie,n,30),wi(Ie,C,30+rn(n)),wi(Ie,$,30+rn(n,C)),wi(Ie,N,30+rn(n,C,$)),wi(Ie,d,30+rn(n,C,$,N)),{localHeaderArray:Ie,headerArray:X,headerView:ee,lastModDate:e,rawLastModDate:we,encrypted:m,compressed:p,version:g,compressionMethod:y,extraFieldExtendedTimestampFlag:H,rawExtraFieldExtendedTimestamp:$,rawExtraFieldNTFS:N,rawExtraFieldAES:C,extraFieldLength:Ce}}(i=Object.assign({},i,{rawFilename:o,rawComment:a,version:l,versionMadeBy:c,lastModDate:u,lastAccessDate:d,creationDate:h,rawExtraField:_e,zip64:te,zip64UncompressedSize:In,zip64CompressedSize:Sn,zip64Offset:xi,zip64DiskNumberStart:Ti,password:y,rawPassword:C,level:Ce||t.config.CompressionStream!==cn||t.config.CompressionStreamNative!==cn?X:0,useWebWorkers:ee,encryptionStrength:N,extendedTimestamp:H,zipCrypto:$,bufferedWrite:he,keepOrder:z,useUnicodeFileNames:we,dataDescriptor:Re,dataDescriptorSignature:ae,signal:se,msDosCompatible:f,internalFileAttribute:m,externalFileAttribute:p,useCompressionStream:Ce,passThrough:g,encrypted:!!(y&&rn(y)||C&&rn(C))||g&&Fr,signature:Rr,compressionMethod:Ie})),Ca=function AX(t){const{zip64:n,dataDescriptor:e,dataDescriptorSignature:i}=t;let o,r=new Uint8Array,s=0;return e&&(r=new Uint8Array(n?i?24:20:i?16:12),o=er(r),i&&(s=4,nn(o,0,HZ))),{dataDescriptorArray:r,dataDescriptorView:o,dataDescriptorOffset:s}}(i),Rn=rn(_o.localHeaderArray,Ca.dataDescriptorArray);let zi;Oe=Rn+Ye,t.options.usdz&&(Oe+=Oe+64),t.pendingEntriesSize+=Oe;try{zi=yield function DX(t,n,e,i,r){return xC.apply(this,arguments)}(t,n,e,{headerInfo:_o,dataDescriptorInfo:Ca,metadataSize:Rn},i)}finally{t.pendingEntriesSize-=Oe}return Object.assign(zi,{name:n,comment:s,extraField:ve}),new Wh(zi)}),EC.apply(this,arguments)}function xC(){return xC=(0,E.A)(function*(t,n,e,i,r){const{files:o,writer:s}=t,{keepOrder:a,dataDescriptor:l,signal:c}=r,{headerInfo:u}=i,{usdz:d}=t.options,h=Array.from(o.values()).pop();let m,p,g,y,C,N,$,f={};o.set(n,f);try{let ae;a&&(ae=h&&h.lock,function H(){f.lock=new Promise(ae=>g=ae)}()),!(r.bufferedWrite||t.writerLocked||t.bufferedWrites&&a)&&l||d?(N=s,yield z()):(N=new TransformStream,$=new Response(N.readable).blob(),N.writable.size=0,m=!0,t.bufferedWrites++,yield go(s)),yield go(N);const{writable:se}=s;let{diskOffset:we}=s;if(t.addSplitZipSignature){delete t.addSplitZipSignature;const Ie=new Uint8Array(4);nn(er(Ie),0,m1),yield Bs(se,Ie),t.offset+=4}d&&function IX(t,n){const{headerInfo:e}=t;let{localHeaderArray:i,extraFieldLength:r}=e,o=er(i),s=64-(n+rn(i))%64;s<4&&(s+=64);const a=new Uint8Array(s),l=er(a);un(l,0,e3),un(l,2,s-2);const c=i;e.localHeaderArray=i=new Uint8Array(rn(c)+s),wi(i,c),wi(i,a,rn(c)),o=er(i),un(o,28,r+s),t.metadataSize+=s}(i,t.offset-we),m||(yield ae,yield ee(se));const{diskNumber:Ce}=s;if(C=!0,f.diskNumberStart=Ce,f=yield function SX(t,n,e,i,r,o){return TC.apply(this,arguments)}(e,N,f,i,t.config,r),C=!1,o.set(n,f),f.filename=n,m){yield N.writable.getWriter().close();let Ie=yield $;yield ae,yield z(),y=!0,l||(Ie=yield function OX(t,n,e,i){return DC.apply(this,arguments)}(f,Ie,se,r)),yield ee(se),f.diskNumberStart=s.diskNumber,we=s.diskOffset,yield Ie.stream().pipeTo(se,{preventClose:!0,preventAbort:!0,signal:c}),se.size+=Ie.size,y=!1}if(f.offset=t.offset-we,f.zip64)!function PX(t,n){const{rawExtraFieldZip64:e,offset:i,diskNumberStart:r}=t,{zip64UncompressedSize:o,zip64CompressedSize:s,zip64Offset:a,zip64DiskNumberStart:l}=n,c=er(e);let u=4;o&&(u+=8),s&&(u+=8),a&&(Jr(c,u,BigInt(i)),u+=8),l&&nn(c,u,r)}(f,r);else if(f.offset>fi)throw new Error(bC);return t.offset+=f.size,f}catch(ae){if(m&&y||!m&&C){if(t.hasCorruptedEntries=!0,ae)try{ae.corruptedEntry=!0}catch{}m?t.offset+=N.writable.size:t.offset=N.writable.size}throw o.delete(n),ae}finally{m&&t.bufferedWrites--,g&&g(),p&&p()}function z(){return X.apply(this,arguments)}function X(){return(X=(0,E.A)(function*(){t.writerLocked=!0;const{lockWriter:ae}=t;t.lockWriter=new Promise(se=>p=()=>{t.writerLocked=!1,se()}),yield ae})).apply(this,arguments)}function ee(ae){return he.apply(this,arguments)}function he(){return(he=(0,E.A)(function*(ae){rn(u.localHeaderArray)>s.availableSize&&(s.availableSize=0,yield Bs(ae,new Uint8Array))})).apply(this,arguments)}}),xC.apply(this,arguments)}function TC(){return TC=(0,E.A)(function*(t,n,{diskNumberStart:e,lock:i},r,o,s){const{headerInfo:a,dataDescriptorInfo:l,metadataSize:c}=r,{localHeaderArray:u,headerArray:d,lastModDate:h,rawLastModDate:f,encrypted:m,compressed:p,version:g,compressionMethod:y,rawExtraFieldExtendedTimestamp:C,extraFieldExtendedTimestampFlag:N,rawExtraFieldNTFS:$,rawExtraFieldAES:H}=a,{dataDescriptorArray:z}=l,{rawFilename:X,lastAccessDate:ee,creationDate:he,password:ae,rawPassword:se,level:we,zip64:Ce,zip64UncompressedSize:Ie,zip64CompressedSize:Re,zip64Offset:te,zip64DiskNumberStart:_e,zipCrypto:ve,dataDescriptor:Ye,directory:Oe,versionMadeBy:jt,rawComment:Ge,rawExtraField:mt,useWebWorkers:$t,onstart:Gn,onprogress:In,onend:Sn,signal:xi,encryptionStrength:qn,extendedTimestamp:Ti,msDosCompatible:Fr,internalFileAttribute:Rr,externalFileAttribute:_o,useCompressionStream:Ca,passThrough:Rn}=s,zi={lock:i,versionMadeBy:jt,zip64:Ce,directory:!!Oe,filenameUTF8:!0,rawFilename:X,commentUTF8:!0,rawComment:Ge,rawExtraFieldExtendedTimestamp:C,rawExtraFieldNTFS:$,rawExtraFieldAES:H,rawExtraField:mt,extendedTimestamp:Ti,msDosCompatible:Fr,internalFileAttribute:Rr,externalFileAttribute:_o,diskNumberStart:e};let{signature:wa,uncompressedSize:No}=s,eo=0;Rn||(No=0);const{writable:Ws}=n;if(t){t.chunkSize=a3(o),yield Bs(Ws,u);const is=t.readable,Rg=is.size=t.size,GC={options:{codecType:N3,level:we,rawPassword:se,password:ae,encryptionStrength:qn,zipCrypto:m&&ve,passwordVerification:m&&ve&&f>>8&255,signed:!Rn,compressed:p&&!Rn,encrypted:m&&!Rn,useWebWorkers:$t,useCompressionStream:Ca,transferStreams:!1},config:o,streamOptions:{signal:xi,size:Rg,onstart:Gn,onprogress:In,onend:Sn}},Ru=yield V3({readable:is,writable:Ws},GC);eo=Ru.outputSize,Rn||(No=Ru.inputSize,wa=Ru.signature),Ws.size+=No}else yield Bs(Ws,u);let qs;if(Ce){let is=4;Ie&&(is+=8),Re&&(is+=8),te&&(is+=8),_e&&(is+=4),qs=new Uint8Array(is)}else qs=new Uint8Array;return function kX(t,n){const{signature:e,rawExtraFieldZip64:i,compressedSize:r,uncompressedSize:o,headerInfo:s,dataDescriptorInfo:a}=t,{headerView:l,encrypted:c}=s,{dataDescriptorView:u,dataDescriptorOffset:d}=a,{zip64:h,zip64UncompressedSize:f,zip64CompressedSize:m,zipCrypto:p,dataDescriptor:g}=n;if((!c||p)&&e!==cn&&(nn(l,10,e),g&&nn(u,d,e)),h){const y=er(i);un(y,0,XO),un(y,2,rn(i)-4);let C=4;f&&(nn(l,18,fi),Jr(y,C,BigInt(o)),C+=8),m&&(nn(l,14,fi),Jr(y,C,BigInt(r))),g&&(Jr(u,d+4,BigInt(r)),Jr(u,d+12,BigInt(o)))}else nn(l,14,r),nn(l,18,o),g&&(nn(u,d+4,r),nn(u,d+8,o))}({signature:wa,rawExtraFieldZip64:qs,compressedSize:eo,uncompressedSize:No,headerInfo:a,dataDescriptorInfo:l},s),Ye&&(yield Bs(Ws,z)),Object.assign(zi,{uncompressedSize:No,compressedSize:eo,lastModDate:h,rawLastModDate:f,creationDate:he,lastAccessDate:ee,encrypted:m,zipCrypto:ve,size:c+eo,compressionMethod:y,version:g,headerArray:d,signature:wa,rawExtraFieldZip64:qs,extraFieldExtendedTimestampFlag:N,zip64UncompressedSize:Ie,zip64CompressedSize:Re,zip64Offset:te,zip64DiskNumberStart:_e}),zi}),TC.apply(this,arguments)}function DC(){return DC=(0,E.A)(function*(t,n,e,{zipCrypto:i}){let r;r=yield n.slice(0,26).arrayBuffer(),26!=r.byteLength&&(r=r.slice(0,26));const o=new DataView(r);return(!t.encrypted||i)&&nn(o,14,t.signature),t.zip64?(nn(o,18,fi),nn(o,22,fi)):(nn(o,18,t.compressedSize),nn(o,22,t.uncompressedSize)),yield Bs(e,new Uint8Array(r)),n.slice(r.byteLength)}),DC.apply(this,arguments)}function SC(){return SC=(0,E.A)(function*(t,n,e){const{files:i,writer:r}=t,{diskOffset:o,writable:s}=r;let{diskNumber:a}=r,l=0,c=0,u=t.offset-o,d=i.size;for(const[,H]of i){const{rawFilename:z,rawExtraFieldZip64:X,rawExtraFieldAES:ee,rawComment:he,rawExtraFieldNTFS:ae,rawExtraField:se,extendedTimestamp:we,extraFieldExtendedTimestampFlag:Ce,lastModDate:Ie}=H;let Re;if(we){Re=new Uint8Array(9);const te=er(Re);un(te,0,v1),un(te,2,5),Ag(te,4,Ce),nn(te,5,Math.floor(Ie.getTime()/1e3))}else Re=new Uint8Array;H.rawExtraFieldCDExtendedTimestamp=Re,c+=46+rn(z,he,X,ee,ae,Re,se)}const h=new Uint8Array(c),f=er(h);yield go(r);let m=0;for(const[H,z]of Array.from(i.values()).entries()){const{offset:X,rawFilename:ee,rawExtraFieldZip64:he,rawExtraFieldAES:ae,rawExtraFieldCDExtendedTimestamp:se,rawExtraFieldNTFS:we,rawExtraField:Ce,rawComment:Ie,versionMadeBy:Re,headerArray:te,directory:_e,zip64:ve,zip64UncompressedSize:Ye,zip64CompressedSize:Oe,zip64DiskNumberStart:jt,zip64Offset:Ge,msDosCompatible:mt,internalFileAttribute:$t,externalFileAttribute:Gn,diskNumberStart:In,uncompressedSize:Sn,compressedSize:xi}=z,qn=rn(he,ae,se,we,Ce);nn(f,l,g1),un(f,l+4,Re);const Ti=er(te);Ye||nn(Ti,18,Sn),Oe||nn(Ti,14,xi),wi(h,te,l+6),un(f,l+30,qn),un(f,l+32,rn(Ie)),un(f,l+34,ve&&jt?oi:In),un(f,l+36,$t),Gn?nn(f,l+38,Gn):_e&&mt&&Ag(f,l+38,16),nn(f,l+42,ve&&Ge?fi:X),wi(h,ee,l+46),wi(h,he,l+46+rn(ee)),wi(h,ae,l+46+rn(ee,he)),wi(h,se,l+46+rn(ee,he,ae)),wi(h,we,l+46+rn(ee,he,ae,se)),wi(h,Ce,l+46+rn(ee,he,ae,se,we)),wi(h,Ie,l+46+rn(ee)+qn);const Fr=46+rn(ee,Ie)+qn;if(l-m>r.availableSize&&(r.availableSize=0,yield Bs(s,h.slice(m,l)),m=l),l+=Fr,e.onprogress)try{yield e.onprogress(H+1,i.size,new Wh(z))}catch{}}yield Bs(s,m?h.slice(m):h);let p=r.diskNumber;const{availableSize:g}=r;g<22&&p++;let y=_n(t,e,fC);if(u>fi||c>fi||d>oi||p>oi){if(!1===y)throw new Error(bC);y=!0}const C=new Uint8Array(y?98:22),N=er(C);l=0,y&&(nn(N,0,_1),Jr(N,4,BigInt(44)),un(N,12,45),un(N,14,45),nn(N,16,p),nn(N,20,a),Jr(N,24,BigInt(d)),Jr(N,32,BigInt(d)),Jr(N,40,BigInt(c)),Jr(N,48,BigInt(u)),nn(N,56,YO),Jr(N,64,BigInt(u)+BigInt(c)),nn(N,72,p+1),_n(t,e,"supportZip64SplitFile",!0)&&(p=oi,a=oi),d=oi,u=fi,c=fi,l+=76),nn(N,l,ZO),un(N,l+4,p),un(N,l+6,a),un(N,l+8,d),un(N,l+10,d),nn(N,l+12,c),nn(N,l+16,u);const $=rn(n);if($){if(!($<=oi))throw new Error("Zip file comment exceeds 64KB");un(N,l+20,$)}yield Bs(s,C),$&&(yield Bs(s,n))}),SC.apply(this,arguments)}function Bs(t,n){return MC.apply(this,arguments)}function MC(){return MC=(0,E.A)(function*(t,n){const e=t.getWriter();try{yield e.ready,t.size+=rn(n),yield e.write(n)}finally{e.releaseLock()}}),MC.apply(this,arguments)}function IC(t){if(t)return(BigInt(t.getTime())+BigInt(116444736e5))*BigInt(1e4)}function _n(t,n,e,i){const r=n[e]===cn?t.options[e]:n[e];return r===cn?i:r}function kP(t){return t+5*(Math.floor(t/16383)+1)}function Ag(t,n,e){t.setUint8(n,e)}function un(t,n,e){t.setUint16(n,e,!0)}function nn(t,n,e){t.setUint32(n,e,!0)}function Jr(t,n,e){t.setBigUint64(n,e,!0)}function wi(t,n,e){t.set(n,e)}function er(t){return new DataView(t.buffer)}function rn(...t){let n=0;return t.forEach(e=>e&&(n+=e.length)),n}let LP;try{LP="file:///D:/c/Kousuke/Documents/GitHubWorkSpace/udonarium/node_modules/@zip.js/zip.js/lib/zip-fs.js"}catch{}x1({baseURL:LP}),function PY(t,n={}){const e='const{Array:e,Object:t,Number:n,Math:r,Error:s,Uint8Array:i,Uint16Array:o,Uint32Array:c,Int32Array:f,Map:a,DataView:l,Promise:u,TextEncoder:w,crypto:h,postMessage:d,TransformStream:p,ReadableStream:y,WritableStream:m,CompressionStream:b,DecompressionStream:g}=self,k=void 0,v="undefined",S="function";class z{constructor(e){return class extends p{constructor(t,n){const r=new e(n);super({transform(e,t){t.enqueue(r.append(e))},flush(e){const t=r.flush();t&&e.enqueue(t)}})}}}}const C=[];for(let e=0;256>e;e++){let t=e;for(let e=0;8>e;e++)1&t?t=t>>>1^3988292384:t>>>=1;C[e]=t}class x{constructor(e){this.t=e||-1}append(e){let t=0|this.t;for(let n=0,r=0|e.length;r>n;n++)t=t>>>8^C[255&(t^e[n])];this.t=t}get(){return~this.t}}class A extends p{constructor(){let e;const t=new x;super({transform(e,n){t.append(e),n.enqueue(e)},flush(){const n=new i(4);new l(n.buffer).setUint32(0,t.get()),e.value=n}}),e=this}}const _={concat(e,t){if(0===e.length||0===t.length)return e.concat(t);const n=e[e.length-1],r=_.i(n);return 32===r?e.concat(t):_.o(t,r,0|n,e.slice(0,e.length-1))},l(e){const t=e.length;if(0===t)return 0;const n=e[t-1];return 32*(t-1)+_.i(n)},u(e,t){if(32*e.length<t)return e;const n=(e=e.slice(0,r.ceil(t/32))).length;return t&=31,n>0&&t&&(e[n-1]=_.h(t,e[n-1]&2147483648>>t-1,1)),e},h:(e,t,n)=>32===e?t:(n?0|t:t<<32-e)+1099511627776*e,i:e=>r.round(e/1099511627776)||32,o(e,t,n,r){for(void 0===r&&(r=[]);t>=32;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(let s=0;s<e.length;s++)r.push(n|e[s]>>>t),n=e[s]<<32-t;const s=e.length?e[e.length-1]:0,i=_.i(s);return r.push(_.h(t+i&31,t+i>32?n:r.pop(),1)),r}},I={p:{m(e){const t=_.l(e)/8,n=new i(t);let r;for(let s=0;t>s;s++)3&s||(r=e[s/4]),n[s]=r>>>24,r<<=8;return n},k(e){const t=[];let n,r=0;for(n=0;n<e.length;n++)r=r<<8|e[n],3&~n||(t.push(r),r=0);return 3&n&&t.push(_.h(8*(3&n),r)),t}}},P=class{constructor(e){const t=this;t.blockSize=512,t.v=[1732584193,4023233417,2562383102,271733878,3285377520],t.S=[1518500249,1859775393,2400959708,3395469782],e?(t.C=e.C.slice(0),t.A=e.A.slice(0),t._=e._):t.reset()}reset(){const e=this;return e.C=e.v.slice(0),e.A=[],e._=0,e}update(e){const t=this;"string"==typeof e&&(e=I.I.k(e));const n=t.A=_.concat(t.A,e),r=t._,i=t._=r+_.l(e);if(i>9007199254740991)throw new s("Cannot hash more than 2^53 - 1 bits");const o=new c(n);let f=0;for(let e=t.blockSize+r-(t.blockSize+r&t.blockSize-1);i>=e;e+=t.blockSize)t.P(o.subarray(16*f,16*(f+1))),f+=1;return n.splice(0,16*f),t}D(){const e=this;let t=e.A;const n=e.C;t=_.concat(t,[_.h(1,1)]);for(let e=t.length+2;15&e;e++)t.push(0);for(t.push(r.floor(e._/4294967296)),t.push(0|e._);t.length;)e.P(t.splice(0,16));return e.reset(),n}V(e,t,n,r){return e>19?e>39?e>59?e>79?void 0:t^n^r:t&n|t&r|n&r:t^n^r:t&n|~t&r}R(e,t){return t<<e|t>>>32-e}P(t){const n=this,s=n.C,i=e(80);for(let e=0;16>e;e++)i[e]=t[e];let o=s[0],c=s[1],f=s[2],a=s[3],l=s[4];for(let e=0;79>=e;e++){16>e||(i[e]=n.R(1,i[e-3]^i[e-8]^i[e-14]^i[e-16]));const t=n.R(5,o)+n.V(e,c,f,a)+l+i[e]+n.S[r.floor(e/20)]|0;l=a,a=f,f=n.R(30,c),c=o,o=t}s[0]=s[0]+o|0,s[1]=s[1]+c|0,s[2]=s[2]+f|0,s[3]=s[3]+a|0,s[4]=s[4]+l|0}},D={getRandomValues(e){const t=new c(e.buffer),n=e=>{let t=987654321;const n=4294967295;return()=>(t=36969*(65535&t)+(t>>16)&n,(((t<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n)/4294967296+.5)*(r.random()>.5?1:-1))};for(let s,i=0;i<e.length;i+=4){const e=n(4294967296*(s||r.random()));s=987654071*e(),t[i/4]=4294967296*e()|0}return e}},V={importKey:e=>new V.B(I.p.k(e)),M(e,t,n,r){if(n=n||1e4,0>r||0>n)throw new s("invalid params to pbkdf2");const i=1+(r>>5)<<2;let o,c,f,a,u;const w=new ArrayBuffer(i),h=new l(w);let d=0;const p=_;for(t=I.p.k(t),u=1;(i||1)>d;u++){for(o=c=e.encrypt(p.concat(t,[u])),f=1;n>f;f++)for(c=e.encrypt(c),a=0;a<c.length;a++)o[a]^=c[a];for(f=0;(i||1)>d&&f<o.length;f++)h.setInt32(d,o[f]),d+=4}return w.slice(0,r/8)},B:class{constructor(e){const t=this,n=t.U=P,r=[[],[]];t.K=[new n,new n];const s=t.K[0].blockSize/32;e.length>s&&(e=(new n).update(e).D());for(let t=0;s>t;t++)r[0][t]=909522486^e[t],r[1][t]=1549556828^e[t];t.K[0].update(r[0]),t.K[1].update(r[1]),t.N=new n(t.K[0])}reset(){const e=this;e.N=new e.U(e.K[0]),e.O=!1}update(e){this.O=!0,this.N.update(e)}digest(){const e=this,t=e.N.D(),n=new e.U(e.K[1]).update(t).D();return e.reset(),n}encrypt(e){if(this.O)throw new s("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}}},R=typeof h!=v&&typeof h.getRandomValues==S,B="Invalid password",E="Invalid signature",M="zipjs-abort-check-password";function U(e){return R?h.getRandomValues(e):D.getRandomValues(e)}const K=16,N={name:"PBKDF2"},O=t.assign({hash:{name:"HMAC"}},N),T=t.assign({iterations:1e3,hash:{name:"SHA-1"}},N),W=["deriveBits"],j=[8,12,16],H=[16,24,32],L=10,F=[0,0,0,0],q=typeof h!=v,G=q&&h.subtle,J=q&&typeof G!=v,Q=I.p,X=class{constructor(e){const t=this;t.T=[[[],[],[],[],[]],[[],[],[],[],[]]],t.T[0][0][0]||t.W();const n=t.T[0][4],r=t.T[1],i=e.length;let o,c,f,a=1;if(4!==i&&6!==i&&8!==i)throw new s("invalid aes key size");for(t.S=[c=e.slice(0),f=[]],o=i;4*i+28>o;o++){let e=c[o-1];(o%i==0||8===i&&o%i==4)&&(e=n[e>>>24]<<24^n[e>>16&255]<<16^n[e>>8&255]<<8^n[255&e],o%i==0&&(e=e<<8^e>>>24^a<<24,a=a<<1^283*(a>>7))),c[o]=c[o-i]^e}for(let e=0;o;e++,o--){const t=c[3&e?o:o-4];f[e]=4>=o||4>e?t:r[0][n[t>>>24]]^r[1][n[t>>16&255]]^r[2][n[t>>8&255]]^r[3][n[255&t]]}}encrypt(e){return this.j(e,0)}decrypt(e){return this.j(e,1)}W(){const e=this.T[0],t=this.T[1],n=e[4],r=t[4],s=[],i=[];let o,c,f,a;for(let e=0;256>e;e++)i[(s[e]=e<<1^283*(e>>7))^e]=e;for(let l=o=0;!n[l];l^=c||1,o=i[o]||1){let i=o^o<<1^o<<2^o<<3^o<<4;i=i>>8^255&i^99,n[l]=i,r[i]=l,a=s[f=s[c=s[l]]];let u=16843009*a^65537*f^257*c^16843008*l,w=257*s[i]^16843008*i;for(let n=0;4>n;n++)e[n][l]=w=w<<24^w>>>8,t[n][i]=u=u<<24^u>>>8}for(let n=0;5>n;n++)e[n]=e[n].slice(0),t[n]=t[n].slice(0)}j(e,t){if(4!==e.length)throw new s("invalid aes block size");const n=this.S[t],r=n.length/4-2,i=[0,0,0,0],o=this.T[t],c=o[0],f=o[1],a=o[2],l=o[3],u=o[4];let w,h,d,p=e[0]^n[0],y=e[t?3:1]^n[1],m=e[2]^n[2],b=e[t?1:3]^n[3],g=4;for(let e=0;r>e;e++)w=c[p>>>24]^f[y>>16&255]^a[m>>8&255]^l[255&b]^n[g],h=c[y>>>24]^f[m>>16&255]^a[b>>8&255]^l[255&p]^n[g+1],d=c[m>>>24]^f[b>>16&255]^a[p>>8&255]^l[255&y]^n[g+2],b=c[b>>>24]^f[p>>16&255]^a[y>>8&255]^l[255&m]^n[g+3],g+=4,p=w,y=h,m=d;for(let e=0;4>e;e++)i[t?3&-e:e]=u[p>>>24]<<24^u[y>>16&255]<<16^u[m>>8&255]<<8^u[255&b]^n[g++],w=p,p=y,y=m,m=b,b=w;return i}},Y=class{constructor(e,t){this.H=e,this.L=t,this.F=t}reset(){this.F=this.L}update(e){return this.q(this.H,e,this.F)}G(e){if(255&~(e>>24))e+=1<<24;else{let t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}return e}J(e){0===(e[0]=this.G(e[0]))&&(e[1]=this.G(e[1]))}q(e,t,n){let r;if(!(r=t.length))return[];const s=_.l(t);for(let s=0;r>s;s+=4){this.J(n);const r=e.encrypt(n);t[s]^=r[0],t[s+1]^=r[1],t[s+2]^=r[2],t[s+3]^=r[3]}return _.u(t,s)}},Z=V.B;let $=q&&J&&typeof G.importKey==S,ee=q&&J&&typeof G.deriveBits==S;class te extends p{constructor({password:e,rawPassword:n,signed:r,encryptionStrength:o,checkPasswordOnly:c}){super({start(){t.assign(this,{ready:new u((e=>this.X=e)),password:ie(e,n),signed:r,Y:o-1,pending:new i})},async transform(e,t){const n=this,{password:r,Y:o,X:f,ready:a}=n;r?(await(async(e,t,n,r)=>{const i=await se(e,t,n,ce(r,0,j[t])),o=ce(r,j[t]);if(i[0]!=o[0]||i[1]!=o[1])throw new s(B)})(n,o,r,ce(e,0,j[o]+2)),e=ce(e,j[o]+2),c?t.error(new s(M)):f()):await a;const l=new i(e.length-L-(e.length-L)%K);t.enqueue(re(n,e,l,0,L,!0))},async flush(e){const{signed:t,Z:n,$:r,pending:o,ready:c}=this;if(r&&n){await c;const f=ce(o,0,o.length-L),a=ce(o,o.length-L);let l=new i;if(f.length){const e=ae(Q,f);r.update(e);const t=n.update(e);l=fe(Q,t)}if(t){const e=ce(fe(Q,r.digest()),0,L);for(let t=0;L>t;t++)if(e[t]!=a[t])throw new s(E)}e.enqueue(l)}}})}}class ne extends p{constructor({password:e,rawPassword:n,encryptionStrength:r}){let s;super({start(){t.assign(this,{ready:new u((e=>this.X=e)),password:ie(e,n),Y:r-1,pending:new i})},async transform(e,t){const n=this,{password:r,Y:s,X:o,ready:c}=n;let f=new i;r?(f=await(async(e,t,n)=>{const r=U(new i(j[t]));return oe(r,await se(e,t,n,r))})(n,s,r),o()):await c;const a=new i(f.length+e.length-e.length%K);a.set(f,0),t.enqueue(re(n,e,a,f.length,0))},async flush(e){const{Z:t,$:n,pending:r,ready:o}=this;if(n&&t){await o;let c=new i;if(r.length){const e=t.update(ae(Q,r));n.update(e),c=fe(Q,e)}s.signature=fe(Q,n.digest()).slice(0,L),e.enqueue(oe(c,s.signature))}}}),s=this}}function re(e,t,n,r,s,o){const{Z:c,$:f,pending:a}=e,l=t.length-s;let u;for(a.length&&(t=oe(a,t),n=((e,t)=>{if(t&&t>e.length){const n=e;(e=new i(t)).set(n,0)}return e})(n,l-l%K)),u=0;l-K>=u;u+=K){const e=ae(Q,ce(t,u,u+K));o&&f.update(e);const s=c.update(e);o||f.update(s),n.set(fe(Q,s),u+r)}return e.pending=ce(t,u),n}async function se(n,r,s,o){n.password=null;const c=await(async(e,t,n,r,s)=>{if(!$)return V.importKey(t);try{return await G.importKey("raw",t,n,!1,s)}catch(e){return $=!1,V.importKey(t)}})(0,s,O,0,W),f=await(async(e,t,n)=>{if(!ee)return V.M(t,e.salt,T.iterations,n);try{return await G.deriveBits(e,t,n)}catch(r){return ee=!1,V.M(t,e.salt,T.iterations,n)}})(t.assign({salt:o},T),c,8*(2*H[r]+2)),a=new i(f),l=ae(Q,ce(a,0,H[r])),u=ae(Q,ce(a,H[r],2*H[r])),w=ce(a,2*H[r]);return t.assign(n,{keys:{key:l,ee:u,passwordVerification:w},Z:new Y(new X(l),e.from(F)),$:new Z(u)}),w}function ie(e,t){return t===k?(e=>{if(typeof w==v){const t=new i((e=unescape(encodeURIComponent(e))).length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}return(new w).encode(e)})(e):t}function oe(e,t){let n=e;return e.length+t.length&&(n=new i(e.length+t.length),n.set(e,0),n.set(t,e.length)),n}function ce(e,t,n){return e.subarray(t,n)}function fe(e,t){return e.m(t)}function ae(e,t){return e.k(t)}class le extends p{constructor({password:e,passwordVerification:n,checkPasswordOnly:r}){super({start(){t.assign(this,{password:e,passwordVerification:n}),de(this,e)},transform(e,t){const n=this;if(n.password){const t=we(n,e.subarray(0,12));if(n.password=null,t[11]!=n.passwordVerification)throw new s(B);e=e.subarray(12)}r?t.error(new s(M)):t.enqueue(we(n,e))}})}}class ue extends p{constructor({password:e,passwordVerification:n}){super({start(){t.assign(this,{password:e,passwordVerification:n}),de(this,e)},transform(e,t){const n=this;let r,s;if(n.password){n.password=null;const t=U(new i(12));t[11]=n.passwordVerification,r=new i(e.length+t.length),r.set(he(n,t),0),s=12}else r=new i(e.length),s=0;r.set(he(n,e),s),t.enqueue(r)}})}}function we(e,t){const n=new i(t.length);for(let r=0;r<t.length;r++)n[r]=ye(e)^t[r],pe(e,n[r]);return n}function he(e,t){const n=new i(t.length);for(let r=0;r<t.length;r++)n[r]=ye(e)^t[r],pe(e,t[r]);return n}function de(e,n){const r=[305419896,591751049,878082192];t.assign(e,{keys:r,te:new x(r[0]),ne:new x(r[2])});for(let t=0;t<n.length;t++)pe(e,n.charCodeAt(t))}function pe(e,t){let[n,s,i]=e.keys;e.te.append([t]),n=~e.te.get(),s=be(r.imul(be(s+me(n)),134775813)+1),e.ne.append([s>>>24]),i=~e.ne.get(),e.keys=[n,s,i]}function ye(e){const t=2|e.keys[2];return me(r.imul(t,1^t)>>>8)}function me(e){return 255&e}function be(e){return 4294967295&e}const ge="deflate-raw";class ke extends p{constructor(e,{chunkSize:t,CompressionStream:n,CompressionStreamNative:r}){super({});const{compressed:s,encrypted:i,useCompressionStream:o,zipCrypto:c,signed:f,level:a}=e,u=this;let w,h,d=Se(super.readable);i&&!c||!f||(w=new A,d=xe(d,w)),s&&(d=Ce(d,o,{level:a,chunkSize:t},r,n)),i&&(c?d=xe(d,new ue(e)):(h=new ne(e),d=xe(d,h))),ze(u,d,(()=>{let e;i&&!c&&(e=h.signature),i&&!c||!f||(e=new l(w.value.buffer).getUint32(0)),u.signature=e}))}}class ve extends p{constructor(e,{chunkSize:t,DecompressionStream:n,DecompressionStreamNative:r}){super({});const{zipCrypto:i,encrypted:o,signed:c,signature:f,compressed:a,useCompressionStream:u}=e;let w,h,d=Se(super.readable);o&&(i?d=xe(d,new le(e)):(h=new te(e),d=xe(d,h))),a&&(d=Ce(d,u,{chunkSize:t},r,n)),o&&!i||!c||(w=new A,d=xe(d,w)),ze(this,d,(()=>{if((!o||i)&&c){const e=new l(w.value.buffer);if(f!=e.getUint32(0,!1))throw new s(E)}}))}}function Se(e){return xe(e,new p({transform(e,t){e&&e.length&&t.enqueue(e)}}))}function ze(e,n,r){n=xe(n,new p({flush:r})),t.defineProperty(e,"readable",{get:()=>n})}function Ce(e,t,n,r,s){try{e=xe(e,new(t&&r?r:s)(ge,n))}catch(r){if(!t)return e;try{e=xe(e,new s(ge,n))}catch(t){return e}}return e}function xe(e,t){return e.pipeThrough(t)}const Ae="data",_e="close";class Ie extends p{constructor(e,n){super({});const r=this,{codecType:s}=e;let i;s.startsWith("deflate")?i=ke:s.startsWith("inflate")&&(i=ve);let o=0,c=0;const f=new i(e,n),a=super.readable,l=new p({transform(e,t){e&&e.length&&(c+=e.length,t.enqueue(e))},flush(){t.assign(r,{inputSize:c})}}),u=new p({transform(e,t){e&&e.length&&(o+=e.length,t.enqueue(e))},flush(){const{signature:e}=f;t.assign(r,{signature:e,outputSize:o,inputSize:c})}});t.defineProperty(r,"readable",{get:()=>a.pipeThrough(l).pipeThrough(f).pipeThrough(u)})}}class Pe extends p{constructor(e){let t;super({transform:function n(r,s){if(t){const e=new i(t.length+r.length);e.set(t),e.set(r,t.length),r=e,t=null}r.length>e?(s.enqueue(r.slice(0,e)),n(r.slice(e),s)):t=r},flush(e){t&&t.length&&e.enqueue(t)}})}}const De=new a,Ve=new a;let Re,Be=0,Ee=!0;async function Me(e){try{const{options:t,scripts:r,config:s}=e;if(r&&r.length)try{Ee?importScripts.apply(k,r):await Ue(r)}catch(e){Ee=!1,await Ue(r)}self.initCodec&&self.initCodec(),s.CompressionStreamNative=self.CompressionStream,s.DecompressionStreamNative=self.DecompressionStream,self.Deflate&&(s.CompressionStream=new z(self.Deflate)),self.Inflate&&(s.DecompressionStream=new z(self.Inflate));const i={highWaterMark:1},o=e.readable||new y({async pull(e){const t=new u((e=>De.set(Be,e)));Ke({type:"pull",messageId:Be}),Be=(Be+1)%n.MAX_SAFE_INTEGER;const{value:r,done:s}=await t;e.enqueue(r),s&&e.close()}},i),c=e.writable||new m({async write(e){let t;const r=new u((e=>t=e));Ve.set(Be,t),Ke({type:Ae,value:e,messageId:Be}),Be=(Be+1)%n.MAX_SAFE_INTEGER,await r}},i),f=new Ie(t,s);Re=new AbortController;const{signal:a}=Re;await o.pipeThrough(f).pipeThrough(new Pe(s.chunkSize)).pipeTo(c,{signal:a,preventClose:!0,preventAbort:!0}),await c.getWriter().close();const{signature:l,inputSize:w,outputSize:h}=f;Ke({type:_e,result:{signature:l,inputSize:w,outputSize:h}})}catch(e){Ne(e)}}async function Ue(e){for(const t of e)await import(t)}function Ke(e){let{value:t}=e;if(t)if(t.length)try{t=new i(t),e.value=t.buffer,d(e,[e.value])}catch(t){d(e)}else d(e);else d(e)}function Ne(e=new s("Unknown error")){const{message:t,stack:n,code:r,name:i}=e;d({error:{message:t,stack:n,code:r,name:i}})}addEventListener("message",(({data:e})=>{const{type:t,messageId:n,value:r,done:s}=e;try{if("start"==t&&Me(e),t==Ae){const e=De.get(n);De.delete(n),e({value:new i(r),done:s})}if("ack"==t){const e=Ve.get(n);Ve.delete(n),e()}t==_e&&Re.abort()}catch(e){Ne(e)}}));const Oe=15,Te=573,We=-2;function je(t){return He(t.map((([t,n])=>new e(t).fill(n,0,t))))}function He(t){return t.reduce(((t,n)=>t.concat(e.isArray(n)?He(n):n)),[])}const Le=[0,1,2,3].concat(...je([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function Fe(){const e=this;function t(e,t){let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}e.re=n=>{const s=e.se,i=e.oe.ie,o=e.oe.ce;let c,f,a,l=-1;for(n.fe=0,n.ae=Te,c=0;o>c;c++)0!==s[2*c]?(n.le[++n.fe]=l=c,n.ue[c]=0):s[2*c+1]=0;for(;2>n.fe;)a=n.le[++n.fe]=2>l?++l:0,s[2*a]=1,n.ue[a]=0,n.we--,i&&(n.he-=i[2*a+1]);for(e.de=l,c=r.floor(n.fe/2);c>=1;c--)n.pe(s,c);a=o;do{c=n.le[1],n.le[1]=n.le[n.fe--],n.pe(s,1),f=n.le[1],n.le[--n.ae]=c,n.le[--n.ae]=f,s[2*a]=s[2*c]+s[2*f],n.ue[a]=r.max(n.ue[c],n.ue[f])+1,s[2*c+1]=s[2*f+1]=a,n.le[1]=a++,n.pe(s,1)}while(n.fe>=2);n.le[--n.ae]=n.le[1],(t=>{const n=e.se,r=e.oe.ie,s=e.oe.ye,i=e.oe.me,o=e.oe.be;let c,f,a,l,u,w,h=0;for(l=0;Oe>=l;l++)t.ge[l]=0;for(n[2*t.le[t.ae]+1]=0,c=t.ae+1;Te>c;c++)f=t.le[c],l=n[2*n[2*f+1]+1]+1,l>o&&(l=o,h++),n[2*f+1]=l,f>e.de||(t.ge[l]++,u=0,i>f||(u=s[f-i]),w=n[2*f],t.we+=w*(l+u),r&&(t.he+=w*(r[2*f+1]+u)));if(0!==h){do{for(l=o-1;0===t.ge[l];)l--;t.ge[l]--,t.ge[l+1]+=2,t.ge[o]--,h-=2}while(h>0);for(l=o;0!==l;l--)for(f=t.ge[l];0!==f;)a=t.le[--c],a>e.de||(n[2*a+1]!=l&&(t.we+=(l-n[2*a+1])*n[2*a],n[2*a+1]=l),f--)}})(n),((e,n,r)=>{const s=[];let i,o,c,f=0;for(i=1;Oe>=i;i++)s[i]=f=f+r[i-1]<<1;for(o=0;n>=o;o++)c=e[2*o+1],0!==c&&(e[2*o]=t(s[c]++,c))})(s,e.de,n.ge)}}function qe(e,t,n,r,s){const i=this;i.ie=e,i.ye=t,i.me=n,i.ce=r,i.be=s}Fe.ke=[0,1,2,3,4,5,6,7].concat(...je([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),Fe.ve=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],Fe.Se=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],Fe.ze=e=>256>e?Le[e]:Le[256+(e>>>7)],Fe.Ce=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Fe.xe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Fe.Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Fe._e=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];const Ge=je([[144,8],[112,9],[24,7],[8,8]]);qe.Ie=He([12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227].map(((e,t)=>[e,Ge[t]])));const Je=je([[30,5]]);function Qe(e,t,n,r,s){const i=this;i.Pe=e,i.De=t,i.Ve=n,i.Re=r,i.Be=s}qe.Ee=He([0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23].map(((e,t)=>[e,Je[t]]))),qe.Me=new qe(qe.Ie,Fe.Ce,257,286,Oe),qe.Ue=new qe(qe.Ee,Fe.xe,0,30,Oe),qe.Ke=new qe(null,Fe.Ae,0,19,7);const Xe=[new Qe(0,0,0,0,0),new Qe(4,4,8,4,1),new Qe(4,5,16,8,1),new Qe(4,6,32,32,1),new Qe(4,4,16,16,2),new Qe(8,16,32,32,2),new Qe(8,16,128,128,2),new Qe(8,32,128,256,2),new Qe(32,128,258,1024,2),new Qe(32,258,258,4096,2)],Ye=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Ze=113,$e=666,et=262;function tt(e,t,n,r){const s=e[2*t],i=e[2*n];return i>s||s==i&&r[t]<=r[n]}function nt(){const e=this;let t,n,s,c,f,a,l,u,w,h,d,p,y,m,b,g,k,v,S,z,C,x,A,_,I,P,D,V,R,B,E,M,U;const K=new Fe,N=new Fe,O=new Fe;let T,W,j,H,L,F;function q(){let t;for(t=0;286>t;t++)E[2*t]=0;for(t=0;30>t;t++)M[2*t]=0;for(t=0;19>t;t++)U[2*t]=0;E[512]=1,e.we=e.he=0,W=j=0}function G(e,t){let n,r=-1,s=e[1],i=0,o=7,c=4;0===s&&(o=138,c=3),e[2*(t+1)+1]=65535;for(let f=0;t>=f;f++)n=s,s=e[2*(f+1)+1],++i<o&&n==s||(c>i?U[2*n]+=i:0!==n?(n!=r&&U[2*n]++,U[32]++):i>10?U[36]++:U[34]++,i=0,r=n,0===s?(o=138,c=3):n==s?(o=6,c=3):(o=7,c=4))}function J(t){e.Ne[e.pending++]=t}function Q(e){J(255&e),J(e>>>8&255)}function X(e,t){let n;const r=t;F>16-r?(n=e,L|=n<<F&65535,Q(L),L=n>>>16-F,F+=r-16):(L|=e<<F&65535,F+=r)}function Y(e,t){const n=2*e;X(65535&t[n],65535&t[n+1])}function Z(e,t){let n,r,s=-1,i=e[1],o=0,c=7,f=4;for(0===i&&(c=138,f=3),n=0;t>=n;n++)if(r=i,i=e[2*(n+1)+1],++o>=c||r!=i){if(f>o)do{Y(r,U)}while(0!=--o);else 0!==r?(r!=s&&(Y(r,U),o--),Y(16,U),X(o-3,2)):o>10?(Y(18,U),X(o-11,7)):(Y(17,U),X(o-3,3));o=0,s=r,0===i?(c=138,f=3):r==i?(c=6,f=3):(c=7,f=4)}}function $(){16==F?(Q(L),L=0,F=0):8>F||(J(255&L),L>>>=8,F-=8)}function ee(t,n){let s,i,o;if(e.Oe[W]=t,e.Te[W]=255&n,W++,0===t?E[2*n]++:(j++,t--,E[2*(Fe.ke[n]+256+1)]++,M[2*Fe.ze(t)]++),!(8191&W)&&D>2){for(s=8*W,i=C-k,o=0;30>o;o++)s+=M[2*o]*(5+Fe.xe[o]);if(s>>>=3,j<r.floor(W/2)&&s<r.floor(i/2))return!0}return W==T-1}function te(t,n){let r,s,i,o,c=0;if(0!==W)do{r=e.Oe[c],s=e.Te[c],c++,0===r?Y(s,t):(i=Fe.ke[s],Y(i+256+1,t),o=Fe.Ce[i],0!==o&&(s-=Fe.ve[i],X(s,o)),r--,i=Fe.ze(r),Y(i,n),o=Fe.xe[i],0!==o&&(r-=Fe.Se[i],X(r,o)))}while(W>c);Y(256,t),H=t[513]}function ne(){F>8?Q(L):F>0&&J(255&L),L=0,F=0}function re(t,n,r){X(0+(r?1:0),3),((t,n)=>{ne(),H=8,Q(n),Q(~n),e.Ne.set(u.subarray(t,t+n),e.pending),e.pending+=n})(t,n)}function se(n){((t,n,r)=>{let s,i,o=0;D>0?(K.re(e),N.re(e),o=(()=>{let t;for(G(E,K.de),G(M,N.de),O.re(e),t=18;t>=3&&0===U[2*Fe._e[t]+1];t--);return e.we+=14+3*(t+1),t})(),s=e.we+3+7>>>3,i=e.he+3+7>>>3,i>s||(s=i)):s=i=n+5,n+4>s||-1==t?i==s?(X(2+(r?1:0),3),te(qe.Ie,qe.Ee)):(X(4+(r?1:0),3),((e,t,n)=>{let r;for(X(e-257,5),X(t-1,5),X(n-4,4),r=0;n>r;r++)X(U[2*Fe._e[r]+1],3);Z(E,e-1),Z(M,t-1)})(K.de+1,N.de+1,o+1),te(E,M)):re(t,n,r),q(),r&&ne()})(0>k?-1:k,C-k,n),k=C,t.We()}function ie(){let e,n,r,s;do{if(s=w-A-C,0===s&&0===C&&0===A)s=f;else if(-1==s)s--;else if(C>=f+f-et){u.set(u.subarray(f,f+f),0),x-=f,C-=f,k-=f,e=y,r=e;do{n=65535&d[--r],d[r]=f>n?0:n-f}while(0!=--e);e=f,r=e;do{n=65535&h[--r],h[r]=f>n?0:n-f}while(0!=--e);s+=f}if(0===t.je)return;e=t.He(u,C+A,s),A+=e,3>A||(p=255&u[C],p=(p<<g^255&u[C+1])&b)}while(et>A&&0!==t.je)}function oe(e){let t,n,r=I,s=C,i=_;const o=C>f-et?C-(f-et):0;let c=B;const a=l,w=C+258;let d=u[s+i-1],p=u[s+i];R>_||(r>>=2),c>A&&(c=A);do{if(t=e,u[t+i]==p&&u[t+i-1]==d&&u[t]==u[s]&&u[++t]==u[s+1]){s+=2,t++;do{}while(u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&w>s);if(n=258-(w-s),s=w-258,n>i){if(x=e,i=n,n>=c)break;d=u[s+i-1],p=u[s+i]}}}while((e=65535&h[e&a])>o&&0!=--r);return i>A?A:i}e.ue=[],e.ge=[],e.le=[],E=[],M=[],U=[],e.pe=(t,n)=>{const r=e.le,s=r[n];let i=n<<1;for(;i<=e.fe&&(i<e.fe&&tt(t,r[i+1],r[i],e.ue)&&i++,!tt(t,s,r[i],e.ue));)r[n]=r[i],n=i,i<<=1;r[n]=s},e.Le=(t,S,x,W,j,G)=>(W||(W=8),j||(j=8),G||(G=0),t.Fe=null,-1==S&&(S=6),1>j||j>9||8!=W||9>x||x>15||0>S||S>9||0>G||G>2?We:(t.qe=e,a=x,f=1<<a,l=f-1,m=j+7,y=1<<m,b=y-1,g=r.floor((m+3-1)/3),u=new i(2*f),h=[],d=[],T=1<<j+6,e.Ne=new i(4*T),s=4*T,e.Oe=new o(T),e.Te=new i(T),D=S,V=G,(t=>(t.Ge=t.Je=0,t.Fe=null,e.pending=0,e.Qe=0,n=Ze,c=0,K.se=E,K.oe=qe.Me,N.se=M,N.oe=qe.Ue,O.se=U,O.oe=qe.Ke,L=0,F=0,H=8,q(),(()=>{w=2*f,d[y-1]=0;for(let e=0;y-1>e;e++)d[e]=0;P=Xe[D].De,R=Xe[D].Pe,B=Xe[D].Ve,I=Xe[D].Re,C=0,k=0,A=0,v=_=2,z=0,p=0})(),0))(t))),e.Xe=()=>42!=n&&n!=Ze&&n!=$e?We:(e.Te=null,e.Oe=null,e.Ne=null,d=null,h=null,u=null,e.qe=null,n==Ze?-3:0),e.Ye=(e,t,n)=>{let r=0;return-1==t&&(t=6),0>t||t>9||0>n||n>2?We:(Xe[D].Be!=Xe[t].Be&&0!==e.Ge&&(r=e.Ze(1)),D!=t&&(D=t,P=Xe[D].De,R=Xe[D].Pe,B=Xe[D].Ve,I=Xe[D].Re),V=n,r)},e.$e=(e,t,r)=>{let s,i=r,o=0;if(!t||42!=n)return We;if(3>i)return 0;for(i>f-et&&(i=f-et,o=r-i),u.set(t.subarray(o,o+i),0),C=i,k=i,p=255&u[0],p=(p<<g^255&u[1])&b,s=0;i-3>=s;s++)p=(p<<g^255&u[s+2])&b,h[s&l]=d[p],d[p]=s;return 0},e.Ze=(r,i)=>{let o,w,m,I,R;if(i>4||0>i)return We;if(!r.et||!r.tt&&0!==r.je||n==$e&&4!=i)return r.Fe=Ye[4],We;if(0===r.nt)return r.Fe=Ye[7],-5;var B;if(t=r,I=c,c=i,42==n&&(w=8+(a-8<<4)<<8,m=(D-1&255)>>1,m>3&&(m=3),w|=m<<6,0!==C&&(w|=32),w+=31-w%31,n=Ze,J((B=w)>>8&255),J(255&B)),0!==e.pending){if(t.We(),0===t.nt)return c=-1,0}else if(0===t.je&&I>=i&&4!=i)return t.Fe=Ye[7],-5;if(n==$e&&0!==t.je)return r.Fe=Ye[7],-5;if(0!==t.je||0!==A||0!=i&&n!=$e){switch(R=-1,Xe[D].Be){case 0:R=(e=>{let n,r=65535;for(r>s-5&&(r=s-5);;){if(1>=A){if(ie(),0===A&&0==e)return 0;if(0===A)break}if(C+=A,A=0,n=k+r,(0===C||C>=n)&&(A=C-n,C=n,se(!1),0===t.nt))return 0;if(C-k>=f-et&&(se(!1),0===t.nt))return 0}return se(4==e),0===t.nt?4==e?2:0:4==e?3:1})(i);break;case 1:R=(e=>{let n,r=0;for(;;){if(et>A){if(ie(),et>A&&0==e)return 0;if(0===A)break}if(3>A||(p=(p<<g^255&u[C+2])&b,r=65535&d[p],h[C&l]=d[p],d[p]=C),0===r||(C-r&65535)>f-et||2!=V&&(v=oe(r)),3>v)n=ee(0,255&u[C]),A--,C++;else if(n=ee(C-x,v-3),A-=v,v>P||3>A)C+=v,v=0,p=255&u[C],p=(p<<g^255&u[C+1])&b;else{v--;do{C++,p=(p<<g^255&u[C+2])&b,r=65535&d[p],h[C&l]=d[p],d[p]=C}while(0!=--v);C++}if(n&&(se(!1),0===t.nt))return 0}return se(4==e),0===t.nt?4==e?2:0:4==e?3:1})(i);break;case 2:R=(e=>{let n,r,s=0;for(;;){if(et>A){if(ie(),et>A&&0==e)return 0;if(0===A)break}if(3>A||(p=(p<<g^255&u[C+2])&b,s=65535&d[p],h[C&l]=d[p],d[p]=C),_=v,S=x,v=2,0!==s&&P>_&&f-et>=(C-s&65535)&&(2!=V&&(v=oe(s)),5>=v&&(1==V||3==v&&C-x>4096)&&(v=2)),3>_||v>_)if(0!==z){if(n=ee(0,255&u[C-1]),n&&se(!1),C++,A--,0===t.nt)return 0}else z=1,C++,A--;else{r=C+A-3,n=ee(C-1-S,_-3),A-=_-1,_-=2;do{++C>r||(p=(p<<g^255&u[C+2])&b,s=65535&d[p],h[C&l]=d[p],d[p]=C)}while(0!=--_);if(z=0,v=2,C++,n&&(se(!1),0===t.nt))return 0}}return 0!==z&&(n=ee(0,255&u[C-1]),z=0),se(4==e),0===t.nt?4==e?2:0:4==e?3:1})(i)}if(2!=R&&3!=R||(n=$e),0==R||2==R)return 0===t.nt&&(c=-1),0;if(1==R){if(1==i)X(2,3),Y(256,qe.Ie),$(),9>1+H+10-F&&(X(2,3),Y(256,qe.Ie),$()),H=7;else if(re(0,0,!1),3==i)for(o=0;y>o;o++)d[o]=0;if(t.We(),0===t.nt)return c=-1,0}}return 4!=i?0:1}}function rt(){const e=this;e.rt=0,e.st=0,e.je=0,e.Ge=0,e.nt=0,e.Je=0}function st(e){const t=new rt,n=(o=e&&e.chunkSize?e.chunkSize:65536)+5*(r.floor(o/16383)+1);var o;const c=new i(n);let f=e?e.level:-1;void 0===f&&(f=-1),t.Le(f),t.et=c,this.append=(e,r)=>{let o,f,a=0,l=0,u=0;const w=[];if(e.length){t.rt=0,t.tt=e,t.je=e.length;do{if(t.st=0,t.nt=n,o=t.Ze(0),0!=o)throw new s("deflating: "+t.Fe);t.st&&(t.st==n?w.push(new i(c)):w.push(c.subarray(0,t.st))),u+=t.st,r&&t.rt>0&&t.rt!=a&&(r(t.rt),a=t.rt)}while(t.je>0||0===t.nt);return w.length>1?(f=new i(u),w.forEach((e=>{f.set(e,l),l+=e.length}))):f=w[0]?new i(w[0]):new i,f}},this.flush=()=>{let e,r,o=0,f=0;const a=[];do{if(t.st=0,t.nt=n,e=t.Ze(4),1!=e&&0!=e)throw new s("deflating: "+t.Fe);n-t.nt>0&&a.push(c.slice(0,t.st)),f+=t.st}while(t.je>0||0===t.nt);return t.Xe(),r=new i(f),a.forEach((e=>{r.set(e,o),o+=e.length})),r}}rt.prototype={Le(e,t){const n=this;return n.qe=new nt,t||(t=Oe),n.qe.Le(n,e,t)},Ze(e){const t=this;return t.qe?t.qe.Ze(t,e):We},Xe(){const e=this;if(!e.qe)return We;const t=e.qe.Xe();return e.qe=null,t},Ye(e,t){const n=this;return n.qe?n.qe.Ye(n,e,t):We},$e(e,t){const n=this;return n.qe?n.qe.$e(n,e,t):We},He(e,t,n){const r=this;let s=r.je;return s>n&&(s=n),0===s?0:(r.je-=s,e.set(r.tt.subarray(r.rt,r.rt+s),t),r.rt+=s,r.Ge+=s,s)},We(){const e=this;let t=e.qe.pending;t>e.nt&&(t=e.nt),0!==t&&(e.et.set(e.qe.Ne.subarray(e.qe.Qe,e.qe.Qe+t),e.st),e.st+=t,e.qe.Qe+=t,e.Je+=t,e.nt-=t,e.qe.pending-=t,0===e.qe.pending&&(e.qe.Qe=0))}};const it=0,ot=1,ct=-2,ft=-3,at=-4,lt=-5,ut=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],wt=1440,ht=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],dt=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],pt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],yt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],mt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],bt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],gt=15;function kt(){let e,t,n,r,s,i;function o(e,t,o,c,f,a,l,u,w,h,d){let p,y,m,b,g,k,v,S,z,C,x,A,_,I,P;C=0,g=o;do{n[e[t+C]]++,C++,g--}while(0!==g);if(n[0]==o)return l[0]=-1,u[0]=0,it;for(S=u[0],k=1;gt>=k&&0===n[k];k++);for(v=k,k>S&&(S=k),g=gt;0!==g&&0===n[g];g--);for(m=g,S>g&&(S=g),u[0]=S,I=1<<k;g>k;k++,I<<=1)if(0>(I-=n[k]))return ft;if(0>(I-=n[g]))return ft;for(n[g]+=I,i[1]=k=0,C=1,_=2;0!=--g;)i[_]=k+=n[C],_++,C++;g=0,C=0;do{0!==(k=e[t+C])&&(d[i[k]++]=g),C++}while(++g<o);for(o=i[m],i[0]=g=0,C=0,b=-1,A=-S,s[0]=0,x=0,P=0;m>=v;v++)for(p=n[v];0!=p--;){for(;v>A+S;){if(b++,A+=S,P=m-A,P=P>S?S:P,(y=1<<(k=v-A))>p+1&&(y-=p+1,_=v,P>k))for(;++k<P&&(y<<=1)>n[++_];)y-=n[_];if(P=1<<k,h[0]+P>wt)return ft;s[b]=x=h[0],h[0]+=P,0!==b?(i[b]=g,r[0]=k,r[1]=S,k=g>>>A-S,r[2]=x-s[b-1]-k,w.set(r,3*(s[b-1]+k))):l[0]=x}for(r[1]=v-A,o>C?d[C]<c?(r[0]=256>d[C]?0:96,r[2]=d[C++]):(r[0]=a[d[C]-c]+16+64,r[2]=f[d[C++]-c]):r[0]=192,y=1<<v-A,k=g>>>A;P>k;k+=y)w.set(r,3*(x+k));for(k=1<<v-1;g&k;k>>>=1)g^=k;for(g^=k,z=(1<<A)-1;(g&z)!=i[b];)b--,A-=S,z=(1<<A)-1}return 0!==I&&1!=m?lt:it}function c(o){let c;for(e||(e=[],t=[],n=new f(gt+1),r=[],s=new f(gt),i=new f(gt+1)),t.length<o&&(t=[]),c=0;o>c;c++)t[c]=0;for(c=0;gt+1>c;c++)n[c]=0;for(c=0;3>c;c++)r[c]=0;s.set(n.subarray(0,gt),0),i.set(n.subarray(0,gt+1),0)}this.it=(n,r,s,i,f)=>{let a;return c(19),e[0]=0,a=o(n,0,19,19,null,null,s,r,i,e,t),a==ft?f.Fe="oversubscribed dynamic bit lengths tree":a!=lt&&0!==r[0]||(f.Fe="incomplete dynamic bit lengths tree",a=ft),a},this.ot=(n,r,s,i,f,a,l,u,w)=>{let h;return c(288),e[0]=0,h=o(s,0,n,257,pt,yt,a,i,u,e,t),h!=it||0===i[0]?(h==ft?w.Fe="oversubscribed literal/length tree":h!=at&&(w.Fe="incomplete literal/length tree",h=ft),h):(c(288),h=o(s,n,r,0,mt,bt,l,f,u,e,t),h!=it||0===f[0]&&n>257?(h==ft?w.Fe="oversubscribed distance tree":h==lt?(w.Fe="incomplete distance tree",h=ft):h!=at&&(w.Fe="empty distance tree with lengths",h=ft),h):it)}}kt.ct=(e,t,n,r)=>(e[0]=9,t[0]=5,n[0]=ht,r[0]=dt,it);const vt=0,St=1,zt=2,Ct=3,xt=4,At=5,_t=6,It=7,Pt=8,Dt=9;function Vt(){const e=this;let t,n,r,s,i=0,o=0,c=0,f=0,a=0,l=0,u=0,w=0,h=0,d=0;function p(e,t,n,r,s,i,o,c){let f,a,l,u,w,h,d,p,y,m,b,g,k,v,S,z;d=c.rt,p=c.je,w=o.ft,h=o.lt,y=o.write,m=y<o.read?o.read-y-1:o.end-y,b=ut[e],g=ut[t];do{for(;20>h;)p--,w|=(255&c.ut(d++))<<h,h+=8;if(f=w&b,a=n,l=r,z=3*(l+f),0!==(u=a[z]))for(;;){if(w>>=a[z+1],h-=a[z+1],16&u){for(u&=15,k=a[z+2]+(w&ut[u]),w>>=u,h-=u;15>h;)p--,w|=(255&c.ut(d++))<<h,h+=8;for(f=w&g,a=s,l=i,z=3*(l+f),u=a[z];;){if(w>>=a[z+1],h-=a[z+1],16&u){for(u&=15;u>h;)p--,w|=(255&c.ut(d++))<<h,h+=8;if(v=a[z+2]+(w&ut[u]),w>>=u,h-=u,m-=k,v>y){S=y-v;do{S+=o.end}while(0>S);if(u=o.end-S,k>u){if(k-=u,y-S>0&&u>y-S)do{o.wt[y++]=o.wt[S++]}while(0!=--u);else o.wt.set(o.wt.subarray(S,S+u),y),y+=u,S+=u,u=0;S=0}}else S=y-v,y-S>0&&2>y-S?(o.wt[y++]=o.wt[S++],o.wt[y++]=o.wt[S++],k-=2):(o.wt.set(o.wt.subarray(S,S+2),y),y+=2,S+=2,k-=2);if(y-S>0&&k>y-S)do{o.wt[y++]=o.wt[S++]}while(0!=--k);else o.wt.set(o.wt.subarray(S,S+k),y),y+=k,S+=k,k=0;break}if(64&u)return c.Fe="invalid distance code",k=c.je-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ft=w,o.lt=h,c.je=p,c.Ge+=d-c.rt,c.rt=d,o.write=y,ft;f+=a[z+2],f+=w&ut[u],z=3*(l+f),u=a[z]}break}if(64&u)return 32&u?(k=c.je-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ft=w,o.lt=h,c.je=p,c.Ge+=d-c.rt,c.rt=d,o.write=y,ot):(c.Fe="invalid literal/length code",k=c.je-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ft=w,o.lt=h,c.je=p,c.Ge+=d-c.rt,c.rt=d,o.write=y,ft);if(f+=a[z+2],f+=w&ut[u],z=3*(l+f),0===(u=a[z])){w>>=a[z+1],h-=a[z+1],o.wt[y++]=a[z+2],m--;break}}else w>>=a[z+1],h-=a[z+1],o.wt[y++]=a[z+2],m--}while(m>=258&&p>=10);return k=c.je-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ft=w,o.lt=h,c.je=p,c.Ge+=d-c.rt,c.rt=d,o.write=y,it}e.init=(e,i,o,c,f,a)=>{t=vt,u=e,w=i,r=o,h=c,s=f,d=a,n=null},e.ht=(e,y,m)=>{let b,g,k,v,S,z,C,x=0,A=0,_=0;for(_=y.rt,v=y.je,x=e.ft,A=e.lt,S=e.write,z=S<e.read?e.read-S-1:e.end-S;;)switch(t){case vt:if(z>=258&&v>=10&&(e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,m=p(u,w,r,h,s,d,e,y),_=y.rt,v=y.je,x=e.ft,A=e.lt,S=e.write,z=S<e.read?e.read-S-1:e.end-S,m!=it)){t=m==ot?It:Dt;break}c=u,n=r,o=h,t=St;case St:for(b=c;b>A;){if(0===v)return e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);m=it,v--,x|=(255&y.ut(_++))<<A,A+=8}if(g=3*(o+(x&ut[b])),x>>>=n[g+1],A-=n[g+1],k=n[g],0===k){f=n[g+2],t=_t;break}if(16&k){a=15&k,i=n[g+2],t=zt;break}if(!(64&k)){c=k,o=g/3+n[g+2];break}if(32&k){t=It;break}return t=Dt,y.Fe="invalid literal/length code",m=ft,e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);case zt:for(b=a;b>A;){if(0===v)return e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);m=it,v--,x|=(255&y.ut(_++))<<A,A+=8}i+=x&ut[b],x>>=b,A-=b,c=w,n=s,o=d,t=Ct;case Ct:for(b=c;b>A;){if(0===v)return e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);m=it,v--,x|=(255&y.ut(_++))<<A,A+=8}if(g=3*(o+(x&ut[b])),x>>=n[g+1],A-=n[g+1],k=n[g],16&k){a=15&k,l=n[g+2],t=xt;break}if(!(64&k)){c=k,o=g/3+n[g+2];break}return t=Dt,y.Fe="invalid distance code",m=ft,e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);case xt:for(b=a;b>A;){if(0===v)return e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);m=it,v--,x|=(255&y.ut(_++))<<A,A+=8}l+=x&ut[b],x>>=b,A-=b,t=At;case At:for(C=S-l;0>C;)C+=e.end;for(;0!==i;){if(0===z&&(S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z&&(e.write=S,m=e.dt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z)))return e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);e.wt[S++]=e.wt[C++],z--,C==e.end&&(C=0),i--}t=vt;break;case _t:if(0===z&&(S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z&&(e.write=S,m=e.dt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z)))return e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);m=it,e.wt[S++]=f,z--,t=vt;break;case It:if(A>7&&(A-=8,v++,_--),e.write=S,m=e.dt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,e.read!=e.write)return e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);t=Pt;case Pt:return m=ot,e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);case Dt:return m=ft,e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m);default:return m=ct,e.ft=x,e.lt=A,y.je=v,y.Ge+=_-y.rt,y.rt=_,e.write=S,e.dt(y,m)}},e.yt=()=>{}}const Rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Bt=0,Et=1,Mt=2,Ut=3,Kt=4,Nt=5,Ot=6,Tt=7,Wt=8,jt=9;function Ht(e,t){const n=this;let r,s=Bt,o=0,c=0,a=0;const l=[0],u=[0],w=new Vt;let h=0,d=new f(3*wt);const p=new kt;n.lt=0,n.ft=0,n.wt=new i(t),n.end=t,n.read=0,n.write=0,n.reset=(e,t)=>{t&&(t[0]=0),s==Ot&&w.yt(e),s=Bt,n.lt=0,n.ft=0,n.read=n.write=0},n.reset(e,null),n.dt=(e,t)=>{let r,s,i;return s=e.st,i=n.read,r=(i>n.write?n.end:n.write)-i,r>e.nt&&(r=e.nt),0!==r&&t==lt&&(t=it),e.nt-=r,e.Je+=r,e.et.set(n.wt.subarray(i,i+r),s),s+=r,i+=r,i==n.end&&(i=0,n.write==n.end&&(n.write=0),r=n.write-i,r>e.nt&&(r=e.nt),0!==r&&t==lt&&(t=it),e.nt-=r,e.Je+=r,e.et.set(n.wt.subarray(i,i+r),s),s+=r,i+=r),e.st=s,n.read=i,t},n.ht=(e,t)=>{let i,f,y,m,b,g,k,v;for(m=e.rt,b=e.je,f=n.ft,y=n.lt,g=n.write,k=g<n.read?n.read-g-1:n.end-g;;){let S,z,C,x,A,_,I,P;switch(s){case Bt:for(;3>y;){if(0===b)return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);t=it,b--,f|=(255&e.ut(m++))<<y,y+=8}switch(i=7&f,h=1&i,i>>>1){case 0:f>>>=3,y-=3,i=7&y,f>>>=i,y-=i,s=Et;break;case 1:S=[],z=[],C=[[]],x=[[]],kt.ct(S,z,C,x),w.init(S[0],z[0],C[0],0,x[0],0),f>>>=3,y-=3,s=Ot;break;case 2:f>>>=3,y-=3,s=Ut;break;case 3:return f>>>=3,y-=3,s=jt,e.Fe="invalid block type",t=ft,n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t)}break;case Et:for(;32>y;){if(0===b)return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);t=it,b--,f|=(255&e.ut(m++))<<y,y+=8}if((~f>>>16&65535)!=(65535&f))return s=jt,e.Fe="invalid stored block lengths",t=ft,n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);o=65535&f,f=y=0,s=0!==o?Mt:0!==h?Tt:Bt;break;case Mt:if(0===b)return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);if(0===k&&(g==n.end&&0!==n.read&&(g=0,k=g<n.read?n.read-g-1:n.end-g),0===k&&(n.write=g,t=n.dt(e,t),g=n.write,k=g<n.read?n.read-g-1:n.end-g,g==n.end&&0!==n.read&&(g=0,k=g<n.read?n.read-g-1:n.end-g),0===k)))return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);if(t=it,i=o,i>b&&(i=b),i>k&&(i=k),n.wt.set(e.He(m,i),g),m+=i,b-=i,g+=i,k-=i,0!=(o-=i))break;s=0!==h?Tt:Bt;break;case Ut:for(;14>y;){if(0===b)return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);t=it,b--,f|=(255&e.ut(m++))<<y,y+=8}if(c=i=16383&f,(31&i)>29||(i>>5&31)>29)return s=jt,e.Fe="too many length or distance symbols",t=ft,n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);if(i=258+(31&i)+(i>>5&31),!r||r.length<i)r=[];else for(v=0;i>v;v++)r[v]=0;f>>>=14,y-=14,a=0,s=Kt;case Kt:for(;4+(c>>>10)>a;){for(;3>y;){if(0===b)return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);t=it,b--,f|=(255&e.ut(m++))<<y,y+=8}r[Rt[a++]]=7&f,f>>>=3,y-=3}for(;19>a;)r[Rt[a++]]=0;if(l[0]=7,i=p.it(r,l,u,d,e),i!=it)return(t=i)==ft&&(r=null,s=jt),n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);a=0,s=Nt;case Nt:for(;i=c,258+(31&i)+(i>>5&31)>a;){let o,w;for(i=l[0];i>y;){if(0===b)return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);t=it,b--,f|=(255&e.ut(m++))<<y,y+=8}if(i=d[3*(u[0]+(f&ut[i]))+1],w=d[3*(u[0]+(f&ut[i]))+2],16>w)f>>>=i,y-=i,r[a++]=w;else{for(v=18==w?7:w-14,o=18==w?11:3;i+v>y;){if(0===b)return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);t=it,b--,f|=(255&e.ut(m++))<<y,y+=8}if(f>>>=i,y-=i,o+=f&ut[v],f>>>=v,y-=v,v=a,i=c,v+o>258+(31&i)+(i>>5&31)||16==w&&1>v)return r=null,s=jt,e.Fe="invalid bit length repeat",t=ft,n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);w=16==w?r[v-1]:0;do{r[v++]=w}while(0!=--o);a=v}}if(u[0]=-1,A=[],_=[],I=[],P=[],A[0]=9,_[0]=6,i=c,i=p.ot(257+(31&i),1+(i>>5&31),r,A,_,I,P,d,e),i!=it)return i==ft&&(r=null,s=jt),t=i,n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);w.init(A[0],_[0],d,I[0],d,P[0]),s=Ot;case Ot:if(n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,(t=w.ht(n,e,t))!=ot)return n.dt(e,t);if(t=it,w.yt(e),m=e.rt,b=e.je,f=n.ft,y=n.lt,g=n.write,k=g<n.read?n.read-g-1:n.end-g,0===h){s=Bt;break}s=Tt;case Tt:if(n.write=g,t=n.dt(e,t),g=n.write,k=g<n.read?n.read-g-1:n.end-g,n.read!=n.write)return n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);s=Wt;case Wt:return t=ot,n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);case jt:return t=ft,n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t);default:return t=ct,n.ft=f,n.lt=y,e.je=b,e.Ge+=m-e.rt,e.rt=m,n.write=g,n.dt(e,t)}}},n.yt=e=>{n.reset(e,null),n.wt=null,d=null},n.bt=(e,t,r)=>{n.wt.set(e.subarray(t,t+r),0),n.read=n.write=r},n.gt=()=>s==Et?1:0}const Lt=13,Ft=[0,0,255,255];function qt(){const e=this;function t(e){return e&&e.kt?(e.Ge=e.Je=0,e.Fe=null,e.kt.mode=7,e.kt.vt.reset(e,null),it):ct}e.mode=0,e.method=0,e.St=[0],e.zt=0,e.marker=0,e.Ct=0,e.xt=t=>(e.vt&&e.vt.yt(t),e.vt=null,it),e.At=(n,r)=>(n.Fe=null,e.vt=null,8>r||r>15?(e.xt(n),ct):(e.Ct=r,n.kt.vt=new Ht(n,1<<r),t(n),it)),e._t=(e,t)=>{let n,r;if(!e||!e.kt||!e.tt)return ct;const s=e.kt;for(t=4==t?lt:it,n=lt;;)switch(s.mode){case 0:if(0===e.je)return n;if(n=t,e.je--,e.Ge++,8!=(15&(s.method=e.ut(e.rt++)))){s.mode=Lt,e.Fe="unknown compression method",s.marker=5;break}if(8+(s.method>>4)>s.Ct){s.mode=Lt,e.Fe="invalid win size",s.marker=5;break}s.mode=1;case 1:if(0===e.je)return n;if(n=t,e.je--,e.Ge++,r=255&e.ut(e.rt++),((s.method<<8)+r)%31!=0){s.mode=Lt,e.Fe="incorrect header check",s.marker=5;break}if(!(32&r)){s.mode=7;break}s.mode=2;case 2:if(0===e.je)return n;n=t,e.je--,e.Ge++,s.zt=(255&e.ut(e.rt++))<<24&4278190080,s.mode=3;case 3:if(0===e.je)return n;n=t,e.je--,e.Ge++,s.zt+=(255&e.ut(e.rt++))<<16&16711680,s.mode=4;case 4:if(0===e.je)return n;n=t,e.je--,e.Ge++,s.zt+=(255&e.ut(e.rt++))<<8&65280,s.mode=5;case 5:return 0===e.je?n:(n=t,e.je--,e.Ge++,s.zt+=255&e.ut(e.rt++),s.mode=6,2);case 6:return s.mode=Lt,e.Fe="need dictionary",s.marker=0,ct;case 7:if(n=s.vt.ht(e,n),n==ft){s.mode=Lt,s.marker=0;break}if(n==it&&(n=t),n!=ot)return n;n=t,s.vt.reset(e,s.St),s.mode=12;case 12:return e.je=0,ot;case Lt:return ft;default:return ct}},e.It=(e,t,n)=>{let r=0,s=n;if(!e||!e.kt||6!=e.kt.mode)return ct;const i=e.kt;return s<1<<i.Ct||(s=(1<<i.Ct)-1,r=n-s),i.vt.bt(t,r,s),i.mode=7,it},e.Pt=e=>{let n,r,s,i,o;if(!e||!e.kt)return ct;const c=e.kt;if(c.mode!=Lt&&(c.mode=Lt,c.marker=0),0===(n=e.je))return lt;for(r=e.rt,s=c.marker;0!==n&&4>s;)e.ut(r)==Ft[s]?s++:s=0!==e.ut(r)?0:4-s,r++,n--;return e.Ge+=r-e.rt,e.rt=r,e.je=n,c.marker=s,4!=s?ft:(i=e.Ge,o=e.Je,t(e),e.Ge=i,e.Je=o,c.mode=7,it)},e.Dt=e=>e&&e.kt&&e.kt.vt?e.kt.vt.gt():ct}function Gt(){}function Jt(e){const t=new Gt,n=e&&e.chunkSize?r.floor(2*e.chunkSize):131072,o=new i(n);let c=!1;t.At(),t.et=o,this.append=(e,r)=>{const f=[];let a,l,u=0,w=0,h=0;if(0!==e.length){t.rt=0,t.tt=e,t.je=e.length;do{if(t.st=0,t.nt=n,0!==t.je||c||(t.rt=0,c=!0),a=t._t(0),c&&a===lt){if(0!==t.je)throw new s("inflating: bad input")}else if(a!==it&&a!==ot)throw new s("inflating: "+t.Fe);if((c||a===ot)&&t.je===e.length)throw new s("inflating: bad input");t.st&&(t.st===n?f.push(new i(o)):f.push(o.subarray(0,t.st))),h+=t.st,r&&t.rt>0&&t.rt!=u&&(r(t.rt),u=t.rt)}while(t.je>0||0===t.nt);return f.length>1?(l=new i(h),f.forEach((e=>{l.set(e,w),w+=e.length}))):l=f[0]?new i(f[0]):new i,l}},this.flush=()=>{t.xt()}}Gt.prototype={At(e){const t=this;return t.kt=new qt,e||(e=15),t.kt.At(t,e)},_t(e){const t=this;return t.kt?t.kt._t(t,e):ct},xt(){const e=this;if(!e.kt)return ct;const t=e.kt.xt(e);return e.kt=null,t},Pt(){const e=this;return e.kt?e.kt.Pt(e):ct},It(e,t){const n=this;return n.kt?n.kt.It(n,e,t):ct},ut(e){return this.tt[e]},He(e,t){return this.tt.subarray(e,e+t)}},self.initCodec=()=>{self.Deflate=st,self.Inflate=Jt};\n',i=()=>n.useDataURI?"data:text/javascript,"+encodeURIComponent(e):URL.createObjectURL(new Blob([e],{type:"text/javascript"}));t({workerScripts:{inflate:[i],deflate:[i]}})}(x1),x1({Deflate:function bZ(t){const e=new CO,i=function CZ(t){return t+5*(Math.floor(t/16383)+1)}(t&&t.chunkSize?t.chunkSize:65536),o=new Uint8Array(i);let s=t?t.level:-1;typeof s>"u"&&(s=-1),e.deflateInit(s),e.next_out=o,this.append=function(a,l){let c,u,d=0,h=0,f=0;const m=[];if(a.length){e.next_in_index=0,e.next_in=a,e.avail_in=a.length;do{if(e.next_out_index=0,e.avail_out=i,c=e.deflate(0),0!=c)throw new Error("deflating: "+e.msg);e.next_out_index&&m.push(e.next_out_index==i?new Uint8Array(o):o.subarray(0,e.next_out_index)),f+=e.next_out_index,l&&e.next_in_index>0&&e.next_in_index!=d&&(l(e.next_in_index),d=e.next_in_index)}while(e.avail_in>0||0===e.avail_out);return m.length>1?(u=new Uint8Array(f),m.forEach(function(p){u.set(p,h),h+=p.length})):u=m[0]?new Uint8Array(m[0]):new Uint8Array,u}},this.flush=function(){let a,l,c=0,u=0;const d=[];do{if(e.next_out_index=0,e.avail_out=i,a=e.deflate(4),1!=a&&0!=a)throw new Error("deflating: "+e.msg);i-e.avail_out>0&&d.push(o.slice(0,e.next_out_index)),u+=e.next_out_index}while(e.avail_in>0||0===e.avail_out);return e.deflateEnd(),l=new Uint8Array(u),d.forEach(function(h){l.set(h,c),c+=h.length}),l}},Inflate:function VZ(t){const e=new zO,i=t&&t.chunkSize?Math.floor(2*t.chunkSize):131072,o=new Uint8Array(i);let s=!1;e.inflateInit(),e.next_out=o,this.append=function(a,l){const c=[];let u,d,h=0,f=0,m=0;if(0!==a.length){e.next_in_index=0,e.next_in=a,e.avail_in=a.length;do{if(e.next_out_index=0,e.avail_out=i,0===e.avail_in&&!s&&(e.next_in_index=0,s=!0),u=e.inflate(0),s&&u===ya){if(0!==e.avail_in)throw new Error("inflating: bad input")}else if(u!==ln&&u!==va)throw new Error("inflating: "+e.msg);if((s||u===va)&&e.avail_in===a.length)throw new Error("inflating: bad input");e.next_out_index&&c.push(e.next_out_index===i?new Uint8Array(o):o.subarray(0,e.next_out_index)),m+=e.next_out_index,l&&e.next_in_index>0&&e.next_in_index!=h&&(l(e.next_in_index),h=e.next_in_index)}while(e.avail_in>0||0===e.avail_out);return c.length>1?(d=new Uint8Array(m),c.forEach(function(p){d.set(p,f),f+=p.length})):d=c[0]?new Uint8Array(c[0]):new Uint8Array,d}},this.flush=function(){e.inflateEnd()}}});var Au,qh,UX=V(2578);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[o]?n[o]:""},t.extension=function i(r){for(let o in n)if(n[o]===r)return o;return r.split("/")[1]}}(Au||(Au={}));class Us{static get instance(){return Us._instance||(Us._instance=new Us),Us._instance}constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,E.A)(function*(){if(!n)return;let i=n instanceof FileList?jP(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),Q.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,E.A)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Dt.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,E.A)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield at.instance.addAsync(n)}})()}handleText(n){return(0,E.A)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=fa.xml2element(yield Qo.readAsTextAsync(n));e&&Q.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,E.A)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let r=yield new mC(new Qa(n)).getEntries();for(let o of r)try{let s=yield o.getData(new Ja);console.log(o.filename+" \u89e3\u51cd..."),yield e.load([new File([s],o.filename,{type:Au.type(o.filename)})])}catch(s){console.warn(s)}})()}saveAsync(n,e,i){return(0,E.A)(function*(){if(!n)return;let r=n instanceof FileList?jP(n):n,o=new wC(new Ja("application/zip"),{bufferedWrite:!0}),s=0,a=0;yield Promise.all(Array.from(r).map(function(){var l=(0,E.A)(function*(c){let u=0;a+=c.size,o.add(c.name,new Qa(c),{onprogress:(d,h)=>(0,E.A)(function*(){s+=d-u,u=d,i({percent:100*s/a,currentFile:c.name})})()})});return function(c){return l.apply(this,arguments)}}())),(0,UX.saveAs)(yield o.close(),e+".zip")})()}}function jP(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}class ku{static get instance(){return ku._instance||(ku._instance=new ku),ku._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}initialize(){var n=this;Q.register(this).on("CONNECT_PEER",1,e=>{e.isSendFromSelf&&(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),Dt.instance.synchronize())}).on("XML_LOADED",e=>{!function VX(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!Dt.instance.get(r)&&0<Au.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!Dt.instance.get(r)&&0<Au.type(r).length&&n.push(r)}for(let i of n)Dt.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=Dt.instance.get(o.identifier);null===s&&(s=pn.createEmpty(o.identifier),Dt.instance.add(s)),s.state<Or.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<Dt.instance.getCatalog().length&&Dt.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,E.A)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=Dt.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===n.isLimitSendTask()&&0<o.length&&!n.existsSendTask(i.data.receiver)){let s=n.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),n.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(Be.peerId);-1<a&&s.splice(a,1);for(let l of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+l+" -> "+i.data.identifiers),void Q.call(i,l);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),Dt.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=Dt.instance.get(i);this.receiveTaskMap.has(i)||r&&Or.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),Q.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){Q.unregister(this)}startSendTask(n,e){var i=this;return(0,E.A)(function*(){let r=1===n.length?n[0].identifier:iO.k.generateUuid(),o=Yl.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),Q.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of n)s.thumbnail.blob?s.thumbnail.blob=yield Qo.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield Qo.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),Dt.instance.synchronize()},o.start(n)})()}startReceiveTask(n){let e=Yl.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&Q.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),Dt.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),Q.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:Be.peerId,candidatePeers:Be.peerIds},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let o=n.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[n[o],n[s]]=[n[s],n[o]]}n.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<n.length;o++){let s=n[o],a=Dt.instance.get(s.identifier),l={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===Or.URL?l.url=a.url:s.state===Or.NULL?(l.thumbnail.blob=a.thumbnail.blob,l.thumbnail.type=a.thumbnail.type):(l.blob=a.blob,l.type=a.blob.type);let c=l.blob?l.blob.size:l.thumbnail.blob?l.thumbnail.blob.size:100;if(i.push(l),r+=c,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Ri{static#e=this.key={};static#t=this.tasksMap=new Map;constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){Ri.tasksMap.size<1&&Q.register(Ri.key).on("DISCONNECT_PEER",r=>{Ri.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Ri.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Ri.onUpdate(r.data.identifier)});let i=new Ri(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=Ri.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Ri.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;Q.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of Ri.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();Ri.tasksMap.size<1&&Q.unregister(Ri.key)}static onUpdate(n){if(!Ri.tasksMap.has(n))return;let e=Ri.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);Ri.tasksMap.size<1&&Q.unregister(Ri.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=Ri.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Ri.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new ha.b(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}class Ou{static get instance(){return Ou._instance||(Ou._instance=new Ou),Ou._instance}constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),Q.register(this).on("CONNECT_PEER",2,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)De.instance.isDeleted(i.identifier)?Q.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(De.instance.isDeleted(n.data))Q.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=De.instance.get(n.data);e&&Q.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=De.instance.get(e.identifier);if(i){let r=n.isSendFromSelf?i:this.updateObject(i,e);r?oO(r,n.sendFrom):n.isSendFromSelf||Q.call("UPDATE_GAME_OBJECT",i.toContext(),n.sendFrom)}else if(De.instance.isDeleted(e.identifier))Q.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom);else{let r=this.createObject(e);r&&oO(r,n.sendFrom)}}).on("DELETE_GAME_OBJECT",1e3,n=>{De.instance.delete(n.data.identifier,!1)})}destroy(){Q.unregister(this)}updateObject(n,e){let i=e.majorVersion+e.minorVersion;if(n.version<i)n.apply(e);else if(i<n.version)return null;return n}createObject(n){let e=Ms.instance.create(n.aliasName,n.identifier);return e?(De.instance.add(e,!1),e.apply(n),e):(console.warn(n.aliasName+" is Unknown...?",n),null)}sendCatalog(n){let e=De.instance.getCatalog(),i=setInterval(()=>{Q.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){let n=!0;for(;0<this.requestMap.size&&this.tasks.length<32&&n;)n=this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId();if(n.length<1)return!1;let e=this.makeRequestList(n);if(e.length<1)return this.removePeerMap(n),0<this.peerMap.size;let i=Ri.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);return r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(n);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))},!0}makeRequestList(n,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(n))continue;let s=De.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e="",i=Be.peers;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<n&&(n=o.length,e=r.peerId)}return e}}class UP{get length(){return this._length}constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}let Og,HX=function zX(){let t=new UP("DiceBotQueue");return t.add((0,E.A)(function*(){Og=new((yield V.e(4402).then(V.bind(V,8914))).default),Vs.diceBotInfos=Og.listAvailableGameSystems().sort((n,e)=>n.sortKey<e.sortKey?-1:n.sortKey>e.sortKey?1:0)})),t}(),Vs=class extends za{static#e=qh=this;static#t=this.diceBotInfos=[];onStoreAdded(){var n=this;super.onStoreAdded(),Q.register(this).on("SEND_MESSAGE",function(){var e=(0,E.A)(function*(i){let r=De.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;let o=ma.toHalfWidth(r.text).trim(),s=r.tag;try{let a=/^((\d+)?\s+)?(.*)?/gi.exec(o),l=null!=a[2]?Number(a[2]):1,c=null!=a[3]?a[3]:o;if(!c||l<1)return;l>1&&(c=`x${l} ${c}`);let u=yield qh.diceRollAsync(c,s);if(!u.result)return;n.sendResultMessage(u,r)}catch(a){console.error(a)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),Q.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result,o=n.isSecret;if(r.length<1)return;let s={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:"system dicebot"+(o?" secret":""),name:`${i} : ${e.name}${o?" (Secret)":""}`,text:r};null!=e.to&&0<e.to.length&&(s.to=e.to,e.to.indexOf(e.from)<0&&(s.to+=" "+e.from));let a=De.instance.get(e.tabIdentifier);a&&a.addMessage(s)}static diceRollAsync(n,e){return(0,E.A)(function*(){const i={id:e,result:"",isSecret:!1};try{const r=yield qh.loadGameSystemAsync(e);if(!r?.COMMAND_PATTERN.test(n))return i;const o=r.eval(n);if(o)return console.log("diceRoll!!!",o.text),console.log("isSecret!!!",o.secret),{id:r.ID,result:o.text.replace(/\n?(#\d+)\n/gi,"$1 "),isSecret:o.secret}}catch(r){console.error(r)}return i})()}static getHelpMessage(n){return(0,E.A)(function*(){try{return(yield qh.loadGameSystemAsync(n)).HELP_MESSAGE}catch(e){console.error(e)}return""})()}static loadGameSystemAsync(n){var e=this;return(0,E.A)(function*(){return yield HX.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return Og.getGameSystemClass(i)}catch{return Og.dynamicLoad(i)}})})()}};Vs=qh=Ne([di("dice-bot")],Vs);let Jl=class extends za{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new nt}get audio(){return at.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=at.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){Q.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){Q.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};Ne([st()],Jl.prototype,"audioIdentifier",void 0),Ne([st()],Jl.prototype,"startTime",void 0),Ne([st()],Jl.prototype,"isLoop",void 0),Ne([st()],Jl.prototype,"isPlaying",void 0),Jl=Ne([di("jukebox")],Jl);let FC=class extends za{onStoreAdded(){super.onStoreAdded(),De.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(De.instance.getObjects(Fi)),e=e.concat(De.instance.getObjects(Vn)),e=e.concat(De.instance.getObjects(Ns)),e=e.concat(De.instance.getObjects(ji)),e=e.concat(De.instance.getObjects(Yr).filter(i=>null===i.parent)),e=e.concat(De.instance.getObjects(Os));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(De.instance.getObjects(Fi)),e=e.concat(De.instance.getObjects(Ps)),e=e.concat(De.instance.getObjects(Ao)),e=e.concat(De.instance.getObjects(Vn)),e=e.concat(De.instance.getObjects(Ns)),e=e.concat(De.instance.getObjects(ji)),e=e.concat(De.instance.getObjects(Yr)),e=e.concat(De.instance.getObjects(Os));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)Un.instance.parseXml(n.children[i])}};FC=Ne([di("room")],FC);var GX=V(9822),$X=V.n(GX);class Hs{static#e=this.queue=new UP("SaveDataServiceQueue");constructor(n){this.ngZone=n}saveRoomAsync(n="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return Hs.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new FC),o=this.convertToXml(Is.instance),s=this.convertToXml(ks.instance);return i.push(new File([r],"data.xml",{type:"text/plain"})),i.push(new File([o],"chat.xml",{type:"text/plain"})),i.push(new File([s],"summary.xml",{type:"text/plain"})),i=i.concat(this.searchImageFiles(r)),i=i.concat(this.searchImageFiles(o)),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="xml_data",i){return Hs.queue.add((r,o)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="xml_data",i){let r=[],o=this.convertToXml(n);return r.push(new File([o],"data.xml",{type:"text/plain"})),r=r.concat(this.searchImageFiles(o)),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return Us.instance.saveAsync(n,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+$X().xml(n.toXml(),2)}searchImageFiles(n){let e=fa.xml2element(n),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=Dt.instance.get(a)}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=Dt.instance.get(a));let l=o[s].getAttribute("backgroundImageIdentifier");l&&(r[l]=Dt.instance.get(l))}for(let s in r){let a=r[s];a&&a.state===Or.COMPLETE&&i.push(new File([a.blob],a.identifier+"."+Au.extension(a.blob.type),{type:a.blob.type}))}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}static#t=this.\u0275fac=function(e){return new(e||Hs)(Ot(kt))};static#n=this.\u0275prov=We({token:Hs,factory:Hs.\u0275fac,providedIn:"root"})}const WX=t=>({"is-hidden":t});function qX(t,n){if(1&t&&(_(0,"option",8),O(1),w()),2&t){const e=n.$implicit;Pn("value",e.identifier),v(),ht(e.name)}}function ZX(t,n){if(1&t&&(_(0,"div",15),O(1),w()),2&t){const e=M(3);v(),ki("",e.progresPercent,"%")}}function YX(t,n){if(1&t){const e=Ue();Ae(0),_(1,"button",3),ue("click",function(){return re(e),oe(M(2).upTabIndex())}),O(2,"\u2191"),w(),_(3,"button",3),ue("click",function(){return re(e),oe(M(2).downTabIndex())}),O(4,"\u2193"),w(),_(5,"button",10),ue("click",function(){return re(e),oe(M(2).save())}),_(6,"div",11)(7,"div",12),O(8,"\u4fdd\u5b58"),w(),J(9,ZX,2,1,"div",13),w()(),_(10,"button",14),ue("click",function(){return re(e),oe(M(2).delete())}),O(11,"\u524a\u9664"),w(),ke()}if(2&t){const e=M(2);v(5),b("disabled",e.isSaveing),v(2),b("ngClass",lt(4,WX,e.isSaveing)),v(2),b("ngIf",e.isSaveing),v(),xo("disabled",e.chatTabs.length<=1?"":null)}}function XX(t,n){if(1&t){const e=Ue();Ae(0),_(1,"button",3),ue("click",function(){return re(e),oe(M(2).restore())}),O(2,"\u5143\u306b\u623b\u3059"),w(),ke()}}function KX(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div"),O(2,"\u30bf\u30d6\u540d : "),_(3,"input",9),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tabName,r)||(o.tabName=r),oe(r)}),w()(),Ee(4,"hr"),_(5,"div"),J(6,YX,12,6,"ng-container",7)(7,XX,3,0,"ng-container",7),w(),ke()}if(2&t){const e=M();v(3),yt("ngModel",e.tabName),xo("disabled",e.isEditable?null:""),v(3),b("ngIf",!e.isDeleted),v(),b("ngIf",e.isDeleted)}}function QX(t,n){1&t&&(Ae(0),_(1,"div",16),O(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),w(),ke())}let JX=(()=>{class t{get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==De.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a"),Q.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=De.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){Q.unregister(this)}onChangeSelectTab(e){this.selectedTab=De.instance.get(e),this.selectedTabXml=""}create(){Is.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,E.A)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=Un.instance.parseXml(this.selectedTabXml);Is.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}static#e=this.\u0275fac=function(i){return new(i||t)(L(gr),L(yn),L(Hl),L(Hs))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["app-chat-tab-setting"]],decls:11,vars:4,consts:[["select",""],[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],["placeholder","Name",3,"ngModelChange","ngModel"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ue();_(0,"div",1)(1,"div",2)(2,"div")(3,"button",3),ue("click",function(){return re(o),oe(r.create())}),O(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),w()(),_(5,"select",4,0),ue("change",function(){re(o);const a=Lt(6);return oe(r.onChangeSelectTab(a.value))}),J(7,qX,2,2,"option",5),w()(),_(8,"div",6),J(9,KX,8,4,"ng-container",7),w()(),J(10,QX,3,0,"ng-container",7)}2&i&&(v(5),b("ngModel",null==r.selectedTab?null:r.selectedTab.identifier),v(2),b("ngForOf",r.chatTabs),v(2),b("ngIf",!r.isEmpty&&r.selectedTab),v(),b("ngIf",r.isEmpty))},dependencies:[Pi,ii,xn,Ba,ja,hr,la,Ar,pr],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]})}return t})(),VP=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",setTimeout(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=Kt({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[Kn],decls:2,vars:2,consts:[[1,"badge"]],template:function(i,r){1&i&&(_(0,"div",0),O(1),w()),2&i&&(b("@bounce",r.animeState),v(),ht(r.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[xs("bounce",[fA("active",Tt({transform:""})),Xi("* => active",[Yi("600ms ease",Xo([Tt({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),Tt({transform:"scale3d(2, 2, 2)",offset:.5}),Tt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Tt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Tt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}})}return t})(),Ei=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}static#e=this.\u0275fac=function(i){return new(i||t)(L(tI,16))};static#t=this.\u0275pipe=Er({name:"safe",type:t,pure:!0})}return t})();const eK=(t,n,e)=>({"direct-message":t,"system-message":n,"dicebot-message":e});function tK(t,n){if(1&t&&(Ee(0,"img",13),Qt(1,"safe")),2&t){const e=M();b("src",Jt(1,1,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),_i)}}function nK(t,n){1&t&&Bn(0)}function iK(t,n){if(1&t){const e=Ue();_(0,"button",15),ue("click",function(){return re(e),oe(M(2).discloseMessage())}),O(1,"\u7d50\u679c\u3092\u516c\u958b"),w()}}function rK(t,n){if(1&t&&(_(0,"span"),O(1),w(),J(2,iK,2,0,"button",14)),2&t){const e=M();v(),ht(e.chatMessage.text),v(),b("ngIf",e.chatMessage.isSecret)}}function oK(t,n){1&t&&(_(0,"span"),O(1,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),w())}let sK=(()=>{class t{constructor(e){this.chatMessageService=e,this.imageFile=pn.Empty,this.animeState="inactive"}ngOnInit(){let e=this.chatMessage.image;e&&(this.imageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}static#e=this.\u0275fac=function(i){return new(i||t)(L(Hl))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["chat-message"]],inputs:{chatMessage:"chatMessage"},decls:19,vars:16,consts:[["visible",""],["secret",""],[1,"container"],[1,"message",3,"ngClass"],[1,"image"],[3,"src",4,"ngIf"],[1,"body"],[1,"title"],[1,"msg-name"],[1,"tip","msg-from"],[1,"tip","msg-timestamp"],[1,"text","msg-text"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"src"],[3,"click",4,"ngIf"],[3,"click"]],template:function(i,r){if(1&i&&(_(0,"div",2)(1,"div",3)(2,"div",4),J(3,tK,2,4,"img",5),w(),_(4,"div",6)(5,"div",7)(6,"span",8),O(7),w(),_(8,"span",9),O(9),w(),_(10,"span",10),O(11),Qt(12,"date"),w()(),_(13,"div",11),J(14,nK,1,0,"ng-container",12),w()()()(),J(15,rK,3,2,"ng-template",null,0,ni)(17,oK,2,0,"ng-template",null,1,ni)),2&i){const o=Lt(16),s=Lt(18);v(),b("ngClass",Bp(12,eK,r.chatMessage.isDirect||r.chatMessage.isSecret,r.chatMessage.isSystem,r.chatMessage.isDicebot))("@flyInOut",r.animeState),v(2),b("ngIf",0<(null==r.imageFile||null==r.imageFile.url?null:r.imageFile.url.length)),v(4),ht(r.chatMessage.name),v(2),ht(r.chatMessage.from),v(2),ht(Jt(12,9,r.chatMessage.timestamp,"y/M/d H:mm")),v(3),b("ngIf",!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)("ngIfThen",o)("ngIfElse",s)}},dependencies:[Pi,xn,S2,Ei],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}"],data:{animation:[xs("flyInOut",[Xi("* => active",[Yi("200ms ease-out",Xo([Tt({transform:"translateX(100px)",opacity:"0",offset:0}),Tt({transform:"translateX(0)",opacity:"1",offset:1})]))]),Xi("void => *",[Yi("200ms ease-out",Xo([Tt({opacity:"0",offset:0}),Tt({opacity:"1",offset:1})]))])])]}})}return t})();const aK=["logContainer"],lK=["messageContainer"];function cK(t,n){1&t&&Ee(0,"chat-message",7),2&t&&b("chatMessage",M().$implicit)}function uK(t,n){if(1&t&&(Ae(0),J(1,cK,1,1,"chat-message",6),ke()),2&t){const e=n.$implicit;v(),b("ngIf",e.isDisplayable)}}function dK(t,n){if(1&t&&(Ae(0),J(1,uK,2,1,"ng-container",5),ke()),2&t){const e=M();v(),b("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function hK(t,n){1&t&&Ee(0,"chat-message",7),2&t&&b("chatMessage",n.$implicit)}function fK(t,n){if(1&t&&(Ae(0),J(1,hK,1,1,"chat-message",8),ke()),2&t){const e=M();v(),b("ngForOf",e.sampleMessages)}}const RC=window.navigator.userAgent.toLowerCase(),HP=RC.indexOf("iphone")>-1||RC.indexOf("ipad")>-1||RC.indexOf("macintosh")>-1&&"ontouchend"in document;let pK=(()=>{class t{get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){let e=this.chatTab?this.chatTab.chatMessages.length:this.sampleMessages.length;return(e<1e4?e:1e4)*this.minMessageHeight}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.sampleMessages=[this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\uff1a\u306f\u3058\u3081\u306b","\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u306f\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u30c6\u30fc\u30d6\u30eb\u3068\u30b3\u30de\u306e\u57fa\u672c\u64cd\u4f5c","\uff1c\u30c6\u30fc\u30d6\u30eb\u306e\u64cd\u4f5c\uff1e\n\u30c6\u30fc\u30d6\u30eb\u3092\u5de6\u30c9\u30e9\u30c3\u30b0 : \u8996\u70b9\u5909\u66f4\n\u30c6\u30fc\u30d6\u30eb\u3092\u53f3\u30c9\u30e9\u30c3\u30b0 : \u8996\u70b9\u56de\u8ee2\n\u30c6\u30fc\u30d6\u30eb\u3092\u53f3\u30af\u30ea\u30c3\u30af : \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\n\n\uff1c\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u64cd\u4f5c\uff1e\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u79fb\u52d5\u3084\u56de\u8ee2\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53f3\u30af\u30ea\u30c3\u30af : \u500b\u5225\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5de6\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af : \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u56fa\u6709\u306e\u52d5\u4f5c"),this.makeSampleMessage("System",null,"\u7bc4\u56f2\u9078\u629e","<\u7528\u8a9e>\n\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9 : \u9078\u629e\u9818\u57df\u306e\u5185\u5074\u306b\u898b\u3048\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u9078\u629e\u72b6\u614b\u306b\u3059\u308b\n\u78c1\u77f3\u30e2\u30fc\u30c9 : \u540c\u3058\u7a2e\u985e\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5dfb\u304d\u8fbc\u307f\u306a\u304c\u3089\u79fb\u52d5\u3055\u305b\u308b\n\n<\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u9078\u629e>\n\u30c6\u30fc\u30d6\u30eb\u3092\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3\u9577\u62bc\u3057+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u9577\u62bc\u3057\u3067\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u7bc4\u56f2\u9818\u57df\u3092\u6307\u5b9a\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5de6\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u9577\u62bc\u3057+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u9577\u62bc\u3057\u3067\u78c1\u77f3\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5\nShift+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u5373\u6642\u306b\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u7bc4\u56f2\u9818\u57df\u3092\u6307\u5b9a\nCtrl+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3 : \u30af\u30ea\u30c3\u30af\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u9078\u629e\u72b6\u614b\u3092\u5207\u308a\u66ff\u3048\u308b\nCtrl+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb\u306e\u89e6\u308c\u305f\u5bfe\u8c61\u3092\u9078\u629e\u72b6\u614b\u306b\u3059\u308b\n\n<\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u64cd\u4f5c>\n\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5 : \u9078\u629e\u72b6\u614b\u306e\u5168\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u540c\u671f\u3057\u3066\u79fb\u52d5\n\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u56de\u8ee2 : \u9078\u629e\u72b6\u614b\u306e\u540c\u3058\u7a2e\u985e\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u540c\u671f\u3057\u3066\u56de\u8ee2\n\n<\u9078\u629e\u89e3\u9664>\n\u4efb\u610f\u306e\u5834\u6240\u3092\u30af\u30ea\u30c3\u30af : \u5168\u3066\u306e\u9078\u629e\u72b6\u614b\u3092\u89e3\u9664"),this.makeSampleMessage("System",null,"\u753b\u50cf\u3068\u97f3\u697d","\u30d5\u30a1\u30a4\u30eb\u3092\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u306b\u30c9\u30e9\u30c3\u30b0&\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3053\u3068\u3067\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u306b\u53d6\u308a\u8fbc\u3081\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58","\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u306e\u307f\u5b58\u5728\u3059\u308b\u305f\u3081\u3001\u5168\u54e1\u304c\u30eb\u30fc\u30e0\u304b\u3089\u96e2\u8131\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u6d88\u5931\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"),this.makeSampleMessage("System","???","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8 > \u30d7\u30ec\u30a4\u30e4\u30fc","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"),this.makeSampleMessage("System","???","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8 > \u30d7\u30ec\u30a4\u30e4\u30fc","\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),this.makeSampleMessage("System",null,"\u52d5\u4f5c\u74b0\u5883","\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3001\u307e\u305f\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Firefox\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u64cd\u4f5c\u6027\u306b\u96e3\u304c\u3042\u308a\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u52d5\u4f5c\u304c\u4e0d\u5b89\u5b9a\u306a\u6642\u306f","\u5229\u7528\u74b0\u5883\u306e\u8a2d\u5b9a\u5909\u66f4\u3067\u6539\u5584\u3067\u304d\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u6b21\u306e\u4e8b\u3092\u8a66\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002\n\u30fb\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u30aa\u30f3\u306b\u3059\u308b\n\u30fb\u30d6\u30e9\u30a6\u30b6\u62e1\u5f35\u6a5f\u80fd\uff08\u30a2\u30c9\u30aa\u30f3\uff0f\u30d7\u30e9\u30b0\u30a4\u30f3\uff09\u3092\u5168\u3066\u30aa\u30d5\u306b\u3059\u308b\n\u30fbChrome \u21d4 Firefox\u306a\u3069\u9055\u3046\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u7528\u3059\u308b"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\uff1a\u304a\u308f\u308a\u306b","\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002")],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.minMessageHeight=61,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Gt}ngOnInit(){Q.register(this).on("MESSAGE_ADDED",e=>{let i=De.instance.get(e.data.messageIdentifier);!i||!this.chatTab.contains(i)||this.topTimestamp<=i.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on(`UPDATE_GAME_OBJECT/aliasName/${Wr.aliasName}`,e=>{let i=De.instance.get(e.data.identifier);i&&this.topTimestamp<=i.timestamp&&i.timestamp<=this.botomTimestamp&&this.chatTab.contains(i)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new ha.b(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new ha.b(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){Q.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&(0,Mo.W)(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,l=null,c=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),l=s.getBoundingClientRect(),c=a.top-l.top-this.scrollSpeed,(!r||!o)&&.25<c**2&&(this.panelService.scrollablePanel.scrollTop-=c);let u=this.logContainerRef.nativeElement.getBoundingClientRect(),d=this.messageContainerRef.nativeElement.getBoundingClientRect(),h=d.top-u.top,f=h+d.height,m=this.getScrollPosition();return r=m.top<h,o=f<m.bottom&&m.bottom<m.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&(0,Mo.W)(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,l=this.getScrollPosition();this.scrollSpeed=l.top-this.preScrollTop,this.preScrollTop=l.top;let c=l.top<r,u=o<l.bottom&&l.bottom<l.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!c&&!u)return;let d=l.top-(!e&&c?100:1200),h=l.bottom+(!e&&u?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,d,h,l,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),(0,Mo.W)(()=>{let m=this.getScrollPosition();this.scrollSpeed=m.top-this.preScrollTop,this.preScrollTop=m.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let l=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/l)+1:r>e&&(HP||(this.topIndex+=Math.floor((r-e)/l))),i>o?HP||(this.bottomIndex-=Math.floor((i-o)/l)):i<o&&(this.bottomIndex+=Math.floor((o-i)/l)+1)}this.adjustIndex()}makeSampleMessage(e,i,r,o){let s=new Wr;return s.from=e,s.to=i,s.name=r,s.value=o,s}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(Zi),L(yn))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["chat-tab"]],viewQuery:function(i,r){if(1&i&&(Qn(aK,7),Qn(lK,7)),2&i){let o;Jn(o=ei())&&(r.logContainerRef=o.first),Jn(o=ei())&&(r.messageContainerRef=o.first)}},inputs:{chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[Kn],decls:6,vars:6,consts:[["logContainer",""],["messageContainer",""],[1,"log"],[1,"virtual-scroll-container"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage",4,"ngIf"],[3,"chatMessage"],[3,"chatMessage",4,"ngFor","ngForOf"]],template:function(i,r){1&i&&(_(0,"div",2,0)(2,"div",3,1),J(4,dK,2,2,"ng-container",4)(5,fK,2,1,"ng-container",4),w()()),2&i&&(vn("min-height",r.minScrollHeight,"px"),v(2),vn("margin-bottom",r.bottomSpace,"px"),v(2),b("ngIf",0<r.chatMessages.length),v(),b("ngIf",r.chatMessages.length<=0))},dependencies:[ii,xn,sK],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0})}return t})(),LC=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title=""}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}static#e=this.\u0275fac=function(i){return new(i||t)(L(yn),L(gr))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["text-view"]],inputs:{text:"text",title:"title"},decls:3,vars:1,consts:[[1,"text"]],template:function(i,r){1&i&&(_(0,"span")(1,"pre",0),O(2),w()()),2&i&&(v(2),ht(r.text))},styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]})}return t})(),Pg=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{(0,Mo.W)(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}static#e=this.\u0275fac=function(i){return new(i||t)(Ot(kt))};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const mK=["textArea"],gK=t=>({"direct-message":t}),zP=()=>({standalone:!0});function _K(t,n){1&t&&(Ee(0,"img",16),Qt(1,"safe")),2&t&&b("src",Jt(1,1,M().imageFile.url,"resourceUrl"),_i)}function vK(t,n){if(1&t&&(_(0,"option",17),O(1),w()),2&t){const e=M();Pn("value",null==e.myPeer?null:e.myPeer.identifier),v(),ki("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function yK(t,n){if(1&t&&(_(0,"option",17),O(1),w()),2&t){const e=n.$implicit;Pn("value",e.identifier),v(),ki("",e.name," ")}}function bK(t,n){1&t&&(Ae(0),O(1,"\uff08\u3042\u306a\u305f\uff09"),ke())}function CK(t,n){if(1&t&&(_(0,"option",17),O(1),J(2,bK,2,0,"ng-container",11),w()),2&t){const e=n.$implicit,i=M();Pn("value",e.identifier),v(),ki("",e.name," "),v(),b("ngIf",e===i.myPeer)}}function wK(t,n){if(1&t&&(_(0,"option",17),O(1),w()),2&t){const e=n.$implicit;Pn("value",e.id),v(),ht("DiceBot"===e.name?"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057":e.name)}}function EK(t,n){if(1&t){const e=Ue();Ae(0),_(1,"select",18,1),ue("change",function(){re(e);const r=Lt(2);return oe(M().loadDiceBot(r.value))}),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.gameType,r)||(o.gameType=r),oe(r)}),J(3,wK,2,2,"option",8),w(),ke()}if(2&t){const e=M();v(),yt("ngModel",e.gameType),b("ngModelOptions",Dl(3,zP)),v(2),b("ngForOf",e.diceBotInfos)}}function xK(t,n){1&t&&(Ae(0),_(1,"select",19)(2,"option",10),O(3,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d..."),w()(),ke())}function TK(t,n){1&t&&(_(0,"span"),O(1,", "),w())}function DK(t,n){if(1&t&&(_(0,"span",21),O(1),J(2,TK,2,0,"span",11),w()),2&t){const e=n.$implicit,i=n.index,r=M(2);v(),ht(e),v(),b("ngIf",r.writingPeerNames.length!==i+1)}}function SK(t,n){if(1&t&&(Ae(0),J(1,DK,3,2,"span",20),_(2,"span"),O(3," \u304c\u5165\u529b\u4e2d..."),w(),ke()),2&t){const e=M();v(),b("ngForOf",e.writingPeerNames)}}let GP=(()=>{class t{get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get imageFile(){let e=De.instance.get(this.sendFrom),i=null;return e instanceof Vn?i=e.imageFile:e instanceof Bt&&(i=e.image),i||pn.Empty}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=De.instance.getObjects(Vn).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return Vs.diceBotInfos}get myPeer(){return Bt.myCursor}get otherPeers(){return De.instance.getObjects(Bt)}constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Gt,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Gt,this._sendTo="",this.sendToChange=new Gt,this._text="",this.textChange=new Gt,this.chat=new Gt,this.gameHelp="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNames=[]}ngOnInit(){Q.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=De.instance.get(e.data.messageIdentifier),r=De.instance.getObjects(Bt).find(s=>s.userId===i.from),o=r?r.peerId:"?";this.writingPeers.has(o)&&(this.writingPeers.get(o).stop(),this.writingPeers.delete(o),this.updateWritingPeerNames())}).on(`UPDATE_GAME_OBJECT/aliasName/${Vn.aliasName}`,e=>{if(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom)return;let i=De.instance.get(e.data.identifier);i&&!this.allowsChat(i)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{let i=De.instance.get(this.sendTo);i instanceof Bt&&i.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new ha.b(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNames(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNames(),this.batchService.requireChangeDetection())})}ngOnDestroy(){Q.unregister(this),this.batchService.remove(this)}updateWritingPeerNames(){this.writingPeerNames=Array.from(this.writingPeers.keys()).map(e=>{let i=Bt.findByPeerId(e);return i?i.name:""})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){let i=De.instance.get(this.sendTo);if(i instanceof Bt){let r=du.y.parse(i.peerId);r&&(e=r.peerId)}}Q.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}sendChat(e){e&&e.preventDefault(),!this.text.length||e&&13!==e.keyCode||(this.sendFrom.length||(this.sendFrom=this.myPeer.identifier),this.chat.emit({text:this.text,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo}),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight())}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),Vs.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}showDicebotHelp(){Vs.getHelpMessage(this.gameType).then(e=>{this.gameHelp=e;let i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let a of Vs.diceBotInfos)a.id===this.gameType&&(i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8<"+a.name+"\uff1e");i+="\u306e\u8aac\u660e";let r=this.pointerDeviceService.pointers[0],s=this.panelService.open(LC,{left:r.x,top:r.y,width:600,height:500});s.title=i,s.text="\u3010\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3011\u30c1\u30e3\u30c3\u30c8\u306b\u30c0\u30a4\u30b9\u7528\u306e\u6587\u5b57\u3092\u5165\u529b\u3059\u308b\u3068\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304c\u53ef\u80fd\n\u5165\u529b\u4f8b\uff09\uff12\uff44\uff16\uff0b\uff11\u3000\u653b\u6483\uff01\n\u51fa\u529b\u4f8b\uff092d6+1\u3000\u653b\u6483\uff01\n\u3000\u3000\u3000\u3000  diceBot: (2d6) \u2192 7\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30c0\u30a4\u30b9\u6587\u5b57\u306e\u5f8c\u308d\u306b\u7a7a\u767d\u3092\u5165\u308c\u3066\u767a\u8a00\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3002\n\u4ee5\u4e0b\u3001\u4f7f\u7528\u4f8b\n\u30003D6+1>=9 \uff1a3d6+1\u3067\u76ee\u6a19\u50249\u4ee5\u4e0a\u304b\u306e\u5224\u5b9a\n\u30001D100<=50 \uff1aD100\u306750\uff05\u76ee\u6a19\u306e\u4e0b\u65b9\u30ed\u30fc\u30eb\u306e\u4f8b\n\u30003U6[5] \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u304c5\u4ee5\u4e0a\u306e\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3057\u3066\u5408\u8a08\u3059\u308b(\u4e0a\u65b9\u7121\u9650)\n\u30003B6 \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u3092\u30d0\u30e9\u30d0\u30e9\u306e\u307e\u307e\u51fa\u529b\u3059\u308b\uff08\u5408\u8a08\u3057\u306a\u3044\uff09\n\u300010B6>=4 \uff1a10d6\u3092\u632f\u308a4\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u30002R6[>3]>=5 \uff1a2D6\u306e\u30c0\u30a4\u30b9\u76ee\u304c3\u3088\u308a\u5927\u304d\u3044\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3066\u30015\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u3000(8/2)D(4+6)<=(5*3)\uff1a\u500b\u6570\u30fb\u30c0\u30a4\u30b9\u30fb\u9054\u6210\u5024\u306b\u306f\u56db\u5247\u6f14\u7b97\u3082\u4f7f\u7528\u53ef\u80fd\n\u3000c(10-4*3/2+2)\uff1ac(\u8a08\u7b97\u5f0f\uff09\u3067\u8a08\u7b97\u3060\u3051\u306e\u5b9f\u884c\u3082\u53ef\u80fd\n\u3000choice[a,b,c]\uff1a\u5217\u6319\u3057\u305f\u8981\u7d20\u304b\u3089\u4e00\u3064\u3092\u9078\u629e\u8868\u793a\u3002\u30e9\u30f3\u30c0\u30e0\u653b\u6483\u5bfe\u8c61\u6c7a\u5b9a\u306a\u3069\u306b\n\u3000S3d6 \uff1a \u5404\u30b3\u30de\u30f3\u30c9\u306e\u5148\u982d\u306b\u300cS\u300d\u3092\u4ed8\u3051\u308b\u3068\u4ed6\u4eba\u7d50\u679c\u306e\u898b\u3048\u306a\u3044\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ed\u30fc\u30eb\n\u30003d6/2 \uff1a \u30c0\u30a4\u30b9\u51fa\u76ee\u3092\u5272\u308a\u7b97\uff08\u7aef\u6570\u51e6\u7406\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u4f9d\u5b58\uff09\u3002\u5207\u308a\u4e0a\u3052\u306f /2C\u3001\u56db\u6368\u4e94\u5165\u306f /2R\u3001\u5207\u308a\u6368\u3066\u306f /2F\n\u3000D66 \uff1a D66\u30c0\u30a4\u30b9\u3002\u9806\u5e8f\u306f\u30b2\u30fc\u30e0\u306b\u4f9d\u5b58\u3002D66N\uff1a\u305d\u306e\u307e\u307e\u3001D66A\uff1a\u6607\u9806\u3001D66D\uff1a\u964d\u9806\n\n\u8a73\u7d30\u306f\u4e0b\u8a18URL\u306e\u30b3\u30de\u30f3\u30c9\u30ac\u30a4\u30c9\u3092\u53c2\u7167\nhttps://docs.bcdice.org/\n===================================\n"+this.gameHelp})}allowsChat(e){switch(e.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const i of Be.peers)if(i.isOpen&&e.location.name===i.peerId)return!1;return!0}}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(Hl),L(Pg),L(yn),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["chat-input"]],viewQuery:function(i,r){if(1&i&&Qn(mK,7),2&i){let o;Jn(o=ei())&&(r.textAreaElementRef=o.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:[Rt.None,"gameType","_gameType"],_sendFrom:[Rt.None,"sendFrom","_sendFrom"],_sendTo:[Rt.None,"sendTo","_sendTo"],_text:[Rt.None,"text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:25,vars:16,consts:[["textArea",""],["select",""],[1,"table",3,"ngClass"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[1,"table-cell"],[2,"width","12em",3,"ngModelChange","ngModel"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[2,"width","10em",3,"ngModelChange","ngModel"],["value",""],[4,"ngIf"],[3,"click","disabled"],["placeholder","Enter\u3067\u9001\u4fe1  Shift+Enter\u3067\u6539\u884c",1,"chat-input",3,"ngModelChange","input","keydown.enter","ngModel","ngModelOptions"],["type","submit",3,"click"],[1,"writing-info"],[1,"image",3,"src"],[3,"value"],[2,"width","12em",3,"change","ngModelChange","ngModel","ngModelOptions"],["disabled","",2,"width","12em"],["style","font-weight: bold;",4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(i,r){if(1&i){const o=Ue();_(0,"div",2)(1,"div",3),J(2,_K,2,4,"img",4),w(),_(3,"div",5)(4,"div")(5,"select",6),bt("ngModelChange",function(a){return re(o),pt(r.sendFrom,a)||(r.sendFrom=a),oe(a)}),J(6,vK,2,2,"option",7)(7,yK,2,2,"option",8),w(),O(8," \uff1e "),_(9,"select",9),bt("ngModelChange",function(a){return re(o),pt(r.sendTo,a)||(r.sendTo=a),oe(a)}),_(10,"option",10),O(11,"\u5168\u54e1"),w(),J(12,CK,3,3,"option",8),w(),J(13,EK,4,4,"ng-container",11)(14,xK,4,0,"ng-container",11),_(15,"button",12),ue("click",function(){return re(o),oe(r.showDicebotHelp())}),O(16,"?"),w()(),_(17,"div")(18,"form")(19,"textarea",13,0),bt("ngModelChange",function(a){return re(o),pt(r.text,a)||(r.text=a),oe(a)}),ue("input",function(){return re(o),oe(r.onInput())})("keydown.enter",function(a){return re(o),oe(r.sendChat(a))}),w(),_(21,"button",14),ue("click",function(){return re(o),oe(r.sendChat(null))}),O(22,"SEND"),w()()(),_(23,"div",15),J(24,SK,4,1,"ng-container",11),w()()()}2&i&&(b("ngClass",lt(13,gK,r.isDirect)),v(2),b("ngIf",0<r.imageFile.url.length),v(3),yt("ngModel",r.sendFrom),v(),b("ngIf",!r.onlyCharacters),v(),b("ngForOf",r.gameCharacters),v(2),yt("ngModel",r.sendTo),v(3),b("ngForOf",r.otherPeers),v(),b("ngIf",0<r.diceBotInfos.length),v(),b("ngIf",r.diceBotInfos.length<1),v(),b("disabled",r.diceBotInfos.length<1),v(4),yt("ngModel",r.text),b("ngModelOptions",Dl(15,zP)),v(5),b("ngIf",0<r.writingPeerNames.length))},dependencies:[Pi,ii,xn,lu,Ba,ja,hr,la,Ar,ou,pr,La,Ei],styles:["[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}"]})}return t})();function MK(t,n){if(1&t){const e=Ue();_(0,"chat-tab",10),ue("onAddMessage",function(){return re(e),oe(M().scrollToBottom())}),w()}2&t&&b("chatTab",M().chatTab)}function IK(t,n){1&t&&(_(0,"div"),O(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),w())}function AK(t,n){1&t&&Ee(0,"badge",13),2&t&&b("count",M().$implicit.unreadLength)}function kK(t,n){if(1&t){const e=Ue();_(0,"label")(1,"input",11),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.chatTabidentifier,r)||(o.chatTabidentifier=r),oe(r)}),w(),_(2,"div"),O(3),J(4,AK,1,1,"badge",12),w()()}if(2&t){const e=n.$implicit,i=M();v(),Pn("value",e.identifier),yt("ngModel",i.chatTabidentifier),v(2),ht(e.name),v(),b("ngIf",e.hasUnread)}}let $P=(()=>{class t{get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return De.instance.get(this.chatTabidentifier)}constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}ngOnInit(){this.sendFrom=Bt.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Q.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=De.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){Q.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(JX,{left:e.x-250,top:e.y-175,width:500,height:350}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo)}trackByChatTab(e,i){return i.identifier}static#e=this.\u0275fac=function(i){return new(i||t)(L(Hl),L(yn),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["chat-window"]],decls:13,vars:7,consts:[[1,"component"],[1,"log"],[3,"chatTab","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[3,"gameTypeChange","sendFromChange","chat","chatTabidentifier","gameType","sendFrom"],[3,"onAddMessage","chatTab"],["name","chat-tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(i,r){1&i&&(_(0,"div",0)(1,"div",1),J(2,MK,1,1,"chat-tab",2)(3,IK,2,0,"div",3),w(),_(4,"div",4)(5,"form")(6,"div",5),J(7,kK,5,4,"label",6),_(8,"button",7),ue("click",function(){return r.showTabSetting()}),_(9,"i",8),O(10,"settings"),w(),O(11,"\u30bf\u30d6\u8a2d\u5b9a"),w()()(),_(12,"chat-input",9),bt("gameTypeChange",function(s){return pt(r.gameType,s)||(r.gameType=s),s})("sendFromChange",function(s){return pt(r.sendFrom,s)||(r.sendFrom=s),s}),ue("chat",function(s){return r.sendChat(s)}),w()()()),2&i&&(v(2),b("ngIf",r.chatTab),v(),b("ngIf",!r.chatTab),v(4),b("ngForOf",r.chatMessageService.chatTabs)("ngForTrackBy",r.trackByChatTab),v(5),b("chatTabidentifier",r.chatTabidentifier),yt("gameType",r.gameType)("sendFrom",r.sendFrom))},dependencies:[ii,xn,lu,hr,vh,Ar,ou,pr,La,VP,pK,GP],styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}"]})}return t})();const OK=["root"],PK=(t,n,e)=>({"submenu-panel":t,"is-max-limit":n,"pointer-events-none":e}),NK=t=>({action:t});function FK(t,n){if(1&t&&(_(0,"div",6),O(1),w()),2&t){const e=M();v(),ht(e.title)}}function RK(t,n){1&t&&Bn(0)}function LK(t,n){if(1&t&&(Ae(0),J(1,RK,1,0,"ng-container",7),ke()),2&t){const e=n.$implicit;M();const i=Lt(6),r=Lt(8);v(),b("ngTemplateOutlet","separator"===(null==e?null:e.type)?r:i)("ngTemplateOutletContext",lt(2,NK,e))}}function BK(t,n){1&t&&(_(0,"div",12)(1,"i",13),O(2,"arrow_forward_ios"),w()())}function jK(t,n){if(1&t&&Ee(0,"context-menu",14),2&t){const e=M().action,i=M();b("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}function UK(t,n){if(1&t){const e=Ue();_(0,"li",8),ue("click",function(){const r=re(e).action;return oe(M().doAction(r))})("mouseenter",function(){const r=re(e).action;return oe(M().showSubMenu(r))}),_(1,"div",9),O(2),w(),J(3,BK,3,0,"div",10)(4,jK,1,3,"context-menu",11),w()}if(2&t){const e=n.action,i=M();v(2),ht(e.name),v(),b("ngIf",e.subActions),v(),b("ngIf",i.subMenu&&i.parentMenu===e)}}function VK(t,n){1&t&&(_(0,"li"),Ee(1,"hr",15),w())}let HK=(()=>{class t{get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}static#e=this.\u0275fac=function(i){return new(i||t)(L(ti),L(Zr),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["context-menu"]],viewQuery:function(i,r){if(1&i&&Qn(OK,7),2&i){let o;Jn(o=ei())&&(r.rootElementRef=o.first)}},hostBindings:function(i,r){1&i&&ue("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{title:"title",actions:"actions",isSubmenu:"isSubmenu"},decls:9,vars:7,consts:[["root",""],["actionMenu",""],["separator",""],[1,"component",3,"mouseleave","ngClass"],["class","title",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"hasHighlight",3,"click","mouseenter"],[1,"menu-title"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(i,r){if(1&i){const o=Ue();_(0,"div",3,0),ue("mouseleave",function(){return re(o),oe(r.hideSubMenu())}),J(2,FK,2,1,"div",4),_(3,"ul"),J(4,LK,2,4,"ng-container",5),w()(),J(5,UK,5,3,"ng-template",null,1,ni)(7,VK,2,0,"ng-template",null,2,ni)}2&i&&(b("ngClass",Bp(3,PK,r.isSubmenu,!r.isSubmenu,r.isPointerDragging)),v(2),b("ngIf",0<r.title.length),v(2),b("ngForOf",r.actions))},dependencies:[Pi,ii,xn,ch,t],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;padding:0;white-space:nowrap;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:9900}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}"]})}return t})();function zK(t,n){if(1&t){const e=Ue();_(0,"img",9),Qt(1,"safe"),ue("click",function(){re(e);const r=M().$implicit;return oe(M().onSelectedFile(r))}),w()}if(2&t){const e=M().$implicit;b("src",Jt(1,2,e.url,"resourceUrl"),_i)("alt",e.name)}}function GK(t,n){1&t&&Ee(0,"img",10),2&t&&Pn("alt",M().$implicit.name)}function $K(t,n){if(1&t&&(_(0,"span",6),J(1,zK,2,5,"img",7)(2,GK,1,1,"img",8),w()),2&t){const e=n.$implicit;v(),b("ngIf",0<e.url.length),v(),b("ngIf",e.url.length<=0)}}let WK=(()=>{class t{constructor(e,i){this.changeDetector=e,this.panelService=i,this.fileStorageService=Dt.instance}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){Q.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Q.unregister(this)}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Us.instance.load(r),i.value=""}onSelectedFile(e){console.log("onSelectedFile",e),Q.call("SELECT_FILE",{fileIdentifier:e.identifier},Be.peerId)}static#e=this.\u0275fac=function(i){return new(i||t)(L(Zi),L(yn))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["file-storage"]],decls:15,vars:1,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],["id","file-list"],["class","image",4,"ngFor","ngForOf"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"click","src","alt"],["src","assets/images/loading.gif",3,"alt"]],template:function(i,r){1&i&&(_(0,"label")(1,"div",0)(2,"div")(3,"i",1),O(4,"add_photo_alternate"),w()(),_(5,"div"),O(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),w(),_(7,"div",2),O(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),w(),_(9,"input",3),ue("change",function(s){return r.handleFileSelect(s)}),w(),_(10,"div",2),Ee(11,"br"),O(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),w()()(),_(13,"div",4),J(14,$K,3,2,"span",5),w()),2&i&&(v(14),b("ngForOf",r.fileStorageService.images))},dependencies:[ii,xn,Ei],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}'],changeDetection:0})}return t})();function qK(t,n){if(1&t){const e=Ue();_(0,"span",3)(1,"button",4),ue("click",function(){re(e);const r=M();return oe(r.onSelectedFile(r.empty))}),O(2,"\u753b\u50cf\u306a\u3057"),w()()}}function ZK(t,n){if(1&t){const e=Ue();_(0,"img",8),Qt(1,"safe"),ue("click",function(){re(e);const r=M().$implicit;return oe(M().onSelectedFile(r))}),w()}if(2&t){const e=M().$implicit;b("src",Jt(1,2,e.url,"resourceUrl"),_i)("alt",e.name)}}function YK(t,n){1&t&&Ee(0,"img",9),2&t&&Pn("alt",M().$implicit.name)}function XK(t,n){if(1&t&&(_(0,"span",5),J(1,ZK,2,5,"img",6)(2,YK,1,1,"img",7),w()),2&t){const e=n.$implicit;v(),b("ngIf",0<e.url.length),v(),b("ngIf",e.url.length<=0)}}let Ng=(()=>{class t{get images(){return Dt.instance.images}get empty(){return pn.Empty}constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){Q.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Q.unregister(this)}onSelectedFile(e){Q.call("SELECT_FILE",{fileIdentifier:e.identifier},Be.peerId),this.modalService.resolve(e.identifier)}static#e=this.\u0275fac=function(i){return new(i||t)(L(Zi),L(yn),L(gr))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty"},decls:3,vars:2,consts:[["id","file-list"],["class","empty",4,"ngIf"],["class","image",4,"ngFor","ngForOf"],[1,"empty"],[3,"click"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","./assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"click","src","alt"],["src","./assets/images/loading.gif",3,"alt"]],template:function(i,r){1&i&&(_(0,"div",0),J(1,qK,3,0,"span",1)(2,XK,3,2,"span",2),w()),2&i&&(v(),b("ngIf",r.isAllowedEmpty),v(),b("ngForOf",r.images))},dependencies:[ii,xn,Ei],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:middle}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100px}"],changeDetection:0})}return t})();function KK(t,n){1&t&&Bn(0)}function QK(t,n){if(1&t){const e=Ue();_(0,"div",4),J(1,KK,1,0,"ng-container",9),_(2,"select",10,1),ue("change",function(){re(e);const r=Lt(3);return oe(M(3).setElementType(r.value))}),_(4,"option",11),O(5,"\u901a\u5e38"),w(),_(6,"option",12),O(7,"\u30ea\u30bd\u30fc\u30b9"),w(),_(8,"option",13),O(9,"\u30ce\u30fc\u30c8"),w()()()}if(2&t){let e;const i=M(3),r=Lt(2);v(),b("ngTemplateOutlet",r),v(),b("ngModel",null!==(e=i.gameDataElement.type)&&void 0!==e?e:"")}}function JK(t,n){if(1&t&&(Ae(0),_(1,"div",14),O(2),w(),ke()),2&t){const e=M(3);v(2),ht(e.name)}}function eQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",15),O(2),w(),_(3,"input",16),bt("ngModelChange",function(r){re(e);const o=M(3);return pt(o.name,r)||(o.name=r),oe(r)}),w(),ke()}if(2&t){const e=M(3);v(2),ht(e.name),v(),yt("ngModel",e.name)}}function tQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"input",17),Qt(2,"safe"),bt("ngModelChange",function(r){re(e);const o=M(3);return pt(o.currentValue,r)||(o.currentValue=r),oe(r)}),w(),Ee(3,"br"),_(4,"input",18),bt("ngModelChange",function(r){re(e);const o=M(3);return pt(o.currentValue,r)||(o.currentValue=r),oe(r)}),w(),O(5," / "),_(6,"input",19),bt("ngModelChange",function(r){re(e);const o=M(3);return pt(o.value,r)||(o.value=r),oe(r)}),w(),ke()}if(2&t){const e=M(3);v(),lo(Jt(2,6,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Pn("max",e.value),yt("ngModel",e.currentValue),v(3),yt("ngModel",e.currentValue),v(2),yt("ngModel",e.value)}}function nQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"textarea",20),bt("ngModelChange",function(r){re(e);const o=M(3);return pt(o.value,r)||(o.value=r),oe(r)}),w(),ke()}if(2&t){const e=M(3);v(),yt("ngModel",e.value)}}function iQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",21),O(2),w(),_(3,"input",22),bt("ngModelChange",function(r){re(e);const o=M(3);return pt(o.value,r)||(o.value=r),oe(r)}),w(),ke()}if(2&t){const e=M(3);v(2),ht(e.value),v(),yt("ngModel",e.value)}}function rQ(t,n){if(1&t&&(Ae(0),J(1,QK,10,2,"div",3),_(2,"div",4),J(3,JK,3,1,"ng-container",2)(4,eQ,4,2,"ng-container",2),w(),_(5,"div",5),Ae(6,6),J(7,tQ,7,9,"ng-container",7)(8,nQ,2,1,"ng-container",7)(9,iQ,4,2,"ng-container",8),ke(),w(),ke()),2&t){const e=M(2);v(),b("ngIf",e.isEdit),v(2),b("ngIf",e.isTagLocked),v(),b("ngIf",!e.isTagLocked),v(2),b("ngSwitch",e.gameDataElement.type),v(),b("ngSwitchCase","numberResource"),v(),b("ngSwitchCase","note")}}function oQ(t,n){1&t&&Bn(0)}function sQ(t,n){if(1&t&&(_(0,"div",28),J(1,oQ,1,0,"ng-container",9),w()),2&t){M(3);const e=Lt(2);v(),b("ngTemplateOutlet",e)}}function aQ(t,n){if(1&t&&(Ae(0),_(1,"div",29),O(2),w(),ke()),2&t){const e=M(3);v(2),ht(e.name)}}function lQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"input",30),bt("ngModelChange",function(r){re(e);const o=M(3);return pt(o.name,r)||(o.name=r),oe(r)}),w(),ke()}if(2&t){const e=M(3);v(),yt("ngModel",e.name)}}function cQ(t,n){if(1&t&&Ee(0,"div",33),2&t){const e=n.$implicit,i=M(4);b("gameDataElement",e)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)}}function uQ(t,n){if(1&t&&(_(0,"div",31),J(1,cQ,1,3,"div",32),w()),2&t){const e=M(3);v(),b("ngForOf",e.gameDataElement.children)}}function dQ(t,n){if(1&t&&(Ae(0),J(1,sQ,2,1,"div",23),Ee(2,"div",24),_(3,"div",25)(4,"div",26),J(5,aQ,3,1,"ng-container",2)(6,lQ,2,1,"ng-container",2),w(),J(7,uQ,2,1,"div",27),w(),ke()),2&t){const e=M(2);v(),b("ngIf",e.isEdit),v(4),b("ngIf",e.isTagLocked),v(),b("ngIf",!e.isTagLocked),v(),b("ngIf",0<e.gameDataElement.children.length)}}function hQ(t,n){if(1&t&&(Ae(0),J(1,rQ,10,6,"ng-container",2)(2,dQ,8,4,"ng-container",2),ke()),2&t){const e=M();v(),b("ngIf",e.gameDataElement.children.length<1),v(),b("ngIf",0<e.gameDataElement.children.length)}}function fQ(t,n){if(1&t){const e=Ue();_(0,"button",34),ue("click",function(){return re(e),oe(M().addElement())}),_(1,"i",35),O(2,"add_circle"),w()(),_(3,"button",34),ue("click",function(){return re(e),oe(M().upElement())}),_(4,"i",35),O(5,"arrow_upward"),w()(),Ee(6,"br"),_(7,"button",34),ue("click",function(){return re(e),oe(M().deleteElement())}),_(8,"i",35),O(9,"remove_circle_outline"),w()(),_(10,"button",34),ue("click",function(){return re(e),oe(M().downElement())}),_(11,"i",35),O(12,"arrow_downward"),w()()}}let pQ=(()=>{class t{get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}constructor(e){this.changeDetector=e,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement)}ngOnChanges(){Q.unregister(this),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameDataElement?.identifier}`,e=>{this.setValues(this.gameDataElement),this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Q.unregister(this)}addElement(){this.gameDataElement.appendChild(tt.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}static#e=this.\u0275fac=function(i){return new(i||t)(L(Zi))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked"},features:[Kn],decls:3,vars:1,consts:[["editButtons",""],["select",""],[4,"ngIf"],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet"],[3,"change","ngModel"],["value",""],["value","numberResource"],["value","note"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModelChange","ngModel"],["type","range","min","0",3,"ngModelChange","ngModel","max"],["size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"ngModelChange","ngModel"],["size","1","type","number","placeholder","Value",2,"width","5em",3,"ngModelChange","ngModel"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","none","font-size","0.8em",3,"ngModelChange","ngModel"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["size","1","placeholder","Value",2,"width","100%","min-width","10px",3,"ngModelChange","ngModel"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModelChange","ngModel"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","isEdit","isTagLocked",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked"],[3,"click"],[1,"material-icons"]],template:function(i,r){1&i&&J(0,hQ,3,2,"ng-container",2)(1,fQ,13,0,"ng-template",null,0,ni),2&i&&b("ngIf",r.gameDataElement)},dependencies:[ii,xn,ch,Il,ah,lh,Ba,ja,hr,cu,Pl,la,Ar,pr,t,Ei],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#eee}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#fff}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}"],changeDetection:0})}return t})();const mQ=t=>({"is-hidden":t});function gQ(t,n){1&t&&Bn(0)}function _Q(t,n){if(1&t){const e=Ue();Ae(0),_(1,"button",1),ue("click",function(){return re(e),oe(M().openModal("front"))}),O(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),w(),_(3,"button",1),ue("click",function(){return re(e),oe(M().openModal("back"))}),O(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),w(),ke()}}function vQ(t,n){1&t&&Bn(0)}function yQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"button",1),ue("click",function(){return re(e),oe(M().openModal("floor"))}),O(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),w(),_(3,"button",1),ue("click",function(){return re(e),oe(M().openModal("wall"))}),O(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),w(),ke()}}function bQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"button",5),ue("click",function(){re(e);const r=M();return oe(r.openModal(r.tabletopObject.face))}),O(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),w(),ke()}if(2&t){const e=M();v(),b("disabled",!e.tabletopObject.isVisible)}}function CQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"button",1),ue("click",function(){return re(e),oe(M().openModal("imageIdentifier",!0))}),O(2,"\u753b\u50cf\u5909\u66f4"),w(),ke()}}function wQ(t,n){if(1&t&&(_(0,"div",11),O(1),w()),2&t){const e=M();v(),ki("",e.progresPercent,"%")}}function EQ(t,n){if(1&t){const e=Ue();_(0,"select",13,0),ue("change",function(){re(e);const r=Lt(1);return oe(M(2).setLocation(r.value))}),_(2,"option",14),O(3,"\u30c6\u30fc\u30d6\u30eb"),w(),_(4,"option",15),O(5,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),w(),_(6,"option",16),O(7,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),w(),_(8,"option",17),O(9,"\u5893\u5730"),w()()}if(2&t){const e=M(2);b("ngModel",e.tabletopObject.location.name),v(6),Pn("value",e.networkService.peerId)}}function xQ(t,n){if(1&t&&(Ae(0),J(1,EQ,10,2,"select",12),ke()),2&t){const e=M();v(),b("ngIf",e.tabletopObject)}}function TQ(t,n){if(1&t&&(_(0,"div",20),Ee(1,"img",21),Qt(2,"safe"),w()),2&t){const e=M(2);v(),b("src",Jt(2,2,e.tabletopObject.imageFile.url,"resourceUrl"),_i)("alt",e.tabletopObject.imageFile.name)}}function DQ(t,n){if(1&t&&(Ae(0),_(1,"div",22)(2,"div",23),Ee(3,"div",24),w()(),ke()),2&t){const e=M(2);v(3),b("gameDataElement",e.tabletopObject.commonDataElement)("isTagLocked",!0)}}function SQ(t,n){if(1&t&&(_(0,"div",22)(1,"div",23),Ee(2,"div",26),w()()),2&t){const e=n.$implicit,i=M(3);v(2),b("gameDataElement",e)("isEdit",i.isEdit)}}function MQ(t,n){if(1&t&&(Ae(0),J(1,SQ,3,2,"div",25),ke()),2&t){const e=M(2);v(),b("ngForOf",e.tabletopObject.detailDataElement.children)}}function IQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",22)(2,"button",27),ue("click",function(){return re(e),oe(M(2).addDataElement())}),O(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),w()(),ke()}}function AQ(t,n){if(1&t&&(_(0,"div",18),J(1,TQ,3,5,"div",19)(2,DQ,4,2,"ng-container",9)(3,MQ,2,1,"ng-container",9)(4,IQ,4,0,"ng-container",9),w()),2&t){const e=M();v(),b("ngIf",0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)),v(),b("ngIf",e.tabletopObject.commonDataElement),v(),b("ngIf",e.tabletopObject.detailDataElement),v(),b("ngIf",e.isEdit)}}let zs=(()=>{class t{constructor(e,i,r){this.saveDataService=e,this.panelService=i,this.modalService=r,this.tabletopObject=null,this.isEdit=!1,this.networkService=Be,this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Q.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Q.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=tt.create("\u898b\u51fa\u3057","",{}),i=tt.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":xe.play(pe.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,xe.play(pe.cardPut);break;case"text-note":e.toTopmost(),xe.play(pe.cardPut);break;case"dice-symbol":xe.play(pe.dicePut);default:xe.play(pe.piecePut)}}saveToXML(){var e=this;return(0,E.A)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tabletopObject.commonDataElement.getFirstElementByName("name"),r=i?i.value:"";yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"xml_"+r,o=>{e.progresPercent=o}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){this.tabletopObject.setLocation(e)}openModal(e="",i=!1){this.modalService.open(Ng,{isAllowedEmpty:i}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);o&&(o.value=r)})}static#e=this.\u0275fac=function(i){return new(i||t)(L(Hs),L(yn),L(gr))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["game-character-sheet"]],inputs:{tabletopObject:"tabletopObject"},decls:18,vars:13,consts:[["select",""],[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"change","ngModel"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"main-image",3,"src","alt"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit"],[2,"width","100%","color","#555",3,"click"]],template:function(i,r){1&i&&(_(0,"button",1),ue("click",function(){return r.toggleEditMode()}),O(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),w(),Ae(2,2),J(3,gQ,1,0,"ng-container",3)(4,_Q,5,0,"ng-container",3)(5,vQ,1,0,"ng-container",3)(6,yQ,5,0,"ng-container",3)(7,bQ,3,1,"ng-container",3)(8,CQ,3,0,"ng-container",4),ke(),_(9,"button",1),ue("click",function(){return r.clone()}),O(10,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),w(),_(11,"button",5),ue("click",function(){return r.saveToXML()}),_(12,"div",6)(13,"div",7),O(14,"\u4fdd\u5b58"),w(),J(15,wQ,2,1,"div",8),w()(),J(16,xQ,2,1,"ng-container",9)(17,AQ,5,4,"div",10)),2&i&&(v(2),b("ngSwitch",r.tabletopObject.aliasName),v(),b("ngSwitchCase","numberResource"),v(),b("ngSwitchCase","card"),v(),b("ngSwitchCase","card-stack"),v(),b("ngSwitchCase","terrain"),v(),b("ngSwitchCase","dice-symbol"),v(4),b("disabled",r.isSaveing),v(2),b("ngClass",lt(11,mQ,r.isSaveing)),v(2),b("ngIf",r.isSaveing),v(),b("ngIf","character"===r.tabletopObject.aliasName),v(),b("ngIf",r.tabletopObject))},dependencies:[Pi,ii,xn,Il,ah,lh,Ba,ja,la,Ar,pr,pQ,Ei],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px}.main-image[_ngcontent-%COMP%]{width:250px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]})}return t})();const kQ=["chatInput"],OQ=["chatPlette"];function PQ(t,n){1&t&&Ee(0,"badge",13),2&t&&b("count",M().$implicit.unreadLength)}function NQ(t,n){if(1&t){const e=Ue();_(0,"label")(1,"input",11),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.chatTabidentifier,r)||(o.chatTabidentifier=r),oe(r)}),w(),_(2,"div"),O(3),J(4,PQ,1,1,"badge",12),w()()}if(2&t){const e=n.$implicit,i=M();v(),Pn("value",e.identifier),yt("ngModel",i.chatTabidentifier),v(2),ht(e.name),v(),b("ngIf",e.hasUnread)}}function FQ(t,n){1&t&&(_(0,"div",14)(1,"i",15),O(2,"info_outline"),w(),O(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),w())}function RQ(t,n){if(1&t&&(_(0,"option",19),O(1),w()),2&t){const e=n.$implicit;Pn("value",e),v(),ht(e)}}function LQ(t,n){if(1&t&&(Ae(0),J(1,RQ,2,2,"option",18),ke()),2&t){const e=M(2);v(),b("ngForOf",e.palette.getPalette())}}function BQ(t,n){if(1&t){const e=Ue();_(0,"div",16)(1,"select",17,1),ue("input",function(){re(e);const r=Lt(2);return oe(M().selectPalette(r.value))})("click",function(){re(e);const r=Lt(2);return oe(M().clickPalette(r.value))}),J(3,LQ,2,1,"ng-container",10),w()()}if(2&t){const e=M();v(3),b("ngIf",e.palette)}}function jQ(t,n){if(1&t){const e=Ue();_(0,"div",16)(1,"textarea",20),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.editPalette,r)||(o.editPalette=r),oe(r)}),w()()}if(2&t){const e=M();v(),yt("ngModel",e.editPalette)}}function UQ(t,n){1&t&&(_(0,"span"),O(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),w())}function VQ(t,n){1&t&&(_(0,"span"),O(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),w())}let WP=(()=>{class t{get palette(){return this.character.chatPalette}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return Vs.diceBotInfos}get chatTab(){return De.instance.get(this.chatTabidentifier)}get myPeer(){return Bt.myCursor}get otherPeers(){return De.instance.getObjects(Bt)}constructor(e,i){this.chatMessageService=e,this.panelService=i,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.doubleClickTimer=null}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",Q.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){Q.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=De.instance.get(e);if(i instanceof Vn){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){this.doubleClickTimer&&this.text===e?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.text=e,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo)}}resetPletteSelect(){this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}static#e=this.\u0275fac=function(i){return new(i||t)(L(Hl),L(yn))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["chat-palette"]],viewQuery:function(i,r){if(1&i&&(Qn(kQ,7),Qn(OQ,5)),2&i){let o;Jn(o=ei())&&(r.chatInputComponent=o.first),Jn(o=ei())&&(r.chatPletteElementRef=o.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[["chatInput",""],["chatPlette",""],[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"gameTypeChange","sendFromChange","textChange","chat","onlyCharacters","chatTabidentifier","gameType","sendFrom","text"],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModelChange","ngModel"]],template:function(i,r){if(1&i){const o=Ue();_(0,"div",2)(1,"div",3)(2,"form")(3,"div",4),J(4,NQ,5,4,"label",5),w()(),_(5,"chat-input",6,0),bt("gameTypeChange",function(a){return re(o),pt(r.gameType,a)||(r.gameType=a),oe(a)})("sendFromChange",function(a){return re(o),pt(r.sendFrom,a)||(r.sendFrom=a),oe(a)})("textChange",function(a){return re(o),pt(r.text,a)||(r.text=a),oe(a)}),ue("chat",function(a){return re(o),oe(r.sendChat(a))}),w(),J(7,FQ,4,0,"div",7),w(),J(8,BQ,4,1,"div",8)(9,jQ,2,1,"div",8),_(10,"div",3)(11,"button",9),ue("click",function(){return re(o),oe(r.toggleEditMode())}),J(12,UQ,2,0,"span",10)(13,VQ,2,0,"span",10),w()()()}2&i&&(v(4),b("ngForOf",r.chatMessageService.chatTabs),v(),b("onlyCharacters",!0)("chatTabidentifier",r.chatTabidentifier),yt("gameType",r.gameType)("sendFrom",r.sendFrom)("text",r.text),v(2),b("ngIf",r.isEdit),v(),b("ngIf",!r.isEdit),v(),b("ngIf",r.isEdit),v(3),b("ngIf",!r.isEdit),v(),b("ngIf",r.isEdit))},dependencies:[ii,xn,lu,Ba,ja,hr,vh,Ar,ou,pr,La,VP,GP],styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}"]})}return t})();const HQ=t=>({box:!0,selected:t}),zQ=t=>({gameObject:t}),GQ=t=>({dataElm:t});function $Q(t,n){1&t&&Bn(0)}function WQ(t,n){1&t&&Bn(0)}function qQ(t,n){if(1&t&&(_(0,"div"),O(1),w()),2&t){const e=M();v(),ki("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function ZQ(t,n){1&t&&Bn(0)}function YQ(t,n){if(1&t){const e=Ue();_(0,"div",9),ue("contextmenu",function(r){const o=re(e).$implicit;return oe(M().onContextMenu(r,o))})("click",function(){const r=re(e).$implicit;return oe(M().selectGameObject(r))}),J(1,ZQ,1,0,"ng-container",10),w()}if(2&t){const e=n.$implicit,i=M(),r=Lt(11);b("ngClass",lt(3,HQ,i.selectedIdentifier===e.identifier)),v(),b("ngTemplateOutlet",r)("ngTemplateOutletContext",lt(5,zQ,e))}}function XQ(t,n){if(1&t){const e=Ue();_(0,"div",11)(1,"button",12),ue("click",function(){return re(e),oe(M().cleanInventory())}),O(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),w()()}if(2&t){const e=M();v(),xo("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function KQ(t,n){if(1&t){const e=Ue();_(0,"label")(1,"input",16),bt("ngModelChange",function(r){re(e);const o=M(2);return pt(o.selectTab,r)||(o.selectTab=r),oe(r)}),w(),_(2,"div"),O(3),w()()}if(2&t){const e=n.$implicit,i=M(2);v(),Pn("value",e),yt("ngModel",i.selectTab),v(2),eu("",i.getTabTitle(e)," (",i.getInventory(e).length,")")}}function QQ(t,n){if(1&t&&(_(0,"form",13)(1,"div",14),J(2,KQ,4,4,"label",15),w()()),2&t){const e=M();v(2),b("ngForOf",e.inventoryTypes)}}function JQ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div")(2,"div",17),O(3,"\u4e26\u3073\u9806"),w(),_(4,"input",18),bt("ngModelChange",function(r){re(e);const o=M(2);return pt(o.sortTag,r)||(o.sortTag=r),oe(r)}),w(),_(5,"select",19),bt("ngModelChange",function(r){re(e);const o=M(2);return pt(o.sortOrder,r)||(o.sortOrder=r),oe(r)}),_(6,"option",20),O(7,"\u6607\u9806"),w(),_(8,"option",21),O(9,"\u964d\u9806"),w()()(),_(10,"div",22),O(11,"\u8868\u793a\u9805\u76ee"),w(),_(12,"input",23),bt("ngModelChange",function(r){re(e);const o=M(2);return pt(o.dataTag,r)||(o.dataTag=r),oe(r)}),w(),_(13,"div",11)(14,"button",24),ue("click",function(){return re(e),oe(M(2).toggleEdit())}),_(15,"i",25),O(16,"settings"),w(),O(17,"\u5b8c\u4e86"),w()(),ke()}if(2&t){const e=M(2);v(4),yt("ngModel",e.sortTag),v(),yt("ngModel",e.sortOrder),v(7),yt("ngModel",e.dataTag)}}function eJ(t,n){if(1&t&&(Ae(0),O(1),ke()),2&t){const e=M(3);v(),eu("",e.sortTag," (",e.sortOrderName,")")}}function tJ(t,n){1&t&&(Ae(0),O(1,"-"),ke())}function nJ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"table",26)(2,"tr")(3,"th",27),O(4,"\u4e26\u3073\u9806:"),w(),_(5,"td",27),J(6,eJ,2,2,"ng-container",6)(7,tJ,2,0,"ng-container",6),w(),_(8,"td")(9,"button",24),ue("click",function(){return re(e),oe(M(2).toggleEdit())}),_(10,"i",25),O(11,"settings"),w(),O(12,"\u8a2d\u5b9a"),w()()()(),ke()}if(2&t){const e=M(2);v(6),b("ngIf",0<e.sortTag.length),v(),b("ngIf",e.sortTag.length<1)}}function iJ(t,n){if(1&t&&J(0,JQ,18,3,"ng-container",6)(1,nJ,13,2,"ng-container",6),2&t){const e=M();b("ngIf",e.isEdit),v(),b("ngIf",!e.isEdit)}}function rJ(t,n){if(1&t){const e=Ue();_(0,"button",35),ue("click",function(r){re(e);const o=M().gameObject;return oe(M().onContextMenu(r,o))}),_(1,"i",36),O(2,"settings"),w()()}}function oJ(t,n){1&t&&(Ee(0,"img",37),Qt(1,"safe")),2&t&&b("src",Jt(1,1,M().gameObject.imageFile.url,"resourceUrl"),_i)}function sJ(t,n){1&t&&Bn(0)}function aJ(t,n){if(1&t&&(Ae(0),J(1,sJ,1,0,"ng-container",10),ke()),2&t){const e=n.$implicit;M(3);const i=Lt(13);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,GQ,e))}}function lJ(t,n){if(1&t&&(_(0,"div"),J(1,aJ,2,4,"ng-container",38),w()),2&t){const e=M().gameObject,i=M();v(),b("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function cJ(t,n){if(1&t&&(_(0,"div",28)(1,"div",29),O(2),J(3,rJ,3,0,"button",30),w(),_(4,"div",31)(5,"div",32),J(6,oJ,2,4,"img",33),w(),_(7,"div",34),J(8,lJ,2,2,"div",6),w()()()),2&t){const e=n.gameObject,i=M();v(2),ki("",e.name," "),v(),b("ngIf",i.selectedIdentifier===e.identifier),v(3),b("ngIf",e.imageFile.url),v(2),b("ngIf",e.rootDataElement)}}function uJ(t,n){1&t&&(Ae(0),Ee(1,"br"),ke())}function dJ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",44)(2,"div",45),O(3),w(),_(4,"input",46),bt("ngModelChange",function(r){re(e);const o=M(2).dataElm;return pt(o.currentValue,r)||(o.currentValue=r),oe(r)}),w()(),_(5,"div",44)(6,"input",47),Qt(7,"safe"),bt("ngModelChange",function(r){re(e);const o=M(2).dataElm;return pt(o.currentValue,r)||(o.currentValue=r),oe(r)}),w()(),ke()}if(2&t){const e=M(2).dataElm;v(3),ht(e.name),v(),yt("ngModel",e.currentValue),v(2),lo(Jt(7,6,"font-size: 0.8em; min-width: 1em; width:"+(e.name.length+4.5)+"em; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Pn("max",e.value),yt("ngModel",e.currentValue)}}function hJ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",48),O(2),w(),_(3,"div",49)(4,"div",50)(5,"div",51)(6,"div",52),O(7),w(),_(8,"input",53),bt("ngModelChange",function(r){re(e);const o=M(2).dataElm;return pt(o.value,r)||(o.value=r),oe(r)}),w()()()(),ke()}if(2&t){const e=M(2).dataElm;v(2),ht(e.name),v(5),ht(e.value),v(),yt("ngModel",e.value)}}function fJ(t,n){if(1&t&&(_(0,"div",40),Ae(1,41),J(2,dJ,8,9,"ng-container",42)(3,hJ,9,3,"ng-container",43),ke(),w()),2&t){const e=M().dataElm;v(),b("ngSwitch",e.attributes.type),v(),b("ngSwitchCase","numberResource")}}function pJ(t,n){if(1&t&&J(0,uJ,2,0,"ng-container",6)(1,fJ,4,2,"div",39),2&t){const e=n.dataElm,i=M();b("ngIf",e===i.newLineDataElement),v(),b("ngIf",e&&e!==i.newLineDataElement)}}let mJ=(()=>{class t{get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get sortOrderName(){return this.sortOrder===t1.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineDataElement(){return this.inventoryService.newLineDataElement}constructor(e,i,r,o,s){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Q.register(this).on("SELECT_TABLETOP_OBJECT",e=>{De.instance.get(e.data.identifier)instanceof qr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",Be.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=Be.peerId)}),this.inventoryTypes=["table","common",Be.peerId,"graveyard"]}ngOnDestroy(){Q.unregister(this)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case Be.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case Be.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],o=[];o.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),"graveyard"!==i.location.name&&o.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)}}),o.push(gn);let s=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5"},{name:"common",alias:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:Be.peerId,alias:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:"graveyard",alias:"\u5893\u5834\u306b\u79fb\u52d5"}];for(let a of s)i.location.name!==a.name&&o.push({name:a.alias,action:()=>{i.setLocation(a.name),xe.play(pe.piecePut)}});"graveyard"===i.location.name&&o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.deleteGameObject(i),xe.play(pe.sweep)}}),o.push(gn),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),xe.play(pe.piecePut)}}),this.contextMenuService.open(r,o,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);if(confirm(`${e}\u306b\u5b58\u5728\u3059\u308b${i.length}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)){for(const r of i)this.deleteGameObject(r);xe.play(pe.sweep)}}cloneGameObject(e){e.clone()}showDetail(e){Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(zs,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(WP,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}selectGameObject(e){Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName})}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}trackByGameObject(e,i){return i?i.identifier:e}static#e=this.\u0275fac=function(i){return new(i||t)(L(Zi),L(yn),L(ga),L(Zr),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"ngClass","contextmenu","click",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],[3,"contextmenu","click","ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModelChange","ngModel"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],[2,"vertical-align","middle"],[1,"inventory-object"],[1,"object-name"],["style","font-size: 0.8em; padding: 2px 5px;",3,"click",4,"ngIf"],[1,"object-tags-box"],[1,"table-cell","image-box"],[3,"src",4,"ngIf"],[1,"table-cell"],[2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em"],[3,"src"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["type","number","size","1","placeholder","Value",1,"input","resource-value",3,"ngModelChange","ngModel"],["type","range","min","0",3,"ngModelChange","max","ngModel"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["size","1","placeholder","",1,"input","tag-value",3,"ngModelChange","ngModel"]],template:function(i,r){if(1&i&&(_(0,"div",4),J(1,$Q,1,0,"ng-container",5)(2,WQ,1,0,"ng-container",5)(3,qQ,2,1,"div",6)(4,YQ,2,7,"div",7)(5,XQ,3,1,"div",8),w(),J(6,QQ,3,1,"ng-template",null,0,ni)(8,iJ,2,2,"ng-template",null,1,ni)(10,cJ,9,4,"ng-template",null,2,ni)(12,pJ,2,2,"ng-template",null,3,ni)),2&i){const o=Lt(7),s=Lt(9);v(),b("ngTemplateOutlet",o),v(),b("ngTemplateOutlet",s),v(),b("ngIf",r.getGameObjects(r.selectTab).length<1),v(),b("ngForOf",r.getGameObjects(r.selectTab))("ngForTrackBy",r.trackByGameObject),v(),b("ngIf","graveyard"===r.selectTab)}},dependencies:[Pi,ii,xn,ch,Il,ah,lh,lu,Ba,ja,hr,cu,Pl,la,vh,Ar,ou,pr,La,Ei],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}"],changeDetection:0})}return t})();const gJ=pn.create("./assets/images/skeleton.png");let Pu=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof pn?e:Dt.instance.get(e);return i&&!i.isEmpty?i:gJ}getEmptyOr(e){let i=e instanceof pn?e:Dt.instance.get(e);return i&&!i.isEmpty?i:pn.Empty}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const _J=t=>({"is-hidden":t});function vJ(t,n){if(1&t&&(_(0,"option",8),O(1),w()),2&t){const e=n.$implicit;Pn("value",e.identifier),v(),ht(e.name)}}function yJ(t,n){if(1&t){const e=Ue();_(0,"div")(1,"button",29),ue("click",function(){return re(e),oe(M(2).openBgImageModal())}),O(2,"\u753b\u50cf\u3092\u8ffd\u52a0"),w()()}if(2&t){const e=M(2);v(),b("disabled",!e.isEditable)}}function bJ(t,n){if(1&t){const e=Ue();_(0,"div",3),ue("click",function(){return re(e),oe(M(2).openBgImageModal())}),Ee(1,"img",30),Qt(2,"safe"),w()}if(2&t){const e=M(2);v(),b("src",Jt(2,1,e.tableBackgroundImage.url,"resourceUrl"),_i)}}function CJ(t,n){if(1&t){const e=Ue();_(0,"div")(1,"button",29),ue("click",function(){return re(e),oe(M(2).openDistanceViewImageModal())}),O(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),w()()}if(2&t){const e=M(2);v(),b("disabled",!e.isEditable)}}function wJ(t,n){if(1&t){const e=Ue();_(0,"div",3),ue("click",function(){return re(e),oe(M(2).openDistanceViewImageModal())}),Ee(1,"img",30),Qt(2,"safe"),w()}if(2&t){const e=M(2);v(),b("src",Jt(2,1,e.tableDistanceviewImage.url,"resourceUrl"),_i)}}function EJ(t,n){if(1&t&&(_(0,"div",36),O(1),w()),2&t){const e=M(3);v(),ki("",e.progresPercent,"%")}}function xJ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"button",31),ue("click",function(){return re(e),oe(M(2).save())}),_(2,"div",32)(3,"div",33),O(4,"\u4fdd\u5b58"),w(),J(5,EJ,2,1,"div",34),w()(),_(6,"button",35),ue("click",function(){return re(e),oe(M(2).delete())}),O(7,"\u524a\u9664"),w(),ke()}if(2&t){const e=M(2);v(),b("disabled",e.isSaveing),v(2),b("ngClass",lt(4,_J,e.isSaveing)),v(2),b("ngIf",e.isSaveing),v(),b("disabled",e.getGameTables().length<=1)}}function TJ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"button",3),ue("click",function(){return re(e),oe(M(2).restore())}),O(2,"\u5143\u306b\u623b\u3059"),w(),ke()}}function DJ(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",9)(2,"div"),O(3," \u753b\u50cf "),J(4,yJ,3,1,"div",7)(5,bJ,3,4,"div",10),w(),_(6,"div"),O(7," \u80cc\u666f "),J(8,CJ,3,1,"div",7)(9,wJ,3,4,"div",10),w()(),_(10,"div"),O(11,"Name : "),_(12,"input",11),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableName,r)||(o.tableName=r),oe(r)}),w()(),_(13,"div")(14,"input",12),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableWidth,r)||(o.tableWidth=r),oe(r)}),w(),O(15," Width : "),_(16,"input",13),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableWidth,r)||(o.tableWidth=r),oe(r)}),w()(),_(17,"div")(18,"input",14),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableHeight,r)||(o.tableHeight=r),oe(r)}),w(),O(19," Height : "),_(20,"input",13),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableHeight,r)||(o.tableHeight=r),oe(r)}),w()(),_(21,"div"),O(22," \u30b0\u30ea\u30c3\u30c9: "),_(23,"select",15),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableGridType,r)||(o.tableGridType=r),oe(r)}),_(24,"option",16),O(25,"\u306a\u3057"),w(),_(26,"option",17),O(27,"\u30b9\u30af\u30a8\u30a2"),w(),_(28,"option",18),O(29,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),w(),_(30,"option",19),O(31,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),w()(),O(32," \u8272: "),_(33,"select",20),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableGridColor,r)||(o.tableGridColor=r),oe(r)}),_(34,"option",21),O(35,"\u9ed2"),w(),_(36,"option",22),O(37,"\u767d"),w()()(),_(38,"div"),O(39," \u80cc\u666f\u30d5\u30a3\u30eb\u30bf "),_(40,"select",23),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableDistanceviewFilter,r)||(o.tableDistanceviewFilter=r),oe(r)}),_(41,"option",24),O(42,"\u306a\u3057"),w(),_(43,"option",25),O(44,"\u30db\u30ef\u30a4\u30c8"),w(),_(45,"option",26),O(46,"\u30d6\u30e9\u30c3\u30af"),w()()(),Ee(47,"hr"),_(48,"div")(49,"label"),O(50,"\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a: "),_(51,"input",27),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableGridShow,r)||(o.tableGridShow=r),oe(r)}),w()(),_(52,"label"),O(53,"\u30b9\u30ca\u30c3\u30d7: "),_(54,"input",28),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.tableGridSnap,r)||(o.tableGridSnap=r),oe(r)}),w()(),J(55,xJ,8,6,"ng-container",7)(56,TJ,3,0,"ng-container",7),w(),ke()}if(2&t){const e=M();v(4),b("ngIf",!e.tableBackgroundImage.url),v(),b("ngIf",e.tableBackgroundImage.url),v(3),b("ngIf",!e.tableDistanceviewImage.url),v(),b("ngIf",e.tableDistanceviewImage.url),v(3),yt("ngModel",e.tableName),b("disabled",!e.isEditable),v(2),Pn("min",e.minSize),Pn("max",e.maxSize),yt("ngModel",e.tableWidth),b("disabled",!e.isEditable),v(2),Pn("min",e.minSize),Pn("max",e.maxSize),yt("ngModel",e.tableWidth),b("disabled",!e.isEditable),v(2),Pn("min",e.minSize),Pn("max",e.maxSize),yt("ngModel",e.tableHeight),b("disabled",!e.isEditable),v(2),Pn("min",e.minSize),Pn("max",e.maxSize),yt("ngModel",e.tableHeight),b("disabled",!e.isEditable),v(3),yt("ngModel",e.tableGridType),b("disabled",!e.isEditable),v(10),yt("ngModel",e.tableGridColor),b("disabled",!e.isEditable),v(7),yt("ngModel",e.tableDistanceviewFilter),b("disabled",!e.isEditable),v(11),yt("ngModel",e.tableGridShow),v(3),yt("ngModel",e.tableGridSnap),v(),b("ngIf",!e.isDeleted),v(),b("ngIf",e.isDeleted)}}function SJ(t,n){1&t&&(Ae(0),_(1,"div",37),O(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),w(),ke())}let qP=(()=>{class t{get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,Q.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return _a.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==De.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o){this.modalService=e,this.saveDataService=i,this.imageService=r,this.panelService=o,this.minSize=1,this.maxSize=100,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),this.selectedTable=this.tableSelecter.viewTable,Q.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=De.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngOnDestroy(){Q.unregister(this)}selectGameTable(e){Q.call("SELECT_GAME_TABLE",{identifier:e},Be.peerId),this.selectedTable=De.instance.get(e),this.selectedTableXml=""}getGameTables(){return De.instance.getObjects(Fi)}createGameTable(){let e=new Fi;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,E.A)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=Un.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}openBgImageModal(){this.isDeleted||this.modalService.open(Ng).then(e=>{!this.selectedTable||!e||(this.selectedTable.imageIdentifier=e)})}openDistanceViewImageModal(){this.isDeleted||this.modalService.open(Ng,{isAllowedEmpty:!0}).then(e=>{!this.selectedTable||!e||(this.selectedTable.backgroundImageIdentifier=e)})}static#e=this.\u0275fac=function(i){return new(i||t)(L(gr),L(Hs),L(Pu),L(yn))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["game-table-setting"]],decls:11,vars:4,consts:[["select",""],[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[1,"images-select"],[3,"click",4,"ngIf"],["placeholder","Name",3,"ngModelChange","ngModel","disabled"],["type","range","name","tableWidth",3,"ngModelChange","ngModel","min","max","disabled"],["type","number",2,"width","5em",3,"ngModelChange","ngModel","min","max","disabled"],["type","range","name","tableHeight",3,"ngModelChange","ngModel","min","max","disabled"],["name","tableGridType",3,"ngModelChange","ngModel","disabled"],["value","-1"],["value","0"],["value","1"],["value","2"],["name","tableGridColor",3,"ngModelChange","ngModel","disabled"],["value","#000000e6"],["value","#dddddde6"],["name","tableDistanceviewFilter",3,"ngModelChange","ngModel","disabled"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModelChange","ngModel"],["type","checkbox","name","tableGridSnap",3,"ngModelChange","ngModel"],[2,"height","120px",3,"click","disabled"],["height","120",3,"src"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click","disabled"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ue();_(0,"div",1)(1,"div",2)(2,"div")(3,"button",3),ue("click",function(){return re(o),oe(r.createGameTable())}),O(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),w()(),_(5,"select",4,0),ue("change",function(){re(o);const a=Lt(6);return oe(r.selectGameTable(a.value))}),J(7,vJ,2,2,"option",5),w()(),_(8,"div",6),J(9,DJ,57,32,"ng-container",7),w()(),J(10,SJ,3,0,"ng-container",7)}2&i&&(v(5),b("ngModel",null==r.selectedTable?null:r.selectedTable.identifier),v(2),b("ngForOf",r.getGameTables()),v(2),b("ngIf",r.selectedTable),v(),b("ngIf",r.isEmpty))},dependencies:[Pi,ii,xn,Ba,ja,hr,cu,Pl,Uy,la,Ar,ob,rb,pr,Ei],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]})}return t})();function MJ(t,n){if(1&t){const e=Ue();_(0,"button",10),ue("click",function(){re(e);const r=M().$implicit;return oe(M().play(r))}),O(1,"\u8a66\u8074/\u518d\u751f"),w()}2&t&&b("disabled",!M().$implicit.isReady)}function IJ(t,n){if(1&t){const e=Ue();_(0,"button",10),ue("click",function(){return re(e),oe(M(2).stop())}),O(1,"\u8a66\u8074/\u505c\u6b62"),w()}2&t&&b("disabled",!M().$implicit.isReady)}function AJ(t,n){if(1&t){const e=Ue();_(0,"button",10),ue("click",function(){re(e);const r=M().$implicit;return oe(M().playBGM(r))}),O(1,"BGM/\u518d\u751f"),w()}2&t&&b("disabled",!M().$implicit.isReady)}function kJ(t,n){if(1&t){const e=Ue();_(0,"button",10),ue("click",function(){re(e);const r=M().$implicit;return oe(M().stopBGM(r))}),O(1,"BGM/\u505c\u6b62"),w()}2&t&&b("disabled",!M().$implicit.isReady)}function OJ(t,n){1&t&&(_(0,"span"),O(1,"\u3010\u8a66\u8074\u4e2d\u3011"),w())}function PJ(t,n){1&t&&(_(0,"span"),O(1,"\u3010BGM\u3011"),w())}function NJ(t,n){if(1&t&&(_(0,"div",8),J(1,MJ,2,1,"button",9)(2,IJ,2,1,"button",9)(3,AJ,2,1,"button",9)(4,kJ,2,1,"button",9)(5,OJ,2,0,"span",2)(6,PJ,2,0,"span",2),_(7,"span"),O(8),w()()),2&t){const e=n.$implicit,i=M();v(),b("ngIf",e!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),v(),b("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),v(),b("ngIf",e!==(null==i.jukebox?null:i.jukebox.audio)),v(),b("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),v(),b("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),v(),b("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),v(2),ht(e.name)}}function FJ(t,n){1&t&&(_(0,"div"),O(1,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),w())}let RJ=(()=>{class t{get volume(){return nt.volume}set volume(e){nt.volume=e}get auditionVolume(){return nt.auditionVolume}set auditionVolume(e){nt.auditionVolume=e}get audios(){return at.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return De.instance.get("Jukebox")}constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new nt,this.lazyUpdateTimer=null}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=Qm.AUDITION,Q.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){Q.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Us.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}static#e=this.\u0275fac=function(i){return new(i||t)(L(gr),L(yn),L(kt))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["app-jukebox"]],decls:29,vars:4,consts:[["type","range","min","0","max","1","step","0.01",3,"ngModelChange","ngModel"],["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px"],[1,"box"],[3,"disabled","click",4,"ngIf"],[3,"click","disabled"]],template:function(i,r){1&i&&(_(0,"div"),O(1,"\u8a66\u8074\u97f3\u91cf\uff1a"),_(2,"input",0),bt("ngModelChange",function(s){return pt(r.auditionVolume,s)||(r.auditionVolume=s),s}),w()(),_(3,"div"),O(4,"BGM\u97f3\u91cf\uff1a"),_(5,"input",0),bt("ngModelChange",function(s){return pt(r.volume,s)||(r.volume=s),s}),w()(),Ee(6,"hr"),_(7,"div"),J(8,NJ,9,7,"div",1)(9,FJ,2,0,"div",2),w(),_(10,"label")(11,"div",3)(12,"div")(13,"i",4),O(14,"playlist_add"),w()(),_(15,"div"),O(16,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),w(),_(17,"div",5),O(18,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),w(),_(19,"input",6),ue("change",function(s){return r.handleFileSelect(s)}),w(),_(20,"div",5),Ee(21,"br"),O(22,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),w()()(),_(23,"div",7),O(24,"\u203b\u300c\u8a66\u8074\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),w(),_(25,"div",7),O(26,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),w(),_(27,"div",7),O(28,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),w()),2&i&&(v(2),yt("ngModel",r.auditionVolume),v(3),yt("ngModel",r.volume),v(3),b("ngForOf",r.audios),v(),b("ngIf",r.audios.length<1))},dependencies:[ii,xn,hr,Pl,Ar,pr],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}']})}return t})();const LJ=["content"],BJ=["*"];let jJ=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}static#e=this.\u0275fac=function(i){return new(i||t)(L(gr))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["modal"]],viewQuery:function(i,r){if(1&i&&Qn(LJ,7,zr),2&i){let o;Jn(o=ei())&&(r.content=o.first)}},ngContentSelectors:BJ,decls:14,vars:3,consts:[["content",""],[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-text"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"]],template:function(i,r){if(1&i){const o=Ue();jv(),_(0,"div",1)(1,"div",2),ue("click",function(a){return re(o),oe(r.clickBackground(a))}),w(),_(2,"div",3)(3,"div",4)(4,"div",5),O(5),w(),_(6,"div",6)(7,"button",7),ue("click",function(){return re(o),oe(r.resolve())}),_(8,"i",8),O(9,"close"),w()()()(),_(10,"div",9),Uv(11),Ee(12,"div",null,0),w()()()}2&i&&(v(),b("@bgInOut","in"),v(),b("@flyInOut","in"),v(3),ht(r.modalService.title))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%;display:flex;flex-direction:column}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;width:100%;background-color:#ccc;color:#444;flex-shrink:0;display:flex}.title-text[_ngcontent-%COMP%]{align-self:center;flex-grow:1;padding:0 5px;text-overflow:ellipsis;overflow:hidden}.title-button[_ngcontent-%COMP%]{align-self:center;flex-shrink:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100% - 41px);width:100%;padding:8px;flex-grow:1}"],data:{animation:[xs("flyInOut",[Xi("void => *",[Yi("100ms ease-out",Xo([Tt({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),Tt({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),Xi("* => void",[Yi(100,Tt({transform:"scale(0, 0)"}))])]),xs("bgInOut",[fA("in",Tt({"background-color":"rgba(30, 30, 30, 0.4)"})),Xi("void => *",[Tt({"background-color":"rgba(30, 30, 30, 0.0)"}),Yi(200)]),Xi("* => void",[Yi(200,Tt({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}})}return t})();var BC=V(6609);const UJ=["passwordInput"],VJ=()=>({standalone:!0});let HJ=(()=>{class t{get peerId(){return Be.peerId}get isConnected(){return 0<Be.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeers=[],this.title="",this.targetPeers=i.option.peers??[],this.title=i.option.title?i.option.title:""}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9 \uff1c${this.title}\uff1e`),Q.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){Q.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeers.find(e=>e.verifyPassword(this.password))&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}static#e=this.\u0275fac=function(i){return new(i||t)(L(yn),L(gr))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["password-check"]],viewQuery:function(i,r){if(1&i&&Qn(UJ,7),2&i){let o;Jn(o=ei())&&(r.passwordInputElementRef=o.first)}},decls:12,vars:4,consts:[["passwordForm","ngForm"],["input","","passwordInput",""],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModelChange","input","ngModel","ngModelOptions"],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ue();_(0,"form",null,0)(2,"div"),O(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),_(4,"input",2,1),bt("ngModelChange",function(a){return re(o),pt(r.password,a)||(r.password=a),oe(a)}),ue("input",function(){re(o);const a=Lt(5);return oe(r.onInputChange(a.value))}),w()(),_(7,"button",3),ue("click",function(){return re(o),oe(r.submit())}),O(8,"\u5165\u5ba4"),w()(),_(9,"div")(10,"span",4),O(11),w()()}2&i&&(v(4),yt("ngModel",r.password),b("ngModelOptions",Dl(3,VJ)),v(7),ht(r.help))},dependencies:[lu,hr,Ar,ou,pr,La],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]})}return t})();function zJ(t,n){if(1&t&&(_(0,"div")(1,"div",9),O(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),w(),_(3,"div",9),O(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),w(),_(5,"div",9),O(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),w()()),2&t){M();const e=Lt(5);v(),b("hidden",!e.errors.required),v(2),b("hidden",!e.errors.minlength),v(2),b("hidden",!e.errors.maxlength)}}function GJ(t,n){if(1&t&&(_(0,"div")(1,"div",9),O(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),w()()),2&t){M();const e=Lt(10);v(),b("hidden",!e.errors.maxlength)}}function $J(t,n){1&t&&(_(0,"div"),O(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),w())}function WJ(t,n){if(1&t){const e=Ue();_(0,"div")(1,"div"),O(2,"\u30eb\u30fc\u30e0\u540d : "),_(3,"input",5,1),ue("input",function(){re(e);const r=Lt(4),o=M();return oe(o.calcPeerId(r.value,o.password))}),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.roomName,r)||(o.roomName=r),oe(r)}),w()(),_(6,"div"),O(7,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),_(8,"input",6,2),ue("input",function(){re(e);const r=Lt(4),o=M();return oe(o.calcPeerId(o.roomName,r.value))}),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.password,r)||(o.password=r),oe(r)}),w()(),Ee(11,"hr"),J(12,zJ,7,3,"div",7)(13,GJ,3,1,"div",7)(14,$J,2,0,"div",7),_(15,"div")(16,"button",8),ue("click",function(){return re(e),oe(M().createRoom())}),O(17,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),w()()()}if(2&t){const e=Lt(5),i=Lt(10),r=M();v(3),yt("ngModel",r.roomName),v(5),yt("ngModel",r.password),v(4),b("ngIf",e.errors&&(e.dirty||e.touched)),v(),b("ngIf",i.errors&&(i.dirty||i.touched)),v(),b("ngIf",!r.validateLength),v(2),b("disabled",!e.valid||!i.valid||!r.validateLength)}}function qJ(t,n){1&t&&(_(0,"span",4),O(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),Ee(2,"br"),O(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Ee(4,"br"),O(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),w())}let ZJ=(()=>{class t{get peerId(){return Be.peerId}get isConnected(){return 0<Be.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),Q.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){Q.unregister(this)}calcPeerId(e,i){let o=du.y.create(Be.peer.userId,du.y.generateId("***"),e,i);this.validateLength=o.peerId.length<64}createRoom(){Be.open(Be.peer.userId,du.y.generateId("***"),this.roomName,this.password),Bt.myCursor.peerId=Be.peerId,this.modalService.resolve(!0)}static#e=this.\u0275fac=function(i){return new(i||t)(L(yn),L(gr))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[["other_content",""],["input","","roomNameValidation","ngModel"],["input","","passwordValidation","ngModel"],[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"input","ngModelChange","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"input","ngModelChange","ngModel"],[4,"ngIf"],[3,"click","disabled"],[3,"hidden"]],template:function(i,r){if(1&i&&(J(0,WJ,18,6,"div",3),_(1,"div")(2,"span",4),O(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),w()(),J(4,qJ,6,0,"ng-template",null,0,ni)),2&i){const o=Lt(5);b("ngIf",!r.isConnected)("ngIfElse",o)}},dependencies:[xn,hr,Ar,Tm,sb,ab,pr],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]})}return t})();function YJ(t,n){1&t&&(_(0,"td")(1,"i",11),O(2,"lock"),w()())}function XJ(t,n){1&t&&(_(0,"td"),O(1,"-"),w())}function KJ(t,n){if(1&t){const e=Ue();_(0,"button",12),ue("click",function(){re(e);const r=M().$implicit;return oe(M(3).connect(r))}),O(1,"\u63a5\u7d9a"),w()}if(2&t){const e=M().$implicit,i=M(3);b("disabled",e.id===i.currentRoom)}}function QJ(t,n){if(1&t&&(Ae(0),_(1,"tr")(2,"td",9),O(3),w(),_(4,"td",7),O(5),w(),J(6,YJ,3,0,"td",4)(7,XJ,2,0,"td",4),_(8,"td"),O(9),w(),_(10,"td"),J(11,KJ,2,1,"button",10),w()(),ke()),2&t){const e=n.$implicit;v(3),ht(e.id),v(2),ht(e.name),v(),b("ngIf",e.hasPassword),v(),b("ngIf",!e.hasPassword),v(2),ki("",e.peers.length,"\u4eba"),v(2),b("ngIf",0<e.id.length)}}function JJ(t,n){if(1&t&&(Ae(0),_(1,"table",6)(2,"tr")(3,"th"),O(4,"\u30eb\u30fc\u30e0ID"),w(),_(5,"th",7),O(6,"\u30eb\u30fc\u30e0\u540d"),w(),_(7,"th"),O(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),w(),_(9,"th"),O(10,"\u53c2\u52a0\u8005"),w(),Ee(11,"th"),w(),J(12,QJ,12,6,"ng-container",8),w(),ke()),2&t){const e=M(2);v(12),b("ngForOf",e.rooms)}}function eee(t,n){if(1&t&&(_(0,"span",13),O(1),w()),2&t){const e=M(2);v(),ht(e.help)}}function tee(t,n){if(1&t){const e=Ue();_(0,"div")(1,"button",2),ue("click",function(){return re(e),oe(M().reload())}),O(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),w(),_(3,"button",3),ue("click",function(){return re(e),oe(M().showRoomSetting())}),O(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),w(),Ee(5,"hr"),J(6,JJ,13,1,"ng-container",4)(7,eee,2,1,"span",5),w()}if(2&t){const e=M();v(),b("disabled",e.isReloading),v(5),b("ngIf",e.rooms.length),v(),b("ngIf",e.rooms.length<1)}}function nee(t,n){1&t&&(_(0,"span",13),O(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Ee(2,"br"),O(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),w())}let iee=(()=>{class t{get currentRoom(){return Be.peer.roomId}get peerId(){return Be.peerId}get isConnected(){return 0<Be.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),Q.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",Be.peer.roomName.length&&(this.modalService.title=this.panelService.title="\uff1c"+Be.peer.roomName+"/"+Be.peer.roomId+"\uff1e")}ngOnDestroy(){Q.unregister(this)}reload(){var e=this;return(0,E.A)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=yield Be.listAllRooms(),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,E.A)(function*(){let r="";e.hasPassword&&(r=yield i.modalService.open(HJ,{peers:e.peers,title:`${e.name}/${e.id}`}),null==r&&(r=""));let o=e.filterByPassword(r);if(o.length<1)return;Be.open(Be.peer.userId,e.id,e.name,r),Bt.myCursor.peerId=Be.peerId;let a=[],l=()=>!(a.length<o.length||(i.resetNetwork(),Q.unregister(a),i.closeIfConnected(),0)),u=d=>(console.warn("\u63a5\u7d9a\u5931\u6557",d),a.push(d),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+o.length),l());Q.register(a).on("OPEN_NETWORK",d=>{console.log("LobbyComponent OPEN_PEER",d.data.peerId),Q.unregister(a),De.instance.clearDeleteHistory();for(let h of o)if(!Be.connect(h)&&u(h.peerId))return;Q.register(a).on("CONNECT_PEER",h=>(d=>(console.log("\u63a5\u7d9a\u6210\u529f\uff01",d),a.push(d),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+o.length),l()))(h.data.peerId)).on("DISCONNECT_PEER",h=>u(h.data.peerId))})})()}resetNetwork(){Be.peers.length<1&&(Be.open(),Bt.myCursor.peerId=Be.peerId)}closeIfConnected(){0<Be.peers.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,E.A)(function*(){(yield e.modalService.open(ZJ,{width:700,height:400,left:0,top:400}))&&e.modalService.resolve(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}static#e=this.\u0275fac=function(i){return new(i||t)(L(yn),L(gr))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[["other_content",""],[4,"ngIf","ngIfElse"],[3,"click","disabled"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"click","disabled"],[2,"font-size","12px"]],template:function(i,r){if(1&i&&J(0,tee,8,3,"div",1)(1,nee,4,0,"ng-template",null,0,ni),2&i){const o=Lt(2);b("ngIf",!r.isConnected)("ngIfElse",o)}},dependencies:[ii,xn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]})}return t})();function ree(t,n){if(1&t){const e=Ue();_(0,"div",8),Qt(1,"safe"),ue("click",function(){return re(e),oe(M(2).changeIcon())}),w()}2&t&&vn("background-image",Jt(1,2,"url("+M(2).myPeer.image.url+")","style"))}function oee(t,n){if(1&t){const e=Ue();_(0,"div")(1,"button",5),ue("click",function(){return re(e),oe(M().changeIcon())}),O(2,"\u30a2\u30a4\u30b3\u30f3\u3092\u5909\u66f4\u3059\u308b"),w(),J(3,ree,2,5,"div",6),_(4,"span"),O(5,"\u3042\u306a\u305f\u306e\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a "),_(6,"input",7),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.myPeer.name,r)||(o.myPeer.name=r),oe(r)}),w()()()}if(2&t){const e=M();v(3),b("ngIf",e.myPeer.image),v(3),yt("ngModel",e.myPeer.name)}}function see(t,n){if(1&t&&(_(0,"span",9),O(1),w()),2&t){const e=M();v(),ht(e.networkService.peer.userId)}}function aee(t,n){1&t&&(_(0,"span",9),O(1,"???"),w())}function lee(t,n){if(1&t&&(_(0,"span",9),O(1),w()),2&t){const e=M(2);v(),eu("",e.networkService.peer.roomName,"/",e.networkService.peer.roomId,"")}}function cee(t,n){if(1&t&&(_(0,"span",9),O(1),w()),2&t){const e=M(3);v(),ht(e.isPasswordVisible?e.networkService.peer.password:"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf")}}function uee(t,n){if(1&t){const e=Ue();_(0,"span"),J(1,cee,2,1,"span",1),_(2,"button",10),ue("click",function(){return re(e),oe(M(2).togglePasswordVisibility())}),_(3,"span",11),O(4),w()()()}if(2&t){const e=M(2);v(),b("ngIf",e.networkService.isOpen),v(3),ht(e.isPasswordVisible?"visibility":"visibility_off")}}function dee(t,n){if(1&t&&(Ae(0),Ee(1,"hr"),_(2,"div")(3,"span"),O(4,"\u30eb\u30fc\u30e0\u540d\uff1a"),J(5,lee,2,2,"span",1),w()(),_(6,"div")(7,"span"),O(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"),J(9,uee,5,2,"span",0),w()(),ke()),2&t){const e=M();v(5),b("ngIf",e.networkService.isOpen),v(4),b("ngIf",e.networkService.peer.hasPassword)}}function hee(t,n){1&t&&(_(0,"span"),O(1,"[\u63a5\u7d9a\u4e2d]"),w())}function fee(t,n){if(1&t&&(_(0,"div")(1,"div",12),J(2,hee,2,0,"span",0),_(3,"span"),O(4),w(),_(5,"div",13)(6,"span"),O(7),w()()()()),2&t){const e=n.$implicit,i=M();v(2),b("ngIf",!e.isOpen),v(2),eu("\u4ed6\u306e\u53c2\u52a0\u8005\uff1a",i.findUserId(e.peerId)," [",i.findPeerName(e.peerId),"]"),v(3),Hv("\u63a5\u7d9a\u72b6\u614b Grade:",i.stringFromSessionGrade(e.session.grade)," (",e.session.description,") Health:",(100*e.session.health).toFixed(0),"% Speed:",(100*e.session.speed).toFixed(0),"% Ping:",e.session.ping.toFixed(1),"ms")}}function pee(t,n){if(1&t){const e=Ue();Ae(0),_(1,"input",14),bt("ngModelChange",function(r){re(e);const o=M();return pt(o.targetUserId,r)||(o.targetUserId=r),oe(r)}),w(),_(2,"button",15),ue("click",function(){return re(e),oe(M().connectPeer())}),O(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),w(),Ee(4,"br"),ke()}if(2&t){const e=M();v(),yt("ngModel",e.targetUserId),v(),b("disabled",!e.networkService.isOpen)}}function mee(t,n){if(1&t){const e=Ue();_(0,"button",15),ue("click",function(){return re(e),oe(M().showLobby())}),O(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),w()}2&t&&b("disabled",!M().networkService.isOpen)}function gee(t,n){1&t&&(_(0,"div",4),O(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),w())}function _ee(t,n){1&t&&(_(0,"div",4),O(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),w())}function vee(t,n){if(1&t&&(Ae(0),J(1,gee,2,0,"div",16)(2,_ee,2,0,"div",16),ke()),2&t){const e=M();v(),b("ngIf",e.networkService.peers.length<1&&e.canUsePrivateSession),v(),b("ngIf",e.networkService.peers.length<1)}}function yee(t,n){1&t&&(Ae(0),_(1,"div",4),O(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),w(),ke())}let ZP=(()=>{class t{get myPeer(){return Bt.myCursor}get config(){return Gm.appConfig}get canUsePrivateSession(){return"skyway"==this.config.backend.mode}constructor(e,i,r,o){this.ngZone=e,this.modalService=i,this.panelService=r,this.appConfigService=o,this.targetUserId="",this.networkService=Be,this.gameRoomService=De.instance,this.help="",this.isPasswordVisible=!1}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u63a5\u7d9a\u60c5\u5831")}ngAfterViewInit(){Q.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{})}),this.interval=setInterval(()=>{},1e3)}ngOnDestroy(){Q.unregister(this),clearInterval(this.interval)}changeIcon(){this.modalService.open(Ng).then(e=>{!this.myPeer||!e||(this.myPeer.imageIdentifier=e)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;this.help="";let i=du.y.create(e);i.isRoom||(De.instance.clearDeleteHistory(),Be.connect(i))}showLobby(){this.modalService.open(iee,{width:700,height:400,left:0,top:400})}togglePasswordVisibility(){this.isPasswordVisible=!this.isPasswordVisible}stringFromSessionGrade(e){return BC.s[e]??BC.s[BC.s.UNSPECIFIED]}findUserId(e){const i=Bt.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=Bt.findByPeerId(e);return i?i.name:""}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(gr),L(yn),L(Gm))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["peer-menu"]],decls:17,vars:10,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],[2,"font-size","12px"],[3,"click"],["class","image cover",3,"background-image","click",4,"ngIf"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",3,"ngModelChange","ngModel"],[1,"image","cover",3,"click"],[2,"font-weight","bold"],[2,"padding","2px","margin-left","1.0em","font-size","1.0em",3,"click"],[1,"material-icons",2,"font-size","1.0em","vertical-align","text-bottom"],[1,"peer-info"],[1,"session-info"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModelChange","ngModel"],[3,"click","disabled"],["style","font-size: 12px;",4,"ngIf"]],template:function(i,r){1&i&&(J(0,oee,7,2,"div",0),_(1,"div")(2,"span"),O(3,"\u3042\u306a\u305f\u306eID\uff1a"),J(4,see,2,1,"span",1)(5,aee,2,0,"span",1),w()(),J(6,dee,10,2,"ng-container",0),Ee(7,"hr"),J(8,fee,8,8,"div",2),_(9,"div"),J(10,pee,5,2,"ng-container",0)(11,mee,2,1,"button",3),w(),_(12,"div")(13,"span",4),O(14),w()(),J(15,vee,3,2,"ng-container",0)(16,yee,3,0,"ng-container",0)),2&i&&(b("ngIf",r.myPeer),v(4),b("ngIf",r.networkService.isOpen),v(),b("ngIf",!r.networkService.isOpen),v(),b("ngIf",r.networkService.peer.isRoom),v(2),b("ngForOf",r.networkService.peers),v(2),b("ngIf",!r.networkService.peer.isRoom&&r.canUsePrivateSession),v(),b("ngIf",r.networkService.peers.length<1),v(3),ht(r.help),v(),b("ngIf",!r.networkService.peer.isRoom),v(),b("ngIf",r.networkService.peer.isRoom&&r.canUsePrivateSession))},dependencies:[ii,xn,hr,Ar,pr,Ei],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:128px;height:128px;display:table-cell;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.peer-info[_ngcontent-%COMP%]{position:relative}.session-info[_ngcontent-%COMP%]{visibility:hidden;pointer-events:none;position:absolute;top:-110%;padding:.2rem .4rem;font-size:12px;color:#444;background:linear-gradient(-30deg,#f0dabd,#fff4e8);border:solid 1px #999;border-left:solid 4px #555}.peer-info[_ngcontent-%COMP%]:hover   .session-info[_ngcontent-%COMP%]{visibility:visible}"]})}return t})();const Zh=-9999;class el{get startPointer(){return this.firstPointer}get pointer(){return this.primaryPointer}get magnitude(){return mn.sqrMagnitude(this.firstPointer,this.primaryPointer)}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isPointerMoved(){return this._isPointerMoved}get isDestroyed(){return this._isDestroyed}constructor(...n){this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.startTime=-1e3,this.clearLastPointerTimer=new ha.b(this.clearLastPointer.bind(this),2e3,!1),this.firstPointer={x:0,y:0,z:0,identifier:Zh},this.lastStartPointers=[],this.lastMovePointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:Zh},this._isDragging=!1,this._isGrabbing=!1,this._isPointerMoved=!1,this._isDestroyed=!1;let e=n[0],i={capture:!1,passive:!1,always:!1},r=!0;switch(n.length){case 3:i=n[1],r=n[2];break;case 2:"boolean"==typeof n[1]?r=n[1]:i=n[1]}this.target=e,this.option={capture:!0===i.capture,passive:!0===i.passive,always:!0===i.always},r&&this.initialize()}initialize(){let n={capture:this.option.capture,passive:this.option.passive};this.target.addEventListener("mousedown",this.callbackOnMouse,n),this.target.addEventListener("touchstart",this.callbackOnTouch,n),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this.clearLastPointerTimer.clear(),this._isDestroyed=!0;let n={capture:this.option.capture};this.target.removeEventListener("mousedown",this.callbackOnMouse,n),this.target.removeEventListener("touchstart",this.callbackOnTouch,n),this.removeEventListeners(),this.onStart=null,this.onMove=null,this.onEnd=null,this.onContextMenu=null}cancel(){this._isDragging=this._isGrabbing=!1,this.clearLastPointerTimer.reset(),this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:Zh};this.isSyntheticEvent(n)?this.updateLastPointer(n):(this.updateLastPointer(n),this.primaryPointer=e,this.onPointer(n))}onTouch(n){if(!(n.changedTouches.length<1)){if(this.updateLastPointer(n),"touchstart"===n.type)this.primaryPointer=this.lastStartPointers[0];else{let r=Array.from(n.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this.onTap&&(this.startTime=performance.now()),this.clearLastPointerTimer.stop(),this.firstPointer=this.primaryPointer,this._isGrabbing=!0,this._isDragging=!1,this._isPointerMoved=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing,this._isPointerMoved=this._isPointerMoved||(n instanceof MouseEvent?3:12)**2<mn.sqrMagnitude(this.firstPointer,this.primaryPointer);break;default:this.onEnd&&this.onEnd(n),this.onTap&&performance.now()-this.startTime<250&&!this._isPointerMoved&&this.onTap(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){let i={x:n.pageX,y:n.pageY,z:0,identifier:Zh},r=this.lastMovePointers;"mousemove"!==n.type&&(r=r.concat(this.lastStartPointers));for(let o of r)if(o.identifier!==i.identifier&&mn.sqrMagnitude(i,o)<e**2)return!0;return!1}updateLastPointer(n){let e=[];if(n instanceof MouseEvent)e.push({x:n.pageX,y:n.pageY,z:0,identifier:Zh});else{let i=n.touches.length;for(let r=0;r<i;r++){let o=n.touches[r];e.push({x:o.pageX,y:o.pageY,z:0,identifier:o.identifier})}}this.lastMovePointers=e,("mousedown"===n.type||"touchstart"===n.type)&&(this.lastStartPointers=e)}clearLastPointer(){this.clearLastPointerTimer.stop(),this.lastStartPointers=[],this.lastMovePointers=[]}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let YP=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.onstart=new Gt,this.onmove=new Gt,this.onend=new Gt,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new el(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():(this.removeSelectionRanges(),this.removeFocus(),e.cancelable&&e.preventDefault(),e.stopPropagation())}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<mn.sqrMagnitude(i)&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>mn.sqrMagnitude(this.input.pointer,this.startPointer))return;let r=o=>{o.cancelable&&o.preventDefault(),o.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",r,!0),setTimeout(()=>this.elementRef.nativeElement.removeEventListener("click",r,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y)),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:hi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:hi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(ti))};static#t=this.\u0275dir=vt({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:[Rt.None,"draggable.disable","isDisable"],boundsSelector:[Rt.None,"draggable.bounds","boundsSelector"],handleSelector:[Rt.None,"draggable.handle","handleSelector"],unhandleSelector:[Rt.None,"draggable.unhandle","unhandleSelector"],stackSelector:[Rt.None,"draggable.stack","stackSelector"],opacity:[Rt.None,"draggable.opacity","opacity"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}})}return t})();var Tn=function(t){return t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw",t}(Tn||{});class bee{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new el(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case Tn.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`,n.cursor="ns-resize";break;case Tn.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`,n.cursor="ew-resize";break;case Tn.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`,n.cursor="ew-resize";break;case Tn.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`,n.cursor="ns-resize";break;case Tn.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nesw-resize",n.zIndex="2";break;case Tn.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nwse-resize",n.zIndex="2";break;case Tn.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nwse-resize",n.zIndex="2";break;case Tn.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nesw-resize",n.zIndex="2"}}destroy(){this.handle.remove(),this.input.destroy()}}let Cee=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Gt,this.onmove=new Gt,this.onend=new Gt,this.handleMap=new Map,this.handleTypes=[Tn.N,Tn.E,Tn.W,Tn.S,Tn.NE,Tn.NW,Tn.SE,Tn.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleTypes.forEach(e=>{let i=new bee(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.input.destroy())}onResizeStart(e,i){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},this.removeSelectionRanges(),this.removeFocus(),e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case Tn.N:case Tn.S:r.width=0;break;case Tn.E:case Tn.W:r.height=0}switch(i.type){case Tn.SW:r.left=r.width,r.width*=-1;break;case Tn.NE:r.top=r.height,r.height*=-1;break;case Tn.E:case Tn.S:case Tn.SE:break;case Tn.N:case Tn.W:case Tn.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:hi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:hi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:hi.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:hi.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(ti))};static#t=this.\u0275dir=vt({type:t,selectors:[["","appResizable",""]],inputs:{isDisable:[Rt.None,"resizable.disable","isDisable"],boundsSelector:[Rt.None,"resizable.bounds","boundsSelector"],stackSelector:[Rt.None,"resizable.stack","stackSelector"],minWidth:[Rt.None,"resizable.minWidth","minWidth"],minHeight:[Rt.None,"resizable.minHeight","minHeight"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}})}return t})();const wee=["draggablePanel"],Eee=["scrollablePanel"],xee=["content"],Tee=["*"],Dee=t=>({"pointer-events-none":t});function See(t,n){if(1&t){const e=Ue();_(0,"div",8)(1,"button",9),ue("click",function(){return re(e),oe(M().toggleFullScreen())}),_(2,"i",10),O(3,"fullscreen"),w()(),_(4,"button",9),ue("click",function(){return re(e),oe(M().close())}),_(5,"i",10),O(6,"close"),w()()()}}let XP=(()=>{class t{set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.isFullScreen=!1}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleFullScreen(){let e=this.draggablePanel.nativeElement;this.isFullScreen=!(e.offsetLeft<=0&&e.offsetTop<=0&&e.offsetWidth>=window.innerWidth&&e.offsetHeight>=window.innerHeight),this.isFullScreen?(this.preLeft=e.offsetLeft,this.preTop=e.offsetTop,this.preWidth=e.offsetWidth,this.preHeight=e.offsetHeight,this.left=0,this.top=0,this.width=window.innerWidth,this.height=window.innerHeight,e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.width=this.width+"px",e.style.height=this.height+"px"):(this.left=this.preLeft,this.top=this.preTop,this.width=this.preWidth,this.height=this.preHeight)}close(){this.panelService&&this.panelService.close()}static#e=this.\u0275fac=function(i){return new(i||t)(L(yn),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["ui-panel"]],viewQuery:function(i,r){if(1&i&&(Qn(wee,7),Qn(Eee,7),Qn(xee,7,zr)),2&i){let o;Jn(o=ei())&&(r.draggablePanel=o.first),Jn(o=ei())&&(r.scrollablePanel=o.first),Jn(o=ei())&&(r.content=o.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",showTitleButtons:"showTitleButtons"},features:[jn([yn])],ngContentSelectors:Tee,decls:11,vars:16,consts:[["draggablePanel",""],["scrollablePanel",""],["content",""],["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","draggable.stack","resizable.stack"],[1,"title"],[1,"title-text"],["class","title-button",4,"ngIf"],[1,"scrollable-panel"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"]],template:function(i,r){1&i&&(jv(),_(0,"div",3,0)(2,"div",4)(3,"div",5),O(4),w(),J(5,See,7,0,"div",6),w(),_(6,"div",7,1),Uv(8),Ee(9,"div",null,2),w()()),2&i&&(vn("left",r.left,"px")("top",r.top,"px")("width",r.width,"px")("height",r.height,"px"),b("@flyInOut","in")("ngClass",lt(14,Dee,r.isPointerDragging))("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),v(4),ht(r.panelService.title),v(),b("ngIf",r.showTitleButtons))},dependencies:[Pi,xn,YP,Cee],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;user-select:none;display:flex}.title-text[_ngcontent-%COMP%]{align-self:center;flex-grow:1;padding:0 5px;text-overflow:ellipsis;overflow:hidden}.title-button[_ngcontent-%COMP%]{align-self:center;flex-shrink:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"],data:{animation:[xs("flyInOut",[Xi("void => *",[Yi("100ms ease-out",Xo([Tt({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),Tt({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),Xi("* => void",[Yi(100,Tt({transform:"scale(0, 0)"}))])])]}})}return t})();class Mee{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=Gl.SQUARE,o="#000000e6"){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let s=this.canvasElement.getContext("2d");if(r<0)return;let a=this.generateCalcGridPositionFunc(r);this.makeBrush(s,i,o);for(let l=0;l<=e;l++)for(let c=0;c<=n;c++){let{gx:u,gy:d}=a(c,l,i);this.strokeSquare(s,u,d,i),s.fillText((c+1).toString()+"-"+(l+1).toString(),u+i/2,d+i/2)}}generateCalcGridPositionFunc(n){switch(n){case Gl.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case Gl.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===Gl.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),l=e+r/2,c=i+r/2;n.beginPath();for(let u=0;u<6;u++){s+=60;let d=mn.radians(s),h=Math.cos(d)*a+l,f=Math.sin(d)*a+c;n.lineTo(h,f)}n.closePath(),n.stroke()}}var Yh=function(t){return t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard",t}(Yh||{}),Gs=function(t){return t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t}(Gs||{});class Iee{get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}initialize(){this.input=new el(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,c=0,d=0,h=Yh.DRAG;2===this.buttonCode?(h=Yh.ROTATE,d=-r/5,c=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,c,0,d,h,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Yh.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,o=0,a=0,l=this.getKeyName(n);switch(l){case Gs.ArrowLeft:n.shiftKey?a=-2:e=10;break;case Gs.ArrowUp:n.shiftKey?o=-2:n.ctrlKey?r=150:i=10;break;case Gs.ArrowRight:n.shiftKey?a=2:e=-10;break;case Gs.ArrowDown:n.shiftKey?o=2:n.ctrlKey?r=-150:i=-10}null!=Gs[l]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Yh.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return Gs.ArrowLeft;case 38:return Gs.ArrowUp;case 39:return Gs.ArrowRight;case 40:return Gs.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}class Aee{get isActive(){return this.pointerDevice.isTablePickGesture}set isActive(n){this.pointerDevice.isTablePickGesture=n}constructor(n,e,i,r,o,s){this.targetElement=n,this.gameObjectsElement=e,this.pointerDevice=o,this.selection=s,this.pickCursorScale=1,this.input=null,this.activateTimer=null,this.keydownTimer=null,this.tappedTimer=null,this.tappedPointer={x:0,y:0,z:0},this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.callbackOnKeydown=a=>this.onKeydown(a),this.onstart=null,this.onend=null,this.oncancelifneeded=null,this.onpick=null,this.pickCursor=new kee(i),this.pickArea=new Oee(r),this.initialize()}initialize(){this.input=new el(this.targetElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onTap=this.onInputTap.bind(this)}cancel(){this.input.cancel(),this.clearActivateTimer(),this.pickCursor.deactive(),this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isActive=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.clearKeyDownTimer(),this.clearTappedTimer()}destroy(){this.cancel(),this.input.destroy(),this.clearKeyDownTimer(),this.clearTappedTimer()}onInputStart(n){if(this.target=null,this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.clearActivateTimer(),this.pickCursor.update(this.input.pointer),!(n instanceof MouseEvent&&0===n.button||n.touches))return this.cancel();this.isStrokeMode=n instanceof MouseEvent&&0===n.button&&n.ctrlKey;let i=n instanceof MouseEvent&&0===n.button&&n.shiftKey;this.isStrokeMode||i?this.startQuickCursor(n):this.startLongPressCursor(n)}onInputMove(n){let e=1<n.touches?.length,i=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||i<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,null==this.keydownTimer&&((e||null!=this.target&&this.isObjectDragging&&this.isPointerMoved&&!this.isMagneticMode||null!=this.activateTimer&&this.isPointerMoved)&&this.cancel(),this.isActive&&(null==this.oncancelifneeded||!this.oncancelifneeded())&&(this.pickCursor.update(this.input.pointer),this.pickCursor.scale(0),this.isPickObjectMode&&n instanceof MouseEvent&&n.ctrlKey?this.pickObject(n):this.isPointerMoved&&this.isPickRegionMode&&this.pickRegion(n),this.onpick&&this.onpick()))}onInputEnd(n){let e=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||e<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,this.onend&&this.onend(),this.cancel()}onInputTap(n){this.setTappedTimer(),this.tappedPointer=this.input.pointer}onKeydown(n){if(!this.isActive||this.input.isGrabbing)switch(n.key){case"Control":this.isStrokeMode=!0;case"Shift":this.clearActivateTimer(),this.clearKeyDownTimer(),this.target=null,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.isActive=!0,this.pickCursor.update(this.input.pointer),this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(.6),requestAnimationFrame(()=>this.pickCursor.scale(0)),this.pointerDevice.isDragging=!1,this.pickStart()}}startQuickCursor(n){this.isActive=!0,this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(1),requestAnimationFrame(()=>this.pickCursor.scale(.6)),this.isMagneticMode=!1,this.isPickObjectMode=this.isStrokeMode,this.isPickRegionMode=!this.isStrokeMode,this.pointerDevice.isDragging=!1,this.pickStart(),this.isPickObjectMode&&(this.selection.excludeElement=null,this.pickObject(n))}startLongPressCursor(n){let e=n.target;e.contains(this.gameObjectsElement)||(this.target=e),this.isMagneticMode=null!=this.target&&this.pointerDevice.isDragging&&null!=this.tappedTimer&&mn.sqrMagnitude(this.tappedPointer,this.input.pointer)<625,this.isPickObjectMode=null!=this.target&&this.pointerDevice.isDragging&&!this.isMagneticMode,this.isPickRegionMode=null==this.target||!this.isPickObjectMode&&!this.isMagneticMode,!this.isPickObjectMode&&(this.setActivateTimer(),this.setKeyDownTimer(),this.pickCursorScale=n.touches?4.5:1,this.pickCursor.active(),this.pickCursor.scale(this.pickCursorScale),this.isMagneticMode&&this.pickCursor.color(jC.MAGNETIC,jC.MAGNETIC_FILL))}pickStart(){let n=new CustomEvent("pickstart",{detail:{isMagnetic:this.isMagneticMode,isPickRegion:this.isPickRegionMode,isPickObject:this.isPickObjectMode},bubbles:!0});this.target?this.target.dispatchEvent(n):document.dispatchEvent(n),this.onstart&&this.onstart()}pickObject(n){let e=n.target;if(e.contains(this.gameObjectsElement))this.selection.excludeElement=document.body;else{this.isKeepSelection=!0;let i=new CustomEvent("pickobject",{detail:{srcEvent:n,first:this.input.startPointer,last:this.input.pointer},bubbles:!0});e.dispatchEvent(i)}}pickRegion(n){let e=this.input.startPointer,i=this.input.pointer,r=Math.min(e.x,i.x),o=Math.min(e.y,i.y),s=Math.abs(e.x-i.x),a=Math.abs(e.y-i.y);this.pickArea.update(r,o,s,a),this.selection.clear();let l=new CustomEvent("pickregion",{detail:{srcEvent:n,x:r,y:o,width:s,height:a},bubbles:!0});document.dispatchEvent(l)}setActivateTimer(){this.clearActivateTimer(),this.activateTimer=setTimeout(()=>{this.activateTimer=null,this.pickCursor.scale(.6*this.pickCursorScale),this.isActive=!0,this.isKeepSelection=this.isPickObjectMode||this.isMagneticMode,this.pickStart()},850)}clearActivateTimer(){this.isActive=!1,null!=this.activateTimer&&(clearTimeout(this.activateTimer),this.activateTimer=null),this.pickArea.deactive()}setKeyDownTimer(){this.clearKeyDownTimer(),this.keydownTimer=setTimeout(()=>{this.keydownTimer=null},66),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}clearKeyDownTimer(){null!=this.keydownTimer&&(clearTimeout(this.keydownTimer),this.keydownTimer=null),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}setTappedTimer(){this.clearTappedTimer(),this.tappedTimer=setTimeout(()=>{this.tappedTimer=null},300)}clearTappedTimer(){null!=this.tappedTimer&&(clearTimeout(this.tappedTimer),this.tappedTimer=null)}}var jC=function(t){return t.SELECTED="hsl(200, 100%, 50%)",t.MAGNETIC="hsl(45, 100%, 50%)",t.SELECTED_FILL="hsla(200, 100%, 95%, .7)",t.MAGNETIC_FILL="hsla(45, 100%, 95%, .7)",t}(jC||{});class kee{constructor(n){this.targetElement=n,this.width=0,this.height=0,this.circleElement=this.targetElement.querySelector("circle"),this.active();let e=this.targetElement.getBoundingClientRect();this.width=e.width,this.height=e.height,this.deactive()}active(){this.deactive(),this.targetElement.style.display="block"}deactive(){this.targetElement.style.display=null,this.targetElement.style.stroke=null,this.targetElement.style.scale=null,this.circleElement.style.animation=null,this.circleElement.style.fill=null}scale(n){this.targetElement.style.scale=n+""}color(n,e){this.targetElement.style.stroke=n,this.circleElement.style.fill=e}disableAnimation(){this.circleElement.style.animation="none"}update(n){this.targetElement.style.left=n.x-this.width/2+"px",this.targetElement.style.top=n.y-this.height/2+"px"}}class Oee{constructor(n){this.targetElement=n}update(n,e,i,r){this.targetElement.style.left=n+"px",this.targetElement.style.top=e+"px",this.targetElement.style.width=i+"px",this.targetElement.style.height=r+"px",this.targetElement.style.display="block"}deactive(){this.targetElement.style.width="0px",this.targetElement.style.height="0px",this.targetElement.style.display=null}}var Nu=function(t){return t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate",t}(Nu||{});class Pee{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([n,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",l=>{let c=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:l.center.x,clientY:l.center.y});this.ngZone.run(()=>l.srcEvent.target.dispatchEvent(c))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<mn.sqrMagnitude(this.tappedPanCenter,n.center)&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer)this.ontransform&&this.ontransform(this.deltaHammerDeltaX,this.deltaHammerDeltaY,0,0,0,0,Nu.PAN,n.srcEvent);else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,Nu.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,Nu.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,Nu.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,Nu.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}let UC=(()=>{class t{constructor(){}createGameCharacter(e){let i=Vn.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=Ps.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=Dt.instance.get(i);r||(r=Dt.instance.add(i));let o=this.getViewTable();if(!o)return;let s=Ao.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=Ns.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=Os.create(i,r,1),a=null;return s.faces.forEach(l=>{let c=`./assets/images/dice/${o}/${o}[${l}].png`;a=Dt.instance.get(c),a||(a=Dt.instance.add(c)),s.imageDataElement.getFirstElementByName(l).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createTrump(e){let i=ji.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";Dt.instance.get(r)||Dt.instance.add(r);let o=["c","d","h","s"],s=[];for(let a of o)for(let l=1;l<=13;l++)s.push(a+("00"+l).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let l="./assets/images/trump/"+a+".gif";Dt.instance.get(l)||Dt.instance.add(l);let c=Yr.create("\u30ab\u30fc\u30c9",l,r);i.putOnBottom(c)}return i}makeDefaultTable(){let e=new Fi("gameTable"),i=null,r=pn.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=Dt.instance.add(r),e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),_a.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new Vn("testCharacter_1"),r=pn.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=Dt.instance.add(r),e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new Vn("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new Vn("testCharacter_3"),r=pn.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=Dt.instance.add(r),e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new Vn("testCharacter_4"),r=pn.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=Dt.instance.add(r),e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new Vn("testCharacter_5"),r=pn.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=Dt.instance.add(r),e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new Vn("testCharacter_6"),r=pn.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=Dt.instance.add(r),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),xe.play(pe.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),xe.play(pe.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),xe.play(pe.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),xe.play(pe.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),xe.play(pe.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"D4",diceName:"D4",type:_r.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:_r.D6,imagePathPrefix:"6_dice"},{menuName:"D8",diceName:"D8",type:_r.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:_r.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:_r.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:_r.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:_r.D20,imagePathPrefix:"20_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),xe.play(pe.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return _a.instance.viewTable}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class tr{static#e=this.layerMap=new Map;get tabletopObject(){return this._tabletopObject}get layerName(){return this._layerName}get colideLayers(){return this._colideLayers}get transformCssOffset(){return this._transformCssOffset}set option(n){this.unregister(),this.synchronizer.unregister(),this._tabletopObject=n.tabletopObject??null,this._layerName=n.layerName??"",this._colideLayers=n.colideLayers??[],this._transformCssOffset=n.transformCssOffset??"",this._layerName.length<1&&this._tabletopObject&&(this._layerName=this._tabletopObject.aliasName),this.register(),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(n){this._posX=n,this.setUpdateBatching()}get posY(){return this._posY}set posY(n){this._posY=n,this.setUpdateBatching()}get posZ(){return this._posZ}set posZ(n){this._posZ=n,this.setUpdateBatching()}get magnitude(){return this.input.magnitude}get isPointerMoved(){return this.input.isPointerMoved}get state(){return this.selectionService.state(this.tabletopObject)}set state(n){this.selectionService.add(this.tabletopObject,n)}get isGridSnap(){return _a.instance.gridSnap}constructor(n,e,i,r,o,s){this.ngZone=n,this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.selectionService=s,this._layerName="",this._colideLayers=[],this._transformCssOffset="",this.isDisable=!1,this.onstart=new Gt,this.ondragstart=new Gt,this.ondrag=new Gt,this.ondragend=new Gt,this.onend=new Gt,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=-1,this.width=-1,this.ratio=1,this.isUpdateBatching=!1,this.collidableElements=[],this.input=new el(this.nativeElement,!1),this.synchronizer=new ba(this,this.selectionService,this.pointerDeviceService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,n=>{n.isSendFromSelf&&(this.input.isGrabbing||this.state!==Nt.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.state=Nt.NONE,this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.isDisable&&this.state!==Nt.NONE&&(this.state=Nt.NONE),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.input.isGrabbing&&this.cancel(),this.unregister(),this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.findCollidableElements()}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1)}dispose(){Q.unregister(this),this.batchService.remove(this)}onInputStart(n){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||n instanceof MouseEvent&&(0!==n.button||n.ctrlKey||n.shiftKey))return void this.cancel();this.onstart.emit(n),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(!0),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let e={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},i=this.coordinateService.convertToGlobal(e,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=i.x-this.input.pointer.x,this.pointerOffset2d.y=i.y-this.input.pointer.y,this.pointerOffset2d.z=i.z-this.input.pointer.z,this.pointerStart3d.x=e.x,this.pointerStart3d.y=e.y,this.pointerStart3d.z=e.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1,this.synchronizer.prepareMove()}onInputMove(n){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();n.cancelable&&n.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let e={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};e.x=Math.min(window.innerWidth-.1,Math.max(e.x,.1)),e.y=Math.min(window.innerHeight-.1,Math.max(e.y,.1));let i=document.elementFromPoint(e.x,e.y);if(null==i)return;let r=this.coordinateService.calcTabletopLocalCoordinate(e,i);if(r.x-=this.width/2,r.y-=this.height/2,this.posX===r.x&&this.posY===r.y&&this.posZ===r.z)return;this.input.isDragging||this.ondragstart.emit(n),this.ondrag.emit(n);let s=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;s<this.ratio&&(this.ratio+=.1*(s-this.ratio));let a={x:r.x-this.posX,y:r.y-this.posY,z:r.z-this.posZ};this.posX=r.x,this.posY=r.y,this.posZ=r.z,this.synchronizer.updateMove(a)}onInputEnd(n){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(n);let e_x=this.posX,e_y=this.posY,e_z=this.posZ;this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.synchronizer.finishMove({x:this.posX-e_x,y:this.posY-e_y,z:this.posZ-e_z}),this.cancel(),this.onend.emit(n)}onContextMenu(n){if(this.isDisable)return this.cancel();n.cancelable&&n.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let e=this.input.isGrabbing&&n.isTrusted;if(this.cancel(),e){n.stopPropagation();let i=new MouseEvent(n.type,n);this.ngZone.run(()=>this.nativeElement.dispatchEvent(i))}}callSelectedEvent(){this.tabletopObject&&Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(n=25){this.posX=this.calcSnapNum(this.posX,n),this.posY=this.calcSnapNum(this.posY,n)}calcSnapNum(n,e){return e<=0?n:(n=n<0?n-e/2:n+e/2)-n%e}setPosition(n){this._posX=n.location.x,this._posY=n.location.y,this._posZ=n.posZ,this.updateTransformCss()}setUpdateBatching(){!this.isUpdateBatching&&this.tabletopObject&&(this.isUpdateBatching=!0,this.batchService.add(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.isUpdateBatching=!1})),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(n){let e=n.children;for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&"none"!==getComputedStyle(r).pointerEvents&&this.collidableElements.push(r)}if(this.collidableElements.length<1)for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&this.findNestedCollidableElements(r)}}setPointerEvents(n){let e=n?"auto":"none";this.collidableElements.forEach(i=>i.style.pointerEvents=e)}setAnimatedTransition(n){this.nativeElement.style.transition=n?"transform 132ms linear":""}shouldTransition(n){return n.location.x!==this.posX||n.location.y!==this.posY||n.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let n=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=n}setCollidableLayer(n){let e=n;for(let i of tr.layerMap.keys())e=this.colideLayers.includes(i)?!this.input.isGrabbing||n:!n,tr.layerMap.get(i).forEach(r=>{r===this||r.input?.isGrabbing||r.setPointerEvents(e)})}register(){let n=tr.layerMap.get(this.layerName)??new Set;n.add(this),tr.layerMap.set(this.layerName,n)}unregister(){let n=tr.layerMap.get(this.layerName);n&&(n.delete(this),n.size<1&&tr.layerMap.delete(this.layerName))}static#t=this.\u0275fac=function(e){return new(e||tr)(L(kt),L(ti),L(Pg),L(Ci),L(ql),L($s))};static#n=this.\u0275dir=vt({type:tr,selectors:[["","appMovable",""]],inputs:{option:[Rt.None,"movable.option","option"],isDisable:[Rt.None,"movable.disable","isDisable"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"},features:[Kn]})}class ba{static#e=this.objectMap=new Map;get selectedMovables(){let n=new Set;for(let e of this.selection.objects)ba.objectMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e,i){this.movable=n,this.selection=e,this.pointerDevice=i,this.callbackOnPickStart=this.onPickStart.bind(this),this.callbackOnPickObject=this.onPickObject.bind(this),this.callbackOnPickRegion=this.onPickRegion.bind(this),this._isDestroyed=!1}initialize(){this.register(),this.addEventListeners()}destroy(){this.unregister(),this._isDestroyed=!0,this.removeEventListeners(),this.movable=null}onPickStart(n){null==this.movable.tabletopObject||this.movable.isDisable||(this.movable.state=n.detail.isMagnetic?Nt.MAGNETIC:Nt.SELECTED,this.prepareMove())}onPickObject(n){this.selection.excludeElement!==this.movable.nativeElement&&(this.pointerDevice.isDragging||this.movable.isDisable||(null==this.selection.excludeElement?(this.toggleState(),this.selection.excludeElement=this.movable.nativeElement):this.movable.state=Nt.SELECTED))}onPickRegion(n){if(this.pointerDevice.isDragging||this.movable.isDisable)return;let e=n.detail.x,i=n.detail.y,r=n.detail.width,o=n.detail.height,s=this.movable.nativeElement.getBoundingClientRect();s.x<=e+r&&e<=s.x+s.width&&s.y<=i+o&&i<=s.y+s.height&&(this.movable.state=Nt.SELECTED)}toggleState(){this.movable.state=this.movable.state===Nt.SELECTED?Nt.NONE:Nt.SELECTED}prepareMove(){if(this.shouldSynchronize())for(let n of this.selectedMovables)n!==this.movable&&(n.isDisable?n.state=Nt.NONE:(n.state=Nt.SELECTED,n.setPointerEvents(!1),n.setAnimatedTransition(!1)))}updateMove(n){if(this.shouldSynchronize()){if(this.movable.state===Nt.MAGNETIC){let e=tr.layerMap.get(this.movable.layerName);if(e)for(let i of e)i!==this.movable&&!i.isDisable&&i.state===Nt.NONE&&(i.width<0&&(i.width=i.nativeElement.clientWidth),i.height<0&&(i.height=i.nativeElement.clientHeight),this.isProximity(i)&&(i.state=Nt.MAGNETIC,i.setPointerEvents(!1),i.setAnimatedTransition(!1)))}for(let e of this.selectedMovables)e!==this.movable&&(e.posX+=n.x,e.posY+=n.y,e.posZ+=n.z,e.state===Nt.MAGNETIC&&(e.posX=.02*(this.movable.posX+(this.movable.width-e.width)/2)+.98*e.posX,e.posY=.02*(this.movable.posY+(this.movable.height-e.height)/2)+.98*e.posY,e.posZ=.02*this.movable.posZ+.98*e.posZ),e.posZ<0&&(e.posZ=0))}else this.movable.isPointerMoved&&this.selection.clear()}finishMove(n){if(!this.shouldSynchronize())return void this.selection.clear();for(let a of this.selectedMovables)a!==this.movable&&(a.posX+=n.x,a.posY+=n.y,a.posZ+=n.z);let e=Array.from(this.selectedMovables).sort((a,l)=>{let c=a.tabletopObject.zindex,u=l.tabletopObject.zindex;return null==c||null==u?0:c-u}).filter(a=>a.state===Nt.MAGNETIC&&a!==this.movable),i=360/e.length,r=360*Math.random(),o=Math.min(Math.max((this.movable.width+this.movable.height)/2,50),75),s_x=this.movable.posX+this.movable.width/2,s_y=this.movable.posY+this.movable.height/2;for(let a of e){if(a===this.movable)continue;r+=i;let l=mn.radians(r);a.posX=s_x+o*Math.sin(l)-a.width/2,a.posY=s_y+o*Math.cos(l)-a.height/2}this.movable.state===Nt.MAGNETIC&&this.selection.size<=1?this.selection.clear():this.refreshState()}shouldSynchronize(){return this.movable.state!==Nt.NONE}refreshState(){for(let n of this.selectedMovables)n.state=Nt.SELECTED,n!==this.movable&&(n.setPointerEvents(!0),n.setAnimatedTransition(!0),n.width=n.height=-1)}isProximity(n,e=this.movable){let i=Math.max(.95*((n.width+e.width)/4+(n.height+e.height)/4),25)**2;return mn.sqrMagnitude({x:n.posX+n.width/2,y:n.posY+n.height/2,z:n.posZ},{x:e.posX+e.width/2,y:e.posY+e.height/2,z:e.posZ})<i}addEventListeners(){this.movable.nativeElement.addEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.addEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.addEventListener("pickregion",this.callbackOnPickRegion)}removeEventListeners(){this.movable.nativeElement.removeEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.removeEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.removeEventListener("pickregion",this.callbackOnPickRegion)}register(){let n=ba.objectMap.get(this.movable.tabletopObject)??new Set;n.add(this.movable),ba.objectMap.set(this.movable.tabletopObject,n)}unregister(){let n=ba.objectMap.get(this.movable.tabletopObject);n&&(n.delete(this.movable),n.size<1&&ba.objectMap.delete(this.movable.tabletopObject))}static congregate(n,e){let i=e.sort((a,l)=>{let c=a.zindex,u=l.zindex;return null==c||null==u?0:c-u}),r=360/i.length,o=360*Math.random(),s=Math.min(Math.max(9*i.length,5),75);for(let a of i){let l=ba.objectMap.get(a);if(null!=l)for(let c of l){c.setAnimatedTransition(!0),c.stopTransition(),c.width<0&&(c.width=c.nativeElement.clientWidth),c.height<0&&(c.height=c.nativeElement.clientHeight),o+=r;let u=mn.radians(o);c.posX=n.x+s*Math.sin(u)-c.width/2,c.posY=n.y+s*Math.cos(u)-c.height/2,c.posZ=n.z}}}}var Nt=function(t){return t[t.NONE=0]="NONE",t[t.SELECTED=1]="SELECTED",t[t.MAGNETIC=2]="MAGNETIC",t}(Nt||{});let $s=(()=>{class t{get size(){return this.selectionMap.size}get objects(){return Array.from(this.selectionMap.keys())}constructor(){this.selectionMap=new Map,this.previus=new Set,this.excludeElement=null,this.isUdpateCssBatching=!1}state(e){return this.selectionMap.get(e)??Nt.NONE}add(e,i=Nt.SELECTED){if(i===Nt.NONE)return this.remove(e);let r=this.objects;this.selectionMap.set(e,i),this.updateHighlight(r)}remove(e){if(!this.selectionMap.has(e))return;let i=this.objects;this.selectionMap.delete(e),this.updateHighlight(i)}clear(){let e=this.objects;this.selectionMap.clear(),this.updateHighlight(e)}congregate(e){ba.congregate(e,this.objects)}updateHighlight(e=[]){e.forEach(i=>this.previus.add(i)),!this.isUdpateCssBatching&&(queueMicrotask(()=>{this.isUdpateCssBatching=!1,this.selectionMap.forEach((r,o)=>this.previus.add(o));let i=Array.from(this.previus);this.previus.clear(),0<i.length&&Q.trigger("UPDATE_SELECTION",{changed:i});for(let r of i)Q.trigger(`UPDATE_SELECTION/identifier/${r.identifier}`,{changed:i})}),this.isUdpateCssBatching=!0)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class VC{constructor(n){this.targetElement=n,this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchMouseInput}),this.isEnable=!0,this.onstart=null,this.oninteract=null,this.initializeHammer()}cancel(){this.isEnable=!1}destroy(){this.hammer.destroy()}initializeHammer(){let n=new Hammer.Tap({event:"tap2",taps:2});this.hammer.add([n]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap2",this.onInteract.bind(this))}onHammer(n){if(!n.isFirst)return;let e=n.srcEvent instanceof MouseEvent&&(0!==n.srcEvent.button||n.srcEvent.ctrlKey||n.srcEvent.shiftKey);this.isEnable=!e,this.isEnable&&this.onstart&&this.onstart(n.srcEvent)}onInteract(n){this.isEnable&&this.oninteract&&this.oninteract(n.srcEvent)}}class ec{static#e=this.rotablesMap=new Map;get selectedRotables(){let n=new Set;for(let e of this.selection.objects)ec.rotablesMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e){this.rotable=n,this.selection=e,this._isDestroyed=!1}initialize(){this.register()}destroy(){this.unregister(),this._isDestroyed=!0,this.rotable=null}prepareRotate(){if(1<this.selection.size&&this.rotable.state!==Nt.NONE)for(let n of this.selectedRotables)n!==this.rotable&&(n.isDisable||n.setAnimatedTransition(!1));else this.selection.clear()}updateRotate(){if(!(this.selection.size<=1||this.rotable.state===Nt.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.rotate=this.rotable.rotate)}finishRotate(){if(!(this.selection.size<=1||this.rotable.state===Nt.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.setAnimatedTransition(!0),n.rotate=this.rotable.rotate)}register(){let n=ec.rotablesMap.get(this.rotable.tabletopObject)??new Set;n.add(this.rotable),ec.rotablesMap.set(this.rotable.tabletopObject,n)}unregister(){let n=ec.rotablesMap.get(this.rotable.tabletopObject);n&&(n.delete(this.rotable),n.size<1&&ec.rotablesMap.delete(this.rotable.tabletopObject))}}let Fu=(()=>{class t{get tabletopObject(){return this._tabletopObject}get targetPropertyName(){return this._targetPropertyName}get targetProperty(){return this.tabletopObject[this.targetPropertyName]}set targetProperty(e){this.targetPropertyName in this.tabletopObject&&(this.tabletopObject[this.targetPropertyName]=e)}get transformCssOffset(){return this._transformCssOffset}get grabbingSelecter(){return this._grabbingSelecter}set option(e){this.synchronizer.unregister(),this._tabletopObject=e.tabletopObject,this._targetPropertyName=e.targetPropertyName??"",this._grabbingSelecter=e.grabbingSelecter??".rotate-grab",this._transformCssOffset=e.transformCssOffset??"",this._targetPropertyName.length<1&&this._tabletopObject&&(this._targetPropertyName="rotate"),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateBatching()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}get state(){return this.selectionService.state(this.tabletopObject)}constructor(e,i,r,o,s){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.selectionService=s,this._targetPropertyName="",this._transformCssOffset="",this._grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new Gt,this.ondragstart=new Gt,this.ondrag=new Gt,this.ondragend=new Gt,this.onend=new Gt,this.cssRotate=0,this._rotate=0,this.rotateOffset=0,this.isUpdateBatching=!1,this.grabbingElement=null,this.input=new el(this.nativeElement,!1),this.synchronizer=new ec(this,this.selectionService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{e.isSendFromSelf&&(this.input.isGrabbing||this.state!==Nt.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(this.targetProperty),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)}ngOnDestroy(){this.input.isGrabbing&&this.cancel(),this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.setAnimatedTransition(!0)}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0)}dispose(){Q.unregister(this),this.batchService.remove(this)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||e instanceof MouseEvent&&(0!==e.button||e.ctrlKey||e.shiftKey))return void this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.synchronizer.prepareRotate()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r,this.synchronizer.updateRotate()}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.synchronizer.finishRotate(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}calcRotate(e,i){let l=Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2),c=(mn.degrees(l)-i+720)%360;return c<180?c:c-360}radianFromMatrix(e,i,r,o,s,a){let l=0;if(0!==e||0!==i){let c=Math.sqrt(e*e+i*i);l=i>0?Math.acos(e/c):-Math.acos(e/c)}else if(0!==r||0!==o){let c=Math.sqrt(r*r+o*o);l=.5*Math.PI-(o>0?Math.acos(-r/c):-Math.acos(r/c))}return l}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateBatching(){this.isUpdateBatching||(this.isUpdateBatching=!0,this.batchService.add(()=>{this.targetProperty=this.rotate,this.isUpdateBatching=!1})),this.updateTransformCss()}setRotate(e){e&&this.targetPropertyName in e&&(this._rotate=e[this.targetPropertyName]),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return this.targetProperty!==this.rotate}stopTransition(e=this.rotate){let i=window.getComputedStyle(this.nativeElement).transform;if(Math.abs(e-this.cssRotate)<180)return;let r=/matrix\(([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+)\)/gi.exec(i);if(!r)return;let o=this.radianFromMatrix(Number(r[1]),Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]),Number(r[6])),s=mn.degrees(o),a_x=Math.cos(o),a_y=Math.sin(o),l=mn.radians(e),c_x=Math.cos(l),u=a_x*Math.sin(l)-c_x*a_y,d=Math.abs(e-s);180<d&&(d=360-d);let h=e+(0<u?-d:d);if(h===s)return;let f=this.nativeElement.style.transition;this.nativeElement.style.transition="",this.cssRotate=h,this.nativeElement.style.transform=`${this.transformCssOffset} rotateZ(${h.toFixed(4)}deg)`,this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform,this.nativeElement.style.transition=f}updateTransformCss(){this.cssRotate=this.rotate;let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}static#e=this.\u0275fac=function(i){return new(i||t)(L(ti),L(Pg),L(Ci),L(ql),L($s))};static#t=this.\u0275dir=vt({type:t,selectors:[["","appRotable",""]],inputs:{option:[Rt.None,"rotable.option","option"],isDisable:[Rt.None,"rotable.disable","isDisable"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend"},features:[Kn]})}return t})();const Nee=t=>({transform:t}),Fee=t=>({"is-magnetic":t});function Ree(t,n){if(1&t&&(Ee(0,"img",7),Qt(1,"safe")),2&t){const e=M();b("src",Jt(1,1,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),_i)}}function Lee(t,n){if(1&t&&(_(0,"div",8)(1,"span"),O(2),w()()),2&t){const e=M();b("ngStyle",lt(2,Nee,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),v(2),ht(e.ownerName)}}function Bee(t,n){1&t&&(Ee(0,"img",9),Qt(1,"safe")),2&t&&b("src",Jt(1,1,M().frontImage.url,"resourceUrl"),_i)}function jee(t,n){1&t&&(Ae(0),_(1,"div",10)(2,"i",11),O(3,"autorenew"),w()(),_(4,"div",12)(5,"i",11),O(6,"autorenew"),w()(),_(7,"div",13)(8,"i",11),O(9,"autorenew"),w()(),_(10,"div",14)(11,"i",11),O(12,"autorenew"),w()(),Ee(13,"div",15),ke())}function Uee(t,n){if(1&t&&Ee(0,"div",16),2&t){const e=M();b("ngClass",lt(1,Fee,e.isMagnetic))}}let Vee=(()=>{class t{get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return mn.clampMin(this.card.size)}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get selectionState(){return this.selectionService.state(this.card)}get isSelected(){return this.selectionState!==Nt.NONE}get isMagnetic(){return this.selectionState===Nt.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.selectionService=l,this.imageService=c,this.pointerDeviceService=u,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){Q.unregister(this),Q.register(this).on(`UPDATE_GAME_OBJECT/aliasName/${Bt.aliasName}`,e=>{let i=De.instance.get(e.data.identifier);this.card&&i&&i.userId===this.card.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Bt.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new VC(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),Q.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof Yr||e.detail instanceof ji)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof ji)){let i=e.detail;this.card.calcSqrDistance(i)<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card))}}onDoubleClick(){this.ownerIsOnline&&!this.isHand||this.ngZone.run(()=>{this.state=this.isVisible&&!this.isHand?zl.BACK:zl.FRONT,this.owner="",xe.play(pe.cardDraw)})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.ngZone.run(()=>{this.card.toTopmost(),this.startIconHiddenTimer()})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.contextMenuService.close(),xe.play(pe.cardPick)}onMoved(){xe.play(pe.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=ji.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let i=this.tabletopService.cards.filter(r=>this.card.calcSqrDistance(r)<1e4);i.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of i)e.putOnBottom(r)}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.card.location.x+this.card.size*this.gridSize/2,y:this.card.location.y+this.card.size*this.gridSize/2,z:this.card.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.card.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ab\u30fc\u30c9",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{r().forEach(o=>o.faceUp()),xe.play(pe.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{r().forEach(o=>o.faceDown()),xe.play(pe.cardDraw)}},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{r().forEach(o=>{o.faceDown(),o.owner=Be.peer.userId}),xe.play(pe.cardDraw)}}]})}return e.push(gn),e}makeContextMenu(){let e=[];return e.push(!this.isVisible||this.isHand?{name:"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),xe.play(pe.cardDraw)}}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),xe.play(pe.cardDraw)}}),e.push(this.isHand?{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),xe.play(pe.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{xe.play(pe.cardDraw),this.card.faceDown(),this.owner=Be.peer.userId}}),e.push(gn),e.push({name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),xe.play(pe.cardPut)}}),e.push(gn),e.push({name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.card.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),xe.play(pe.cardPut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),xe.play(pe.sweep)}}),e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}showDetail(e){Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(zs,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(Zr),L(yn),L(ti),L(Zi),L(i1),L($s),L(Pu),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["card"]],hostBindings:function(i,r){1&i&&ue("carddrop",function(s){return r.onCardDrop(s)})("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{card:"card",is3D:"is3D"},features:[Kn],decls:7,vars:9,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none","is-grab",3,"movable.ondragstart","movable.ondragend","movable.option"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],["class","card-image chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background",3,"ngStyle"],[1,"card-image","thumbnail-transform","is-translucent","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"border-bg","is-pointer-events-none"],[1,"selected-highlight",3,"ngClass"]],template:function(i,r){1&i&&(_(0,"div",0),ue("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),_(1,"div",1),ue("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),J(2,Ree,2,4,"img",2)(3,Lee,3,4,"div",3)(4,Bee,2,4,"img",4)(5,jee,14,0,"ng-container",5)(6,Uee,1,3,"div",6),w()()),2&i&&(vn("width",r.size*r.gridSize,"px"),b("movable.option",r.movableOption),v(),b("rotable.option",r.rotableOption),v(),b("ngIf",r.imageFile),v(),b("ngIf",!r.isFront&&r.hasOwner&&0<r.ownerName.length),v(),b("ngIf",r.isHand&&r.frontImage),v(),b("ngIf",!r.isIconHidden),v(),b("ngIf",r.isSelected))},dependencies:[Pi,xn,Al,tr,Fu,Ei],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%;backface-visibility:hidden}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:3px;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0})}return t})();const Hee=["draggablePanel"],KP=t=>({card:t}),zee=t=>({note:t}),QP=t=>({character:t}),Gee=t=>({dice:t}),ns=(t,n)=>({"is-pointer-events-auto":t,"pointer-events-none":n}),JP=t=>({"with-button-marign":t}),Fg=t=>({dataElm:t}),$ee=(t,n)=>({"is-black-mask":t,"is-harf-black-mask":n});function Wee(t,n){1&t&&Bn(0)}function qee(t,n){1&t&&Bn(0)}function Zee(t,n){if(1&t&&(Ae(0),J(1,qee,1,0,"ng-container",14),ke()),2&t){const e=M(),i=Lt(12);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,KP,e.tabletopObject))}}function Yee(t,n){1&t&&Bn(0)}function Xee(t,n){if(1&t&&(Ae(0),J(1,Yee,1,0,"ng-container",14),ke()),2&t){const e=M(),i=Lt(12);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,KP,e.tabletopObject))}}function Kee(t,n){1&t&&Bn(0)}function Qee(t,n){if(1&t&&(Ae(0),J(1,Kee,1,0,"ng-container",14),ke()),2&t){const e=M(),i=Lt(14);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,zee,e.tabletopObject))}}function Jee(t,n){1&t&&Bn(0)}function ete(t,n){if(1&t&&(Ae(0),J(1,Jee,1,0,"ng-container",14),ke()),2&t){const e=M(),i=Lt(16);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,QP,e.tabletopObject))}}function tte(t,n){1&t&&Bn(0)}function nte(t,n){if(1&t&&(Ae(0),J(1,tte,1,0,"ng-container",14),ke()),2&t){const e=M(),i=Lt(18);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,Gee,e.tabletopObject))}}function ite(t,n){1&t&&Bn(0)}function rte(t,n){if(1&t&&(Ae(0),J(1,ite,1,0,"ng-container",14),ke()),2&t){const e=M(),i=Lt(16);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,QP,e.tabletopObject))}}function ote(t,n){1&t&&Bn(0)}function ste(t,n){if(1&t&&(Ae(0),J(1,ote,1,0,"ng-container",15),ke()),2&t){M();const e=Lt(22);v(),b("ngTemplateOutlet",e)}}function ate(t,n){if(1&t&&(_(0,"div",26)(1,"div",27),O(2),w()()),2&t){const e=M(2).card,i=M();b("ngClass",lt(2,JP,i.hasImage)),v(2),ht(e.ownerName)}}function lte(t,n){if(1&t){const e=Ue();_(0,"div",21),Ee(1,"img",22),Qt(2,"safe"),_(3,"button",23),ue("click",function(){return re(e),oe(M(2).chanageImageView(!0))}),_(4,"i",24),O(5,"zoom_in"),w()(),J(6,ate,3,4,"div",25),w()}if(2&t){const e=M().card,i=M();v(),b("src",Jt(2,2,i.imageUrl,"resourceUrl"),_i),v(5),b("ngIf",e.hasOwner&&0<e.ownerName.length)}}function cte(t,n){if(1&t&&(Ae(0),O(1),ke()),2&t){const e=M(2).card;v(),ht(e.name)}}function ute(t,n){1&t&&(Ae(0),O(1,"\u30ab\u30fc\u30c9"),ke())}function dte(t,n){if(1&t&&(_(0,"div",28),J(1,cte,2,1,"ng-container",13)(2,ute,2,0,"ng-container",13),w()),2&t){const e=M().card,i=M();b("ngClass",lt(3,JP,i.hasImage)),v(),b("ngIf",null==e.isVisible||e.isVisible),v(),b("ngIf",null!=e.isVisible&&!e.isVisible)}}function hte(t,n){1&t&&Bn(0)}function fte(t,n){if(1&t&&(Ae(0),J(1,hte,1,0,"ng-container",14),ke()),2&t){const e=n.$implicit;M(3);const i=Lt(20);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,Fg,e))}}function pte(t,n){if(1&t&&(_(0,"div",29)(1,"div",30),J(2,fte,2,4,"ng-container",31),w()()),2&t){const e=M(2);v(2),b("ngForOf",e.dataElms)}}function mte(t,n){if(1&t&&(_(0,"div",16),J(1,lte,7,5,"div",17)(2,dte,3,5,"div",18),_(3,"div",19),J(4,pte,3,1,"div",20),w()()),2&t){const e=n.card,i=M();b("ngClass",qi(4,ns,!i.isPointerDragging,i.isPointerDragging)),v(),b("ngIf",i.hasImage),v(),b("ngIf",0<(null==e||null==e.name?null:e.name.length)),v(2),b("ngIf",i.hasDataElms&&e.isVisible)}}function gte(t,n){if(1&t){const e=Ue();_(0,"div",32)(1,"div",33),O(2),w(),_(3,"div",34)(4,"div",21)(5,"div",35)(6,"textarea",36),bt("ngModelChange",function(r){const o=re(e).note;return pt(o.text,r)||(o.text=r),oe(r)}),w()(),_(7,"div",37),O(8),w()()()()}if(2&t){const e=n.note,i=M();b("ngClass",qi(4,ns,!i.isPointerDragging,i.isPointerDragging)),v(2),ht(e.title),v(4),yt("ngModel",e.text),v(2),ht(e.text)}}function _te(t,n){if(1&t&&(_(0,"div",44),Ee(1,"img",45),Qt(2,"safe"),w()),2&t){const e=M(2);b("ngClass",qi(5,ns,!e.isPointerDragging,e.isPointerDragging)),v(),b("src",Jt(2,2,e.imageUrl,"resourceUrl"),_i)}}function vte(t,n){1&t&&Bn(0)}function yte(t,n){if(1&t&&(Ae(0),_(1,"div",30),J(2,vte,1,0,"ng-container",14),w(),ke()),2&t){const e=M().$implicit;M(3);const i=Lt(20);v(2),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,Fg,e))}}function bte(t,n){if(1&t&&(Ae(0),J(1,yte,3,4,"ng-container",13),ke()),2&t){const e=n.$implicit,i=M(3);v(),b("ngIf",e&&e!==i.newLineDataElement)}}function Cte(t,n){if(1&t&&(_(0,"div",29),J(1,bte,2,1,"ng-container",31),w()),2&t){const e=M(2);v(),b("ngForOf",e.inventoryDataElms)}}function wte(t,n){if(1&t&&(_(0,"div",38),Ee(1,"div",39),J(2,_te,3,8,"div",40),_(3,"div",41),O(4),w(),Ee(5,"div",42),_(6,"div",43),J(7,Cte,2,1,"div",20),w()()),2&t){const e=n.character,i=M();v(),b("ngClass",qi(6,ns,!i.isPointerDragging,i.isPointerDragging)),v(),b("ngIf",i.hasImage),v(),b("ngClass",qi(9,ns,!i.isPointerDragging,i.isPointerDragging)),v(),ht(e.name),v(2),b("ngClass",qi(12,ns,!i.isPointerDragging,i.isPointerDragging)),v(),b("ngIf",i.hasDataElms)}}function Ete(t,n){if(1&t&&(Ae(0),O(1),ke()),2&t){const e=M().dice;v(),ht(e.face)}}function xte(t,n){1&t&&(Ae(0),O(1,"???"),ke())}function Tte(t,n){if(1&t&&(_(0,"div",47)(1,"div",27),O(2),w()()),2&t){const e=M().dice,i=M();b("ngClass",qi(2,ns,!i.isPointerDragging,i.isPointerDragging)),v(2),ki("",e.ownerName," ")}}function Dte(t,n){if(1&t&&(_(0,"div",44),Ee(1,"img",48),Qt(2,"safe"),w()),2&t){const e=M().dice,i=M();b("ngClass",qi(6,ns,!i.isPointerDragging,i.isPointerDragging)),v(),b("ngClass",qi(9,$ee,!e.isVisible,e.isMine))("src",Jt(2,3,i.imageUrl,"resourceUrl"),_i)}}function Ste(t,n){1&t&&Bn(0)}function Mte(t,n){if(1&t&&(Ae(0),J(1,Ste,1,0,"ng-container",14),ke()),2&t){const e=M().$implicit;M(3);const i=Lt(20);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,Fg,e))}}function Ite(t,n){if(1&t&&(Ae(0),J(1,Mte,2,4,"ng-container",13),ke()),2&t){const e=n.$implicit,i=M(3);v(),b("ngIf",e&&e!==i.newLineDataElement)}}function Ate(t,n){if(1&t&&(_(0,"div",29)(1,"div",30),J(2,Ite,2,1,"ng-container",31),w()()),2&t){const e=M(2);v(2),b("ngForOf",e.dataElms)}}function kte(t,n){if(1&t&&(_(0,"div",38),Ee(1,"div",39),_(2,"div",41),O(3),J(4,Ete,2,1,"ng-container",13)(5,xte,2,0,"ng-container",13),w(),J(6,Tte,3,5,"div",46)(7,Dte,3,12,"div",40),Ee(8,"div",42),_(9,"div",43),J(10,Ate,3,1,"div",20),w()()),2&t){const e=n.dice,i=M();v(),b("ngClass",qi(9,ns,!i.isPointerDragging,i.isPointerDragging)),v(),b("ngClass",qi(12,ns,!i.isPointerDragging,i.isPointerDragging)),v(),ki(" ",e.name,": "),v(),b("ngIf",e.isVisible),v(),b("ngIf",!e.isVisible),v(),b("ngIf",e.hasOwner&&0<e.ownerName.length),v(),b("ngIf",i.hasImage),v(2),b("ngClass",qi(15,ns,!i.isPointerDragging,i.isPointerDragging)),v(),b("ngIf",i.hasDataElms&&e.isVisible)}}function Ote(t,n){1&t&&Bn(0)}function Pte(t,n){if(1&t&&(_(0,"div",53),O(1),w()),2&t){const e=M(2).dataElm;v(),ht(e.name)}}function Nte(t,n){1&t&&Bn(0)}function Fte(t,n){if(1&t&&(Ae(0),J(1,Nte,1,0,"ng-container",14),ke()),2&t){const e=n.$implicit;M(3);const i=Lt(20);v(),b("ngTemplateOutlet",i)("ngTemplateOutletContext",lt(2,Fg,e))}}function Rte(t,n){if(1&t&&(_(0,"div",50),J(1,Pte,2,1,"div",51),_(2,"div",52),J(3,Fte,2,4,"ng-container",31),w()()),2&t){const e=M().dataElm;v(),b("ngIf",0<e.name.trim().length),v(2),b("ngForOf",e.children)}}function Lte(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",55)(2,"div"),O(3),w(),_(4,"div",56)(5,"div",35)(6,"textarea",36),bt("ngModelChange",function(r){re(e);const o=M(2).dataElm;return pt(o.value,r)||(o.value=r),oe(r)}),w()(),_(7,"div",37),O(8),w()()(),ke()}if(2&t){const e=M(2).dataElm;v(3),ht(e.name),v(3),yt("ngModel",e.value),v(2),ht(e.value)}}function Bte(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",57),O(2),w(),_(3,"div",58)(4,"div",59)(5,"div",60),O(6),w(),_(7,"input",61),bt("ngModelChange",function(r){re(e);const o=M(2).dataElm;return pt(o.currentValue,r)||(o.currentValue=r),oe(r)}),w()(),_(8,"div",62),O(9),w()(),_(10,"div",63)(11,"input",64),Qt(12,"safe"),bt("ngModelChange",function(r){re(e);const o=M(2).dataElm;return pt(o.currentValue,r)||(o.currentValue=r),oe(r)}),w()(),ke()}if(2&t){const e=M(2).dataElm;v(2),ht(e.name),v(4),ht(e.currentValue),v(),yt("ngModel",e.currentValue),v(2),ki(" / ",e.value,""),v(2),lo(Jt(12,8,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),Pn("max",e.value),yt("ngModel",e.currentValue)}}function jte(t,n){if(1&t){const e=Ue();Ae(0),_(1,"div",57),O(2),w(),_(3,"div",58)(4,"div",65),O(5),w(),_(6,"input",66),bt("ngModelChange",function(r){re(e);const o=M(2).dataElm;return pt(o.value,r)||(o.value=r),oe(r)}),w()(),ke()}if(2&t){const e=M(2).dataElm;v(2),ht(e.name),v(3),ht(e.value),v(),yt("ngModel",e.value)}}function Ute(t,n){1&t&&(Ae(0,10),J(1,Lte,9,3,"ng-container",11)(2,Bte,13,11,"ng-container",11)(3,jte,7,3,"ng-container",12),ke(),Ee(4,"div",54)),2&t&&(b("ngSwitch",M().dataElm.type),v(),b("ngSwitchCase","note"),v(),b("ngSwitchCase","numberResource"))}function Vte(t,n){if(1&t&&J(0,Ote,1,0,"ng-container",49)(1,Rte,4,2,"ng-template",null,7,ni)(3,Ute,5,3,"ng-template",null,8,ni),2&t){const e=n.dataElm,i=Lt(2),r=Lt(4);b("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function Hte(t,n){if(1&t){const e=Ue();_(0,"div",67),ue("click",function(){return re(e),oe(M().chanageImageView(!1))}),_(1,"div",68)(2,"i",24),O(3,"close"),w()(),Ee(4,"img",69),Qt(5,"safe"),w()}if(2&t){const e=M();b("@fadeInOut","in"),v(4),b("src",Jt(5,2,e.imageUrl,"resourceUrl"),_i)}}let zte=(()=>{class t{get imageUrl(){return this.tabletopObject&&this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineDataElement(){return this.inventoryService.newLineDataElement}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}constructor(e,i,r){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.tabletopObject=null,this.left=0,this.top=0,this.isOpenImageView=!1}ngOnChanges(){Q.unregister(this),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16)}ngOnDestroy(){Q.unregister(this)}onChangeDragging(e){this.changeDetector.markForCheck()}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}chanageImageView(e){this.isOpenImageView=e}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}static#e=this.\u0275fac=function(i){return new(i||t)(L(ga),L(Zi),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["overview-panel"]],viewQuery:function(i,r){if(1&i&&Qn(Hee,7),2&i){let o;Jn(o=ei())&&(r.draggablePanel=o.first)}},hostBindings:function(i,r){1&i&&ue("draggingstate",function(s){return r.onChangeDragging(s)},0,Cd)},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},features:[Kn],decls:23,vars:9,consts:[["draggablePanel",""],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["dataElement",""],["imageView",""],["thenBlock",""],["elseBlock",""],["appDraggable","",1,"component","is-pointer-events-none"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],["class","component-title title-background",3,"ngClass",4,"ngIf"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],[1,"card-image",3,"src"],[1,"zoom-button",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom",3,"ngClass",4,"ngIf"],[1,"component-owner","position-right-bottom",3,"ngClass"],[1,"owner-tag"],[1,"component-title","title-background",3,"ngClass"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[1,"is-fill"],["spellcheck","false",1,"textarea",3,"ngModelChange","ngModel"],[1,"textarea-spacer"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[1,"character-image",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],[1,"character-image",3,"ngClass","src"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],[1,"tag"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","size","1",1,"input",3,"ngModelChange","ngModel"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["type","range","min","0",3,"ngModelChange","max","ngModel"],[1,"hidden-spacer"],["size","1",1,"input",3,"ngModelChange","ngModel"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none"],[1,"contain-image",3,"src"]],template:function(i,r){1&i&&(_(0,"div",9,0),Ae(2,10),J(3,Wee,1,0,"ng-container",11)(4,Zee,2,4,"ng-container",11)(5,Xee,2,4,"ng-container",11)(6,Qee,2,4,"ng-container",11)(7,ete,2,4,"ng-container",11)(8,nte,2,4,"ng-container",11)(9,rte,2,4,"ng-container",12),ke(),w(),J(10,ste,2,1,"ng-container",13)(11,mte,5,7,"ng-template",null,1,ni)(13,gte,9,7,"ng-template",null,2,ni)(15,wte,8,15,"ng-template",null,3,ni)(17,kte,11,18,"ng-template",null,4,ni)(19,Vte,5,3,"ng-template",null,5,ni)(21,Hte,6,5,"ng-template",null,6,ni)),2&i&&(b("@fadeInOut","in"),v(2),b("ngSwitch",r.tabletopObject.aliasName),v(),b("ngSwitchCase","numberResource"),v(),b("ngSwitchCase","card"),v(),b("ngSwitchCase","card-stack"),v(),b("ngSwitchCase","text-note"),v(),b("ngSwitchCase","character"),v(),b("ngSwitchCase","dice-symbol"),v(2),b("ngIf",r.isOpenImageView))},dependencies:[Pi,ii,xn,ch,Il,ah,lh,hr,cu,Pl,Ar,pr,YP,Ei],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#ccc;background-color:#1e1e1ecc;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;max-height:120px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;border-radius:1em;z-index:1}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#eee}.textarea[_ngcontent-%COMP%]:focus{background:#fff}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{width:100%;min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}"],data:{animation:[xs("fadeInOut",[Xi("void => *",[Yi("100ms ease-out",Xo([Tt({opacity:0,offset:0}),Tt({opacity:1,offset:1})]))]),Xi("* => void",[Yi("100ms ease-in",Xo([Tt({opacity:1,offset:0}),Tt({opacity:0,offset:1})]))])])]},changeDetection:0})}return t})(),eN=(()=>{class t{static#e=this.activeTooltips=[];constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=o=>this.onMouseEnter(o),this.callbackOnMouseLeave=o=>this.onMouseLeave(o),this.callbackOnMouseDown=o=>this.onMouseDown(o),this.callbackOnPick=o=>this.ngZone.run(()=>this.closeAll())}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){this.tooltipComponentRef&&!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointer;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<mn.sqrMagnitude(e,this.pointerDeviceService.pointer)?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture)return;let e=Zr.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(zte,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0),document.addEventListener("pickstart",this.callbackOnPick,!0),document.addEventListener("pickobject",this.callbackOnPick,!0),document.addEventListener("pickregion",this.callbackOnPick,!0)}),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject.identifier}`,o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("UPDATE_SELECTION",o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("DELETE_GAME_OBJECT",o=>{this.tabletopObject&&this.tabletopObject.identifier===o.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),document.removeEventListener("pickstart",this.callbackOnPick,!0),document.removeEventListener("pickobject",this.callbackOnPick,!0),document.removeEventListener("pickregion",this.callbackOnPick,!0),this.clearTimer(),this.tooltipComponentRef=null,Q.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef);let r=this.tooltipComponentRef.instance;null!=r?.ngOnChanges&&queueMicrotask(()=>{this.tooltipComponentRef.instance&&r?.ngOnChanges({})})}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}static#t=this.\u0275fac=function(i){return new(i||t)(L(kt),L(zr),L(Ci))};static#n=this.\u0275dir=vt({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:[Rt.None,"appTooltip","tabletopObject"]}})}return t})();function Gte(t,n){if(1&t){const e=Ue();_(0,"div",2)(1,"div",3),Ee(2,"div",4),Qt(3,"safe"),Ee(4,"div",4),Qt(5,"safe"),w(),_(6,"div",5)(7,"button",6),ue("click",function(){const r=re(e).$implicit;return oe(M().drawCard(r))}),O(8,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),w(),_(9,"button",0),ue("click",function(){const r=re(e).$implicit;return oe(M().showDetail(r))}),_(10,"i",7),O(11,"settings"),w(),O(12,"\u7de8\u96c6"),w(),Ee(13,"br"),_(14,"button",0),ue("click",function(){const r=re(e).$implicit;return oe(M().up(r))}),O(15,"\u2191"),w(),_(16,"button",0),ue("click",function(){const r=re(e).$implicit;return oe(M().down(r))}),O(17,"\u2193"),w(),Ee(18,"br"),w()()}if(2&t){const e=n.$implicit;v(),b("appTooltip",e),v(),vn("background-image",Jt(3,5,"url("+(null==e||null==e.frontImage?null:e.frontImage.url)+")","style")),v(2),vn("background-image",Jt(5,8,"url("+(null==e||null==e.backImage?null:e.backImage.url)+")","style"))}}let $te=(()=>{class t{constructor(e,i){this.panelService=e,this.changeDetector=i,this.cardStack=null,this.owner=Be.peer.userId}ngOnChanges(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),Q.unregister(this),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck(),this.cardStack.owner!==this.owner&&this.panelService.close()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Q.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),xe.play(pe.cardDraw)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),Q.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),xe.play(pe.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(zs,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}static#e=this.\u0275fac=function(i){return new(i||t)(L(yn),L(Zi))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},features:[Kn],decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[1,"image-box",3,"appTooltip"],[1,"image","contain"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(i,r){1&i&&(_(0,"div")(1,"button",0),ue("click",function(){return r.close(!0)}),O(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),w(),Ee(3,"hr"),J(4,Gte,19,11,"div",1),w()),2&i&&(v(4),b("ngForOf",r.cardStack.cards)("ngForTrackBy",r.trackByCard))},dependencies:[ii,eN,Ei],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0})}return t})();const Wte=t=>({"is-empty":t}),HC=t=>({transform:t}),qte=t=>({"is-magnetic":t});function Zte(t,n){if(1&t&&(Ee(0,"img",8),Qt(1,"safe")),2&t){const e=M();b("ngStyle",lt(5,HC,"rotateZ("+e.topCard.rotate+"deg)"))("src",Jt(1,2,e.imageFile.url,"resourceUrl"),_i)}}function Yte(t,n){1&t&&(Ae(0),_(1,"div",9)(2,"i",10),O(3,"autorenew"),w()(),_(4,"div",11)(5,"i",10),O(6,"autorenew"),w()(),_(7,"div",12)(8,"i",10),O(9,"autorenew"),w()(),_(10,"div",13)(11,"i",10),O(12,"autorenew"),w()(),ke())}function Xte(t,n){if(1&t&&(_(0,"div",14)(1,"span"),O(2),w()()),2&t){const e=M();b("ngStyle",lt(2,HC,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),v(2),ki("",e.cards.length,"\u679a")}}function Kte(t,n){if(1&t&&(_(0,"div",15)(1,"span"),O(2),w()()),2&t){const e=M();b("ngStyle",lt(2,HC,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),v(2),ki("",e.ownerName," \u304c\u78ba\u8a8d\u4e2d")}}function Qte(t,n){if(1&t&&Ee(0,"div",16),2&t){const e=M();b("ngClass",lt(1,qte,e.isMagnetic))}}let Jte=(()=>{class t{get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?mn.clampMin(e.size):2}get hasOwner(){return this.cardStack.hasOwner}get ownerName(){return this.cardStack.ownerName}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get selectionState(){return this.selectionService.state(this.cardStack)}get isSelected(){return this.selectionState!==Nt.NONE}get isMagnetic(){return this.selectionState===Nt.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.selectionService=a,this.imageService=l,this.pointerDeviceService=c,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){Q.unregister(this),Q.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on(`UPDATE_GAME_OBJECT/aliasName/${Bt.aliasName}`,e=>{let i=De.instance.get(e.data.identifier);this.cardStack&&i&&i.userId===this.cardStack.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Bt.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new VC(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),Q.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof Yr||e.detail instanceof ji))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof Yr){let i=e.detail;this.cardStack.calcSqrDistance(i)<2500&&this.cardStack.putOnTop(i)}else if(e.detail instanceof ji){let i=e.detail;this.cardStack.calcSqrDistance(i)<625&&this.concatStack(i)}}onDoubleClick(){this.ngZone.run(()=>{null!=this.drawCard()&&xe.play(pe.cardDraw)})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.ngZone.run(()=>{this.cardStack.toTopmost(),this.startIconHiddenTimer()})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),xe.play(pe.cardPick)}onMoved(){xe.play(pe.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let l=ji.create(this.cardStack.name);l.location.x=this.cardStack.location.x+50-100*Math.random(),l.location.y=this.cardStack.location.y+50-100*Math.random(),l.posZ=this.cardStack.posZ,l.location.name=this.cardStack.location.name,l.rotate=this.rotate,l.toTopmost(),i.push(l)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=ji.create(e.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.cardStack.topCard?.size??2,r={x:this.cardStack.location.x+i*this.gridSize/2,y:this.cardStack.location.y+i*this.gridSize/2,z:this.cardStack.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(r)}),this.isSelected){let o=()=>this.selectionService.objects.filter(s=>s.aliasName===this.cardStack.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5c71\u672d",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceUpAll()),xe.play(pe.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceDownAll()),xe.play(pe.cardDraw)}},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.uprightAll()),xe.play(pe.cardDraw)}},gn,{name:"\u3059\u3079\u3066\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{xe.play(pe.cardShuffle),o().forEach(s=>{s.shuffle(),Q.call("SHUFFLE_CARD_STACK",{identifier:s.identifier})})}}]})}return e.push(gn),e}makeContextMenu(){let e=[];return e.push({name:"\uff11\u679a\u5f15\u304f",action:()=>{null!=this.drawCard()&&xe.play(pe.cardDraw)}}),e.push(gn),e.push({name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUp(),xe.play(pe.cardDraw)}}),e.push({name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),xe.play(pe.cardDraw)}}),e.push(gn),e.push({name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),xe.play(pe.cardDraw)}}),e.push({name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),xe.play(pe.cardDraw)}}),e.push({name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),xe.play(pe.cardDraw)}}),e.push(gn),e.push({name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),xe.play(pe.cardShuffle),Q.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})}}),e.push({name:"\u30ab\u30fc\u30c9\u4e00\u89a7",action:()=>{this.showStackList(this.cardStack)}}),e.push(gn),e.push(this.isShowTotal?{name:"\u679a\u6570\u3092\u975e\u8868\u793a\u306b\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u679a\u6570\u3092\u8868\u793a\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!0}}),e.push({name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)}}),e.push(gn),e.push({name:"\u5c71\u672d\u3092\u4eba\u6570\u5206\u306b\u5206\u5272\u3059\u308b",action:()=>{this.splitStack(Be.peerIds.length+1),xe.play(pe.cardDraw)}}),e.push({name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),xe.play(pe.cardShuffle)}}),e.push(gn),e.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.cardStack.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.owner="",i.toTopmost(),xe.play(pe.cardPut)}}),e.push({name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),xe.play(pe.sweep)}}),e}showDetail(e){Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(zs,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}showStackList(e){Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=Be.peer.userId,this.panelService.open($te,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(Zr),L(yn),L(ti),L(Zi),L($s),L(Pu),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["card-stack"]],hostBindings:function(i,r){1&i&&ue("carddrop",function(s){return r.onCardDrop(s)})("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{cardStack:"cardStack",is3D:"is3D"},features:[Kn],decls:8,vars:13,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option"],["appRotable","",1,"component-content","is-pointer-events-auto","is-grab","is-3d",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[1,"is-backface-hidden","chrome-smooth-image-trick"],["class","card-image chrome-smooth-image-trick",3,"ngStyle","src",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",3,"ngStyle"],[1,"selected-highlight",3,"ngClass"]],template:function(i,r){1&i&&(_(0,"div",0),ue("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),_(1,"div",1),ue("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),_(2,"div",2),ue("@shuffle.start",function(s){return r.animationShuffleStarted(s)})("@shuffle.done",function(s){return r.animationShuffleDone(s)}),J(3,Zte,2,7,"img",3),w(),J(4,Yte,13,0,"ng-container",4)(5,Xte,3,4,"div",5)(6,Kte,3,4,"div",6)(7,Qte,1,3,"div",7),w()()),2&i&&(vn("width",r.size*r.gridSize,"px"),b("ngClass",lt(11,Wte,r.isEmpty))("movable.option",r.movableOption),v(),b("rotable.option",r.rotableOption),v(),b("@shuffle",r.animeState),v(),b("ngIf",r.topCard&&r.imageFile),v(),b("ngIf",!r.isIconHidden),v(),b("ngIf",r.isShowTotal),v(),b("ngIf",r.hasOwner),v(),b("ngIf",r.isSelected))},dependencies:[Pi,xn,Al,tr,Fu,Ei],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.is-backface-hidden[_ngcontent-%COMP%]{backface-visibility:hidden}.component[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%;backface-visibility:hidden}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99;inset:-5px}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[xs("shuffle",[Xi("* => active",[Yi("800ms ease",Xo([Tt({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),Tt({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),Tt({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),Tt({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),Tt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])])]},changeDetection:0})}return t})();const zC=t=>({transform:t}),ene=t=>({"is-magnetic":t}),tne=()=>["0","180deg"];function nne(t,n){if(1&t&&Ee(0,"div",18),2&t){const e=M();b("ngClass",lt(1,ene,e.isMagnetic))}}function ine(t,n){if(1&t&&(_(0,"div",20)(1,"div",21),O(2),w()()),2&t){const e=n.$implicit,i=M(2);b("ngStyle",lt(2,zC,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),v(2),ht(i.name)}}function rne(t,n){1&t&&(Ae(0),J(1,ine,3,4,"div",19),ke()),2&t&&(v(),b("ngForOf",Dl(1,tne)))}function one(t,n){1&t&&(Ee(0,"img",22),Qt(1,"safe")),2&t&&b("src",Jt(1,1,M().imageFile.url,"resourceUrl"),_i)}let sne=(()=>{class t{get name(){return this.gameCharacter.name}get size(){return mn.clampMin(this.gameCharacter.size)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get selectionState(){return this.selectionService.state(this.gameCharacter)}get isSelected(){return this.selectionState!==Nt.NONE}get isMagnetic(){return this.selectionState===Nt.MAGNETIC}constructor(e,i,r,o,s){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.selectionService=o,this.pointerDeviceService=s,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.rollOption={}}ngOnChanges(){Q.unregister(this),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.gameCharacter},this.rollOption={tabletopObject:this.gameCharacter,targetPropertyName:"roll"}}ngOnDestroy(){Q.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),xe.play(pe.piecePick)}onMoved(){xe.play(pe.piecePut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.gameCharacter.location.x+this.gameCharacter.size*this.gridSize/2,y:this.gameCharacter.location.y+this.gameCharacter.size*this.gridSize/2,z:this.gameCharacter.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameCharacter.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",action:null,subActions:[{name:"\u3059\u3079\u3066\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("common"),this.selectionService.remove(o)}),xe.play(pe.piecePut)}},{name:"\u3059\u3079\u3066\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation(Be.peerId),this.selectionService.remove(o)}),xe.play(pe.piecePut)}},{name:"\u3059\u3079\u3066\u5893\u5834\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("graveyard"),this.selectionService.remove(o)}),xe.play(pe.sweep)}}]})}return e.push(gn),e}makeContextMenu(){let e=[];return e.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}}),e.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}}),e.push(gn),e.push({name:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("common"),xe.play(pe.piecePut)}}),e.push({name:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation(Be.peerId),xe.play(pe.piecePut)}}),e.push({name:"\u5893\u5834\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("graveyard"),xe.play(pe.sweep)}}),e.push(gn),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.gameCharacter.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),xe.play(pe.piecePut)}}),e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(zs,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(WP,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}static#e=this.\u0275fac=function(i){return new(i||t)(L(Zr),L(yn),L(Zi),L($s),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["game-character"]],hostBindings:function(i,r){1&i&&ue("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},features:[Kn],decls:23,vars:21,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"pedestal-inner"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"upright-transform","is-fit-width","is-3d"],["appRotable","",1,"rotate-frame","is-3d",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[1,"rotate-inner","is-3d"],[4,"ngIf"],["class","image chrome-smooth-image-trick",3,"src",4,"ngIf"],[1,"rotate-grab","rotate-grab-icon","of-top",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom",3,"ngStyle"],[1,"selected-highlight",3,"ngClass"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngFor","ngForOf"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"has-length-limit"],[1,"image","chrome-smooth-image-trick",3,"src"]],template:function(i,r){1&i&&(_(0,"div",0),ue("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),_(1,"div",1)(2,"div",2),ue("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),_(3,"div",3)(4,"div",4)(5,"div",5),O(6,"autorenew"),w(),_(7,"div",6),O(8,"autorenew"),w()()(),Ee(9,"div",7),J(10,nne,1,3,"div",8),Ee(11,"div",9),_(12,"div",10)(13,"div",11),ue("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),_(14,"div",12),J(15,rne,2,2,"ng-container",13)(16,one,2,4,"img",14),_(17,"div",15)(18,"i",16),O(19,"autorenew"),w()(),_(20,"div",17)(21,"i",16),O(22,"autorenew"),w()()()()()()()()),2&i&&(vn("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),b("movable.option",r.movableOption),v(),b("@bounceInOut","in"),v(),b("rotable.option",r.rotableOption),v(8),b("ngIf",r.isSelected),v(3),vn("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),b("rotable.option",r.rollOption),v(2),b("ngIf",0<r.name.length),v(),b("ngIf",0<r.imageFile.url.length),v(),b("ngStyle",lt(17,zC,"translateX(-50%) translateX("+r.size*r.gridSize/2+"px)")),v(3),b("ngStyle",lt(19,zC,"translateX(-50%) translateX("+r.size*r.gridSize/2+"px")))},dependencies:[Pi,ii,xn,Al,tr,Fu,Ei],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-outer[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:25px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:-30px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[xs("bounceInOut",[Xi("void => *",[Yi("600ms ease",Xo([Tt({transform:"scale3d(0, 0, 0)",offset:0}),Tt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Tt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Tt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Tt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xi("* => void",[Yi(100,Tt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0})}return t})();const ane=t=>({"is-grab":t}),lne=t=>({"is-magnetic":t});function cne(t,n){1&t&&Ee(0,"div")}function une(t,n){1&t&&Ee(0,"div",6),2&t&&vn("background-color","rgba(10, 10, 10,"+M().opacity+")")}function dne(t,n){if(1&t&&(_(0,"div",7),Ee(1,"img",8),Qt(2,"safe"),w()),2&t){const e=M();v(),vn("opacity",e.opacity),b("src",Jt(2,3,e.imageFile.url,"resourceUrl"),_i)}}function hne(t,n){1&t&&(_(0,"div",9)(1,"i",10),O(2,"lock"),w()())}function fne(t,n){if(1&t&&Ee(0,"div",11),2&t){const e=M();b("ngClass",lt(1,lne,e.isMagnetic))}}let pne=(()=>{class t{get name(){return this.gameTableMask.name}get width(){return mn.clampMin(this.gameTableMask.width)}get height(){return mn.clampMin(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get selectionState(){return this.selectionService.state(this.gameTableMask)}get isSelected(){return this.selectionState!==Nt.NONE}get isMagnetic(){return this.selectionState===Nt.MAGNETIC}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.selectionService=l,this.pointerDeviceService=c,this.coordinateService=u,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.input=null}ngOnChanges(){Q.unregister(this),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new el(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Q.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Q.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),xe.play(pe.cardPick)}onMoved(){xe.play(pe.cardPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameTableMask.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30de\u30c3\u30d7\u30de\u30b9\u30af",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLock=!0),xe.play(pe.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,o.parent&&o.parent.appendChild(s)}),xe.play(pe.cardPut)}}]})}return e.push(gn),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate(),i=[];return i.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,xe.play(pe.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,xe.play(pe.lock)}}),this.isLock||(i.push(gn),i.push({name:"\u91cd\u306a\u308a\u9806\u3092\u4e00\u756a\u4e0a\u306b",action:()=>{let r=this.gameTableMask.parent;r&&r.appendChild(this.gameTableMask)}}),i.push({name:"\u91cd\u306a\u308a\u9806\u3092\u4e00\u756a\u4e0b\u306b",action:()=>{let r=this.gameTableMask.parent;r&&r.prependChild(this.gameTableMask)}})),i.push(gn),i.push({name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}}),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameTableMask.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(r),xe.play(pe.cardPut)}}),i.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),xe.play(pe.sweep)}}),i.push(gn),i.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}),i}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(zs,{title:r,left:i.x-200,top:i.y-150,width:400,height:300}).tabletopObject=e}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(UC),L(Zr),L(ti),L(yn),L(Zi),L($s),L(Ci),L(ql))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["game-table-mask"]],hostBindings:function(i,r){1&i&&ue("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},features:[Kn],decls:8,vars:14,consts:[["blackMask",""],["imageMask",""],["appMovable","",1,"component","is-3d",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],[4,"ngIf","ngIfThen","ngIfElse"],["class","lock-icon is-center",4,"ngIf"],["class","selected-highlight border",3,"ngClass",4,"ngIf"],[1,"border","is-fit-full"],[1,"border","is-fit-full","chrome-smooth-image-trick"],[1,"image","is-fit-full","chrome-smooth-image-trick",3,"src"],[1,"lock-icon","is-center"],[1,"material-icons"],[1,"selected-highlight","border",3,"ngClass"]],template:function(i,r){if(1&i){const o=Ue();_(0,"div",2),ue("movable.ondragstart",function(){return re(o),oe(r.onMove())})("movable.ondragend",function(){return re(o),oe(r.onMoved())}),J(1,cne,1,0,"div",3)(2,une,1,2,"ng-template",null,0,ni)(4,dne,3,6,"ng-template",null,1,ni)(6,hne,3,0,"div",4)(7,fne,1,3,"div",5),w()}if(2&i){const o=Lt(3),s=Lt(5);vn("width",r.width*r.gridSize,"px")("height",r.height*r.gridSize,"px"),b("ngClass",lt(12,ane,!r.isLock))("movable.option",r.movableOption)("movable.disable",r.isLock),v(),b("ngIf",r.imageFile.url.length<1)("ngIfThen",o)("ngIfElse",s),v(5),b("ngIf",r.isLock),v(),b("ngIf",r.isSelected)}},dependencies:[Pi,xn,tr,Ei],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}"],changeDetection:0})}return t})();const mne=t=>({"is-grab":t}),Xh=t=>({"blinking-animation":t}),gne=t=>({transform:t}),Kh=t=>({"is-magnetic":t});function _ne(t,n){1&t&&(Ae(0),Ee(1,"div",3),_(2,"div",4)(3,"i",5),O(4,"autorenew"),w()(),_(5,"div",6)(6,"i",5),O(7,"autorenew"),w()(),_(8,"div",7)(9,"i",5),O(10,"autorenew"),w()(),_(11,"div",8)(12,"i",5),O(13,"autorenew"),w()(),ke())}function vne(t,n){if(1&t&&Ee(0,"div",11),2&t){const e=M(2);b("ngClass",lt(1,Kh,e.isMagnetic))}}function yne(t,n){if(1&t&&(Ae(0),_(1,"div",9),Qt(2,"safe"),J(3,vne,1,3,"div",10),w(),ke()),2&t){const e=M();v(),vn("background-image",Jt(2,5,"url("+e.floorImage.url+")","style")),b("ngClass",lt(8,Xh,!e.isLocked))("ngStyle",lt(10,gne,"translateZ("+e.height*e.gridSize+"px)")),v(2),b("ngIf",e.isSelected)}}function bne(t,n){if(1&t&&Ee(0,"div",11),2&t){const e=M(3);b("ngClass",lt(1,Kh,e.isMagnetic))}}function Cne(t,n){if(1&t&&(_(0,"div",16),Qt(1,"safe"),J(2,bne,1,3,"div",10),w()),2&t){const e=M(2);vn("background-image",Jt(1,8,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),b("ngClass",lt(11,Xh,!e.isLocked)),v(2),b("ngIf",e.isSelected)}}function wne(t,n){if(1&t&&Ee(0,"div",11),2&t){const e=M(3);b("ngClass",lt(1,Kh,e.isMagnetic))}}function Ene(t,n){if(1&t&&(_(0,"div",17),Qt(1,"safe"),J(2,wne,1,3,"div",10),w()),2&t){const e=M(2);vn("background-image",Jt(1,8,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),b("ngClass",lt(11,Xh,!e.isLocked)),v(2),b("ngIf",e.isSelected)}}function xne(t,n){if(1&t&&Ee(0,"div",11),2&t){const e=M(3);b("ngClass",lt(1,Kh,e.isMagnetic))}}function Tne(t,n){if(1&t&&(_(0,"div",18),Qt(1,"safe"),J(2,xne,1,3,"div",10),w()),2&t){const e=M(2);vn("background-image",Jt(1,8,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),b("ngClass",lt(11,Xh,!e.isLocked)),v(2),b("ngIf",e.isSelected)}}function Dne(t,n){if(1&t&&Ee(0,"div",11),2&t){const e=M(3);b("ngClass",lt(1,Kh,e.isMagnetic))}}function Sne(t,n){if(1&t&&(_(0,"div",19),Qt(1,"safe"),J(2,Dne,1,3,"div",10),w()),2&t){const e=M(2);vn("background-image",Jt(1,8,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),b("ngClass",lt(11,Xh,!e.isLocked)),v(2),b("ngIf",e.isSelected)}}function Mne(t,n){if(1&t&&(Ae(0),J(1,Cne,3,13,"div",12)(2,Ene,3,13,"div",13)(3,Tne,3,13,"div",14)(4,Sne,3,13,"div",15),ke()),2&t){const e=M();v(),b("ngIf",e.isVisibleWallTopBottom),v(),b("ngIf",e.isVisibleWallTopBottom),v(),b("ngIf",e.isVisibleWallLeftRight),v(),b("ngIf",e.isVisibleWallLeftRight)}}let Ine=(()=>{class t{get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return mn.clampMin(this.terrain.height)}get width(){return mn.clampMin(this.terrain.width)}get depth(){return mn.clampMin(this.terrain.depth)}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get selectionState(){return this.selectionService.state(this.terrain)}get isSelected(){return this.selectionState!==Nt.NONE}get isMagnetic(){return this.selectionState===Nt.MAGNETIC}constructor(e,i,r,o,s,a,l,c,u,d){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=l,this.selectionService=c,this.pointerDeviceService=u,this.coordinateService=d,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.input=null}ngOnChanges(){Q.unregister(this),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new el(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Q.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Q.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),xe.play(pe.blockPick)}onMoved(){xe.play(pe.blockPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.terrain.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5730\u5f62",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLocked=!0),xe.play(pe.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,o.parent&&o.parent.appendChild(s)}),xe.play(pe.blockPut)}}]})}return e.push(gn),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate(),i=[];return i.push(this.isLocked?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLocked=!1,xe.play(pe.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLocked=!0,xe.play(pe.lock)}}),i.push(gn),i.push(this.hasWall?{name:"\u58c1\u3092\u975e\u8868\u793a",action:()=>{this.mode=bu.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}:{name:"\u58c1\u3092\u8868\u793a",action:()=>{this.mode=bu.ALL}}),this.isLocked||(i.push(gn),i.push({name:"\u91cd\u306a\u308a\u9806\u3092\u4e00\u756a\u4e0a\u306b",action:()=>{let r=this.terrain.parent;r&&r.appendChild(this.terrain)}}),i.push({name:"\u91cd\u306a\u308a\u9806\u3092\u4e00\u756a\u4e0b\u306b",action:()=>{let r=this.terrain.parent;r&&r.prependChild(this.terrain)}})),i.push(gn),i.push({name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}}),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.terrain.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(r),xe.play(pe.blockPut)}}),i.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),xe.play(pe.sweep)}}),i.push(gn),i.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}),i}showDetail(e){Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(zs,{title:r,left:i.x-250,top:i.y-150,width:500,height:300}).tabletopObject=e}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(Pu),L(UC),L(Zr),L(ti),L(yn),L(Zi),L($s),L(Ci),L(ql))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["terrain"]],hostBindings:function(i,r){1&i&&ue("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{terrain:"terrain",is3D:"is3D"},features:[Kn],decls:5,vars:14,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option","movable.disable"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","ngClass","rotable.option","rotable.disable"],[4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"rotate-grab","of-left-top","rotate-grab-icon"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-top","rotate-grab-icon"],[1,"texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"selected-highlight",3,"ngClass"],["class","texture of-wall-top chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-bottom chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-left chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-right chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"texture","of-wall-top","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-bottom","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-left","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-right","chrome-smooth-image-trick",3,"ngClass"]],template:function(i,r){1&i&&(_(0,"div",0),ue("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),_(1,"div",1),ue("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),J(2,_ne,14,0,"ng-container",2)(3,yne,4,12,"ng-container",2)(4,Mne,5,4,"ng-container",2),w()()),2&i&&(vn("width",r.width*r.gridSize,"px")("height",r.depth*r.gridSize,"px"),b("movable.option",r.movableOption)("movable.disable",r.isLocked),v(),b("ngClass",lt(12,mne,!r.isLocked))("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),v(),b("ngIf",!r.isLocked),v(),b("ngIf",r.hasFloor&&r.isVisibleFloor&&0<(null==r.floorImage?null:r.floorImage.url.length)),v(),b("ngIf",r.hasWall&&0<(null==r.wallImage?null:r.wallImage.url.length)))},dependencies:[Pi,xn,Al,tr,Fu,Ei],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.selected-highlight[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.pedestal-grab[_ngcontent-%COMP%]{position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blink 1s linear infinite alternate}@keyframes _ngcontent-%COMP%_blink{0%{opacity:.9}to{opacity:.5}}"],changeDetection:0})}return t})();const Ane=["cursor"],kne=["opacity"],One=()=>["is-front","is-back"];function Pne(t,n){if(1&t&&(_(0,"div",6)(1,"div",7),Qt(2,"safe"),_(3,"div",8)(4,"span",9),O(5),w()()()()),2&t){const e=n.$implicit,i=M(2);b("ngClass",e),v(),vn("background-image",Jt(2,4,"url("+i.iconUrl+")","style")),v(4),ht(i.name)}}function Nne(t,n){1&t&&(Ae(0),_(1,"div",3,0)(3,"div",4,1),J(5,Pne,6,7,"div",5),w()(),ke()),2&t&&(v(5),b("ngForOf",Dl(1,One)))}let Fne=(()=>{class t{get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get delayMs(){let e=16.6*(Be.peerIds.length+1);return e<100?100:e}constructor(e,i,r){this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=Bt.myCursor,this.cursorElement=null,this.opacityElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=o=>this.onMouseMove(o),this._x=0,this._y=0}ngOnInit(){this.isMine||Q.register(this).on("CURSOR_MOVE",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(e.data[0],e.data[1],e.data[2]),this.resetFadeOut()},this)})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Q.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(e){let i=e.touches?e.changedTouches[0].pageX:e.pageX,r=e.touches?e.changedTouches[0].pageY:e.pageY;i===this._x&&r===this._y||(this._x=i,this._y=r,this._target=e.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(e,i,r){if(!document.getElementById("app-table-layer").contains(r))return;let o={x:e,y:i,z:0};o=this.coordinateService.calcTabletopLocalCoordinate(o,r),Q.call("CURSOR_MOVE",[o.x,o.y,o.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new ha.b(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(e,i,r){this.cursorElement.style.transform=`translateX(${e.toFixed(4)}px) translateY(${i.toFixed(4)}px) translateZ(${r.toFixed(4)}px)`}static#e=this.\u0275fac=function(i){return new(i||t)(L(Pg),L(ql),L(kt))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(i,r){if(1&i&&(Qn(Ane,5),Qn(kne,5)),2&i){let o;Jn(o=ei())&&(r.cursorElementRef=o.first),Jn(o=ei())&&(r.opacityElementRef=o.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[["cursor",""],["opacity",""],[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],[1,"upright-transform","is-3d","is-transition"],["class","peer-cursor is-front",3,"ngClass",4,"ngFor","ngForOf"],[1,"peer-cursor","is-front",3,"ngClass"],[1,"icon"],[1,"name","is-center"],[2,"white-space","nowrap"]],template:function(i,r){1&i&&J(0,Nne,6,2,"ng-container",2),2&i&&b("ngIf",!r.isMine)},dependencies:[Pi,ii,xn,Ei],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg)}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;background-color:#f0dabde6;transform-origin:100% 100%;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]})}return t})();const Rne=["textArea"],Lne=(t,n,e)=>({"is-pointer-events-none":t,"is-pointer-events-auto":n,"is-outline-text":e}),tN=t=>({"is-magnetic":t});function Bne(t,n){if(1&t&&(_(0,"div",12),O(1),w()),2&t){const e=M();v(),ht(e.title)}}function jne(t,n){if(1&t&&Ee(0,"div",13),2&t){const e=M();b("ngClass",lt(1,tN,e.isMagnetic))}}function Une(t,n){if(1&t&&Ee(0,"div",13),2&t){const e=M();b("ngClass",lt(1,tN,e.isMagnetic))}}let Vne=(()=>{class t{get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return mn.clampMin(this.textNote.height)}get width(){return mn.clampMin(this.textNote.width)}get isActive(){return document.activeElement===this.textAreaElementRef.nativeElement}get selectionState(){return this.selectionService.state(this.textNote)}get isSelected(){return this.selectionState!==Nt.NONE}get isMagnetic(){return this.selectionState===Nt.MAGNETIC}constructor(e,i,r,o,s,a){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.changeDetector=o,this.selectionService=s,this.pointerDeviceService=a,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=l=>this.onMouseUp(l),this.gridSize=50,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={}}ngOnChanges(){Q.unregister(this),Q.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngOnDestroy(){Q.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isActive){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void Q.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(this.removeMouseEventListeners(),this.isActive||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.title)}onMove(){this.contextMenuService.close(),xe.play(pe.cardPick)}onMoved(){xe.play(pe.cardPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.textNote.location.x,y:this.textNote.location.y,z:this.textNote.posZ};return e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),e.push(gn),e}makeContextMenu(){let e=[];return e.push({name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.textNote.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),xe.play(pe.cardPut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),xe.play(pe.sweep)}}),e}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(zs,{title:r,left:i.x-350,top:i.y-200,width:700,height:400}).tabletopObject=e}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(Zr),L(yn),L(Zi),L($s),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["text-note"]],viewQuery:function(i,r){if(1&i&&Qn(Rne,7),2&i){let o;Jn(o=ei())&&(r.textAreaElementRef=o.first)}},hostBindings:function(i,r){1&i&&ue("dragstart",function(s){return r.onDragstart(s)})("mousedown",function(s){return r.onMouseDown(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{textNote:"textNote",is3D:"is3D"},features:[Kn],decls:18,vars:34,consts:[["textArea",""],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option","movable.disable"],["appRotable","",1,"is-3d",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[1,"upright-transform","is-front","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],["class","title is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea",3,"input","ngModelChange","ngClass","ngModel"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"upright-transform","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],[1,"title","is-black-background","is-pointer-events-none"],[1,"selected-highlight",3,"ngClass"]],template:function(i,r){if(1&i){const o=Ue();_(0,"div",1),ue("movable.ondragstart",function(){return re(o),oe(r.onMove())})("movable.ondragend",function(){return re(o),oe(r.onMoved())}),_(1,"div",2),ue("rotable.ondragstart",function(){return re(o),oe(r.onMove())})("rotable.ondragend",function(){return re(o),oe(r.onMoved())}),_(2,"div",3)(3,"div",4)(4,"i",5),O(5,"autorenew"),w()(),_(6,"div",6)(7,"i",5),O(8,"autorenew"),w()(),_(9,"div",7),Qt(10,"safe"),J(11,Bne,2,1,"div",8),_(12,"textarea",9,0),ue("input",function(){return re(o),oe(r.calcFitHeight())}),bt("ngModelChange",function(a){return re(o),pt(r.text,a)||(r.text=a),oe(a)}),w(),J(14,jne,1,3,"div",10),w(),_(15,"div",11),Qt(16,"safe"),J(17,Une,1,3,"div",10),w()()()()}2&i&&(b("movable.option",r.movableOption)("movable.disable",r.isActive),v(),b("rotable.option",r.rotableOption),v(),vn("width",r.width*r.gridSize,"px"),v(7),vn("background-image",Jt(10,24,"url("+(null==r.imageFile?null:r.imageFile.url)+")","style"))("width",r.width*r.gridSize,"px")("min-height",r.height*r.gridSize,"px"),v(2),b("ngIf",r.title.length),v(),vn("font-size",r.fontSize+9,"px"),b("ngClass",Bp(30,Lne,!r.isActive,r.isActive,!r.isActive)),yt("ngModel",r.text),v(2),b("ngIf",r.isSelected),v(),vn("background-image",Jt(16,27,"url("+(null==r.imageFile?null:r.imageFile.url)+")","style"))("width",r.width*r.gridSize,"px")("min-height",r.height*r.gridSize,"px"),v(2),b("ngIf",r.isSelected))},dependencies:[Pi,xn,hr,Ar,pr,tr,Fu,Ei],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:#ffffffbf}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;box-sizing:border-box;height:100%;width:100%;top:0;left:0;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0})}return t})();const Hne=t=>({"is-gray-border":t}),zne=()=>["0","180deg"],Gne=t=>({"is-magnetic":t}),nN=t=>({transform:t}),$ne=(t,n)=>({"is-black-mask":t,"is-harf-black-mask":n});function Wne(t,n){1&t&&(Ae(0),_(1,"div",12)(2,"div",13)(3,"div",14),O(4,"autorenew"),w(),_(5,"div",15),O(6,"autorenew"),w()()(),ke())}function qne(t,n){if(1&t&&Ee(0,"div",16),2&t){const e=M();b("ngClass",lt(1,Gne,e.isMagnetic))}}function Zne(t,n){if(1&t&&(_(0,"span"),O(1),w()),2&t){const e=M(3);v(),ht(e.face)}}function Yne(t,n){1&t&&(_(0,"span"),O(1,"???"),w())}function Xne(t,n){if(1&t&&(_(0,"div",19)(1,"div"),O(2),J(3,Zne,2,1,"span",3)(4,Yne,2,0,"span",3),w()()),2&t){const e=M().$implicit,i=M();b("ngStyle",lt(4,nN,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),v(2),ki("",i.name,":"),v(),b("ngIf",i.isVisible),v(),b("ngIf",!i.isVisible)}}function Kne(t,n){if(1&t&&(_(0,"div",20)(1,"div"),O(2),w()()),2&t){const e=M().$implicit,i=M();b("ngStyle",lt(2,nN,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),v(2),ht(i.ownerName)}}function Qne(t,n){if(1&t&&(Ae(0),J(1,Xne,5,6,"div",17)(2,Kne,3,4,"div",18),ke()),2&t){const e=M();v(),b("ngIf",0<e.name.length),v(),b("ngIf",e.hasOwner&&0<e.ownerName.length)}}function Jne(t,n){if(1&t&&(Ee(0,"img",21),Qt(1,"safe")),2&t){const e=M();b("src",Jt(1,2,e.imageFile.url,"resourceUrl"),_i)("ngClass",qi(5,$ne,!e.isVisible,e.isMine))}}let eie=(()=>{class t{get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return mn.clampMin(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get isVisible(){return this.diceSymbol.isVisible}get selectionState(){return this.selectionService.state(this.diceSymbol)}get isSelected(){return this.selectionState!==Nt.NONE}get isMagnetic(){return this.selectionState===Nt.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.selectionService=a,this.imageService=l,this.pointerDeviceService=c,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){Q.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),setTimeout(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on(`UPDATE_GAME_OBJECT/aliasName/${Bt.aliasName}`,e=>{let i=De.instance.get(e.data.identifier);this.diceSymbol&&i&&i.userId===this.diceSymbol.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Bt.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new VC(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),Q.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.ngZone.run(()=>this.startIconHiddenTimer())}onDoubleClick(){this.isVisible&&this.ngZone.run(()=>this.diceRoll())}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.diceSymbol.location.x+this.diceSymbol.size*this.gridSize/2,y:this.diceSymbol.location.y+this.diceSymbol.size*this.gridSize/2,z:this.diceSymbol.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.diceSymbol.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30c0\u30a4\u30b9",action:null,subActions:[{name:"\u3059\u3079\u3066\u632f\u308b",action:()=>{let o=!1;r().forEach(s=>{s.isVisible&&(o=!0,Q.call("ROLL_DICE_SYMBOL",{identifier:s.identifier}),s.diceRoll())}),o&&xe.play(pe.diceRoll1)}},{name:"\u3059\u3079\u3066\u516c\u958b",action:()=>{r().forEach(o=>o.owner=""),xe.play(pe.unlock)}},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{r().forEach(o=>o.owner=Be.peer.userId),xe.play(pe.lock)}}]})}return e.push(gn),e}makeContextMenu(){let e=[];if(this.isVisible&&e.push({name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()}}),e.length&&e.push(gn),(this.isMine||this.hasOwner)&&e.push({name:"\u30c0\u30a4\u30b9\u3092\u516c\u958b",action:()=>{this.owner="",xe.play(pe.unlock)}}),this.isMine||e.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=Be.peer.userId,xe.play(pe.lock)}}),this.isVisible){let i=[];this.faces.forEach(r=>{i.push({name:`${r}`,action:()=>{this.face=r,xe.play(pe.dicePut)}})}),e.push({name:"\u30c0\u30a4\u30b9\u76ee\u3092\u8a2d\u5b9a",action:null,subActions:i})}return e.push(gn),e.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.diceSymbol.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),xe.play(pe.dicePut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),xe.play(pe.sweep)}}),e}onMove(){this.contextMenuService.close(),xe.play(pe.dicePick)}onMoved(){xe.play(pe.dicePut)}diceRoll(){return Q.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),xe.play(pe.diceRoll1),this.diceSymbol.diceRoll()}showDetail(e){Q.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(zs,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(yn),L(Zr),L(ti),L(Zi),L($s),L(Pu),L(Ci))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["dice-symbol"]],hostBindings:function(i,r){1&i&&ue("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},features:[Kn],decls:13,vars:20,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[4,"ngIf"],[1,"pedestal-inner",3,"ngClass"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[4,"ngFor","ngForOf"],["class","image chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"selected-highlight",3,"ngClass"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","owner-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"owner-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"image","chrome-smooth-image-trick",3,"src","ngClass"]],template:function(i,r){1&i&&(_(0,"div",0),ue("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),_(1,"div",1)(2,"div",2),ue("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),J(3,Wne,7,0,"ng-container",3),Ee(4,"div",4),J(5,qne,1,3,"div",5),Ee(6,"div",6),_(7,"div",1),ue("@diceRoll.done",function(s){return r.animationShuffleDone(s)}),_(8,"div",7)(9,"div",8)(10,"div",9),J(11,Qne,3,2,"ng-container",10)(12,Jne,2,8,"img",11),w()()()()()()()),2&i&&(vn("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),b("movable.option",r.movableOption),v(),b("@bounceInOut","in"),v(),b("rotable.option",r.rotableOption),v(),b("ngIf",!r.isIconHidden),v(),b("ngClass",lt(17,Hne,r.hasOwner)),v(),b("ngIf",r.isSelected),v(2),b("@diceRoll",r.animeState),v(2),vn("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),v(2),b("ngForOf",Dl(19,zne)),v(),b("ngIf",0<r.imageFile.url.length))},dependencies:[Pi,ii,xn,Al,tr,Fu,Ei],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[xs("diceRoll",[Xi("* => active",[Yi("800ms ease",Xo([Tt({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),Tt({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),Tt({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),Tt({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),Tt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])]),xs("bounceInOut",[Xi("void => *",[Yi("600ms ease",Xo([Tt({transform:"scale3d(0, 0, 0)",offset:0}),Tt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Tt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Tt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Tt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xi("* => void",[Yi(100,Tt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0})}return t})();const tie=["root"],nie=["gameTable"],iie=["gameObjects"],rie=["gridCanvas"],oie=["pickArea"],sie=["pickCursor"],aie=(t,n)=>[t,n],lie=t=>({"is-grabbing":t}),cie=t=>({"z-index":t}),iN=(t,n)=>({"z-index":t,transform:n});function uie(t,n){1&t&&Ee(0,"terrain",23),2&t&&b("terrain",n.$implicit)}function die(t,n){1&t&&Ee(0,"game-table-mask",24),2&t&&b("gameTableMask",n.$implicit)}function hie(t,n){if(1&t&&Ee(0,"text-note",25),2&t){const e=n.$implicit;b("textNote",e)("appTooltip",e)("ngStyle",lt(3,cie,e.zindex))}}function fie(t,n){if(1&t&&Ee(0,"card-stack",26),2&t){const e=n.$implicit;b("cardStack",e)("appTooltip",e)("ngStyle",qi(3,iN,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function pie(t,n){if(1&t&&Ee(0,"card",27),2&t){const e=n.$implicit;b("card",e)("appTooltip",e)("ngStyle",qi(3,iN,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function mie(t,n){if(1&t&&Ee(0,"dice-symbol",28),2&t){const e=n.$implicit;b("diceSymbol",e)("appTooltip",e)}}function gie(t,n){if(1&t&&Ee(0,"game-character",29),2&t){const e=n.$implicit;b("gameCharacter",e)("appTooltip",e)}}function _ie(t,n){1&t&&Ee(0,"peer-cursor",30),2&t&&b("cursor",n.$implicit)}let vie=(()=>{class t{get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=o,this.imageService=s,this.tabletopService=a,this.tabletopActionService=l,this.selectionService=c,this.modalService=u,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null,this.pickGesture=null}ngOnInit(){Q.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture(),this.initializeTablePickGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){Q.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy(),this.pickGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new Pee(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new Iee(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}initializeTablePickGesture(){this.pickGesture=new Aee(this.rootElementRef.nativeElement,this.gameObjects.nativeElement,this.pickCursor.nativeElement,this.pickArea.nativeElement,this.pointerDeviceService,this.selectionService),this.pickGesture.onstart=this.onTablePickStart.bind(this),this.pickGesture.onend=this.onTablePickEnd.bind(this),this.pickGesture.oncancelifneeded=this.onTablePickCancelIfNeeded.bind(this),this.pickGesture.onpick=this.onTablePick.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,l,c){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),c.cancelable&&c.preventDefault();let u=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=u,i*=u,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,o,s,a,l,c){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),c.cancelable&&c.preventDefault();let u=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=u,i*=u,r,o,s,a),this.isTableTransformed=!0}onTablePickStart(){this.isTableTransformMode=!1,xe.playLocal(pe.selectionStart),this.pickGesture.isMagneticMode||(this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+"")}onTablePickEnd(){this.pickGesture.isKeepSelection||requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.contextMenuService.isShow||this.selectionService.clear()})})}onTablePickCancelIfNeeded(){return this.isTableTransformMode}onTablePick(){!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close())}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];0<this.selectionService.size&&(o.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>{this.selectionService.congregate(r)},enabled:0<this.selectionService.size}),o.push(gn)),Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(gn),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(qP)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a){this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r,this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=Gl.SQUARE,s="#000000e6"){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new Mee(this.gridCanvas.nativeElement).render(e,i,r,o,s),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}static#e=this.\u0275fac=function(i){return new(i||t)(L(kt),L(Zr),L(Ci),L(ql),L(Pu),L(i1),L(UC),L($s),L(gr))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["game-table"]],viewQuery:function(i,r){if(1&i&&(Qn(tie,7),Qn(nie,7),Qn(iie,7),Qn(rie,7),Qn(oie,7),Qn(sie,7)),2&i){let o;Jn(o=ei())&&(r.rootElementRef=o.first),Jn(o=ei())&&(r.gameTable=o.first),Jn(o=ei())&&(r.gameObjects=o.first),Jn(o=ei())&&(r.gridCanvas=o.first),Jn(o=ei())&&(r.pickArea=o.first),Jn(o=ei())&&(r.pickCursor=o.first)}},hostBindings:function(i,r){1&i&&ue("contextmenu",function(s){return r.onContextMenu(s)})("mousedown",function(s){return r.onDocumentMouseDown(s)},!1,Cd)("touchstart",function(s){return r.onDocumentTouchStart(s)},!1,Cd)("contextmenu",function(s){return r.onDocumentContextMenu(s)},!1,Cd)},decls:25,vars:33,consts:[["root",""],["gameTable",""],["gameObjects",""],["gridCanvas",""],["pickArea",""],["pickCursor",""],[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],[1,"component-content","is-fill","is-3d"],["id","app-game-table",1,"game-table","table-image","is-3d"],[1,"grid-canvas","is-fill","is-pointer-events-none"],["class","is-3d",3,"terrain",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameCharacter","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor",4,"ngFor","ngForOf","ngForTrackBy"],[1,"pick-area"],[1,"pick-cursor"],["xmlns","http://www.w3.org/2000/svg","width","100","height","100","viewBox","0 0 100 100"],["cx","50","cy","50","r","15"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(i,r){1&i&&(Ee(0,"div",6),Qt(1,"safe"),_(2,"div",7,0)(4,"div",8,1)(6,"div",9,2),Qt(8,"safe"),Ee(9,"canvas",10,3),J(11,uie,1,1,"terrain",11)(12,die,1,1,"game-table-mask",12)(13,hie,1,5,"text-note",13)(14,fie,1,6,"card-stack",14)(15,pie,1,6,"card",15)(16,mie,1,2,"dice-symbol",16)(17,gie,1,2,"game-character",17)(18,_ie,1,1,"peer-cursor",18),w()()(),Ee(19,"div",19,4),_(21,"div",20,5),function Xw(){wt.lFrame.currentNamespace="svg"}(),_(23,"svg",21),Ee(24,"circle",22),w()()),2&i&&(vn("background-image",Jt(1,22,"url("+r.backgroundImage.url+")","style")),b("ngClass",qi(28,aie,r.backgroundFilterType?"is-filter":"",r.backgroundFilterType)),v(2),b("ngClass",lt(31,lie,r.isPointerDragging)),v(4),vn("background-image",Jt(8,25,"url("+r.tableImage.url+")","style")),v(5),b("ngForOf",r.terrains)("ngForTrackBy",r.trackByGameObject),v(),b("ngForOf",r.tableMasks)("ngForTrackBy",r.trackByGameObject),v(),b("ngForOf",r.textNotes)("ngForTrackBy",r.trackByGameObject),v(),b("ngForOf",r.cardStacks)("ngForTrackBy",r.trackByGameObject),v(),b("ngForOf",r.cards)("ngForTrackBy",r.trackByGameObject),v(),b("ngForOf",r.diceSymbols)("ngForTrackBy",r.trackByGameObject),v(),b("ngForOf",r.characters)("ngForTrackBy",r.trackByGameObject),v(),b("ngForOf",r.peerCursors)("ngForTrackBy",r.trackByGameObject))},dependencies:[Pi,ii,Al,Vee,Jte,sne,pne,Ine,Fne,Vne,eie,eN,Ei],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:none;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.3s ease-out;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.pick-area[_ngcontent-%COMP%]{position:absolute;display:none;background-color:#00a8ff1a;border:1px solid hsl(200,100%,50%);pointer-events:none}.pick-cursor[_ngcontent-%COMP%]{position:absolute;display:none;scale:1;transition:scale .2s ease-out;stroke:#0af;pointer-events:none}.pick-cursor[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:rotate(-90deg)}.pick-cursor[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:#e5f6ffb3;stroke:inherit;stroke-width:4;animation-name:_ngcontent-%COMP%_circle-animation,_ngcontent-%COMP%_circle-fill;animation-timing-function:linear,ease-out;animation-duration:.85s,.85s}@keyframes _ngcontent-%COMP%_circle-animation{0%{stroke-dasharray:0 94.3}55%{stroke-dasharray:0 94.3}99.9%,to{stroke-dasharray:94.3 94.3}}@keyframes _ngcontent-%COMP%_circle-fill{0%{opacity:0}45%{opacity:0}99.9%,to{opacity:1}}']})}return t})(),yie=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};Q.register(this).on("*",i=>{this.needRepeat||Be.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){Q.unregister(this)}static#e=this.\u0275fac=function(i){return new(i||t)(L(ti))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(i,r){1&i&&(_(0,"div",0),Ee(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),_(10,"div",10),O(11,"sync"),w()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]})}return t})();const bie=["modalLayer"];function Cie(t,n){if(1&t){const e=Ue();_(0,"li",3),ue("click",function(){return re(e),oe(M().save())}),_(1,"a",4)(2,"div")(3,"i",6),O(4,"sd_storage"),w()(),_(5,"div"),O(6,"\u4fdd\u5b58"),w()()()}}function wie(t,n){if(1&t&&(_(0,"li",11)(1,"a")(2,"div")(3,"i",12),O(4,"sd_storage"),w()(),_(5,"div"),O(6),w()()()),2&t){const e=M();v(6),ki("",e.progresPercent,"%")}}let Eie=(()=>{class t{constructor(e,i,r,o,s,a,l){var c=this;this.modalService=e,this.panelService=i,this.pointerDeviceService=r,this.chatMessageService=o,this.appConfigService=s,this.saveDataService=a,this.ngZone=l,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.ngZone.runOutsideAngular(()=>{Us.instance.initialize(),ku.instance.initialize(),Cu.instance.initialize(),Ou.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),_a.instance.initialize(),Is.instance.initialize(),ks.instance.initialize(),new Vs("DiceBot").initialize(),Vs.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new Jl("Jukebox").initialize(),new xe("SoundEffect").initialize(),Is.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),Is.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab");let f=pn.createEmpty("none_icon").toContext();f.url="./assets/images/ic_account_circle_black_24dp_2x.png";let m=Dt.instance.add(f);nt.resumeAudioContext(),pe.dicePick=at.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,pe.dicePut=at.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,pe.diceRoll1=at.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,pe.diceRoll2=at.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,pe.cardDraw=at.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,pe.cardPick=at.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,pe.cardPut=at.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,pe.cardShuffle=at.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,pe.piecePick=at.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,pe.piecePut=at.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,pe.blockPick=at.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,pe.blockPut=at.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,pe.lock=at.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,pe.unlock=at.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,pe.sweep=at.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,pe.selectionStart=at.instance.add("./assets/sounds/soundeffect-lab/decision50.mp3").identifier,at.instance.get(pe.dicePick).isHidden=!0,at.instance.get(pe.dicePut).isHidden=!0,at.instance.get(pe.diceRoll1).isHidden=!0,at.instance.get(pe.diceRoll2).isHidden=!0,at.instance.get(pe.cardDraw).isHidden=!0,at.instance.get(pe.cardPick).isHidden=!0,at.instance.get(pe.cardPut).isHidden=!0,at.instance.get(pe.cardShuffle).isHidden=!0,at.instance.get(pe.piecePick).isHidden=!0,at.instance.get(pe.piecePut).isHidden=!0,at.instance.get(pe.blockPick).isHidden=!0,at.instance.get(pe.blockPut).isHidden=!0,at.instance.get(pe.lock).isHidden=!0,at.instance.get(pe.unlock).isHidden=!0,at.instance.get(pe.sweep).isHidden=!0,at.instance.get(pe.selectionStart).isHidden=!0,Bt.createMyCursor(),Bt.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc",Bt.myCursor.imageIdentifier=m.identifier,Q.register(this).on("UPDATE_GAME_OBJECT",p=>{this.lazyNgZoneUpdate(p.isSendFromSelf)}).on("DELETE_GAME_OBJECT",p=>{this.lazyNgZoneUpdate(p.isSendFromSelf)}).on("UPDATE_SELECTION",p=>{this.lazyNgZoneUpdate(p.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",p=>{p.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",p=>{p.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",p=>{console.log("LOAD_CONFIG !!!"),Be.configure(p.data),Be.open()}).on("FILE_LOADED",p=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",p=>{console.log("OPEN_NETWORK",p.data.peerId),Bt.myCursor.peerId=Be.peer.peerId,Bt.myCursor.userId=Be.peer.userId}).on("NETWORK_ERROR",p=>{console.log("NETWORK_ERROR",p.data.peerId);let g=p.data.errorType,y=p.data.errorMessage;this.ngZone.run((0,E.A)(function*(){["peer-unavailable"].includes(g)||(yield c.modalService.open(LC,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:y}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(g)&&(yield c.modalService.open(LC,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),Be.open()))}))}).on("CONNECT_PEER",p=>{p.isSendFromSelf&&this.chatMessageService.calibrateTimeOffset(),this.lazyNgZoneUpdate(p.isSendFromSelf)}).on("DISCONNECT_PEER",p=>{this.lazyNgZoneUpdate(p.isSendFromSelf)}),function xie(){let t=window.navigator.userAgent.toLowerCase();if(t.indexOf("iphone")>-1||t.indexOf("ipad")>-1||t.indexOf("macintosh")>-1&&"ontouchend"in document){let e=document.createElement("style");e.innerHTML="\n      .chrome-smooth-image-trick {\n        transform-style: flat;\n      }\n      ",document.body.appendChild(e)}}()}ngAfterViewInit(){yn.defaultParentViewContainerRef=gr.defaultParentViewContainerRef=Zr.defaultParentViewContainerRef=this.modalLayerViewContainerRef,setTimeout(()=>{this.panelService.open(ZP,{width:500,height:450,left:100}),this.panelService.open($P,{width:700,height:400,left:100,top:450})},0)}ngOnDestroy(){Q.unregister(this)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":i=ZP;break;case"ChatWindowComponent":i=$P,r.width=700;break;case"GameTableSettingComponent":i=qP,r={width:630,height:400,left:100};break;case"FileStorageComponent":i=WK;break;case"GameCharacterSheetComponent":i=zs;break;case"JukeboxComponent":i=RJ;break;case"GameObjectInventoryComponent":i=mJ}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,E.A)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=0<Be.peer.roomName.length?Be.peer.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Us.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}static#e=this.\u0275fac=function(i){return new(i||t)(L(gr),L(yn),L(Ci),L(Hl),L(Gm),L(Hs),L(kt))};static#t=this.\u0275cmp=Kt({type:t,selectors:[["app-root"]],viewQuery:function(i,r){if(1&i&&Qn(bie,7,zr),2&i){let o;Jn(o=ei())&&(r.modalLayerViewContainerRef=o.first)}},decls:61,vars:8,consts:[["modalLayer",""],["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","showTitleButtons"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(i,r){if(1&i){const o=Ue();_(0,"div",1),Ee(1,"game-table"),w(),_(2,"ui-panel",2)(3,"nav")(4,"ul")(5,"li",3),ue("click",function(){return re(o),oe(r.open("PeerMenuComponent"))}),_(6,"a",4)(7,"div")(8,"i",5),O(9,"people"),w()(),_(10,"div"),O(11,"\u63a5\u7d9a"),w()()(),_(12,"li",3),ue("click",function(){return re(o),oe(r.open("ChatWindowComponent"))}),_(13,"a",4)(14,"div")(15,"i",5),O(16,"speaker_notes"),w()(),_(17,"div"),O(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),w()()(),_(19,"li",3),ue("click",function(){return re(o),oe(r.open("GameTableSettingComponent"))}),_(20,"a",4)(21,"div")(22,"i",5),O(23,"layers"),w()(),_(24,"div"),O(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),w()()(),_(26,"li",3),ue("click",function(){return re(o),oe(r.open("FileStorageComponent"))}),_(27,"a",4)(28,"div")(29,"i",5),O(30,"photo_library"),w()(),_(31,"div"),O(32,"\u753b\u50cf"),w()()(),_(33,"li",3),ue("click",function(){return re(o),oe(r.open("JukeboxComponent"))}),_(34,"a",4)(35,"div")(36,"i",6),O(37,"queue_music"),w()(),_(38,"div"),O(39,"\u97f3\u697d"),w()()(),_(40,"li",3),ue("click",function(){return re(o),oe(r.open("GameObjectInventoryComponent"))}),_(41,"a",4)(42,"div")(43,"i",5),O(44,"folder_shared"),w()(),_(45,"div"),O(46,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),w()()(),_(47,"li")(48,"a",4)(49,"label")(50,"div")(51,"i",6),O(52,"open_in_browser"),w()(),_(53,"div"),O(54,"ZIP\u8aad\u8fbc"),w(),_(55,"input",7),ue("change",function(a){return re(o),oe(r.handleFileSelect(a))}),w()()()(),J(56,Cie,7,0,"li",8)(57,wie,7,1,"li",9),w()()(),Ee(58,"div",null,0)(60,"network-indicator",10)}2&i&&(v(2),b("top",0)("left",0)("width",100)("height",470)("title","\u30e1\u30cb\u30e5\u30fc")("showTitleButtons",!1),v(54),b("ngIf",!r.isSaveing),v(),b("ngIf",r.isSaveing))},dependencies:[xn,vie,XP,yie],styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer;white-space:nowrap}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_vibration .2s infinite}@keyframes _ngcontent-%COMP%_vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}"]})}return t})();yn.UIPanelComponentClass=XP,Zr.ContextMenuComponentClass=HK,gr.ModalComponentClass=jJ;let Tie=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ta({type:t,bootstrap:[Eie]});static#n=this.\u0275inj=Xs({providers:[Gm,Hl,Zr,gr,ga,yn,Ci,i1],imports:[Q2,D$,I2,Oz]})}return t})();V7().bootstrapModule(Tie).catch(t=>console.error(t))},7385:je=>{"use strict";je.exports=function Y(V){if(V.length>=255)throw new TypeError("Alphabet too long");for(var E=new Uint8Array(256),Z=0;Z<E.length;Z++)E[Z]=255;for(var R=0;R<V.length;R++){var P=V.charAt(R),k=P.charCodeAt(0);if(255!==E[k])throw new TypeError(P+" is ambiguous");E[k]=R}var I=V.length,S=V.charAt(0),j=Math.log(I)/Math.log(256),A=Math.log(256)/Math.log(I);function F(W){if("string"!=typeof W)throw new TypeError("Expected String");if(0===W.length)return new Uint8Array;for(var U=0,ne=0,me=0;W[U]===S;)ne++,U++;for(var Ve=(W.length-U)*j+1>>>0,K=new Uint8Array(Ve);W[U];){var de=E[W.charCodeAt(U)];if(255===de)return;for(var fe=0,Le=Ve-1;(0!==de||fe<me)&&-1!==Le;Le--,fe++)K[Le]=(de+=I*K[Le]>>>0)%256>>>0,de=de/256>>>0;if(0!==de)throw new Error("Non-zero carry");me=fe,U++}for(var qe=Ve-me;qe!==Ve&&0===K[qe];)qe++;for(var ie=new Uint8Array(ne+(Ve-qe)),it=ne;qe!==Ve;)ie[it++]=K[qe++];return ie}return{encode:function T(W){if(W instanceof Uint8Array||(ArrayBuffer.isView(W)?W=new Uint8Array(W.buffer,W.byteOffset,W.byteLength):Array.isArray(W)&&(W=Uint8Array.from(W))),!(W instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===W.length)return"";for(var U=0,ne=0,me=0,Ve=W.length;me!==Ve&&0===W[me];)me++,U++;for(var K=(Ve-me)*A+1>>>0,de=new Uint8Array(K);me!==Ve;){for(var fe=W[me],Le=0,qe=K-1;(0!==fe||Le<ne)&&-1!==qe;qe--,Le++)de[qe]=(fe+=256*de[qe]>>>0)%I>>>0,fe=fe/I>>>0;if(0!==fe)throw new Error("Non-zero carry");ne=Le,me++}for(var ie=K-ne;ie!==K&&0===de[ie];)ie++;for(var it=S.repeat(U);ie<K;++ie)it+=V.charAt(de[ie]);return it},decodeUnsafe:F,decode:function q(W){var U=F(W);if(U)return U;throw new Error("Non-base"+I+" character")}}}},7656:function(je,Y,V){var E;je.exports=(E=E||function(Z,R){var P;if(typeof window<"u"&&window.crypto&&(P=window.crypto),typeof self<"u"&&self.crypto&&(P=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(P=globalThis.crypto),!P&&typeof window<"u"&&window.msCrypto&&(P=window.msCrypto),!P&&typeof global<"u"&&global.crypto&&(P=global.crypto),!P)try{P=V(477)}catch{}var k=function(){if(P){if("function"==typeof P.getRandomValues)try{return P.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof P.randomBytes)try{return P.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},I=Object.create||function(){function K(){}return function(de){var fe;return K.prototype=de,fe=new K,K.prototype=null,fe}}(),S={},j=S.lib={},A=j.Base=function(){return{extend:function(K){var de=I(this);return K&&de.mixIn(K),(!de.hasOwnProperty("init")||this.init===de.init)&&(de.init=function(){de.$super.init.apply(this,arguments)}),de.init.prototype=de,de.$super=this,de},create:function(){var K=this.extend();return K.init.apply(K,arguments),K},init:function(){},mixIn:function(K){for(var de in K)K.hasOwnProperty(de)&&(this[de]=K[de]);K.hasOwnProperty("toString")&&(this.toString=K.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),T=j.WordArray=A.extend({init:function(K,de){K=this.words=K||[],this.sigBytes=null!=de?de:4*K.length},toString:function(K){return(K||q).stringify(this)},concat:function(K){var de=this.words,fe=K.words,Le=this.sigBytes,qe=K.sigBytes;if(this.clamp(),Le%4)for(var ie=0;ie<qe;ie++)de[Le+ie>>>2]|=(fe[ie>>>2]>>>24-ie%4*8&255)<<24-(Le+ie)%4*8;else for(var Ft=0;Ft<qe;Ft+=4)de[Le+Ft>>>2]=fe[Ft>>>2];return this.sigBytes+=qe,this},clamp:function(){var K=this.words,de=this.sigBytes;K[de>>>2]&=4294967295<<32-de%4*8,K.length=Z.ceil(de/4)},clone:function(){var K=A.clone.call(this);return K.words=this.words.slice(0),K},random:function(K){for(var de=[],fe=0;fe<K;fe+=4)de.push(k());return new T.init(de,K)}}),F=S.enc={},q=F.Hex={stringify:function(K){for(var de=K.words,fe=K.sigBytes,Le=[],qe=0;qe<fe;qe++){var ie=de[qe>>>2]>>>24-qe%4*8&255;Le.push((ie>>>4).toString(16)),Le.push((15&ie).toString(16))}return Le.join("")},parse:function(K){for(var de=K.length,fe=[],Le=0;Le<de;Le+=2)fe[Le>>>3]|=parseInt(K.substr(Le,2),16)<<24-Le%8*4;return new T.init(fe,de/2)}},W=F.Latin1={stringify:function(K){for(var de=K.words,fe=K.sigBytes,Le=[],qe=0;qe<fe;qe++)Le.push(String.fromCharCode(de[qe>>>2]>>>24-qe%4*8&255));return Le.join("")},parse:function(K){for(var de=K.length,fe=[],Le=0;Le<de;Le++)fe[Le>>>2]|=(255&K.charCodeAt(Le))<<24-Le%4*8;return new T.init(fe,de)}},U=F.Utf8={stringify:function(K){try{return decodeURIComponent(escape(W.stringify(K)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(K){return W.parse(unescape(encodeURIComponent(K)))}},ne=j.BufferedBlockAlgorithm=A.extend({reset:function(){this._data=new T.init,this._nDataBytes=0},_append:function(K){"string"==typeof K&&(K=U.parse(K)),this._data.concat(K),this._nDataBytes+=K.sigBytes},_process:function(K){var de,fe=this._data,Le=fe.words,qe=fe.sigBytes,ie=this.blockSize,Ft=qe/(4*ie),He=(Ft=K?Z.ceil(Ft):Z.max((0|Ft)-this._minBufferSize,0))*ie,Fe=Z.min(4*He,qe);if(He){for(var gt=0;gt<He;gt+=ie)this._doProcessBlock(Le,gt);de=Le.splice(0,He),fe.sigBytes-=Fe}return new T.init(de,Fe)},clone:function(){var K=A.clone.call(this);return K._data=this._data.clone(),K},_minBufferSize:0}),Ve=(j.Hasher=ne.extend({cfg:A.extend(),init:function(K){this.cfg=this.cfg.extend(K),this.reset()},reset:function(){ne.reset.call(this),this._doReset()},update:function(K){return this._append(K),this._process(),this},finalize:function(K){return K&&this._append(K),this._doFinalize()},blockSize:16,_createHelper:function(K){return function(de,fe){return new K.init(fe).finalize(de)}},_createHmacHelper:function(K){return function(de,fe){return new Ve.HMAC.init(K,fe).finalize(de)}}}),S.algo={});return S}(Math),E)},8823:function(je,Y,V){var E;je.exports=(E=V(7656),function(){if("function"==typeof ArrayBuffer){var P=E.lib.WordArray,k=P.init,I=P.init=function(S){if(S instanceof ArrayBuffer&&(S=new Uint8Array(S)),(S instanceof Int8Array||typeof Uint8ClampedArray<"u"&&S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array)&&(S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength)),S instanceof Uint8Array){for(var j=S.byteLength,A=[],T=0;T<j;T++)A[T>>>2]|=S[T]<<24-T%4*8;k.call(this,A,j)}else k.apply(this,arguments)};I.prototype=P}}(),E.lib.WordArray)},5168:function(je,Y,V){var E;je.exports=(E=V(7656),function(Z){var R=E,P=R.lib,k=P.WordArray,I=P.Hasher,S=R.algo,j=[],A=[];!function(){function q(me){for(var Ve=Z.sqrt(me),K=2;K<=Ve;K++)if(!(me%K))return!1;return!0}function W(me){return 4294967296*(me-(0|me))|0}for(var U=2,ne=0;ne<64;)q(U)&&(ne<8&&(j[ne]=W(Z.pow(U,.5))),A[ne]=W(Z.pow(U,1/3)),ne++),U++}();var T=[],F=S.SHA256=I.extend({_doReset:function(){this._hash=new k.init(j.slice(0))},_doProcessBlock:function(q,W){for(var U=this._hash.words,ne=U[0],me=U[1],Ve=U[2],K=U[3],de=U[4],fe=U[5],Le=U[6],qe=U[7],ie=0;ie<64;ie++){if(ie<16)T[ie]=0|q[W+ie];else{var it=T[ie-15],He=T[ie-2];T[ie]=((it<<25|it>>>7)^(it<<14|it>>>18)^it>>>3)+T[ie-7]+((He<<15|He>>>17)^(He<<13|He>>>19)^He>>>10)+T[ie-16]}var Ut=ne&me^ne&Ve^me&Ve,Je=qe+((de<<26|de>>>6)^(de<<21|de>>>11)^(de<<7|de>>>25))+(de&fe^~de&Le)+A[ie]+T[ie];qe=Le,Le=fe,fe=de,de=K+Je|0,K=Ve,Ve=me,me=ne,ne=Je+(((ne<<30|ne>>>2)^(ne<<19|ne>>>13)^(ne<<10|ne>>>22))+Ut)|0}U[0]=U[0]+ne|0,U[1]=U[1]+me|0,U[2]=U[2]+Ve|0,U[3]=U[3]+K|0,U[4]=U[4]+de|0,U[5]=U[5]+fe|0,U[6]=U[6]+Le|0,U[7]=U[7]+qe|0},_doFinalize:function(){var q=this._data,W=q.words,U=8*this._nDataBytes,ne=8*q.sigBytes;return W[ne>>>5]|=128<<24-ne%32,W[14+(ne+64>>>9<<4)]=Z.floor(U/4294967296),W[15+(ne+64>>>9<<4)]=U,q.sigBytes=4*W.length,this._process(),this._hash},clone:function(){var q=I.clone.call(this);return q._hash=this._hash.clone(),q}});R.SHA256=I._createHelper(F),R.HmacSHA256=I._createHmacHelper(F)}(Math),E.SHA256)},8004:je=>{!function(V){je.exports=V;var E="listeners",Z={on:function P(A,T){return j(this,A).push(T),this},once:function k(A,T){var F=this;return q.originalListener=T,j(F,A).push(q),F;function q(){I.call(F,A,q),T.apply(this,arguments)}},off:I,emit:function S(A,T){var F=this,q=j(F,A,!0);if(!q)return!1;var W=arguments.length;if(1===W)q.forEach(function ne(K){K.call(F)});else if(2===W)q.forEach(function me(K){K.call(F,T)});else{var U=Array.prototype.slice.call(arguments,1);q.forEach(function Ve(K){K.apply(F,U)})}return!!q.length}};function R(A){for(var T in Z)A[T]=Z[T];return A}function I(A,T){var q,F=this;if(arguments.length){if(T){if(q=j(F,A,!0)){if(!(q=q.filter(function W(U){return U!==T&&U.originalListener!==T})).length)return I.call(F,A);F[E][A]=q}}else if((q=F[E])&&(delete q[A],!Object.keys(q).length))return I.call(F)}else delete F[E];return F}function j(A,T,F){if(!F||A[E]){var q=A[E]||(A[E]={});return q[T]||(q[T]=[])}}R(V.prototype),V.mixin=R}(function Y(){if(!(this instanceof Y))return new Y})},2578:function(je,Y){var V,Z;void 0!==(Z="function"==typeof(V=function(){"use strict";function P(T,F,q){var W=new XMLHttpRequest;W.open("GET",T),W.responseType="blob",W.onload=function(){A(W.response,F,q)},W.onerror=function(){console.error("could not download file")},W.send()}function k(T){var F=new XMLHttpRequest;F.open("HEAD",T,!1);try{F.send()}catch{}return 200<=F.status&&299>=F.status}function I(T){try{T.dispatchEvent(new MouseEvent("click"))}catch{var F=document.createEvent("MouseEvents");F.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),T.dispatchEvent(F)}}var S="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,j=S.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),A=S.saveAs||("object"!=typeof window||window!==S?function(){}:"download"in HTMLAnchorElement.prototype&&!j?function(T,F,q){var W=S.URL||S.webkitURL,U=document.createElement("a");U.download=F=F||T.name||"download",U.rel="noopener","string"==typeof T?(U.href=T,U.origin===location.origin?I(U):k(U.href)?P(T,F,q):I(U,U.target="_blank")):(U.href=W.createObjectURL(T),setTimeout(function(){W.revokeObjectURL(U.href)},4e4),setTimeout(function(){I(U)},0))}:"msSaveOrOpenBlob"in navigator?function(T,F,q){if(F=F||T.name||"download","string"!=typeof T)navigator.msSaveOrOpenBlob(function R(T,F){return typeof F>"u"?F={autoBom:!1}:"object"!=typeof F&&(console.warn("Deprecated: Expected third argument to be a object"),F={autoBom:!F}),F.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(T.type)?new Blob(["\ufeff",T],{type:T.type}):T}(T,q),F);else if(k(T))P(T,F,q);else{var W=document.createElement("a");W.href=T,W.target="_blank",setTimeout(function(){I(W)})}}:function(T,F,q,W){if((W=W||open("","_blank"))&&(W.document.title=W.document.body.innerText="downloading..."),"string"==typeof T)return P(T,F,q);var U="application/octet-stream"===T.type,ne=/constructor/i.test(S.HTMLElement)||S.safari,me=/CriOS\/[\d]+/.test(navigator.userAgent);if((me||U&&ne||j)&&typeof FileReader<"u"){var Ve=new FileReader;Ve.onloadend=function(){var fe=Ve.result;fe=me?fe:fe.replace(/^data:[^;]*;/,"data:attachment/file;"),W?W.location.href=fe:location=fe,W=null},Ve.readAsDataURL(T)}else{var K=S.URL||S.webkitURL,de=K.createObjectURL(T);W?W.location=de:location.href=de,W=null,setTimeout(function(){K.revokeObjectURL(de)},4e4)}});S.saveAs=A.saveAs=A,je.exports=A})?V.apply(Y,[]):V)&&(je.exports=Z)},4511:(je,Y,V)=>{var E;!function(Z,R,P,k){"use strict";var me,I=["","webkit","Moz","MS","ms","o"],S=R.createElement("div"),j="function",A=Math.round,T=Math.abs,F=Date.now;function q(x,D,B){return setTimeout(fe(x,B),D)}function W(x,D,B){return!!Array.isArray(x)&&(U(x,B[D],B),!0)}function U(x,D,B){var G;if(x)if(x.forEach)x.forEach(D,B);else if(x.length!==k)for(G=0;G<x.length;)D.call(B,x[G],G,x),G++;else for(G in x)x.hasOwnProperty(G)&&D.call(B,x[G],G,x)}function ne(x,D,B){var G="DEPRECATED METHOD: "+D+"\n"+B+" AT \n";return function(){var be=new Error("get-stack-trace"),$e=be&&be.stack?be.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",zt=Z.console&&(Z.console.warn||Z.console.log);return zt&&zt.call(Z.console,G,$e),x.apply(this,arguments)}}me="function"!=typeof Object.assign?function(D){if(D===k||null===D)throw new TypeError("Cannot convert undefined or null to object");for(var B=Object(D),G=1;G<arguments.length;G++){var be=arguments[G];if(be!==k&&null!==be)for(var $e in be)be.hasOwnProperty($e)&&(B[$e]=be[$e])}return B}:Object.assign;var Ve=ne(function(D,B,G){for(var be=Object.keys(B),$e=0;$e<be.length;)(!G||G&&D[be[$e]]===k)&&(D[be[$e]]=B[be[$e]]),$e++;return D},"extend","Use `assign`."),K=ne(function(D,B){return Ve(D,B,!0)},"merge","Use `assign`.");function de(x,D,B){var be,G=D.prototype;(be=x.prototype=Object.create(G)).constructor=x,be._super=G,B&&me(be,B)}function fe(x,D){return function(){return x.apply(D,arguments)}}function Le(x,D){return typeof x==j?x.apply(D&&D[0]||k,D):x}function qe(x,D){return x===k?D:x}function ie(x,D,B){U(Fe(D),function(G){x.addEventListener(G,B,!1)})}function it(x,D,B){U(Fe(D),function(G){x.removeEventListener(G,B,!1)})}function Ft(x,D){for(;x;){if(x==D)return!0;x=x.parentNode}return!1}function He(x,D){return x.indexOf(D)>-1}function Fe(x){return x.trim().split(/\s+/g)}function gt(x,D,B){if(x.indexOf&&!B)return x.indexOf(D);for(var G=0;G<x.length;){if(B&&x[G][B]==D||!B&&x[G]===D)return G;G++}return-1}function Ut(x){return Array.prototype.slice.call(x,0)}function Pe(x,D,B){for(var G=[],be=[],$e=0;$e<x.length;){var zt=D?x[$e][D]:x[$e];gt(be,zt)<0&&G.push(x[$e]),be[$e]=zt,$e++}return B&&(G=D?G.sort(function(Bi,We){return Bi[D]>We[D]}):G.sort()),G}function Ke(x,D){for(var B,G,be=D[0].toUpperCase()+D.slice(1),$e=0;$e<I.length;){if((G=(B=I[$e])?B+be:D)in x)return G;$e++}return k}var Je=1;function bn(x){var D=x.ownerDocument||x;return D.defaultView||D.parentWindow||Z}var Li="ontouchstart"in Z,br=Ke(Z,"PointerEvent")!==k,nl=Li&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Fo="touch",Xe="mouse",sn=25,Wt=1,Xt=4,Ln=8,Qe=1,ft=2,_t=4,St=8,qt=16,Yn=ft|_t,mi=St|qt,Gi=Yn|mi,vo=["x","y"],yo=["clientX","clientY"];function Cr(x,D){var B=this;this.manager=x,this.callback=D,this.element=x.element,this.target=x.options.inputTarget,this.domHandler=function(G){Le(x.options.enable,[x])&&B.handler(G)},this.init()}function Lg(x,D,B){var G=B.pointers.length,be=B.changedPointers.length,$e=D&Wt&&G-be==0,zt=D&(Xt|Ln)&&G-be==0;B.isFirst=!!$e,B.isFinal=!!zt,$e&&(x.session={}),B.eventType=D,function Bg(x,D){var B=x.session,G=D.pointers,be=G.length;B.firstInput||(B.firstInput=os(D)),be>1&&!B.firstMultiple?B.firstMultiple=os(D):1===be&&(B.firstMultiple=!1);var $e=B.firstInput,zt=B.firstMultiple,Di=zt?zt.center:$e.center,Bi=D.center=il(G);D.timeStamp=F(),D.deltaTime=D.timeStamp-$e.timeStamp,D.angle=rl(Di,Bi),D.distance=nc(Di,Bi),function jg(x,D){var B=D.center,G=x.offsetDelta||{},be=x.prevDelta||{},$e=x.prevInput||{};(D.eventType===Wt||$e.eventType===Xt)&&(be=x.prevDelta={x:$e.deltaX||0,y:$e.deltaY||0},G=x.offsetDelta={x:B.x,y:B.y}),D.deltaX=be.x+(B.x-G.x),D.deltaY=be.y+(B.y-G.y)}(B,D),D.offsetDirection=tc(D.deltaX,D.deltaY);var We=Jh(D.deltaTime,D.deltaX,D.deltaY);D.overallVelocityX=We.x,D.overallVelocityY=We.y,D.overallVelocity=T(We.x)>T(We.y)?We.x:We.y,D.scale=zt?function Bu(x,D){return nc(D[0],D[1],yo)/nc(x[0],x[1],yo)}(zt.pointers,G):1,D.rotation=zt?function Ug(x,D){return rl(D[1],D[0],yo)+rl(x[1],x[0],yo)}(zt.pointers,G):0,D.maxPointers=B.prevInput?D.pointers.length>B.prevInput.maxPointers?D.pointers.length:B.prevInput.maxPointers:D.pointers.length,function Lu(x,D){var be,$e,zt,Di,B=x.lastInterval||D,G=D.timeStamp-B.timeStamp;if(D.eventType!=Ln&&(G>sn||B.velocity===k)){var Bi=D.deltaX-B.deltaX,We=D.deltaY-B.deltaY,Bo=Jh(G,Bi,We);$e=Bo.x,zt=Bo.y,be=T(Bo.x)>T(Bo.y)?Bo.x:Bo.y,Di=tc(Bi,We),x.lastInterval=D}else be=B.velocity,$e=B.velocityX,zt=B.velocityY,Di=B.direction;D.velocity=be,D.velocityX=$e,D.velocityY=zt,D.direction=Di}(B,D);var Bo=x.element;Ft(D.srcEvent.target,Bo)&&(Bo=D.srcEvent.target),D.target=Bo}(x,B),x.emit("hammer.input",B),x.recognize(B),x.session.prevInput=B}function os(x){for(var D=[],B=0;B<x.pointers.length;)D[B]={clientX:A(x.pointers[B].clientX),clientY:A(x.pointers[B].clientY)},B++;return{timeStamp:F(),pointers:D,center:il(D),deltaX:x.deltaX,deltaY:x.deltaY}}function il(x){var D=x.length;if(1===D)return{x:A(x[0].clientX),y:A(x[0].clientY)};for(var B=0,G=0,be=0;be<D;)B+=x[be].clientX,G+=x[be].clientY,be++;return{x:A(B/D),y:A(G/D)}}function Jh(x,D,B){return{x:D/x||0,y:B/x||0}}function tc(x,D){return x===D?Qe:T(x)>=T(D)?x<0?ft:_t:D<0?St:qt}function nc(x,D,B){B||(B=vo);var G=D[B[0]]-x[B[0]],be=D[B[1]]-x[B[1]];return Math.sqrt(G*G+be*be)}function rl(x,D,B){return B||(B=vo),180*Math.atan2(D[B[1]]-x[B[1]],D[B[0]]-x[B[0]])/Math.PI}Cr.prototype={handler:function(){},init:function(){this.evEl&&ie(this.element,this.evEl,this.domHandler),this.evTarget&&ie(this.target,this.evTarget,this.domHandler),this.evWin&&ie(bn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&it(this.element,this.evEl,this.domHandler),this.evTarget&&it(this.target,this.evTarget,this.domHandler),this.evWin&&it(bn(this.element),this.evWin,this.domHandler)}};var ic={mousedown:Wt,mousemove:2,mouseup:Xt},Vg="mousedown",ju="mousemove mouseup";function rc(){this.evEl=Vg,this.evWin=ju,this.pressed=!1,Cr.apply(this,arguments)}de(rc,Cr,{handler:function(D){var B=ic[D.type];B&Wt&&0===D.button&&(this.pressed=!0),2&B&&1!==D.which&&(B=Xt),this.pressed&&(B&Xt&&(this.pressed=!1),this.callback(this.manager,B,{pointers:[D],changedPointers:[D],pointerType:Xe,srcEvent:D}))}});var Uu={pointerdown:Wt,pointermove:2,pointerup:Xt,pointercancel:Ln,pointerout:Ln},Hg={2:Fo,3:"pen",4:Xe,5:"kinect"},zg="pointerdown",Vu="pointermove pointerup pointercancel";function ir(){this.evEl=zg,this.evWin=Vu,Cr.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Z.MSPointerEvent&&!Z.PointerEvent&&(zg="MSPointerDown",Vu="MSPointerMove MSPointerUp MSPointerCancel"),de(ir,Cr,{handler:function(D){var B=this.store,G=!1,be=D.type.toLowerCase().replace("ms",""),$e=Uu[be],zt=Hg[D.pointerType]||D.pointerType,Di=zt==Fo,Bi=gt(B,D.pointerId,"pointerId");$e&Wt&&(0===D.button||Di)?Bi<0&&(B.push(D),Bi=B.length-1):$e&(Xt|Ln)&&(G=!0),!(Bi<0)&&(B[Bi]=D,this.callback(this.manager,$e,{pointers:B,changedPointers:[D],pointerType:zt,srcEvent:D}),G&&B.splice(Bi,1))}});var ef={touchstart:Wt,touchmove:2,touchend:Xt,touchcancel:Ln};function tf(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,Cr.apply(this,arguments)}function ol(x,D){var B=Ut(x.touches),G=Ut(x.changedTouches);return D&(Xt|Ln)&&(B=Pe(B.concat(G),"identifier",!0)),[B,G]}de(tf,Cr,{handler:function(D){var B=ef[D.type];if(B===Wt&&(this.started=!0),this.started){var G=ol.call(this,D,B);B&(Xt|Ln)&&G[0].length-G[1].length==0&&(this.started=!1),this.callback(this.manager,B,{pointers:G[0],changedPointers:G[1],pointerType:Fo,srcEvent:D})}}});var nf={touchstart:Wt,touchmove:2,touchend:Xt,touchcancel:Ln},Wg="touchstart touchmove touchend touchcancel";function oc(){this.evTarget=Wg,this.targetIds={},Cr.apply(this,arguments)}function Hu(x,D){var B=Ut(x.touches),G=this.targetIds;if(D&(2|Wt)&&1===B.length)return G[B[0].identifier]=!0,[B,B];var be,$e,zt=Ut(x.changedTouches),Di=[],Bi=this.target;if($e=B.filter(function(We){return Ft(We.target,Bi)}),D===Wt)for(be=0;be<$e.length;)G[$e[be].identifier]=!0,be++;for(be=0;be<zt.length;)G[zt[be].identifier]&&Di.push(zt[be]),D&(Xt|Ln)&&delete G[zt[be].identifier],be++;return Di.length?[Pe($e.concat(Di),"identifier",!0),Di]:void 0}de(oc,Cr,{handler:function(D){var B=nf[D.type],G=Hu.call(this,D,B);G&&this.callback(this.manager,B,{pointers:G[0],changedPointers:G[1],pointerType:Fo,srcEvent:D})}});var zu=2500;function sl(){Cr.apply(this,arguments);var x=fe(this.handler,this);this.touch=new oc(this.manager,x),this.mouse=new rc(this.manager,x),this.primaryTouch=null,this.lastTouches=[]}function qC(x,D){x&Wt?(this.primaryTouch=D.changedPointers[0].identifier,Gu.call(this,D)):x&(Xt|Ln)&&Gu.call(this,D)}function Gu(x){var D=x.changedPointers[0];if(D.identifier===this.primaryTouch){var B={x:D.clientX,y:D.clientY};this.lastTouches.push(B);var G=this.lastTouches;setTimeout(function(){var $e=G.indexOf(B);$e>-1&&G.splice($e,1)},zu)}}function le(x){for(var D=x.srcEvent.clientX,B=x.srcEvent.clientY,G=0;G<this.lastTouches.length;G++){var be=this.lastTouches[G],$e=Math.abs(D-be.x),zt=Math.abs(B-be.y);if($e<=25&&zt<=25)return!0}return!1}de(sl,Cr,{handler:function(D,B,G){var $e=G.pointerType==Xe;if(!($e&&G.sourceCapabilities&&G.sourceCapabilities.firesTouchEvents)){if(G.pointerType==Fo)qC.call(this,B,G);else if($e&&le.call(this,G))return;this.callback(D,B,G)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Zs=Ke(S.style,"touchAction"),al=Zs!==k,$u="compute",of="manipulation",ss="none",wr="pan-x",bo="pan-y",Ro=function Wu(){if(!al)return!1;var x={},D=Z.CSS&&Z.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(B){x[B]=!D||Z.CSS.supports("touch-action",B)}),x}();function as(x,D){this.manager=x,this.set(D)}as.prototype={set:function(x){x==$u&&(x=this.compute()),al&&this.manager.element.style&&Ro[x]&&(this.manager.element.style[Zs]=x),this.actions=x.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var x=[];return U(this.manager.recognizers,function(D){Le(D.options.enable,[D])&&(x=x.concat(D.getTouchAction()))}),function sf(x){if(He(x,ss))return ss;var D=He(x,wr),B=He(x,bo);return D&&B?ss:D||B?D?wr:bo:He(x,of)?of:"auto"}(x.join(" "))},preventDefaults:function(x){var D=x.srcEvent,B=x.offsetDirection;if(!this.manager.session.prevented){var G=this.actions,be=He(G,ss)&&!Ro[ss],$e=He(G,bo)&&!Ro[bo],zt=He(G,wr)&&!Ro[wr];if(be&&1===x.pointers.length&&x.distance<2&&x.deltaTime<250)return;return zt&&$e||!(be||$e&&B&Yn||zt&&B&mi)?void 0:this.preventSrc(D)}D.preventDefault()},preventSrc:function(x){this.manager.session.prevented=!0,x.preventDefault()}};var Lo=1;function Cn(x){this.options=me({},this.defaults,x||{}),this.id=function ct(){return Je++}(),this.manager=null,this.options.enable=qe(this.options.enable,!0),this.state=Lo,this.simultaneous={},this.requireFail=[]}function sc(x){return 16&x?"cancel":8&x?"end":4&x?"move":2&x?"start":""}function Zg(x){return x==qt?"down":x==St?"up":x==ft?"left":x==_t?"right":""}function ac(x,D){var B=D.manager;return B?B.get(x):x}function Ht(){Cn.apply(this,arguments)}function ut(){Ht.apply(this,arguments),this.pX=null,this.pY=null}function Ea(){Ht.apply(this,arguments)}function $i(){Cn.apply(this,arguments),this._timer=null,this._input=null}function af(){Ht.apply(this,arguments)}function qu(){Ht.apply(this,arguments)}function Zu(){Cn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function rr(x,D){return(D=D||{}).recognizers=qe(D.recognizers,rr.defaults.preset),new lf(x,D)}function lf(x,D){this.options=me({},rr.defaults,D||{}),this.options.inputTarget=this.options.inputTarget||x,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=x,this.input=function Qh(x){return new(x.options.inputClass||(br?ir:nl?oc:Li?sl:rc))(x,Lg)}(this),this.touchAction=new as(this,this.options.touchAction),Xg(this,!0),U(this.options.recognizers,function(B){var G=this.add(new B[0](B[1]));B[2]&&G.recognizeWith(B[2]),B[3]&&G.requireFailure(B[3])},this)}function Xg(x,D){var G,B=x.element;B.style&&(U(x.options.cssProps,function(be,$e){G=Ke(B.style,$e),D?(x.oldCssProps[G]=B.style[G],B.style[G]=be):B.style[G]=x.oldCssProps[G]||""}),D||(x.oldCssProps={}))}Cn.prototype={defaults:{},set:function(x){return me(this.options,x),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(x){if(W(x,"recognizeWith",this))return this;var D=this.simultaneous;return D[(x=ac(x,this)).id]||(D[x.id]=x,x.recognizeWith(this)),this},dropRecognizeWith:function(x){return W(x,"dropRecognizeWith",this)||(x=ac(x,this),delete this.simultaneous[x.id]),this},requireFailure:function(x){if(W(x,"requireFailure",this))return this;var D=this.requireFail;return-1===gt(D,x=ac(x,this))&&(D.push(x),x.requireFailure(this)),this},dropRequireFailure:function(x){if(W(x,"dropRequireFailure",this))return this;x=ac(x,this);var D=gt(this.requireFail,x);return D>-1&&this.requireFail.splice(D,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(x){return!!this.simultaneous[x.id]},emit:function(x){var D=this,B=this.state;function G(be){D.manager.emit(be,x)}B<8&&G(D.options.event+sc(B)),G(D.options.event),x.additionalEvent&&G(x.additionalEvent),B>=8&&G(D.options.event+sc(B))},tryEmit:function(x){if(this.canEmit())return this.emit(x);this.state=32},canEmit:function(){for(var x=0;x<this.requireFail.length;){if(!(this.requireFail[x].state&(32|Lo)))return!1;x++}return!0},recognize:function(x){var D=me({},x);if(!Le(this.options.enable,[this,D]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Lo),this.state=this.process(D),30&this.state&&this.tryEmit(D)},process:function(x){},getTouchAction:function(){},reset:function(){}},de(Ht,Cn,{defaults:{pointers:1},attrTest:function(x){var D=this.options.pointers;return 0===D||x.pointers.length===D},process:function(x){var D=this.state,B=x.eventType,G=6&D,be=this.attrTest(x);return G&&(B&Ln||!be)?16|D:G||be?B&Xt?8|D:2&D?4|D:2:32}}),de(ut,Ht,{defaults:{event:"pan",threshold:10,pointers:1,direction:Gi},getTouchAction:function(){var x=this.options.direction,D=[];return x&Yn&&D.push(bo),x&mi&&D.push(wr),D},directionTest:function(x){var D=this.options,B=!0,G=x.distance,be=x.direction,$e=x.deltaX,zt=x.deltaY;return be&D.direction||(D.direction&Yn?(be=0===$e?Qe:$e<0?ft:_t,B=$e!=this.pX,G=Math.abs(x.deltaX)):(be=0===zt?Qe:zt<0?St:qt,B=zt!=this.pY,G=Math.abs(x.deltaY))),x.direction=be,B&&G>D.threshold&&be&D.direction},attrTest:function(x){return Ht.prototype.attrTest.call(this,x)&&(2&this.state||!(2&this.state)&&this.directionTest(x))},emit:function(x){this.pX=x.deltaX,this.pY=x.deltaY;var D=Zg(x.direction);D&&(x.additionalEvent=this.options.event+D),this._super.emit.call(this,x)}}),de(Ea,Ht,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ss]},attrTest:function(x){return this._super.attrTest.call(this,x)&&(Math.abs(x.scale-1)>this.options.threshold||2&this.state)},emit:function(x){1!==x.scale&&(x.additionalEvent=this.options.event+(x.scale<1?"in":"out")),this._super.emit.call(this,x)}}),de($i,Cn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(x){var D=this.options,B=x.pointers.length===D.pointers,G=x.distance<D.threshold,be=x.deltaTime>D.time;if(this._input=x,!G||!B||x.eventType&(Xt|Ln)&&!be)this.reset();else if(x.eventType&Wt)this.reset(),this._timer=q(function(){this.state=8,this.tryEmit()},D.time,this);else if(x.eventType&Xt)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(x){8===this.state&&(x&&x.eventType&Xt?this.manager.emit(this.options.event+"up",x):(this._input.timeStamp=F(),this.manager.emit(this.options.event,this._input)))}}),de(af,Ht,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ss]},attrTest:function(x){return this._super.attrTest.call(this,x)&&(Math.abs(x.rotation)>this.options.threshold||2&this.state)}}),de(qu,Ht,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Yn|mi,pointers:1},getTouchAction:function(){return ut.prototype.getTouchAction.call(this)},attrTest:function(x){var B,D=this.options.direction;return D&(Yn|mi)?B=x.overallVelocity:D&Yn?B=x.overallVelocityX:D&mi&&(B=x.overallVelocityY),this._super.attrTest.call(this,x)&&D&x.offsetDirection&&x.distance>this.options.threshold&&x.maxPointers==this.options.pointers&&T(B)>this.options.velocity&&x.eventType&Xt},emit:function(x){var D=Zg(x.offsetDirection);D&&this.manager.emit(this.options.event+D,x),this.manager.emit(this.options.event,x)}}),de(Zu,Cn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[of]},process:function(x){var D=this.options,B=x.pointers.length===D.pointers,G=x.distance<D.threshold,be=x.deltaTime<D.time;if(this.reset(),x.eventType&Wt&&0===this.count)return this.failTimeout();if(G&&be&&B){if(x.eventType!=Xt)return this.failTimeout();var $e=!this.pTime||x.timeStamp-this.pTime<D.interval,zt=!this.pCenter||nc(this.pCenter,x.center)<D.posThreshold;if(this.pTime=x.timeStamp,this.pCenter=x.center,zt&&$e?this.count+=1:this.count=1,this._input=x,0==this.count%D.taps)return this.hasRequireFailures()?(this._timer=q(function(){this.state=8,this.tryEmit()},D.interval,this),2):8}return 32},failTimeout:function(){return this._timer=q(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),rr.VERSION="2.0.7",rr.defaults={domEvents:!1,touchAction:$u,enable:!0,inputTarget:null,inputClass:null,preset:[[af,{enable:!1}],[Ea,{enable:!1},["rotate"]],[qu,{direction:Yn}],[ut,{direction:Yn},["swipe"]],[Zu],[Zu,{event:"doubletap",taps:2},["tap"]],[$i]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},lf.prototype={set:function(x){return me(this.options,x),x.touchAction&&this.touchAction.update(),x.inputTarget&&(this.input.destroy(),this.input.target=x.inputTarget,this.input.init()),this},stop:function(x){this.session.stopped=x?2:1},recognize:function(x){var D=this.session;if(!D.stopped){this.touchAction.preventDefaults(x);var B,G=this.recognizers,be=D.curRecognizer;(!be||be&&8&be.state)&&(be=D.curRecognizer=null);for(var $e=0;$e<G.length;)B=G[$e],2===D.stopped||be&&B!=be&&!B.canRecognizeWith(be)?B.reset():B.recognize(x),!be&&14&B.state&&(be=D.curRecognizer=B),$e++}},get:function(x){if(x instanceof Cn)return x;for(var D=this.recognizers,B=0;B<D.length;B++)if(D[B].options.event==x)return D[B];return null},add:function(x){if(W(x,"add",this))return this;var D=this.get(x.options.event);return D&&this.remove(D),this.recognizers.push(x),x.manager=this,this.touchAction.update(),x},remove:function(x){if(W(x,"remove",this))return this;if(x=this.get(x)){var D=this.recognizers,B=gt(D,x);-1!==B&&(D.splice(B,1),this.touchAction.update())}return this},on:function(x,D){if(x!==k&&D!==k){var B=this.handlers;return U(Fe(x),function(G){B[G]=B[G]||[],B[G].push(D)}),this}},off:function(x,D){if(x!==k){var B=this.handlers;return U(Fe(x),function(G){D?B[G]&&B[G].splice(gt(B[G],D),1):delete B[G]}),this}},emit:function(x,D){this.options.domEvents&&function Kg(x,D){var B=R.createEvent("Event");B.initEvent(x,!0,!0),B.gesture=D,D.target.dispatchEvent(B)}(x,D);var B=this.handlers[x]&&this.handlers[x].slice();if(B&&B.length){D.type=x,D.preventDefault=function(){D.srcEvent.preventDefault()};for(var G=0;G<B.length;)B[G](D),G++}},destroy:function(){this.element&&Xg(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},me(rr,{INPUT_START:Wt,INPUT_MOVE:2,INPUT_END:Xt,INPUT_CANCEL:Ln,STATE_POSSIBLE:Lo,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:Qe,DIRECTION_LEFT:ft,DIRECTION_RIGHT:_t,DIRECTION_UP:St,DIRECTION_DOWN:qt,DIRECTION_HORIZONTAL:Yn,DIRECTION_VERTICAL:mi,DIRECTION_ALL:Gi,Manager:lf,Input:Cr,TouchAction:as,TouchInput:oc,MouseInput:rc,PointerEventInput:ir,TouchMouseInput:sl,SingleTouchInput:tf,Recognizer:Cn,AttrRecognizer:Ht,Tap:Zu,Pan:ut,Swipe:qu,Pinch:Ea,Rotate:af,Press:$i,on:ie,off:it,each:U,merge:K,extend:Ve,assign:me,inherit:de,bindFn:fe,prefixed:Ke}),(typeof Z<"u"?Z:typeof self<"u"?self:{}).Hammer=rr,(E=function(){return rr}.call(Y,V,Y,je))!==k&&(je.exports=E)}(window,document)},2020:(je,Y)=>{Y.read=function(V,E,Z,R,P){var k,I,S=8*P-R-1,j=(1<<S)-1,A=j>>1,T=-7,F=Z?P-1:0,q=Z?-1:1,W=V[E+F];for(F+=q,k=W&(1<<-T)-1,W>>=-T,T+=S;T>0;k=256*k+V[E+F],F+=q,T-=8);for(I=k&(1<<-T)-1,k>>=-T,T+=R;T>0;I=256*I+V[E+F],F+=q,T-=8);if(0===k)k=1-A;else{if(k===j)return I?NaN:1/0*(W?-1:1);I+=Math.pow(2,R),k-=A}return(W?-1:1)*I*Math.pow(2,k-R)},Y.write=function(V,E,Z,R,P,k){var I,S,j,A=8*k-P-1,T=(1<<A)-1,F=T>>1,q=23===P?Math.pow(2,-24)-Math.pow(2,-77):0,W=R?0:k-1,U=R?1:-1,ne=E<0||0===E&&1/E<0?1:0;for(E=Math.abs(E),isNaN(E)||E===1/0?(S=isNaN(E)?1:0,I=T):(I=Math.floor(Math.log(E)/Math.LN2),E*(j=Math.pow(2,-I))<1&&(I--,j*=2),(E+=I+F>=1?q/j:q*Math.pow(2,1-F))*j>=2&&(I++,j/=2),I+F>=T?(S=0,I=T):I+F>=1?(S=(E*j-1)*Math.pow(2,P),I+=F):(S=E*Math.pow(2,F-1)*Math.pow(2,P),I=0));P>=8;V[Z+W]=255&S,W+=U,S/=256,P-=8);for(I=I<<P|S,A+=P;A>0;V[Z+W]=255&I,W+=U,I/=256,A-=8);V[Z+W-U]|=128*ne}},8590:function(je,Y){!function(P){var W,k="undefined",I=k!==typeof Buffer&&Buffer,S=k!==typeof Uint8Array&&Uint8Array,j=k!==typeof ArrayBuffer&&ArrayBuffer,A=[0,0,0,0,0,0,0,0],T=Array.isArray||function Ft(He){return!!He&&"[object Array]"==Object.prototype.toString.call(He)},F=4294967296;function U(He,Fe,gt){var Ut=Fe?0:4,Pe=Fe?4:0,Ke=Fe?0:3,Je=Fe?1:2,ct=Fe?2:1,bn=Fe?3:0,nr=Fe?Le:ie,Li=Fe?qe:it,br=ze.prototype,nl="is"+He,Fo="_"+nl;return br.buffer=void 0,br.offset=0,br[Fo]=!0,br.toNumber=Wt,br.toString=function Zn(Qe){var ft=this.buffer,_t=this.offset,St=Ln(ft,_t+Ut),qt=Ln(ft,_t+Pe),Yn="",mi=!gt&&2147483648&St;for(mi&&(St=~St,qt=F-qt),Qe=Qe||10;;){var Gi=St%Qe*F+qt;if(St=Math.floor(St/Qe),qt=Math.floor(Gi/Qe),Yn=(Gi%Qe).toString(Qe)+Yn,!St&&!qt)break}return mi&&(Yn="-"+Yn),Yn},br.toJSON=Wt,br.toArray=ne,I&&(br.toBuffer=me),S&&(br.toArrayBuffer=Ve),ze[nl]=function Xe(Qe){return!(!Qe||!Qe[Fo])},P[He]=ze,ze;function ze(Qe,ft,_t,St){return this instanceof ze?function et(Qe,ft,_t,St,qt){S&&j&&(ft instanceof j&&(ft=new S(ft)),St instanceof j&&(St=new S(St))),ft||_t||St||W?(K(ft,_t)||(qt=_t,St=ft,_t=0,ft=new(W||Array)(8)),Qe.buffer=ft,Qe.offset=_t|=0,k!==typeof St&&("string"==typeof St?function sn(Qe,ft,_t,St){var qt=0,Yn=_t.length,mi=0,Gi=0;"-"===_t[0]&&qt++;for(var vo=qt;qt<Yn;){var yo=parseInt(_t[qt++],St);if(!(yo>=0))break;Gi=Gi*St+yo,mi=mi*St+Math.floor(Gi/F),Gi%=F}vo&&(mi=~mi,Gi?Gi=F-Gi:mi++),Xt(Qe,ft+Ut,mi),Xt(Qe,ft+Pe,Gi)}(ft,_t,St,qt||10):K(St,qt)?de(ft,_t,St,qt):"number"==typeof qt?(Xt(ft,_t+Ut,St),Xt(ft,_t+Pe,qt)):St>0?nr(ft,_t,St):St<0?Li(ft,_t,St):de(ft,_t,A,0))):Qe.buffer=fe(A,0)}(this,Qe,ft,_t,St):new ze(Qe,ft,_t,St)}function Wt(){var Qe=this.buffer,ft=this.offset,_t=Ln(Qe,ft+Ut),St=Ln(Qe,ft+Pe);return gt||(_t|=0),_t?_t*F+St:St}function Xt(Qe,ft,_t){Qe[ft+bn]=255&_t,Qe[ft+ct]=255&(_t>>=8),Qe[ft+Je]=255&(_t>>=8),Qe[ft+Ke]=255&(_t>>=8)}function Ln(Qe,ft){return 16777216*Qe[ft+Ke]+(Qe[ft+Je]<<16)+(Qe[ft+ct]<<8)+Qe[ft+bn]}}function ne(He){var Fe=this.buffer,gt=this.offset;return W=null,!1!==He&&0===gt&&8===Fe.length&&T(Fe)?Fe:fe(Fe,gt)}function me(He){var Fe=this.buffer,gt=this.offset;if(W=I,!1!==He&&0===gt&&8===Fe.length&&Buffer.isBuffer(Fe))return Fe;var Ut=new I(8);return de(Ut,0,Fe,gt),Ut}function Ve(He){var Fe=this.buffer,gt=this.offset,Ut=Fe.buffer;if(W=S,!1!==He&&0===gt&&Ut instanceof j&&8===Ut.byteLength)return Ut;var Pe=new S(8);return de(Pe,0,Fe,gt),Pe.buffer}function K(He,Fe){var gt=He&&He.length;return Fe|=0,gt&&Fe+8<=gt&&"string"!=typeof He[Fe]}function de(He,Fe,gt,Ut){Fe|=0,Ut|=0;for(var Pe=0;Pe<8;Pe++)He[Fe++]=255&gt[Ut++]}function fe(He,Fe){return Array.prototype.slice.call(He,Fe,Fe+8)}function Le(He,Fe,gt){for(var Ut=Fe+8;Ut>Fe;)He[--Ut]=255&gt,gt/=256}function qe(He,Fe,gt){var Ut=Fe+8;for(gt++;Ut>Fe;)He[--Ut]=255&-gt^255,gt/=256}function ie(He,Fe,gt){for(var Ut=Fe+8;Fe<Ut;)He[Fe++]=255&gt,gt/=256}function it(He,Fe,gt){var Ut=Fe+8;for(gt++;Fe<Ut;)He[Fe++]=255&-gt^255,gt/=256}U("Uint64BE",!0,!0),U("Int64BE",!0,!1),U("Uint64LE",!1,!0),U("Int64LE",!1,!1)}("string"!=typeof Y.nodeName?Y:this||{})},53:je=>{var Y={}.toString;je.exports=Array.isArray||function(V){return"[object Array]"==Y.call(V)}},1741:(je,Y,V)=>{var E=V(5662),Z=V(3192);function R(P){this._init(P)}R.prototype={_init:function(P){P=P||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=P.onData,this._onEndCallback=P.onEnd},_createTable:function(){for(var P=Z.createBuffer(8,E.TABLE_LENGTH),k=0;k<E.TABLE_LENGTH;k++)P[k]=E.BASE62TABLE.charCodeAt(k);return P},_onData:function(P,k){var I=Z.bufferToString_fast(P,k);this._onDataCallback?this._onDataCallback(I):this._result+=I},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var P=2,k=this._data,I=this._offset,S=E.BUFFER_MAX;if(this._dataLen-I<S&&(S=this._dataLen-I),P>S)return!1;var F,q,W,U,ne,j=I-E.WINDOW_BUFFER_MAX,A=k.substring(j,I+S),T=I+P-3-j;do{if(2===P){if(q=k.charAt(I)+k.charAt(I+1),!~(W=A.indexOf(q))||W>T)break}else 3===P?q+=k.charAt(I+2):q=k.substr(I,P);if(!~(U=E.STRING_LASTINDEXOF_BUG?k.substring(j,I+P-1).lastIndexOf(q):A.lastIndexOf(q,T)))break;ne=U,F=j+U;do{if(k.charCodeAt(I+P)!==k.charCodeAt(F+P))break}while(++P<S);if(W===U){P++;break}}while(++P<S);return 2!==P&&(this._index=E.WINDOW_BUFFER_MAX-ne,this._length=P-1,!0)},compress:function(P){if(null==P||0===P.length)return"";var k,I=this._createTable(),S=Z.createWindow(),j=Z.createBuffer(8,E.COMPRESS_CHUNK_SIZE),A=0;this._result="",this._offset=S.length,this._data=S+P,this._dataLen=this._data.length,S=P=null;for(var q,W,U,ne,me,T=-1,F=-1;this._offset<this._dataLen;)this._search()?(this._index<E.BUFFER_MAX?(W=this._index,U=0):U=(this._index-(W=this._index%E.BUFFER_MAX))/E.BUFFER_MAX,2===this._length?(j[A++]=I[U+E.COMPRESS_FIXED_START],j[A++]=I[W]):(j[A++]=I[U+E.COMPRESS_START],j[A++]=I[W],j[A++]=I[this._length]),this._offset+=this._length,~F&&(F=-1)):(q=this._data.charCodeAt(this._offset++))<E.LATIN_BUFFER_MAX?(q<E.UNICODE_CHAR_MAX?(W=q,U=0,T=E.LATIN_INDEX):T=(U=(q-(W=q%E.UNICODE_CHAR_MAX))/E.UNICODE_CHAR_MAX)+E.LATIN_INDEX,F===T?j[A++]=I[W]:(j[A++]=I[T-E.LATIN_INDEX_START],j[A++]=I[W],F=T)):(q<E.UNICODE_BUFFER_MAX?(W=q,U=0,T=E.UNICODE_INDEX):T=(U=(q-(W=q%E.UNICODE_BUFFER_MAX))/E.UNICODE_BUFFER_MAX)+E.UNICODE_INDEX,W<E.UNICODE_CHAR_MAX?(ne=W,me=0):me=(W-(ne=W%E.UNICODE_CHAR_MAX))/E.UNICODE_CHAR_MAX,F===T?(j[A++]=I[ne],j[A++]=I[me]):(j[A++]=I[E.CHAR_START],j[A++]=I[T-E.TABLE_LENGTH],j[A++]=I[ne],j[A++]=I[me],F=T)),A>=E.COMPRESS_CHUNK_MAX&&(this._onData(j,A),A=0);return A>0&&this._onData(j,A),this._onEnd(),k=this._result,this._result=null,null===k?"":k}},je.exports=R},5662:(je,Y)=>{var V=Y.HAS_TYPED=typeof Uint8Array<"u"&&typeof Uint16Array<"u",E=!1,Z=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(E=!0)}catch{}if(V)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(Z=!0)}catch{}Y.CAN_CHARCODE_APPLY=E,Y.CAN_CHARCODE_APPLY_TYPED=Z;var R=Y.APPLY_BUFFER_SIZE=65533;Y.APPLY_BUFFER_SIZE_OK=null;var P=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(P=!0),Y.STRING_LASTINDEXOF_BUG=P;var k=Y.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",I=Y.TABLE_LENGTH=k.length,S=Math.max(I,62)-Math.min(I,62);Y.BUFFER_MAX=I-1;var j=Y.WINDOW_MAX=1024;Y.WINDOW_BUFFER_MAX=304;var A=Y.COMPRESS_CHUNK_SIZE=R;Y.COMPRESS_CHUNK_MAX=A-I;var T=Y.DECOMPRESS_CHUNK_SIZE=R;Y.DECOMPRESS_CHUNK_MAX=T+2*j,Y.LATIN_BUFFER_MAX=132;var q=Y.UNICODE_CHAR_MAX=40;Y.UNICODE_BUFFER_MAX=q*(q+1),Y.LATIN_INDEX=I+1,Y.LATIN_INDEX_START=S+20,Y.UNICODE_INDEX=I+5,Y.DECODE_MAX=I-S-19;var W=Y.LATIN_DECODE_MAX=q+7,U=Y.CHAR_START=W+1,ne=Y.COMPRESS_START=U+1,me=Y.COMPRESS_FIXED_START=ne+5;Y.COMPRESS_INDEX=me+5},2062:(je,Y,V)=>{var E=V(5662),Z=V(3192);function R(P){this._init(P)}R.prototype={_init:function(P){P=P||{},this._result=null,this._onDataCallback=P.onData,this._onEndCallback=P.onEnd},_createTable:function(){for(var P={},k=0;k<E.TABLE_LENGTH;k++)P[E.BASE62TABLE.charAt(k)]=k;return P},_onData:function(P){var k;if(this._onDataCallback){if(P)k=this._result,this._result=[];else{var I=E.DECOMPRESS_CHUNK_SIZE-E.WINDOW_MAX;k=this._result.slice(E.WINDOW_MAX,E.WINDOW_MAX+I),this._result=this._result.slice(0,E.WINDOW_MAX).concat(this._result.slice(E.WINDOW_MAX+I))}k.length>0&&this._onDataCallback(Z.bufferToString_fast(k))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(P){if(null==P||0===P.length)return"";this._result=Z.stringToArray(Z.createWindow());for(var k,F,q,W,ne,me,Ve,K,de,fe,I=this._createTable(),S=!1,j=null,A=P.length,T=0;T<A;T++)if(void 0!==(q=I[P.charAt(T)])){if(q<E.DECODE_MAX)ne=S?I[P.charAt(++T)]*E.UNICODE_CHAR_MAX+q+E.UNICODE_BUFFER_MAX*j:j*E.UNICODE_CHAR_MAX+q,this._result[this._result.length]=ne;else if(q<E.LATIN_DECODE_MAX)j=q-E.DECODE_MAX,S=!1;else if(q===E.CHAR_START)j=(W=I[P.charAt(++T)])-5,S=!0;else if(q<E.COMPRESS_INDEX){if(W=I[P.charAt(++T)],q<E.COMPRESS_FIXED_START?(me=(q-E.COMPRESS_START)*E.BUFFER_MAX+W,Ve=I[P.charAt(++T)]):(me=(q-E.COMPRESS_FIXED_START)*E.BUFFER_MAX+W,Ve=2),(K=this._result.slice(-me)).length>Ve&&(K.length=Ve),de=K.length,K.length>0)for(fe=0;fe<Ve;)for(F=0;F<de&&(this._result[this._result.length]=K[F],!(++fe>=Ve));F++);j=null}this._result.length>=E.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(E.WINDOW_MAX),this._onData(!0),this._onEnd(),k=Z.bufferToString_fast(this._result),this._result=null,k}},je.exports=R},1782:(je,Y,V)=>{var E=V(1741),Z=V(2062);Y.version=V(4469).version,Y.compress=function(R,P){return new E(P).compress(R)},Y.decompress=function(R,P){return new Z(P).decompress(R)}},3192:(je,Y,V)=>{var E=V(5662),Z=String.fromCharCode;Y.createBuffer=function(I,S){if(!E.HAS_TYPED)return new Array(S);switch(I){case 8:return new Uint8Array(S);case 16:return new Uint16Array(S)}};var R=Y.truncateBuffer=function(I,S){return I.length===S?I:I.subarray?I.subarray(0,S):(I.length=S,I)};Y.bufferToString_fast=function(I,S){if(null==S?S=I.length:I=R(I,S),E.CAN_CHARCODE_APPLY&&E.CAN_CHARCODE_APPLY_TYPED){var j=I.length;if(j<E.APPLY_BUFFER_SIZE&&E.APPLY_BUFFER_SIZE_OK)return Z.apply(null,I);if(null===E.APPLY_BUFFER_SIZE_OK)try{var A=Z.apply(null,I);return j>E.APPLY_BUFFER_SIZE&&(E.APPLY_BUFFER_SIZE_OK=!0),A}catch{E.APPLY_BUFFER_SIZE_OK=!1}}return P(I)};var P=Y.bufferToString_chunked=function(I){for(var T,S="",j=I.length,A=0;A<j;){if(T=I.subarray?I.subarray(A,A+E.APPLY_BUFFER_SIZE):I.slice(A,A+E.APPLY_BUFFER_SIZE),A+=E.APPLY_BUFFER_SIZE,!E.APPLY_BUFFER_SIZE_OK){if(null===E.APPLY_BUFFER_SIZE_OK)try{S+=Z.apply(null,T),T.length>E.APPLY_BUFFER_SIZE&&(E.APPLY_BUFFER_SIZE_OK=!0);continue}catch{E.APPLY_BUFFER_SIZE_OK=!1}return k(I)}S+=Z.apply(null,T)}return S},k=Y.bufferToString_slow=function(I){for(var S="",j=I.length,A=0;A<j;A++)S+=Z(I[A]);return S};Y.stringToArray=function(I){for(var S=[],j=I&&I.length,A=0;A<j;A++)S[A]=I.charCodeAt(A);return S},Y.createWindow=function(){for(var I=E.WINDOW_MAX>>7,S="        ";!(I&E.WINDOW_MAX);)S+=S,I<<=1;return S}},4999:(je,Y,V)=>{Y.encode=V(5013).encode,Y.decode=V(2813).decode,Y.Encoder=V(6951).Encoder,Y.Decoder=V(2335).Decoder,Y.createCodec=V(2032).createCodec,Y.codec=V(4197).codec},7865:function(je){function Y(V){return V&&V.isBuffer&&V}je.exports=Y(typeof Buffer<"u"&&Buffer)||Y(this.Buffer)||Y(typeof window<"u"&&window.Buffer)||this.Buffer},5066:(je,Y)=>{Y.copy=function R(P,k,I,S){var j;I||(I=0),!S&&0!==S&&(S=this.length),k||(k=0);var A=S-I;if(P===this&&I<k&&k<S)for(j=A-1;j>=0;j--)P[j+k]=this[j+I];else for(j=0;j<A;j++)P[j+k]=this[j+I];return A},Y.toString=function Z(P,k,I){var S=this,j=0|k;I||(I=S.length);for(var A="",T=0;j<I;)(T=S[j++])<128?A+=String.fromCharCode(T):(192==(224&T)?T=(31&T)<<6|63&S[j++]:224==(240&T)?T=(15&T)<<12|(63&S[j++])<<6|63&S[j++]:240==(248&T)&&(T=(7&T)<<18|(63&S[j++])<<12|(63&S[j++])<<6|63&S[j++]),T>=65536?(T-=65536,A+=String.fromCharCode(55296+(T>>>10),56320+(1023&T))):A+=String.fromCharCode(T));return A},Y.write=function E(P,k){for(var I=this,S=k||(k|=0),j=P.length,A=0,T=0;T<j;)(A=P.charCodeAt(T++))<128?I[S++]=A:A<2048?(I[S++]=192|A>>>6,I[S++]=128|63&A):A<55296||A>57343?(I[S++]=224|A>>>12,I[S++]=128|A>>>6&63,I[S++]=128|63&A):(A=65536+(A-55296<<10|P.charCodeAt(T++)-56320),I[S++]=240|A>>>18,I[S++]=128|A>>>12&63,I[S++]=128|A>>>6&63,I[S++]=128|63&A);return S-k}},5129:(je,Y,V)=>{var E=V(2029),Z=je.exports=R(0);function R(k){return new Array(k)}Z.alloc=R,Z.concat=E.concat,Z.from=function P(k){if(!E.isBuffer(k)&&E.isView(k))k=E.Uint8Array.from(k);else if(E.isArrayBuffer(k))k=new Uint8Array(k);else{if("string"==typeof k)return E.from.call(Z,k);if("number"==typeof k)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(k)}},864:(je,Y,V)=>{var E=V(2029),Z=E.global,R=je.exports=E.hasBuffer?P(0):[];function P(I){return new Z(I)}R.alloc=E.hasBuffer&&Z.alloc||P,R.concat=E.concat,R.from=function k(I){if(!E.isBuffer(I)&&E.isView(I))I=E.Uint8Array.from(I);else if(E.isArrayBuffer(I))I=new Uint8Array(I);else{if("string"==typeof I)return E.from.call(R,I);if("number"==typeof I)throw new TypeError('"value" argument must not be a number')}return Z.from&&1!==Z.from.length?Z.from(I):new Z(I)}},1002:(je,Y,V)=>{var E=V(5066);Y.copy=I,Y.slice=S,Y.toString=function j(T,F,q){return(!P&&Z.isBuffer(this)?this.toString:E.toString).apply(this,arguments)},Y.write=function A(T){return function F(){return(this[T]||E[T]).apply(this,arguments)}}("write");var Z=V(2029),R=Z.global,P=Z.hasBuffer&&"TYPED_ARRAY_SUPPORT"in R,k=P&&!R.TYPED_ARRAY_SUPPORT;function I(T,F,q,W){var U=Z.isBuffer(this),ne=Z.isBuffer(T);if(U&&ne)return this.copy(T,F,q,W);if(k||U||ne||!Z.isView(this)||!Z.isView(T))return E.copy.call(this,T,F,q,W);var me=q||null!=W?S.call(this,q,W):this;return T.set(me,F),me.length}function S(T,F){var q=this.slice||!k&&this.subarray;if(q)return q.call(this,T,F);var W=Z.alloc.call(this,F-T);return I.call(this,W,0,T,F),W}},8343:(je,Y,V)=>{var E=V(2029),Z=je.exports=E.hasArrayBuffer?R(0):[];function R(k){return new Uint8Array(k)}Z.alloc=R,Z.concat=E.concat,Z.from=function P(k){if(E.isView(k)){var I=k.byteOffset,S=k.byteLength;(k=k.buffer).byteLength!==S&&(k.slice?k=k.slice(I,I+S):(k=new Uint8Array(k)).byteLength!==S&&(k=Array.prototype.slice.call(k,I,I+S)))}else{if("string"==typeof k)return E.from.call(Z,k);if("number"==typeof k)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(k)}},2029:(je,Y,V)=>{var E=Y.global=V(7865),Z=Y.hasBuffer=E&&!!E.isBuffer,R=Y.hasArrayBuffer=typeof ArrayBuffer<"u",P=Y.isArray=V(53);Y.isArrayBuffer=R?function ne(fe){return fe instanceof ArrayBuffer||U(fe)}:K;var k=Y.isBuffer=Z?E.isBuffer:K,I=Y.isView=R?ArrayBuffer.isView||de("ArrayBuffer","buffer"):K;Y.alloc=q,Y.concat=function W(fe,Le){Le||(Le=0,Array.prototype.forEach.call(fe,function Ft(Fe){Le+=Fe.length}));var ie=q.call(this!==Y&&this||fe[0],Le),it=0;return Array.prototype.forEach.call(fe,function He(Fe){it+=T.copy.call(Fe,ie,it)}),ie},Y.from=function F(fe){return"string"==typeof fe?me.call(this,fe):Ve(this).from(fe)};var S=Y.Array=V(5129),j=Y.Buffer=V(864),A=Y.Uint8Array=V(8343),T=Y.prototype=V(1002);function q(fe){return Ve(this).alloc(fe)}var U=de("ArrayBuffer");function me(fe){var Le=3*fe.length,qe=q.call(this,Le),ie=T.write.call(qe,fe);return Le!==ie&&(qe=T.slice.call(qe,0,ie)),qe}function Ve(fe){return k(fe)?j:I(fe)?A:P(fe)?S:Z?j:R?A:S}function K(){return!1}function de(fe,Le){return fe="[object "+fe+"]",function(qe){return null!=qe&&{}.toString.call(Le?qe[Le]:qe)===fe}}},2199:(je,Y,V)=>{var E=V(53);Y.createCodec=j,Y.install=function P(A){for(var T in A)R.prototype[T]=k(R.prototype[T],A[T])},Y.filter=function S(A){return E(A)?function I(A){return A=A.slice(),function(F){return A.reduce(T,F)};function T(F,q){return q(F)}}(A):A};var Z=V(2029);function R(A){if(!(this instanceof R))return new R(A);this.options=A,this.init()}function k(A,T){return A&&T?function F(){return A.apply(this,arguments),T.apply(this,arguments)}:A||T}function j(A){return new R(A)}R.prototype.init=function(){var A=this.options;return A&&A.uint8array&&(this.bufferish=Z.Uint8Array),this},Y.preset=j({preset:!0})},4197:(je,Y,V)=>{V(2415),V(6962),Y.codec={preset:V(2199).preset}},9088:(je,Y,V)=>{Y.n=R;var E=V(2415).preset;function R(P){if(!(this instanceof R))return new R(P);if(P&&(this.options=P,P.codec)){var k=this.codec=P.codec;k.bufferish&&(this.bufferish=k.bufferish)}}V(3351).I.mixin(R.prototype),R.prototype.codec=E,R.prototype.fetch=function(){return this.codec.decode(this)}},2813:(je,Y,V)=>{Y.decode=function Z(R,P){var k=new E(P);return k.write(R),k.read()};var E=V(9088).n},2335:(je,Y,V)=>{Y.Decoder=R;var E=V(8004),Z=V(9088).n;function R(P){if(!(this instanceof R))return new R(P);Z.call(this,P)}R.prototype=new Z,E.mixin(R.prototype),R.prototype.decode=function(P){arguments.length&&this.write(P),this.flush()},R.prototype.push=function(P){this.emit("data",P)},R.prototype.end=function(P){this.decode(P),this.emit("end")}},8120:(je,Y,V)=>{Y.D=R;var E=V(6962).preset;function R(P){if(!(this instanceof R))return new R(P);if(P&&(this.options=P,P.codec)){var k=this.codec=P.codec;k.bufferish&&(this.bufferish=k.bufferish)}}V(3351).w.mixin(R.prototype),R.prototype.codec=E,R.prototype.write=function(P){this.codec.encode(this,P)}},5013:(je,Y,V)=>{Y.encode=function Z(R,P){var k=new E(P);return k.write(R),k.read()};var E=V(8120).D},6951:(je,Y,V)=>{Y.Encoder=R;var E=V(8004),Z=V(8120).D;function R(P){if(!(this instanceof R))return new R(P);Z.call(this,P)}R.prototype=new Z,E.mixin(R.prototype),R.prototype.encode=function(P){this.write(P),this.emit("data",this.read())},R.prototype.end=function(P){arguments.length&&this.encode(P),this.flush(),this.emit("end")}},7603:(je,Y,V)=>{Y.u=function Z(R,P){if(!(this instanceof Z))return new Z(R,P);this.buffer=E.from(R),this.type=P};var E=V(2029)},5167:(je,Y,V)=>{Y.setExtPackers=function I(F){F.addExtPacker(14,Error,[T,S]),F.addExtPacker(1,EvalError,[T,S]),F.addExtPacker(2,RangeError,[T,S]),F.addExtPacker(3,ReferenceError,[T,S]),F.addExtPacker(4,SyntaxError,[T,S]),F.addExtPacker(5,TypeError,[T,S]),F.addExtPacker(6,URIError,[T,S]),F.addExtPacker(10,RegExp,[A,S]),F.addExtPacker(11,Boolean,[j,S]),F.addExtPacker(12,String,[j,S]),F.addExtPacker(13,Date,[Number,S]),F.addExtPacker(15,Number,[j,S]),typeof Uint8Array<"u"&&(F.addExtPacker(17,Int8Array,R),F.addExtPacker(18,Uint8Array,R),F.addExtPacker(19,Int16Array,R),F.addExtPacker(20,Uint16Array,R),F.addExtPacker(21,Int32Array,R),F.addExtPacker(22,Uint32Array,R),F.addExtPacker(23,Float32Array,R),typeof Float64Array<"u"&&F.addExtPacker(24,Float64Array,R),typeof Uint8ClampedArray<"u"&&F.addExtPacker(25,Uint8ClampedArray,R),F.addExtPacker(26,ArrayBuffer,R),F.addExtPacker(29,DataView,R)),E.hasBuffer&&F.addExtPacker(27,Z,E.from)};var P,E=V(2029),Z=E.global,R=E.Uint8Array.from,k={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function S(F){return P||(P=V(5013).encode),P(F)}function j(F){return F.valueOf()}function A(F){(F=RegExp.prototype.toString.call(F).split("/")).shift();var q=[F.pop()];return q.unshift(F.join("/")),q}function T(F){var q={};for(var W in k)q[W]=F[W];return q}},1800:(je,Y,V)=>{Y.setExtUnpackers=function k(F){F.addExtUnpacker(14,[I,j(Error)]),F.addExtUnpacker(1,[I,j(EvalError)]),F.addExtUnpacker(2,[I,j(RangeError)]),F.addExtUnpacker(3,[I,j(ReferenceError)]),F.addExtUnpacker(4,[I,j(SyntaxError)]),F.addExtUnpacker(5,[I,j(TypeError)]),F.addExtUnpacker(6,[I,j(URIError)]),F.addExtUnpacker(10,[I,S]),F.addExtUnpacker(11,[I,A(Boolean)]),F.addExtUnpacker(12,[I,A(String)]),F.addExtUnpacker(13,[I,A(Date)]),F.addExtUnpacker(15,[I,A(Number)]),typeof Uint8Array<"u"&&(F.addExtUnpacker(17,A(Int8Array)),F.addExtUnpacker(18,A(Uint8Array)),F.addExtUnpacker(19,[T,A(Int16Array)]),F.addExtUnpacker(20,[T,A(Uint16Array)]),F.addExtUnpacker(21,[T,A(Int32Array)]),F.addExtUnpacker(22,[T,A(Uint32Array)]),F.addExtUnpacker(23,[T,A(Float32Array)]),typeof Float64Array<"u"&&F.addExtUnpacker(24,[T,A(Float64Array)]),typeof Uint8ClampedArray<"u"&&F.addExtUnpacker(25,A(Uint8ClampedArray)),F.addExtUnpacker(26,T),F.addExtUnpacker(29,[T,A(DataView)])),E.hasBuffer&&F.addExtUnpacker(27,A(Z))};var R,E=V(2029),Z=E.global,P={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function I(F){return R||(R=V(2813).decode),R(F)}function S(F){return RegExp.apply(null,F)}function j(F){return function(q){var W=new F;for(var U in P)W[U]=q[U];return W}}function A(F){return function(q){return new F(q)}}function T(F){return new Uint8Array(F).buffer}},2032:(je,Y,V)=>{V(2415),V(6962),Y.createCodec=V(2199).createCodec},3351:(je,Y,V)=>{Y.I=k,Y.w=I;var E=V(2029),P="BUFFER_SHORTAGE";function k(){if(!(this instanceof k))return new k}function I(){if(!(this instanceof I))return new I}function A(){throw new Error("method not implemented: write()")}function T(){throw new Error("method not implemented: fetch()")}function F(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function q(ne){(this.buffers||(this.buffers=[])).push(ne)}function W(){return(this.buffers||(this.buffers=[])).shift()}function U(ne){return function me(Ve){for(var K in ne)Ve[K]=ne[K];return Ve}}k.mixin=U(function S(){return{bufferish:E,write:function ne(K){var de=this.offset?E.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=de?K?this.bufferish.concat([de,K]):de:K,this.offset=0},fetch:T,flush:function me(){for(;this.offset<this.buffer.length;){var de,K=this.offset;try{de=this.fetch()}catch(fe){if(fe&&fe.message!=P)throw fe;this.offset=K;break}this.push(de)}},push:q,pull:W,read:F,reserve:function Ve(K){var de=this.offset,fe=de+K;if(fe>this.buffer.length)throw new Error(P);return this.offset=fe,de},offset:0}}()),k.mixin(k.prototype),I.mixin=U(function j(){return{bufferish:E,write:A,fetch:function ne(){var fe=this.start;if(fe<this.offset){var Le=this.start=this.offset;return E.prototype.slice.call(this.buffer,fe,Le)}},flush:function me(){for(;this.start<this.offset;){var fe=this.fetch();fe&&this.push(fe)}},push:q,pull:function Ve(){var fe=this.buffers||(this.buffers=[]),Le=fe.length>1?this.bufferish.concat(fe):fe[0];return fe.length=0,Le},read:F,reserve:function K(fe){var Le=0|fe;if(this.buffer){var qe=this.buffer.length,ie=0|this.offset,it=ie+Le;if(it<qe)return this.offset=it,ie;this.flush(),fe=Math.max(fe,Math.min(2*qe,this.maxBufferSize))}return fe=Math.max(fe,this.minBufferSize),this.buffer=this.bufferish.alloc(fe),this.start=0,this.offset=Le,0},send:function de(fe){var Le=fe.length;if(Le>this.minBufferSize)this.flush(),this.push(fe);else{var qe=this.reserve(Le);E.prototype.copy.call(fe,this.buffer,qe)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),I.mixin(I.prototype)},2415:(je,Y,V)=>{var E=V(7603).u,Z=V(1800),R=V(6539).readUint8,P=V(3247),k=V(2199);function S(){var T=this.options;return this.decode=function I(T){var F=P.getReadToken(T);return function q(W){var U=R(W),ne=F[U];if(!ne)throw new Error("Invalid type: "+(U&&"0x"+U.toString(16)));return ne(W)}}(T),T&&T.preset&&Z.setExtUnpackers(this),this}k.install({addExtUnpacker:function j(T,F){(this.extUnpackers||(this.extUnpackers=[]))[T]=k.filter(F)},getExtUnpacker:function A(T){return(this.extUnpackers||(this.extUnpackers=[]))[T]||function q(W){return new E(W,T)}},init:S}),Y.preset=S.call(k.preset)},6539:(je,Y,V)=>{var E=V(2020),Z=V(8590),R=Z.Uint64BE,P=Z.Int64BE;Y.getReadFormat=function A(Pe){var Je=Pe&&Pe.int64;return{map:S&&Pe&&Pe.usemap?F:T,array:q,str:W,bin:k.hasArrayBuffer&&Pe&&Pe.binarraybuffer?ne:U,ext:me,uint8:Ve,uint16:de,uint32:Le,uint64:ie(8,Je?He:it),int8:K,int16:fe,int32:qe,int64:ie(8,Je?Fe:Ft),float32:ie(4,gt),float64:ie(8,Ut)}},Y.readUint8=Ve;var k=V(2029),I=V(1002),S=typeof Map<"u",j=!0;function T(Pe,Ke){var ct,Je={},bn=new Array(Ke),nr=new Array(Ke),Li=Pe.codec.decode;for(ct=0;ct<Ke;ct++)bn[ct]=Li(Pe),nr[ct]=Li(Pe);for(ct=0;ct<Ke;ct++)Je[bn[ct]]=nr[ct];return Je}function F(Pe,Ke){var ct,Je=new Map,bn=new Array(Ke),nr=new Array(Ke),Li=Pe.codec.decode;for(ct=0;ct<Ke;ct++)bn[ct]=Li(Pe),nr[ct]=Li(Pe);for(ct=0;ct<Ke;ct++)Je.set(bn[ct],nr[ct]);return Je}function q(Pe,Ke){for(var Je=new Array(Ke),ct=Pe.codec.decode,bn=0;bn<Ke;bn++)Je[bn]=ct(Pe);return Je}function W(Pe,Ke){var Je=Pe.reserve(Ke);return I.toString.call(Pe.buffer,"utf-8",Je,Je+Ke)}function U(Pe,Ke){var Je=Pe.reserve(Ke),bn=I.slice.call(Pe.buffer,Je,Je+Ke);return k.from(bn)}function ne(Pe,Ke){var Je=Pe.reserve(Ke),bn=I.slice.call(Pe.buffer,Je,Je+Ke);return k.Uint8Array.from(bn).buffer}function me(Pe,Ke){var Je=Pe.reserve(Ke+1),ct=Pe.buffer[Je++],bn=Je+Ke,nr=Pe.codec.getExtUnpacker(ct);if(!nr)throw new Error("Invalid ext type: "+(ct&&"0x"+ct.toString(16)));return nr(I.slice.call(Pe.buffer,Je,bn))}function Ve(Pe){var Ke=Pe.reserve(1);return Pe.buffer[Ke]}function K(Pe){var Ke=Pe.reserve(1),Je=Pe.buffer[Ke];return 128&Je?Je-256:Je}function de(Pe){var Ke=Pe.reserve(2),Je=Pe.buffer;return Je[Ke++]<<8|Je[Ke]}function fe(Pe){var Ke=Pe.reserve(2),Je=Pe.buffer,ct=Je[Ke++]<<8|Je[Ke];return 32768&ct?ct-65536:ct}function Le(Pe){var Ke=Pe.reserve(4),Je=Pe.buffer;return 16777216*Je[Ke++]+(Je[Ke++]<<16)+(Je[Ke++]<<8)+Je[Ke]}function qe(Pe){var Ke=Pe.reserve(4),Je=Pe.buffer;return Je[Ke++]<<24|Je[Ke++]<<16|Je[Ke++]<<8|Je[Ke]}function ie(Pe,Ke){return function(Je){var ct=Je.reserve(Pe);return Ke.call(Je.buffer,ct,j)}}function it(Pe){return new R(this,Pe).toNumber()}function Ft(Pe){return new P(this,Pe).toNumber()}function He(Pe){return new R(this,Pe)}function Fe(Pe){return new P(this,Pe)}function gt(Pe){return E.read(this,Pe,!1,23,4)}function Ut(Pe){return E.read(this,Pe,!1,52,8)}},3247:(je,Y,V)=>{var E=V(6539);function R(j){var A,T=new Array(256);for(A=0;A<=127;A++)T[A]=k(A);for(A=128;A<=143;A++)T[A]=S(A-128,j.map);for(A=144;A<=159;A++)T[A]=S(A-144,j.array);for(A=160;A<=191;A++)T[A]=S(A-160,j.str);for(T[192]=k(null),T[193]=null,T[194]=k(!1),T[195]=k(!0),T[196]=I(j.uint8,j.bin),T[197]=I(j.uint16,j.bin),T[198]=I(j.uint32,j.bin),T[199]=I(j.uint8,j.ext),T[200]=I(j.uint16,j.ext),T[201]=I(j.uint32,j.ext),T[202]=j.float32,T[203]=j.float64,T[204]=j.uint8,T[205]=j.uint16,T[206]=j.uint32,T[207]=j.uint64,T[208]=j.int8,T[209]=j.int16,T[210]=j.int32,T[211]=j.int64,T[212]=S(1,j.ext),T[213]=S(2,j.ext),T[214]=S(4,j.ext),T[215]=S(8,j.ext),T[216]=S(16,j.ext),T[217]=I(j.uint8,j.str),T[218]=I(j.uint16,j.str),T[219]=I(j.uint32,j.str),T[220]=I(j.uint16,j.array),T[221]=I(j.uint32,j.array),T[222]=I(j.uint16,j.map),T[223]=I(j.uint32,j.map),A=224;A<=255;A++)T[A]=k(A-256);return T}function k(j){return function(){return j}}function I(j,A){return function(T){var F=j(T);return A(T,F)}}function S(j,A){return function(T){return A(T,j)}}Y.getReadToken=function Z(j){var A=E.getReadFormat(j);return j&&j.useraw?function P(j){var A,T=R(j).slice();for(T[217]=T[196],T[218]=T[197],T[219]=T[198],A=160;A<=191;A++)T[A]=S(A-160,j.bin);return T}(A):R(A)}},6962:(je,Y,V)=>{var E=V(7603).u,Z=V(5167),R=V(5217),P=V(2199);function I(){var A=this.options;return this.encode=function k(A){var T=R.getWriteType(A);return function F(q,W){var U=T[typeof W];if(!U)throw new Error('Unsupported type "'+typeof W+'": '+W);U(q,W)}}(A),A&&A.preset&&Z.setExtPackers(this),this}P.install({addExtPacker:function S(A,T,F){F=P.filter(F);var q=T.name;function ne(me){return F&&(me=F(me)),new E(me,A)}q&&"Object"!==q?(this.extPackers||(this.extPackers={}))[q]=ne:(this.extEncoderList||(this.extEncoderList=[])).unshift([T,ne])},getExtPacker:function j(A){var T=this.extPackers||(this.extPackers={}),F=A.constructor,q=F&&F.name&&T[F.name];if(q)return q;for(var W=this.extEncoderList||(this.extEncoderList=[]),U=W.length,ne=0;ne<U;ne++){var me=W[ne];if(F===me[0])return me[1]}},init:I}),Y.preset=I.call(P.preset)},4912:(je,Y,V)=>{var E=V(2020),Z=V(8590),R=Z.Uint64BE,P=Z.Int64BE,k=V(7857).h,I=V(2029),S=I.global,A=I.hasBuffer&&"TYPED_ARRAY_SUPPORT"in S&&!S.TYPED_ARRAY_SUPPORT,T=I.hasBuffer&&S.prototype||{};function W(){var ie=k.slice();return ie[196]=ne(196),ie[197]=me(197),ie[198]=Ve(198),ie[199]=ne(199),ie[200]=me(200),ie[201]=Ve(201),ie[202]=K(202,4,T.writeFloatBE||Le,!0),ie[203]=K(203,8,T.writeDoubleBE||qe,!0),ie[204]=ne(204),ie[205]=me(205),ie[206]=Ve(206),ie[207]=K(207,8,de),ie[208]=ne(208),ie[209]=me(209),ie[210]=Ve(210),ie[211]=K(211,8,fe),ie[217]=ne(217),ie[218]=me(218),ie[219]=Ve(219),ie[220]=me(220),ie[221]=Ve(221),ie[222]=me(222),ie[223]=Ve(223),ie}function ne(ie){return function(it,Ft){var He=it.reserve(2),Fe=it.buffer;Fe[He++]=ie,Fe[He]=Ft}}function me(ie){return function(it,Ft){var He=it.reserve(3),Fe=it.buffer;Fe[He++]=ie,Fe[He++]=Ft>>>8,Fe[He]=Ft}}function Ve(ie){return function(it,Ft){var He=it.reserve(5),Fe=it.buffer;Fe[He++]=ie,Fe[He++]=Ft>>>24,Fe[He++]=Ft>>>16,Fe[He++]=Ft>>>8,Fe[He]=Ft}}function K(ie,it,Ft,He){return function(Fe,gt){var Ut=Fe.reserve(it+1);Fe.buffer[Ut++]=ie,Ft.call(Fe.buffer,gt,Ut,He)}}function de(ie,it){new R(this,it,ie)}function fe(ie,it){new P(this,it,ie)}function Le(ie,it){E.write(this,ie,it,!1,23,4)}function qe(ie,it){E.write(this,ie,it,!1,52,8)}Y.getWriteToken=function F(ie){return ie&&ie.uint8array?function q(){var ie=W();return ie[202]=K(202,4,Le),ie[203]=K(203,8,qe),ie}():A||I.hasBuffer&&ie&&ie.safe?function U(){var ie=k.slice();return ie[196]=K(196,1,S.prototype.writeUInt8),ie[197]=K(197,2,S.prototype.writeUInt16BE),ie[198]=K(198,4,S.prototype.writeUInt32BE),ie[199]=K(199,1,S.prototype.writeUInt8),ie[200]=K(200,2,S.prototype.writeUInt16BE),ie[201]=K(201,4,S.prototype.writeUInt32BE),ie[202]=K(202,4,S.prototype.writeFloatBE),ie[203]=K(203,8,S.prototype.writeDoubleBE),ie[204]=K(204,1,S.prototype.writeUInt8),ie[205]=K(205,2,S.prototype.writeUInt16BE),ie[206]=K(206,4,S.prototype.writeUInt32BE),ie[207]=K(207,8,de),ie[208]=K(208,1,S.prototype.writeInt8),ie[209]=K(209,2,S.prototype.writeInt16BE),ie[210]=K(210,4,S.prototype.writeInt32BE),ie[211]=K(211,8,fe),ie[217]=K(217,1,S.prototype.writeUInt8),ie[218]=K(218,2,S.prototype.writeUInt16BE),ie[219]=K(219,4,S.prototype.writeUInt32BE),ie[220]=K(220,2,S.prototype.writeUInt16BE),ie[221]=K(221,4,S.prototype.writeUInt32BE),ie[222]=K(222,2,S.prototype.writeUInt16BE),ie[223]=K(223,4,S.prototype.writeUInt32BE),ie}():W()}},5217:(je,Y,V)=>{var E=V(53),Z=V(8590),R=Z.Uint64BE,P=Z.Int64BE,k=V(2029),I=V(1002),S=V(4912),j=V(7857).h,A=V(7603).u,T=typeof Uint8Array<"u",F=typeof Map<"u",q=[];q[1]=212,q[2]=213,q[4]=214,q[8]=215,q[16]=216,Y.getWriteType=function W(U){var ne=S.getWriteToken(U),me=U&&U.useraw,Ve=T&&U&&U.binarraybuffer,K=Ve?k.isArrayBuffer:k.isBuffer,de=Ve?function nr(ze,Xe){bn(ze,new Uint8Array(Xe))}:bn,Le=F&&U&&U.usemap?function nl(ze,Xe){if(!(Xe instanceof Map))return br(ze,Xe);var et=Xe.size;ne[et<16?128+et:et<=65535?222:223](ze,et);var Wt=ze.codec.encode;Xe.forEach(function(Zn,Xt,Ln){Wt(ze,Xt),Wt(ze,Zn)})}:br;return{boolean:function ie(ze,Xe){ne[Xe?195:194](ze,Xe)},function:Je,number:function it(ze,Xe){var et=0|Xe;Xe===et?ne[-32<=et&&et<=127?255&et:0<=et?et<=255?204:et<=65535?205:206:-128<=et?208:-32768<=et?209:210](ze,et):ne[203](ze,Xe)},object:me?function Ke(ze,Xe){if(K(Xe))return function Fo(ze,Xe){var et=Xe.length;ne[et<32?160+et:et<=65535?218:219](ze,et),ze.send(Xe)}(ze,Xe);Pe(ze,Xe)}:Pe,string:function Ut(ze){return function Xe(et,sn){var Wt=sn.length;et.offset=et.reserve(5+3*Wt);var Xt=et.buffer,Ln=ze(Wt),Qe=et.offset+Ln;Wt=I.write.call(Xt,sn,Qe);var ft=ze(Wt);Ln!==ft&&I.copy.call(Xt,Xt,Qe+ft-Ln,Qe,Qe+Wt),ne[1===ft?160+Wt:ft<=3?215+ft:219](et,Wt),et.offset+=Wt}}(me?function gt(ze){return ze<32?1:ze<=65535?3:5}:function Fe(ze){return ze<32?1:ze<=255?2:ze<=65535?3:5}),symbol:Je,undefined:Je};function Pe(ze,Xe){if(null===Xe)return Je(ze,Xe);if(K(Xe))return de(ze,Xe);if(E(Xe))return function ct(ze,Xe){var et=Xe.length;ne[et<16?144+et:et<=65535?220:221](ze,et);for(var Wt=ze.codec.encode,Zn=0;Zn<et;Zn++)Wt(ze,Xe[Zn])}(ze,Xe);if(R.isUint64BE(Xe))return function Ft(ze,Xe){ne[207](ze,Xe.toArray())}(ze,Xe);if(P.isInt64BE(Xe))return function He(ze,Xe){ne[211](ze,Xe.toArray())}(ze,Xe);var et=ze.codec.getExtPacker(Xe);if(et&&(Xe=et(Xe)),Xe instanceof A)return function Li(ze,Xe){var et=Xe.buffer,sn=et.length;ne[q[sn]||(sn<255?199:sn<=65535?200:201)](ze,sn),j[Xe.type](ze),ze.send(et)}(ze,Xe);Le(ze,Xe)}function Je(ze,Xe){ne[192](ze,Xe)}function bn(ze,Xe){var et=Xe.length;ne[et<255?196:et<=65535?197:198](ze,et),ze.send(Xe)}function br(ze,Xe){var et=Object.keys(Xe),sn=et.length;ne[sn<16?128+sn:sn<=65535?222:223](ze,sn);var Zn=ze.codec.encode;et.forEach(function(Xt){Zn(ze,Xt),Zn(ze,Xe[Xt])})}}},7857:(je,Y)=>{for(var V=Y.h=new Array(256),E=0;E<=255;E++)V[E]=Z(E);function Z(R){return function(P){var k=P.reserve(1);P.buffer[k]=R}}},9822:je=>{function Y(R){var P="    ";if(isNaN(parseInt(R)))P=R;else switch(R){case 1:P=" ";break;case 2:P="  ";break;case 3:P="   ";break;case 4:P="    ";break;case 5:P="     ";break;case 6:P="      ";break;case 7:P="       ";break;case 8:P="        ";break;case 9:P="         ";break;case 10:P="          ";break;case 11:P="           ";break;case 12:P="            "}for(var k=["\n"],I=0;I<100;I++)k.push(k[I]+P);return k}function V(){this.step="    ",this.shift=Y(this.step)}function E(R,P){return P-(R.replace(/\(/g,"").length-R.replace(/\)/g,"").length)}function Z(R,P){return R.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+P+P+"AND ").replace(/ BETWEEN /gi,"~::~"+P+"BETWEEN ").replace(/ CASE /gi,"~::~"+P+"CASE ").replace(/ ELSE /gi,"~::~"+P+"ELSE ").replace(/ END /gi,"~::~"+P+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+P+"ON ").replace(/ OR /gi,"~::~"+P+P+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+P+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+P).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+P+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}V.prototype.xml=function(R,P){var k=R.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),I=k.length,S=!1,j=0,A="",T=0,F=P?Y(P):this.shift;for(T=0;T<I;T++)k[T].search(/<!/)>-1?(A+=F[j]+k[T],S=!0,(k[T].search(/-->/)>-1||k[T].search(/\]>/)>-1||k[T].search(/!DOCTYPE/)>-1)&&(S=!1)):k[T].search(/-->/)>-1||k[T].search(/\]>/)>-1?(A+=k[T],S=!1):/^<\w/.exec(k[T-1])&&/^<\/\w/.exec(k[T])&&/^<[\w:\-\.\,]+/.exec(k[T-1])==/^<\/[\w:\-\.\,]+/.exec(k[T])[0].replace("/","")?(A+=k[T],S||j--):k[T].search(/<\w/)>-1&&-1==k[T].search(/<\//)&&-1==k[T].search(/\/>/)?A=A+=S?k[T]:F[j++]+k[T]:k[T].search(/<\w/)>-1&&k[T].search(/<\//)>-1?A=A+=S?k[T]:F[j]+k[T]:k[T].search(/<\//)>-1?A=A+=S?k[T]:F[--j]+k[T]:k[T].search(/\/>/)>-1?A=A+=S?k[T]:F[j]+k[T]:k[T].search(/<\?/)>-1||k[T].search(/xmlns\:/)>-1||k[T].search(/xmlns\=/)>-1?A+=F[j]+k[T]:A+=k[T];return"\n"==A[0]?A.slice(1):A},V.prototype.json=function(R,k){return k=k||this.step,typeof JSON>"u"?R:"string"==typeof R?JSON.stringify(JSON.parse(R),null,k):"object"==typeof R?JSON.stringify(R,null,k):R},V.prototype.css=function(R,P){var k=R.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),I=k.length,S=0,j="",A=0,T=P?Y(P):this.shift;for(A=0;A<I;A++)/\{/.exec(k[A])?j+=T[S++]+k[A]:/\}/.exec(k[A])?j+=T[--S]+k[A]:(/\*\\/.exec(k[A]),j+=T[S]+k[A]);return j.replace(/^\n{1,}/,"")},V.prototype.sql=function(R,P){var k=R.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),I=k.length,S=[],j=0,A=this.step,q=0,W="",U=0,ne=P?Y(P):this.shift;for(U=0;U<I;U++)S=S.concat(U%2?k[U]:Z(k[U],A));for(I=S.length,U=0;U<I;U++)q=E(S[U],q),/\s{0,}\s{0,}SELECT\s{0,}/.exec(S[U])&&(S[U]=S[U].replace(/\,/g,",\n"+A+A)),/\s{0,}\s{0,}SET\s{0,}/.exec(S[U])&&(S[U]=S[U].replace(/\,/g,",\n"+A+A)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(S[U])?W+=ne[++j]+S[U]:/\'/.exec(S[U])?(q<1&&j&&j--,W+=S[U]):(W+=ne[j]+S[U],q<1&&j&&j--);return W.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},V.prototype.xmlmin=function(R,P){return(P?R:R.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},V.prototype.jsonmin=function(R){return typeof JSON>"u"?R:JSON.stringify(JSON.parse(R),null,0)},V.prototype.cssmin=function(R,P){return(P?R:R.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},V.prototype.sqlmin=function(R){return R.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},je.exports=new V},477:()=>{},467:(je,Y,V)=>{"use strict";function E(R,P,k,I,S,j,A){try{var T=R[j](A),F=T.value}catch(q){return void k(q)}T.done?P(F):Promise.resolve(F).then(I,S)}function Z(R){return function(){var P=this,k=arguments;return new Promise(function(I,S){var j=R.apply(P,k);function A(F){E(j,I,S,A,T,"next",F)}function T(F){E(j,I,S,A,T,"throw",F)}A(void 0)})}}V.d(Y,{A:()=>Z})},4469:je=>{"use strict";je.exports={version:"2.0.0"}}},je=>{je(je.s=3695)}]);